var lalolib=function(){function laloprint(e,r,t){if(void 0===r)var r="LALOLibOutput"
if(void 0===t)var t=!0
return printMat(e,size(e),r,t)}function printMat(e,r,t,a){if(void 0===a)var a=!1
if(void 0===t||!0===t){if("matrix"==type(e)){var n,i,o="[",l=r[0],s=r[1]
for(n=0;n<l;n++){for(o+="[",i=0;i<s-1;i++)o+=printNumber(e.val[n*e.n+i])+","
o+=n<l-1?printNumber(e.val[n*e.n+i])+"]; ":printNumber(e.val[n*e.n+i])+"]"}return o+="]"}if("vector"==type(e)){for(var s=e.length,o="",n=0;n<s;n++)o+="[ "+printNumber(e[n])+" ]<br>"
return console.log(o),o}}else{var n,i,c=""
if(isScalar(e))c+=e+"<br>"
else if("vector"==type(e)){var s=r[0]
for(n=0;n<s;n++)c+="[ "+printNumber(e[n])+" ]<br>"}else{var l=r[0],s=r[1]
for(n=0;n<l;n++){for(c+="[ ",i=0;i<s-1;i++)c+=printNumber(e.val[n*e.n+i])+", "
c+=printNumber(e.val[n*e.n+i])+" ]<br>"}}a?document.getElementById(t).innerHTML+=c:document.getElementById(t).innerHTML=c}}function printNumber(e){switch(typeof e){case"undefined":return"0"
case"string":case"boolean":return e
default:if(e==1/0)return"Inf"
if(e==-1/0)return"-Inf"
var r=Math.floor(e)
return Math.abs(e-r)<2.23e-16?""+r:e.toFixed(printPrecision)}}function error(e){throw new Error(e)}function plot(e){for(var r,t,a,n,i=new Array,o=new Array,l=new Array,s=1/0,c=-1/0,u=1/0,f=-1/0,d=0,h=0;d<arguments.length;){if("vector"==type(arguments[d]))d+1<arguments.length&&"vector"==type(arguments[d+1])?(r=arguments[d],t=arguments[d+1],d++):(t=arguments[d],r=range(t.length))
else{if("matrix"!=type(arguments[d]))return"undefined"
if(1==arguments[d].n)t=arguments[d].val,r=range(t.length)
else if(1==arguments[d].m)t=arguments[d].val,r=range(t.length)
else{if(2!=arguments[d].n){r=range(arguments[d].n)
for(var m=0;m<arguments[d].m;m++){for(t=arguments[d].row(m),i[h]=[new Array(r.length),new Array(r.length)],n=0;n<r.length;n++)i[h][0][n]=r[n],i[h][1][n]=t[n],r[n]<s&&(s=r[n]),r[n]>c&&(c=r[n]),t[n]>f&&(f=t[n]),t[n]<u&&(u=t[n])
o[h]=void 0,l[h]="",h++}d++
continue}r=getCols(arguments[d],[0]),t=getCols(arguments[d],[1])}}for(a=void 0,d+1<arguments.length&&"string"==type(arguments[d+1])&&(a=arguments[d+1],d++),legend="",d+1<arguments.length&&"string"==type(arguments[d+1])&&(legend=arguments[d+1],d++),i[h]=[new Array(r.length),new Array(r.length)],n=0;n<r.length;n++)i[h][0][n]=r[n],i[h][1][n]=t[n],r[n]<s&&(s=r[n]),r[n]>c&&(c=r[n]),t[n]>f&&(f=t[n]),t[n]<u&&(u=t[n])
o[h]=a,l[h]=legend,h++,d++}var p=c-s,v=Math.max(f-u,1)
c+=.1*p,s-=.1*p,f+=.1*v,u-=.1*v,u>0&&(u=-.1*f),f<0&&(f=-.1*u)
var b={data:i,minX:s,maxX:c,minY:u,maxY:f,styles:o,legend:l},g="LALOLibPlot"+LALOLibPlotsIndex
LALOLibOutput.innerHTML+="<br><div style='position:relative;left:0px;top:0px;text-align:left;'> <div><a onmousemove='mouseposition(event,"+LALOLibPlotsIndex+");' onmousedown='mousestartmove(event,"+LALOLibPlotsIndex+");' onmouseup='mousestopmove(event);' onmouseleave='mousestopmove(event);' ondblclick='zoomoriginal("+LALOLibPlotsIndex+");'><canvas id='"+g+"'  width='500' height='500' style='border: 1px solid black;'></canvas></a></div> <label id='lblposition"+LALOLibPlotsIndex+"'></label> <div style='position: absolute;left: 550px;top: -1em;'> <canvas id='legend"+LALOLibPlotsIndex+"' width='50' height='500'></canvas></div> <div id='legendtxt"+LALOLibPlotsIndex+"' style='position: absolute;left: 610px;top: 0;'></div> </div>"
var x=20
LALOLibPlots[LALOLibPlotsIndex]=new Plot(g),LALOLibPlots[LALOLibPlotsIndex].setScalePlot(b.minX,b.maxX,200,b.scaleY),b.minY&&b.maxY&&LALOLibPlots[LALOLibPlotsIndex].view(b.minX,b.maxX,b.minY,b.maxY)
var d,y,w=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,0]
for(d=0;d<b.data.length;d++){var M=!0,_=!0
for("string"==typeof b.styles[d]?(b.styles[d].indexOf(".")>=0&&(M=!1,b.styles[d]=b.styles[d].replace(".","")),b.styles[d].indexOf("_")>=0&&(_=!1,b.styles[d]=b.styles[d].replace("_","")),y=parseColor(b.styles[d]),y<0?y=w.splice(0,1)[0]:w.splice(w.indexOf(y),1)):y=y=w.splice(0,1)[0],void 0===y&&(y=0),n=0;n<b.data[d][0].length;n++)_&&LALOLibPlots[LALOLibPlotsIndex].addPoint(b.data[d][0][n],b.data[d][1][n],y),M&&n<b.data[d][0].length-1&&LALOLibPlots[LALOLibPlotsIndex].plot_line(b.data[d][0][n],b.data[d][1][n],b.data[d][0][n+1],b.data[d][1][n+1],y)
if(""!=b.legend[d]){var k=document.getElementById("legend"+LALOLibPlotsIndex).getContext("2d")
setcolor(k,y),k.lineWidth="3",_&&(k.beginPath(),k.arc(25,x,5,0,2*Math.PI,!0),k.closePath(),k.fill()),M&&(k.beginPath(),k.moveTo(0,x),k.lineTo(50,x),k.stroke()),x+=20,document.getElementById("legendtxt"+LALOLibPlotsIndex).innerHTML+=b.legend[d]+"<br>"}}for(var A=0;A<=LALOLibPlotsIndex;A++)LALOLibPlots[A].replot()
window.addEventListener&&document.getElementById(g).addEventListener("DOMMouseScroll",this.mousezoom,!1),document.getElementById(g).onmousewheel=this.mousezoom,LALOLibPlotsIndex++}function colorplot(e){var r,t,a,n,i=1/0,o=-1/0,l=1/0,s=-1/0,c=1/0,u=-1/0,f=type(arguments[0])
if("matrix"==f&&3==arguments[0].n)r=getCols(arguments[0],[0]),t=getCols(arguments[0],[1]),a=getCols(arguments[0],[2])
else if("matrix"==f&&2==arguments[0].n&&"vector"==type(arguments[1]))r=getCols(arguments[0],[0]),t=getCols(arguments[0],[1]),a=arguments[1]
else{if("vector"!=f||"vector"!=type(arguments[1])||"vector"!=type(arguments[2]))return"undefined"
r=arguments[0],t=arguments[1],a=arguments[2]}var i=min(r),o=max(r),l=min(t),s=max(t),c=min(a),u=max(a),d=o-i,h=Math.max(s-l,1)
o+=.1*d,i-=.1*d,s+=.1*h,l-=.1*h,l>0&&(l=-.1*s),s<0&&(s=-.1*l)
var m={x:r,y:t,z:a,minX:i,maxX:o,minY:l,maxY:s,minZ:c,maxZ:u},p="LALOLibPlot"+LALOLibPlotsIndex,v=50
LALOLibOutput.innerHTML+="<br><div style='position:relative;left:0px;top:0px;text-align:left;'> <div><a onmousemove='mouseposition(event,"+LALOLibPlotsIndex+");' onmousedown='mousestartmove(event,"+LALOLibPlotsIndex+");' onmouseup='mousestopmove(event);' onmouseleave='mousestopmove(event);' ondblclick='zoomoriginal("+LALOLibPlotsIndex+");'><canvas id='"+p+"'  width='500' height='500' style='border: 1px solid black;'></canvas></a></div> <label id='lblposition"+LALOLibPlotsIndex+"'></label> <div style='position: absolute;left: 550px;top: -1em;'><label id='legendmaxZ"+LALOLibPlotsIndex+"' style='font-family:verdana;font-size:80%;'></label><br>  <canvas id='legend"+LALOLibPlotsIndex+"' width='"+v+"' height='500'></canvas><br><label id='legendminZ"+LALOLibPlotsIndex+"' style='font-family:verdana;font-size:80%;'></label></div> <div id='legendtxt"+LALOLibPlotsIndex+"' style='position: absolute;left: 610px;top: 0;'></div> </div>",LALOLibPlots[LALOLibPlotsIndex]=new ColorPlot(p),LALOLibPlots[LALOLibPlotsIndex].setScale(m.minX,m.maxX,m.minY,m.maxY,m.minZ,m.maxZ),LALOLibPlots[LALOLibPlotsIndex].view(m.minX,m.maxX,m.minY,m.maxY)
for(var n=0;n<m.x.length;n++)LALOLibPlots[LALOLibPlotsIndex].addPoint(m.x[n],m.y[n],m.z[n])
LALOLibPlots[LALOLibPlotsIndex].replot()
var v=50,b=document.getElementById("legend"+LALOLibPlotsIndex).getContext("2d"),g=document.getElementById("legend"+LALOLibPlotsIndex)
if(g)var x=g.height
else var x=500
for(var t,n=0;n<LALOLibPlots[LALOLibPlotsIndex].cmap.length;n++)t=Math.floor(n*x/LALOLibPlots[LALOLibPlotsIndex].cmap.length),b.fillStyle="rgb("+LALOLibPlots[LALOLibPlotsIndex].cmap[n][0]+","+LALOLibPlots[LALOLibPlotsIndex].cmap[n][1]+","+LALOLibPlots[LALOLibPlotsIndex].cmap[n][2]+")",b.fillRect(0,x-t,v,x/LALOLibPlots[LALOLibPlotsIndex].cmap.length+1)
document.getElementById("legendmaxZ"+LALOLibPlotsIndex).innerHTML=m.maxZ.toPrecision(3),document.getElementById("legendminZ"+LALOLibPlotsIndex).innerHTML=m.minZ.toPrecision(3),window.addEventListener&&document.getElementById(p).addEventListener("DOMMouseScroll",this.mousezoom,!1),document.getElementById(p).onmousewheel=this.mousezoom,LALOLibPlotsIndex++}function plot3(e){for(var r,t,a,n,i,o,l=new Array,s=new Array,c=new Array,u=0,f=0;u<arguments.length;){if("vector"==type(arguments[u])){if(!(u+2<arguments.length&&"vector"==type(arguments[u+1])&&"vector"==type(arguments[u+2])))return"undefined"
r=arguments[u],t=arguments[u+1],a=arguments[u+2],u+=2}else{if("matrix"!=type(arguments[u]))return"undefined"
for(o=arguments[u].length,r=new Array(o),t=new Array(o),a=new Array(o),i=0;i<o;i++)r[i]=get(arguments[u],i,0),t[i]=get(arguments[u],i,1),a[i]=get(arguments[u],i,2)}for(n=void 0,u+1<arguments.length&&"string"==type(arguments[u+1])&&(n=arguments[u+1],u++),legend="",u+1<arguments.length&&"string"==type(arguments[u+1])&&(legend=arguments[u+1],u++),l[f]=new Array,i=0;i<r.length;i++)l[f][i]=[r[i],t[i],a[i]]
s[f]=n,c[f]=legend,f++,u++}var d={data:l,styles:s,legend:c},h="LALOLibPlot"+LALOLibPlotsIndex
LALOLibOutput.innerHTML+='<br><div style="position:relative;left:0px;top:0px;text-align:left;"> <div><a onmousedown="LALOLibPlots['+LALOLibPlotsIndex+'].mousedown(event);" onmouseup="LALOLibPlots['+LALOLibPlotsIndex+'].mouseup(event);" onmousemove="LALOLibPlots['+LALOLibPlotsIndex+'].mouserotation(event);"><canvas id="'+h+'" width="500" height="500" style="border: 1px solid black;" title="Hold down the mouse button to change the view and use the mousewheel to zoom in or out." ></canvas></a></div><label id="lblposition'+LALOLibPlotsIndex+'"></label> <div style="position: absolute;left: 550px;top: -1em;"> <canvas id="legend'+LALOLibPlotsIndex+'" width="50" height="500"></canvas></div> <div id="legendtxt'+LALOLibPlotsIndex+'" style="position: absolute;left: 610px;top: 0;"></div> </div>'
var m=20
LALOLibPlots[LALOLibPlotsIndex]=new Plot3D(h),LALOLibPlots[LALOLibPlotsIndex].cameraDistance=30,LALOLibPlots[LALOLibPlotsIndex].angleX=Math.PI/10,LALOLibPlots[LALOLibPlotsIndex].angleZ=Math.PI/10,LALOLibPlots[LALOLibPlotsIndex].axisNameX1="x",LALOLibPlots[LALOLibPlotsIndex].axisNameX2="y",LALOLibPlots[LALOLibPlotsIndex].axisNameX3="z"
var u,p,v=[1,2,3,4,5,0]
for(u=0;u<d.data.length;u++){var b=!1,g=!0
for("string"==typeof d.styles[u]?(d.styles[u].indexOf(".")>=0&&(b=!1,d.styles[u]=d.styles[u].replace(".","")),d.styles[u].indexOf("_")>=0&&(g=!1,d.styles[u]=d.styles[u].replace("_","")),p=parseColor(d.styles[u]),p<0?p=v.splice(0,1)[0]:v.splice(v.indexOf(p),1)):p=p=v.splice(0,1)[0],void 0===p&&(p=0),i=0;i<d.data[u].length;i++)g&&(LALOLibPlots[LALOLibPlotsIndex].X.push(d.data[u][i]),LALOLibPlots[LALOLibPlotsIndex].Y.push(p)),b&&i<d.data[u].length-1&&LALOLibPlots[LALOLibPlotsIndex].plot_line(d.data[u][i],d.data[u][i+1],"",p)
if(""!=d.legend[u]){var x=document.getElementById("legend"+LALOLibPlotsIndex).getContext("2d")
setcolor(x,p),x.lineWidth="3",g&&(x.beginPath(),x.arc(25,m,5,0,2*Math.PI,!0),x.closePath(),x.fill()),b&&(x.beginPath(),x.moveTo(0,m),x.lineTo(50,m),x.stroke()),m+=20,document.getElementById("legendtxt"+LALOLibPlotsIndex).innerHTML+=d.legend[u]+"<br>"}}LALOLibPlots[LALOLibPlotsIndex].computeRanges(),LALOLibPlots[LALOLibPlotsIndex].replot(),LALOLibPlotsIndex++}function image(e,r){"vector"==type(e)&&(e=mat([e]))
var t,a,n,i=min(e),o=max(e),l=e.length,s=e.n,c=o-i,u=0,f=new Array
for(a=0;a<l;a++){var d=e.row(a)
for(n=0;n<s;n++)M=mul((d[n]-i)/c,ones(3)),f[u]=[a/l,n/s,M],u++}t=[l,s,i,o]
var h,m,a,p={data:f,style:t,title:r},v="LALOLibPlot"+LALOLibPlotsIndex,b=50,g=500,x=500,r=p.title
r&&(LALOLibOutput.innerHTML+="<h3>"+r+"</h3>  ( "+p.style[0]+" by "+p.style[1]+" matrix )"),p.style[1]>g&&(g=p.style[1],plotlegend.style.left=g+60+"px"),p.style[0]>x&&(x=p.style[0]),h=g/p.style[1],m=x/p.style[0]
var b=50
LALOLibOutput.innerHTML+='<div style="position:relative;left:0px;top:0px;text-align:left;"> <div><a onmousemove="mouseimageposition(event,'+LALOLibPlotsIndex+');"><canvas id="'+v+'"  width="'+g+'" height="'+x+'" style="border: 1px solid black;"></canvas></a></div><label id="lblposition'+LALOLibPlotsIndex+'"></label> <div style="position: absolute;left: 550px;top: -1em;">'+p.style[2].toFixed(3)+'<br> <canvas id="legend'+LALOLibPlotsIndex+'" width="'+b+'" height="500"></canvas> <br>'+p.style[3].toFixed(3)+" </div>  </div>"
var y,w,M
LALOLibPlots[LALOLibPlotsIndex]=p,LALOLibPlots[LALOLibPlotsIndex].canvasId=v
var _=document.getElementById(v)
if(_.getContext){var k=_.getContext("2d")
for(a=0;a<p.data.length;a++)y=_.width*LALOLibPlots[LALOLibPlotsIndex].data[a][1],w=_.height*LALOLibPlots[LALOLibPlotsIndex].data[a][0],M=LALOLibPlots[LALOLibPlotsIndex].data[a][2],k.fillStyle="rgb("+Math.floor(255*(1-M[0]))+","+Math.floor(255*(1-M[1]))+","+Math.floor(255*(1-M[2]))+")",k.fillRect(y,w,h+1,m+1)}var A=document.getElementById("legend"+LALOLibPlotsIndex),k=A.getContext("2d")
for(a=0;a<255;a++)w=Math.floor(a*A.height/255),k.fillStyle="rgb("+(255-a)+","+(255-a)+","+(255-a)+")",k.fillRect(0,w,b,A.height/255+1)
LALOLibPlots[LALOLibPlotsIndex].pixelWidth=h,LALOLibPlots[LALOLibPlotsIndex].pixelHeight=m,LALOLibPlotsIndex++}function parseColor(e){if(void 0===e)return-1
var r
switch(e){case"k":case"black":r=0
break
case"blue":case"b":r=1
break
case"r":case"red":r=2
break
case"g":case"green":r=3
break
case"m":case"magenta":r=4
break
case"y":case"yellow":r=5
break
default:r=-1}return r}function mousezoom(e,r,t){if(e||(e=window.event),e.preventDefault(),void 0===t)var t=0
if(void 0===r){var r=0
e.wheelDelta?r=e.wheelDelta/30:e.detail&&(r=-e.detail)}else 0!=e.button&&(r*=-1)
var a=document.getElementById(LALOLibPlots[t].canvasId),n=a.getBoundingClientRect(),i=e.clientX-n.left,o=e.clientY-n.top
LALOLibPlots[t].zoom(1+r/30,1+r/30,i,o)}function zoomoriginal(e){LALOLibPlots[e].resetzoom()}function mouseposition(e,r){var t=document.getElementById(LALOLibPlots[r].canvasId),a=t.getBoundingClientRect(),n=e.clientX-a.left,i=e.clientY-a.top
if(LALOLABPLOTMOVING){var o=n-LALOLABPLOTxprev,l=i-LALOLABPLOTyprev;(Math.abs(o)>1||Math.abs(l)>1)&&LALOLibPlots[r].translate(o,l),LALOLABPLOTxprev=n,LALOLABPLOTyprev=i}else{var s=n/LALOLibPlots[r].scaleX+LALOLibPlots[r].minX,c=(t.height-i)/LALOLibPlots[r].scaleY+LALOLibPlots[r].minY
document.getElementById("lblposition"+r).innerHTML="x = "+s.toFixed(3)+", y = "+c.toFixed(3)}}function mousestartmove(e,r){if(0==e.button){LALOLABPLOTMOVING=!0
var t=document.getElementById(LALOLibPlots[r].canvasId),a=t.getBoundingClientRect()
LALOLABPLOTxprev=e.clientX-a.left,LALOLABPLOTyprev=e.clientY-a.top}else LALOLABPLOTMOVING=!1}function mousestopmove(e){LALOLABPLOTMOVING=!1}function mouseimageposition(e,r){var t=document.getElementById(LALOLibPlots[r].canvasId),a=t.getBoundingClientRect(),n=e.clientX-a.left,i=e.clientY-a.top,o=LALOLibPlots[r].style[1],l=LALOLibPlots[r].style[2],s=LALOLibPlots[r].style[3],c=Math.floor(i/LALOLibPlots[r].pixelHeight),u=Math.floor(n/LALOLibPlots[r].pixelWidth)
if(u<o){var f=LALOLibPlots[r].data[c*o+u][2][0]*(s-l)+l
document.getElementById("lblposition"+r).innerHTML="Matrix[ "+c+" ][ "+u+" ] = "+f.toFixed(3)}}function lalo(e){var r=laloparse(e)
return self.eval(r)}function laloparse(e){var r,t=e.split("\n"),a=""
for(r=0;r<t.length;r++)t[r].length>0&&(t[r].indexOf("{")>=0||t[r].indexOf("}")>=0?(a+=t[r],t[r].indexOf("}")>=0&&(a+=" ;\n")):a+=parseCommand(t[r])+" ;\n")
return a}function parseSplittedCommand(e){var r,t,a,n,i=["==","!=",">=","<=",">","<","\\",":","+","-",".*","*","./","^","'"],o=["isEqual","isNotEqual","isGreaterOrEqual","isLowerOrEqual","isGreater","isLower","solve","range","add","sub","entrywisemul","mul","entrywisediv","pow","undefined"],l=["","","","","","","","range","","minus","","","","","transpose"]
for(r=0;r<i.length;r++){var s=e.split(i[r])
if(s.length>1)if(""!=removeSpaces(s[0]))if(""!=removeSpaces(s[1])){for(a=parseSplittedCommand(s[0]),t=1;t<s.length;t++)n=s[t],a=o[r]+"("+a+","+parseSplittedCommand(n)+")"
e=a}else e=l[r]+"("+parseSplittedCommand(s[0])+")"
else{for(a=l[r]+"("+parseSplittedCommand(s[1])+")",t=2;t<s.length;t++)n=s[t],a=o[r]+"("+a+","+parseSplittedCommand(n)+")"
e=a}}return e}function parseAssignment(e){if(e.indexOf("[")<0)return e
var r=removeSpaces(e).replace("=","").replace(",","]["),t=r.indexOf("]["),a=r.indexOf("["),n=r.substr(0,a)
if(t>=0){for(var i=r.substr(a+1,t-a-1),o=t+1;r.indexOf("]",o+1)>=0;)o=r.indexOf("]",o+1)
var l=r.substr(t+2,o-(t+2)),s=i.split(":")
2==s.length?i=""==s[0]&&""==s[1]?"[]":"range("+s[0]+","+s[1]+")":3==s.length&&(i="range("+s[0]+","+s[2]+","+s[1]+")")
var c=l.split(":")
return 2==c.length?l=""==c[0]&&""==c[1]?"[]":"range("+c[0]+","+c[1]+")":3==c.length&&(l="range("+c[0]+","+c[2]+","+c[1]+")"),"set( "+n+","+i+","+l+", "}for(var o=a;r.indexOf("]",o+1)>=0;)o=r.indexOf("]",o+1)
var i=r.substr(a+1,o-a-1),s=i.split(":")
return 2==s.length?i=""==s[0]&&""==s[1]?"[]":"range("+s[0]+","+s[1]+")":3==s.length&&(i="range("+s[0]+","+s[2]+","+s[1]+")"),"set( "+n+","+i+", "}function parseBrackets(e){var r=["[","(",",",";",")","\\","+","-","*","/",":","^","'","=",">","<","!"]
e=e.split("][").join(",")
var t,a,n,i,o,l=e.split("")
for(t=l.length-1;t>=0;){for(;t>=0&&"["!=l[t];)t--
if(t>=0){for(a=t+1;a<l.length&&"]"!=l[a];)a++
if(!(a<l.length))return
for(i=0,n=0;n<t;)r.indexOf(l[n])>=0&&(i=n+1),n++
if(o=l.slice(i,t).join(""),""==removeSpaces(o)){l[t]="#",n=t+1
for(var s=!1,c=!1;n<a;)l[n],";"==l[n]&&(s=!0,c?(l.splice(n,1,["@",","]),c=!1):l[n]=","),n++
l[a]=s?"$":"@"}else{for(l[i]="get("+o,n=i+1;n<t;n++)l[n]=""
l[t]=",",l[a]=")"}}t--}return l.join("").split("#").join("mat([").split("$").join("], true)").split("@").join("])")}function parseCommand(e){var r=e.indexOf("//")
r>=0&&(e=e.substr(0,r))
var t=e.split("==")[0].split("!=")[0].split(">=")[0].split("<=")[0].indexOf("=")
if(t>0){var a=parseAssignment(e.substr(0,t+1)),n=e.substr(t+1)
if(a.indexOf("set(")<0&&void 0!==self[removeSpaces(n)]&&!isScalar(self[removeSpaces(n)])){var i=a+"matrixCopy("+n+")"
return console.log(i),i}}else var a="",n=e
var o,l,s,c=parseBrackets(n).split(""),u=["(","[",",",";"],f=[")","]",",",";"],d="",h=new Array(c.length),m=new Array(c.length)
for(s=0;s<c.length;s++)m[s]=s,h[s]=c[s]
for(o=c.length-1;o>=0;){for(;o>=0&&u.indexOf(c[o])<0;)o--
if(o>=0){for(l=o+1;l<c.length&&f.indexOf(c[l])<0;)l++
if(!(l<c.length))return"undefined"
for(d=parseSplittedCommand(h.slice(m[o]+1,m[l]).join("")),h.splice(m[o]+1,m[l]-m[o]-1,d),","!=c[o]&&(c[o]=" "),c[l]=" ",s=o+1;s<l;s++)m[s]=m[o]+1
var p=m[l]-m[o]-1
for(s=l;s<c.length;s++)m[s]+=1-p}o--}var i=a+parseSplittedCommand(h.join(""))
return"set("==a.substr(0,4)&&(i+=" )"),i=parseRangeRange(i),console.log(i),i}function parseRangeRange(e){var r,t,a,n,i,o,l=e.split("range(range(")
for(r=0;r<l.length-1;r++){for(n=l[r+1].split(","),a=n[2].split(")"),o=a[0],t=0;a[t].indexOf("(")>=0;)o=o+")"+a[t+1],t++
i=n[1].substr(0,n[1].length-1),n[1]=o,n[2]=i+")"+a.slice(t+1).join(")"),l[r+1]=n.join(",")}return l.join("range(")}function removeSpaces(e){return e.split(" ").join("")}function MLlab(e,r){return new Lalolab(e,!0,r)}function Lalolab(e,r,t){if(this.id=e,this.callbacks=new Array,void 0===t)var t="http://mlweb.loria.fr/"
else t.length>0&&"/"!=t[t.length-1]&&(t=[t,"/"].join(""))
void 0!==r&&r?(this.worker=new Worker(t+"mlworker.js"),this.labtype="ml"):(this.worker=new Worker(t+"lalolibworker.js"),this.labtype="lalo"),this.worker.onmessage=this.onresult,this.worker.parent=this}function importLaloScript(e){var r=new XMLHttpRequest
return r.open("GET",e,!1),r.send(),lalo(r.responseText)}function getObjectWithoutFunc(e){if("object"!=typeof e)return e
var r={}
for(var t in e)switch(type(e[t])){case"vector":r[t]={type:"vector",data:[].slice.call(e[t])}
break
case"matrix":r[t]=e[t],r[t].val=[].slice.call(e[t].val)
break
case"spvector":r[t]=e[t],r[t].val=[].slice.call(e[t].val),r[t].ind=[].slice.call(e[t].ind)
break
case"spmatrix":r[t]=e[t],r[t].val=[].slice.call(e[t].val),r[t].cols=[].slice.call(e[t].cols),r[t].rows=[].slice.call(e[t].rows)
break
case"undefined":r[t]=e[t]
break
case"function":break
case"Array":r[t]=getObjectWithoutFunc(e[t]),r[t].type="Array",r[t].length=e[t].length
break
default:r[t]=getObjectWithoutFunc(e[t])}return r}function renewObject(obj){var to=type(obj)
switch(to){case"number":case"boolean":case"string":case"undefined":return obj
case"vector":return new Float64Array(obj.data)
case"matrix":return new Matrix(obj.m,obj.n,obj.val)
case"spvector":return new spVector(obj.length,obj.val,obj.ind)
case"spmatrix":return new spMatrix(obj.m,obj.n,obj.val,obj.cols,obj.rows)
case"object":var newobj={}
for(var p in obj)newobj[p]=renewObject(obj[p])
return newobj
case"Array":var newobj=new Array(obj.length)
for(var p in obj)newobj[p]=renewObject(obj[p])
return newobj
default:var typearray=obj.type.split(":"),Class=eval(typearray[0])
if(1==typearray.length)var newobj=new Class
else var newobj=new Class(typearray[1])
for(var p in obj)newobj[p]=renewObject(obj[p])
return"SVM"!=typearray[1]&&"SVR"!=typearray[1]||(newobj.kernelFunc=kernelFunction(newobj.kernel,newobj.kernelpar,"spmatrix"==type(newobj.SV)?"spvector":"vector")),"KernelRidgeRegression"==typearray[1]&&(newobj.kernelFunc=kernelFunction(newobj.kernel,newobj.kernelpar,"spmatrix"==type(newobj.X)?"spvector":"vector")),newobj}}function load_data(datastring){var i,cmd="mat( [ ",row,rows=datastring.split("\n"),ri
for(i=0;i<rows.length-1;i++)""!=(ri=removeFirstSpaces(rows[i]))&&(row=ri.replace(/,/g," ").replace(/ +/g,","),cmd+="new Float64Array(["+row+"]) ,")
return ri=removeFirstSpaces(rows[rows.length-1]),""!=ri?(row=ri.replace(/,/g," ").replace(/ +/g,","),cmd+="new Float64Array(["+row+"]) ] , true) "):(cmd=cmd.substr(0,cmd.length-1),cmd+="] , true) "),eval(cmd)}function removeFirstSpaces(e){for(var r=0;r<e.length&&" "==e[r];)r++
return r<e.length?e.slice(r):""}function notifyProgress(e){postMessage({progress:e}),console.log("progress: "+e)}function isZero(e){return Math.abs(e)<EPS}function isInteger(e){return Math.floor(e)==e}function tic(e){if("undefined"==typeof TICTOCstartTime&&(TICTOCstartTime=new Array),void 0===e)var e=0
TICTOCstartTime[e]=new Date}function toc(e){if(void 0===e)var e=0
if("undefined"!=typeof TICTOCstartTime&&void 0!==TICTOCstartTime[e]){var r=TICTOCstartTime[e]
return(new Date-r)/1e3}}function type(e){if(null==e)return"undefined"
if(e.type)return e.type
var r=typeof e
return"object"==r?Array.isArray(e)?isArrayOfNumbers(e)?"vector":"Array":e.buffer?"vector":r:r}function isArrayOfNumbers(e){for(var r=0;r<e.length;r++)if("number"!=typeof e[r])return!1
return!0}function isScalar(e){switch(typeof e){case"string":case"number":case"boolean":return!0
default:return"Complex"==type(e)}}function printVector(e){const r=e.length
for(var t="[ ",a=0;a<r-1&&a<5;)t+=(isInteger(e[a])?e[a]:e[a].toFixed(3))+"; ",a++
return t+=a==r-1?(isInteger(e[a])?e[a]:e[a].toFixed(3))+" ]":"... ] (length = "+r+")"}function Matrix(e,r,t){this.length=e,this.m=e,this.n=r,this.size=[e,r],this.type="matrix",2==arguments.length?this.val=new Float64Array(e*r):3==arguments.length?this.val=new Float64Array(t):4==arguments.length&&(this.val=t)}function array2mat(e){return mat(e,!0)}function array2vec(e){return vectorCopy(e)}function vec2array(e){return Array.apply([],e)}function size(e,r){var t
switch(type(e)){case"string":case"boolean":case"number":case"Complex":t=[1,1]
break
case"vector":case"spvector":case"ComplexVector":t=[e.length,1]
break
case"matrix":case"spmatrix":case"ComplexMatrix":t=e.size
break
case"object":default:t=[1,1]}return void 0===r?t:t[r-1]}function ones(e,r){if(1==arguments.length||1==r){for(var t=new Float64Array(e),a=0;a<e;a++)t[a]=1
return t}var n=new Matrix(e,r)
const i=e*r
for(var a=0;a<i;a++)n.val[a]=1
return n}function zeros(e,r){return 1==arguments.length||1==r?new Float64Array(e):new Matrix(e,r)}function eye(e,r){if(void 0===r)var r=e
if(1==e&&1==r)return 1
var t=zeros(e,r)
const a=e<r?e:r
for(var n=0;n<a;n++)t.val[n*(r+1)]=1
return t}function diag(e){var r,t=type(e)
if("vector"==t){var a=zeros(e.length,e.length),n=0
const i=e.length+1
for(r=0;r<e.length;r++)a.val[n]=e[r],n+=i
return a}if("matrix"==t){var o=Math.min(e.m,e.n),l=new Float64Array(o),n=0
const s=e.n+1
for(r=0;r<o;r++)l[r]=e.val[n],n+=s
return l}if("ComplexVector"==t){var a=new ComplexMatrix(e.length,e.length),n=0
const i=e.length+1
for(r=0;r<e.length;r++)a.re[n]=e.re[r],a.im[n]=e.im[r],n+=i
return a}if("ComplexMatrix"==t){var o=Math.min(e.m,e.n),l=new ComplexVector(o),n=0
const s=e.n+1
for(r=0;r<o;r++)l.re[r]=e.re[n],l.im[r]=e.im[n],n+=s
return l}}function vec(e){return new Float64Array(e.val)}function matrixCopy(e){switch(type(e)){case"vector":return vectorCopy(e)
case"ComplexVector":return new ComplexVector(e)
case"matrix":return new Matrix(e.m,e.n,e.val)
case"ComplexMatrix":return new ComplexMatrix(e)
case"Array":return arrayCopy(e)
case"spvector":case"spmatrix":return e.copy()
default:return void error("Error in matrixCopy(A): A is not a matrix nor a vector.")}}function vectorCopy(e){return new Float64Array(e)}function vectorCopyInto(e,r){r.set(e)}function arrayCopy(e){for(var r=new Array(e.length),t=0;t<e.length;t++)isScalar(e[t])?r[t]=e[t]:r[t]=matrixCopy(e[t])
return r}function appendRow(e){var r=zeros(e.m+1,e.n)
return r.val.set(e.val),r}function reshape(e,r,t){var a=void 0,n=type(e)
return"vector"==n?r*t!=e.length?error("Error in reshape(a,m,n): a.length = "+e.length+" != m*n"):a=new Matrix(r,t,e):"matrix"==n?r*t!=e.m*e.n?error("Error in reshape(A,m,n): A.m * A.n = "+e.m*e.n+" != m*n"):a=1==t?vectorCopy(e.val):new Matrix(r,t,e.val):error("Error in reshape(A): A is neither a vector nor a matrix."),a}function get(e,r,t){var a=typeof r,n=typeof t
if(1==arguments.length)return matrixCopy(e)
var o=type(e)
if("vector"==o)return"number"==a?r>=0&&r<e.length?e[r]:void error("Error in a[i] = get(a,i): Index i="+r+" out of bounds [0,"+(e.length-1)+"]"):getSubVector(e,r)
if("matrix"==o)return"number"==a&&(r=[r]),"number"==n&&(t=[t]),1==r.length&&1==t.length?e.val[r[0]*e.n+t[0]]:0==r.length?getCols(e,t):0==t.length?getRows(e,r):getSubMatrix(e,r,t)
if("Array"==o)return"number"==a?e[r]:getSubArray(e,r)
if("spmatrix"==o){if("number"==a&&(r=[r]),"number"==n&&(t=[t]),1==r.length&&1==t.length)return e.get(r[0],t[0])
if(1==r.length&&e.rowmajor)return e.row(r[0])
if(1==t.length&&!e.rowmajor)return e.col(t[0])
if(0==t.length)return spgetRows(e,r)
if(0==r.length)return spgetCols(e,t)}else{if("spvector"==o)return"number"==a?e.get(r):getSubspVector(e,r)
if("ComplexVector"==o)return"number"==a?e.get(r):e.getSubVector(r)
if("ComplexMatrix"==o)return"number"==a&&(r=[r]),"number"==n&&(t=[t]),1==r.length&&1==t.length?e.get(i,j):0==r.length?e.getCols(t):0==t.length?e.getRows(r):e.getSubMatrix(r,t)}}function getSubMatrix(e,r,t){var a,n,i,o=t.length
if(1==o)for(i=new Float64Array(r.length),a=0;a<r.length;a++)i[a]=e.val[r[a]*e.n+t[0]]
else{i=new Matrix(r.length,o)
var l=0
for(a=0;a<r.length;a++){var s=r[a]*e.n
for(n=0;n<o;n++)i.val[l+n]=e.val[s+t[n]]
l+=o}}return i}function getRows(e,r){var t=r.length
if(t>1){for(var a=new Matrix(t,e.n),n=0,i=0;i<t;i++){for(var o=0;o<e.n;o++)a.val[n+o]=e.val[r[i]*e.n+o]
n+=e.n}return a}return vectorCopy(e.val.subarray(r[0]*e.n,r[0]*e.n+e.n))}function getCols(e,r){var t=e.m,a=r.length
if(a>1){for(var n=new Matrix(t,a),i=0,o=0,l=0;l<t;l++){for(var s=0;s<a;s++)n.val[i+s]=e.val[o+r[s]]
i+=a,o+=e.n}return n}for(var n=new Float64Array(t),i=0,l=0;l<t;l++)n[l]=e.val[i+r[0]],i+=e.n
return n}function getSubVector(e,r){const t=r.length
for(var a=new Float64Array(t),n=0;n<t;n++)a[n]=e[r[n]]
return a}function getSubArray(e,r){const t=r.length
for(var a=new Array(t),n=0;n<t;n++)a[n]=e[r[n]]
return a}function getrowref(e,r){return e.val.subarray(r*e.n,(r+1)*e.n)}function set(e,r,t,a){var n=typeof r,i=typeof t
if(1!=arguments.length){var o=type(e)
if("vector"==o)return a=t,"number"==n?(e[r]=a,a):(0==r.length&&(r=range(e.length)),1==size(a,1)?setVectorScalar(e,r,a):setVectorVector(e,r,a),a)
if("matrix"==o){if("number"==n&&(r=[r]),"number"==i&&(t=[t]),1==r.length&&1==t.length)return e.val[r[0]*e.n+t[0]]=a,a
if(0==r.length)return setCols(e,t,a),a
if(0==t.length)return setRows(e,r,a),a
var l=size(a),s=type(a)
return 1==l[0]&&1==l[1]?"number"==s?setMatrixScalar(e,r,t,a):"vector"==s?setMatrixScalar(e,r,t,a[0]):setMatrixScalar(e,r,t,a.val[0]):1==t.length?setMatrixColVector(e,r,t[0],a):1==r.length?"vector"==s?setMatrixRowVector(e,r[0],t,a):setMatrixRowVector(e,r[0],t,a.val):setMatrixMatrix(e,r,t,a),a}return"ComplexVector"==o?(a=t,"number"==n?(e.set(r,a),a):(0==r.length&&(r=range(e.length)),1==size(a,1)?e.setVectorScalar(r,a):e.setVectorVector(r,a),a)):void 0}}function setVectorScalar(e,r,t){var a
for(a=0;a<r.length;a++)e[r[a]]=t}function setVectorVector(e,r,t){var a
for(a=0;a<r.length;a++)e[r[a]]=t[a]}function setMatrixScalar(e,r,t,a){var n,i,o=r.length,l=t.length
for(n=0;n<o;n++)for(i=0;i<l;i++)e.val[r[n]*e.n+t[i]]=a}function setMatrixMatrix(e,r,t,a){var n,i,o=r.length,l=t.length
for(n=0;n<o;n++)for(i=0;i<l;i++)e.val[r[n]*e.n+t[i]]=a.val[n*a.n+i]}function setMatrixColVector(e,r,t,a){var n,i=r.length
for(n=0;n<i;n++)e.val[r[n]*e.n+t]=a[n]}function setMatrixRowVector(e,r,t,a){var n,i=t.length
for(n=0;n<i;n++)e.val[r*e.n+t[n]]=a[n]}function setRows(e,r,t){var a,n,i,o=r.length
switch(type(t)){case"vector":for(a=0;a<o;a++)for(i=r[a]*e.n,n=0;n<t.length;n++)e.val[i+n]=t[n]
break
case"matrix":var l=0
for(a=0;a<o;a++){for(i=r[a]*e.n,n=0;n<t.n;n++)e.val[i+n]=t.val[l+n]
l+=t.n}break
default:for(a=0;a<o;a++)for(i=r[a]*e.n,n=0;n<e.n;n++)e.val[i+n]=t}}function setCols(e,r,t){var a,n=e.m,i=r.length,o=0
switch(type(t)){case"vector":for(a=0;a<n;a++){for(j=0;j<i;j++)e.val[o+r[j]]=t[a]
o+=e.n}break
case"matrix":for(a=0;a<n;a++){for(j=0;j<i;j++)e.val[o+r[j]]=t.val[a*t.n+j]
o+=e.n}break
default:for(a=0;a<n;a++){for(j=0;j<i;j++)e.val[o+r[j]]=t
o+=e.n}}}function dense(e){return e}function supp(e){const r=type(e)
if("vector"==r){var t,a=[]
for(t=0;t<e.length;t++)isZero(e[t])||a.push(t)
return a}return"spvector"==r?new Float64Array(e.ind):void 0}function range(e,r,t){if(void 0===e)return[]
if(void 0===t)var t=1
if(void 0===r){var r=e
e=0}if(e==r-t)return e
if(e==r)return[]
if(e>r){t>0&&(t*=-1)
for(var a=new Array(Math.floor((e-r)/Math.abs(t))),n=0,i=e;i>r;i+=t)a[n]=i,n++}else for(var a=new Array(Math.floor((r-e)/t)),n=0,i=e;i<r;i+=t)a[n]=i,n++
return a}function swaprows(e,r,t){if(r!=t){var a=r*e.n,n=t*e.n,i=vectorCopy(e.val.subarray(a,a+e.n))
e.val.set(vectorCopy(e.val.subarray(n,n+e.n)),a),e.val.set(i,n)}}function swapcols(e,r,t){if(r!=t){var a=getCols(e,[r])
setCols(e,[r],getCols(e,[t])),setCols(e,[t],a)}}function randnScalar(){var e,r,t,a
do{e=2*Math.random()-1,r=2*Math.random()-1,t=e*e+r*r}while(t>=1)
return t=Math.sqrt(-2*Math.log(t)/t),a=e*t,r*t,a}function randn(e,r){var t
if(void 0===e||1==e&&void 0===r||1==e&&1==r)return randnScalar()
if(void 0===r||1==r){t=new Float64Array(e)
for(var a=0;a<e;a++)t[a]=randnScalar()
return t}t=zeros(e,r)
for(var a=0;a<e*r;a++)t.val[a]=randnScalar()
return t}function randVector(e){for(var r=new Float64Array(e),t=0;t<e;t++)r[t]=Math.random()
return r}function randMatrix(e,r){const t=e*r
for(var a=new Float64Array(t),n=0;n<t;n++)a[n]=Math.random()
return new Matrix(e,r,a,!0)}function rand(e,r){return void 0===e||1==e&&void 0===r||1==e&&1==r?Math.random():void 0===r||1==r?randVector(e):randMatrix(e,r)}function randnsparse(e,r,t){var a
a=e>1?e:Math.floor(e*r*t)
var n,i,o,l,s
if(void 0===r)return randn()
if(void 0===t||1==t){for(n=randperm(r),s=zeros(r),i=0;i<a;i++)s[n[i]]=randn()
return s}for(s=zeros(r,t),n=randperm(r*t),l=0;l<a;l++)i=Math.floor(n[l]/t),o=n[l]-i*t,s.val[i*t+o]=randn()
return s}function randsparse(e,r,t){if(void 0===t)var t=1
var a
a=e>1?e:Math.floor(e*r*t)
var n,i,o,l,s
if(void 0===r)return randn()
if(1==t){for(n=randperm(r),s=zeros(r),i=0;i<a;i++)s[n[i]]=Math.random()
return s}for(s=zeros(r,t),n=randperm(r*t),l=0;l<a;l++)i=Math.floor(n[l]/t),o=n[l]-i*t,s.val[i*t+o]=Math.random()
return s}function randperm(e){if("number"==typeof e)var r=range(e)
else var r=new Float64Array(e)
var t,a,n
for(t=r.length-1;t>1;t--)a=Math.floor(Math.random()*t),n=r[a],r[a]=r[t],r[t]=n
return r}function apply(f,x){if("function"==typeof f)switch(type(x)){case"number":return f(x)
case"Complex":var ComplexFunctions=["exp","abs"],fc=ComplexFunctions.indexOf(f.name)
return fc>=0?eval(ComplexFunctions[fc]+"Complex(x);"):void error("This function has no Complex counterpart (yet).")
case"vector":return applyVector(f,x)
case"spvector":return applyspVector(f,x)
case"ComplexVector":return"abs"==f.name?absComplex(x):applyComplexVector(f,x)
case"matrix":return applyMatrix(f,x)
case"spmatrix":return applyspMatrix(f,x)
case"ComplexMatrix":return"abs"==f.name?absComplex(x):applyComplexMatrix(f,x)
default:return"undefined"}}function applyVector(e,r){const t=r.length
for(var a=new Float64Array(t),n=0;n<t;n++)a[n]=e(r[n])
return a}function applyComplexVector(e,r){const t=r.length
for(var a=new ComplexVector(t),n=0;n<t;n++)a.set(n,e(r.get(n)))
return a}function applyComplexMatrix(e,r){const t=r.m,a=r.n
for(var n=new ComplexMatrix(t,a),i=0;i<t;i++)for(var o=0;o<a;o++)n.set(i,o,e(r.get(i,o)))
return n}function applyMatrix(e,r){return new Matrix(r.m,r.n,applyVector(e,r.val),!0)}function mul(e,r){var t=size(e),a=size(r)
switch(isScalar(e)||1!=t[0]||1!=t[1]||(e=get(e,0,0)),isScalar(r)||1!=a[0]||1!=a[1]||(r=get(r,0,0)),type(e)){case"number":switch(type(r)){case"number":return e*r
case"Complex":return mulComplexReal(r,e)
case"vector":return mulScalarVector(e,r)
case"spvector":return mulScalarspVector(e,r)
case"ComplexVector":return mulScalarComplexVector(e,r)
case"matrix":return mulScalarMatrix(e,r)
case"spmatrix":return mulScalarspMatrix(e,r)
case"ComplexMatrix":return mulScalarComplexMatrix(e,r)
default:return}break
case"Complex":switch(type(r)){case"number":return mulComplexReal(e,r)
case"Complex":return mulComplex(e,r)
case"vector":return mulComplexVector(e,r)
case"ComplexVector":return mulComplexComplexVector(e,r)
case"spvector":return mulComplexspVector(e,r)
case"matrix":return mulComplexMatrix(e,r)
case"ComplexMatrix":return mulComplexComplexMatrix(e,r)
case"spmatrix":return mulComplexspMatrix(e,r)
default:return}break
case"vector":switch(type(r)){case"number":return mulScalarVector(r,e)
case"Complex":return mulComplexVector(r,e)
case"vector":return e.length!=r.length?void error("Error in mul(a,b) (dot product): a.length = "+e.length+" != "+r.length+" = b.length."):dot(e,r)
case"spvector":return e.length!=r.length?void error("Error in mul(a,b) (dot product): a.length = "+e.length+" != "+r.length+" = b.length."):dotspVectorVector(r,e)
case"ComplexVector":return e.length!=r.length?void error("Error in mul(a,b) (dot product): a.length = "+e.length+" != "+r.length+" = b.length."):dotComplexVectorVector(r,e)
case"matrix":return 1==r.m?outerprodVectors(e,r.val):void error("Inconsistent dimensions in mul(a,B): size(a) = ["+t[0]+","+t[1]+"], size(B) = ["+a[0]+","+a[1]+"]")
case"spmatrix":return 1==r.m?outerprodVectors(e,fullMatrix(r).val):void error("Inconsistent dimensions in mul(a,B): size(a) = ["+t[0]+","+t[1]+"], size(B) = ["+a[0]+","+a[1]+"]")
case"ComplexMatrix":return 1==r.m?transpose(outerprodComplexVectorVector(new ComplexVector(r.re,r.im,!0),e,r.val)):void error("Inconsistent dimensions in mul(a,B): size(a) = ["+t[0]+","+t[1]+"], size(B) = ["+a[0]+","+a[1]+"]")
default:return}break
case"spvector":switch(type(r)){case"number":return mulScalarspVector(r,e)
case"vector":return e.length!=r.length?void error("Error in mul(a,b) (dot product): a.length = "+e.length+" != "+r.length+" = b.length."):dotspVectorVector(e,r)
case"spvector":return e.length!=r.length?void error("Error in mul(a,b) (dot product): a.length = "+e.length+" != "+r.length+" = b.length."):spdot(r,e)
case"matrix":return 1==r.m?outerprodspVectorVector(e,r.val):void error("Inconsistent dimensions in mul(a,B): size(a) = ["+t[0]+","+t[1]+"], size(B) = ["+a[0]+","+a[1]+"]")
case"spmatrix":return 1==r.m?outerprodspVectorVector(e,fullMatrix(r).val):void error("Inconsistent dimensions in mul(a,B): size(a) = ["+t[0]+","+t[1]+"], size(B) = ["+a[0]+","+a[1]+"]")
default:return}break
case"ComplexVector":switch(type(r)){case"number":return mulScalarComplexVector(r,e)
case"Complex":return mulComplexComplexVector(r,e)
case"vector":return e.length!=r.length?void error("Error in mul(a,b) (dot product): a.length = "+e.length+" != "+r.length+" = b.length."):dotComplexVectorVector(e,r)
case"spvector":return e.length!=r.length?void error("Error in mul(a,b) (dot product): a.length = "+e.length+" != "+r.length+" = b.length."):dotComplexVectorspVector(e,r)
case"matrix":return 1==r.m?outerprodComplexVectorVector(e,r.val):void error("Inconsistent dimensions in mul(a,B): size(a) = ["+t[0]+","+t[1]+"], size(B) = ["+a[0]+","+a[1]+"]")
case"spmatrix":return 1==r.m?outerprodComplexVectorVector(e,fullMatrix(r).val):void error("Inconsistent dimensions in mul(a,B): size(a) = ["+t[0]+","+t[1]+"], size(B) = ["+a[0]+","+a[1]+"]")
case"ComplexMatrix":return 1==r.m?outerprodComplexVectors(e,new ComplexVector(r.re,r.im,!0)):void error("Inconsistent dimensions in mul(a,B): size(a) = ["+t[0]+","+t[1]+"], size(B) = ["+a[0]+","+a[1]+"]")
default:return}break
case"matrix":switch(type(r)){case"number":return mulScalarMatrix(r,e)
case"Complex":return mulComplexMatrix(r,e)
case"vector":return 1==e.m?e.val.length!=r.length?void error("Error in mul(a',b): a.length = "+e.val.length+" != "+r.length+" =  b.length."):dot(e.val,r):e.n!=r.length?void error("Error in mul(A,b): A.n = "+e.n+" != "+r.length+" = b.length."):mulMatrixVector(e,r)
case"spvector":return 1==e.m?e.val.length!=r.length?void error("Error in mul(a',b): a.length = "+e.val.length+" != "+r.length+" =  b.length."):dotspVectorVector(r,e.val):e.n!=r.length?void error("Error in mul(A,b): A.n = "+e.n+" != "+r.length+" = b.length."):mulMatrixspVector(e,r)
case"ComplexVector":return 1==e.m?e.val.length!=r.length?void error("Error in mul(a',b): a.length = "+e.val.length+" != "+r.length+" =  b.length."):dotComplexVectorVector(r,e.val):e.n!=r.length?void error("Error in mul(A,b): A.n = "+e.n+" != "+r.length+" = b.length."):mulMatrixComplexVector(e,r)
case"matrix":return e.n!=r.m?void error("Error in mul(A,B): A.n = "+e.n+" != "+r.m+" = B.m."):mulMatrixMatrix(e,r)
case"spmatrix":return e.n!=r.m?void error("Error in mul(A,B): A.n = "+e.n+" != "+r.m+" = B.m."):mulMatrixspMatrix(e,r)
case"ComplexMatrix":return e.n!=r.m?void error("Error in mul(A,B): A.n = "+e.n+" != "+r.m+" = B.m."):transpose(mulComplexMatrixMatrix(transpose(r),transpose(e)))
default:return}break
case"spmatrix":switch(type(r)){case"number":return mulScalarspMatrix(r,e)
case"vector":return 1==e.m?e.n!=r.length?void error("Error in mul(a',b): a.length = "+e.val.length+" != "+r.length+" =  b.length."):dot(fullMatrix(e).val,r):e.n!=r.length?void error("Error in mul(A,b): A.n = "+e.n+" != "+r.length+" = b.length."):mulspMatrixVector(e,r)
case"spvector":return 1==e.m?e.n!=r.length?void error("Error in mul(a',b): a.length = "+e.val.length+" != "+r.length+" =  b.length."):dotspVectorVector(r,fullMatrix(e).val):e.n!=r.length?void error("Error in mul(A,b): A.n = "+e.n+" != "+r.length+" = b.length."):mulspMatrixspVector(e,r)
case"matrix":return e.n!=r.m?void error("Error in mul(A,B): A.n = "+e.n+" != "+r.m+" = B.m."):mulspMatrixMatrix(e,r)
case"spmatrix":return e.n!=r.m?void error("Error in mul(A,B): A.n = "+e.n+" != "+r.m+" = B.m."):mulspMatrixspMatrix(e,r)
default:return}break
case"ComplexMatrix":switch(type(r)){case"number":return mulScalarComplexMatrix(r,e)
case"Complex":return mulComplexComplexMatrix(r,e)
case"vector":return 1==e.m?e.val.length!=r.length?void error("Error in mul(a',b): a.length = "+e.val.length+" != "+r.length+" =  b.length."):dotComplexVectorVector(new ComplexVector(e.re,e.im,!0),r):e.n!=r.length?void error("Error in mul(A,b): A.n = "+e.n+" != "+r.length+" = b.length."):mulComplexMatrixVector(e,r)
case"spvector":return 1==e.m?e.val.length!=r.length?void error("Error in mul(a',b): a.length = "+e.val.length+" != "+r.length+" =  b.length."):dotComplexVectorspVector(new ComplexVector(e.re,e.im,!0),r):e.n!=r.length?void error("Error in mul(A,b): A.n = "+e.n+" != "+r.length+" = b.length."):mulComplexMatrixspVector(e,r)
case"ComplexVector":return 1==e.m?e.val.length!=r.length?void error("Error in mul(a',b): a.length = "+e.val.length+" != "+r.length+" =  b.length."):dotComplexVectors(new ComplexVector(e.re,e.im,!0),r):e.n!=r.length?void error("Error in mul(A,b): A.n = "+e.n+" != "+r.length+" = b.length."):mulComplexMatrixComplexVector(e,r)
case"matrix":return e.n!=r.m?void error("Error in mul(A,B): A.n = "+e.n+" != "+r.m+" = B.m."):mulComplexMatrixMatrix(e,r)
case"spmatrix":return e.n!=r.m?void error("Error in mul(A,B): A.n = "+e.n+" != "+r.m+" = B.m."):mulComplexMatrixspMatrix(e,r)
case"ComplexMatrix":return e.n!=r.m?void error("Error in mul(A,B): A.n = "+e.n+" != "+r.m+" = B.m."):mulComplexMatrices(e,r)
default:return}break
default:return}}function mulScalarVector(e,r){var t
const a=r.length
var n=new Float64Array(r)
for(t=0;t<a;t++)n[t]*=e
return n}function mulScalarMatrix(e,r){return new Matrix(r.m,r.n,mulScalarVector(e,r.val),!0)}function dot(e,r){const t=e.length
var a,n=0
for(a=0;a<t;a++)n+=e[a]*r[a]
return n}function mulMatrixVector(e,r){const t=e.length
for(var a=new Float64Array(t),n=0,i=0;i<t;i++)a[i]=dot(e.val.subarray(n,n+e.n),r),n+=e.n
return a}function mulMatrixTransVector(e,r){const t=e.length,a=e.n
for(var n=new Float64Array(a),i=0,o=0;o<t;o++){for(var l=r[o],s=0;s<a;s++)n[s]+=e.val[i+s]*l
i+=e.n}return n}function mulMatrixMatrix(e,r){const t=e.length,a=r.n,n=r.length
for(var i,o=e.val,l=r.val,s=new Float64Array(t*a),c=0,u=0,f=0;f<t;f++){for(var d=0,h=0;h<n;h++){i=o[c]
for(var m=0;m<a;m++)s[u+m]+=i*l[d],d++
c++}u+=a}return new Matrix(t,a,s,!0)}function entrywisemulVector(e,r){var t
const a=e.length
var n=new Float64Array(a)
for(t=0;t<a;t++)n[t]=e[t]*r[t]
return n}function entrywisemulMatrix(e,r){return new Matrix(e.m,e.n,entrywisemulVector(e.val,r.val),!0)}function entrywisemul(e,r){var t=size(e),a=size(r)
switch("number"!=typeof e&&1==t[0]&&1==t[1]&&(e=get(e,0,0)),"number"!=typeof r&&1==a[0]&&1==a[1]&&(r=get(r,0,0)),type(e)){case"number":switch(type(r)){case"number":return e*r
case"Complex":return mulComplexReal(r,e)
case"vector":return mulScalarVector(e,r)
case"spvector":return mulScalarspVector(e,r)
case"ComplexVector":return mulScalarComplexVector(r,e)
case"matrix":return mulScalarMatrix(e,r)
case"spmatrix":return mulScalarspMatrix(e,r)
case"ComplexMatrix":return mulScalarComplexMatrix(r,e)
default:return}break
case"vector":switch(type(r)){case"number":return mulScalarVector(r,e)
case"Complex":return mulComplexVector(r,e)
case"vector":return e.length!=r.length?void error("Error in entrywisemul(a,b): a.length = "+e.length+" != "+r.length+" = b.length."):entrywisemulVector(e,r)
case"ComplexVector":return e.length!=r.length?void error("Error in entrywisemul(a,b): a.length = "+e.length+" != "+r.length+" = b.length."):entrywisemulComplexVectorVector(r,e)
case"spvector":return e.length!=r.length?void error("Error in entrywisemul(a,b): a.length = "+e.length+" != "+r.length+" = b.length."):entrywisemulspVectorVector(r,e)
case"matrix":case"spmatrix":case"ComplexMatrix":return void error("Error in entrywisemul(a,B): a is a vector and B is a matrix.")
default:return}break
case"spvector":switch(type(r)){case"number":return mulScalarspVector(r,e)
case"vector":return e.length!=r.length?void error("Error in entrywisemul(a,b): a.length = "+e.length+" != "+r.length+" = b.length."):entrywisemulspVectorVector(e,r)
case"spvector":return e.length!=r.length?void error("Error in entrywisemul(a,b): a.length = "+e.length+" != "+r.length+" = b.length."):entrywisemulspVectors(e,r)
case"matrix":case"spmatrix":return void error("Error in entrywisemul(a,B): a is a vector and B is a Matrix.")
default:return}break
case"matrix":switch(type(r)){case"number":return mulScalarMatrix(r,e)
case"Complex":return mulComplexMatrix(r,e)
case"vector":case"spvector":case"ComplexVector":return void error("Error in entrywisemul(A,b): A is a Matrix and b is a vector.")
case"matrix":return e.m!=r.m||e.n!=r.n?void error("Error in entrywisemul(A,B): size(A) = ["+e.m+","+e.n+"] != ["+r.m+","+r.n+"] = size(B)."):entrywisemulMatrix(e,r)
case"spmatrix":return e.m!=r.m||e.n!=r.n?void error("Error in entrywisemul(A,B): size(A) = ["+e.m+","+e.n+"] != ["+r.m+","+r.n+"] = size(B)."):entrywisemulspMatrixMatrix(r,e)
case"ComplexMatrix":return e.m!=r.m||e.n!=r.n?void error("Error in entrywisemul(A,B): size(A) = ["+e.m+","+e.n+"] != ["+r.m+","+r.n+"] = size(B)."):entrywisemulComplexMatrixMatrix(r,e)
default:return}break
case"spmatrix":switch(type(r)){case"number":return mulScalarspMatrix(r,e)
case"vector":case"spvector":return void error("Error in entrywisemul(A,b): A is a Matrix and b is a vector.")
case"matrix":return e.m!=r.m||e.n!=r.n?void error("Error in entrywisemul(A,B): size(A) = ["+e.m+","+e.n+"] != ["+r.m+","+r.n+"] = size(B)."):entrywisemulspMatrixMatrix(e,r)
case"spmatrix":return e.m!=r.m||e.n!=r.n?void error("Error in entrywisemul(A,B): size(A) = ["+e.m+","+e.n+"] != ["+r.m+","+r.n+"] = size(B)."):entrywisemulspMatrices(e,r)
default:return}break
case"ComplexVector":switch(type(r)){case"number":return mulScalarComplexVector(r,e)
case"Complex":return mulComplexComplexVector(r,e)
case"vector":return e.length!=r.length?void error("Error in entrywisemul(a,b): a.length = "+e.length+" != "+r.length+" = b.length."):entrywisemulComplexVectorVector(e,r)
case"ComplexVector":return e.length!=r.length?void error("Error in entrywisemul(a,b): a.length = "+e.length+" != "+r.length+" = b.length."):entrywisemulComplexVectors(e,r)
case"spvector":return e.length!=r.length?void error("Error in entrywisemul(a,b): a.length = "+e.length+" != "+r.length+" = b.length."):entrywisemulComplexVectorspVector(e,r)
case"matrix":case"spmatrix":case"ComplexMatrix":return void error("Error in entrywisemul(a,B): a is a vector and B is a matrix.")
default:return}break
case"ComplexMatrix":switch(type(r)){case"number":return mulScalarComplexMatrix(r,e)
case"Complex":return mulComplexComplexMatrix(r,e)
case"vector":case"spvector":case"ComplexVector":return void error("Error in entrywisemul(A,b): A is a Matrix and b is a vector.")
case"matrix":return e.m!=r.m||e.n!=r.n?void error("Error in entrywisemul(A,B): size(A) = ["+e.m+","+e.n+"] != ["+r.m+","+r.n+"] = size(B)."):entrywisemulComplexMatrixMatrix(e,r)
case"spmatrix":return e.m!=r.m||e.n!=r.n?void error("Error in entrywisemul(A,B): size(A) = ["+e.m+","+e.n+"] != ["+r.m+","+r.n+"] = size(B)."):entrywisemulComplexMatrixspMatrix(e,r)
case"ComplexMatrix":return e.m!=r.m||e.n!=r.n?void error("Error in entrywisemul(A,B): size(A) = ["+e.m+","+e.n+"] != ["+r.m+","+r.n+"] = size(B)."):entrywisemulComplexMatrices(e,r)
default:return}break
default:return}}function saxpy(e,r,t){const a=t.length
for(var n=0;n<a;n++)t[n]+=e*r[n]}function gaxpy(e,r,t){const a=e.m,n=e.n
for(var i=0,o=0;o<a;o++)t[o]+=dot(e.val.subarray(i,i+n),r),i+=n}function divVectorScalar(e,r){var t
const a=e.length
var n=new Float64Array(e)
for(t=0;t<a;t++)n[t]/=r
return n}function divScalarVector(e,r){var t
const a=r.length
var n=new Float64Array(a)
for(t=0;t<a;t++)n[t]=e/r[t]
return n}function divVectors(e,r){var t
const a=e.length
var n=new Float64Array(e)
for(t=0;t<a;t++)n[t]/=r[t]
return n}function divMatrixScalar(e,r){return new Matrix(e.m,e.n,divVectorScalar(e.val,r),!0)}function divScalarMatrix(e,r){return new Matrix(r.m,r.n,divScalarVector(e,r.val),!0)}function divMatrices(e,r){return new Matrix(e.m,e.n,divVectors(e.val,r.val),!0)}function entrywisediv(e,r){var t=type(e),a=type(r)
switch(t){case"number":switch(a){case"number":return e/r
case"vector":return divScalarVector(e,r)
case"matrix":return divScalarMatrix(e,r)
case"spvector":return divScalarspVector(e,r)
case"spmatrix":return divScalarspMatrix(e,r)
default:return void error("Error in entrywisediv(a,b): b must be a number, a vector or a matrix.")}break
case"vector":switch(a){case"number":return divVectorScalar(e,r)
case"vector":return e.length!=r.length?void error("Error in entrywisediv(a,b): a.length = "+e.length+" != "+r.length+" = b.length."):divVectors(e,r)
case"spvector":error("Error in entrywisediv(a,b): b is a sparse vector with zeros.")
break
default:return void error("Error in entrywisediv(a,B): a is a vector and B is a "+a+".")}break
case"spvector":switch(a){case"number":return mulScalarspVector(1/r,e)
case"vector":return e.length!=r.length?void error("Error in entrywisediv(a,b): a.length = "+e.length+" != "+r.length+" = b.length."):divVectorspVector(e,r)
case"spvector":return void error("Error in entrywisediv(a,b): b is a sparse vector with zeros.")
default:return void error("Error in entrywisediv(a,B): a is a vector and B is a "+a+".")}break
case"matrix":switch(a){case"number":return divMatrixScalar(e,r)
case"matrix":return e.m!=r.m||e.n!=r.n?void error("Error in entrywisediv(A,B): size(A) = ["+e.m+","+e.n+"] != ["+r.m+","+r.n+"] = size(B)."):divMatrices(e,r)
case"spmatrix":return void error("Error in entrywisediv(A,B): B is a sparse matrix with zeros.")
default:return void error("Error in entrywisediv(A,b): a is a matrix and B is a "+a+".")}case"spmatrix":switch(a){case"number":return mulScalarspMatrix(1/r,e)
case"matrix":return e.m!=r.m||e.n!=r.n?void error("Error in entrywisediv(A,B): size(A) = ["+e.m+","+e.n+"] != ["+r.m+","+r.n+"] = size(B)."):divMatrixspMatrix(e,r)
case"spmatrix":return void error("Error in entrywisediv(A,B): B is a sparse matrix with zeros.")
default:return void error("Error in entrywisediv(A,b): a is a matrix and B is a "+a+".")}break
default:return void error("Error in entrywisediv(a,b): a must be a number, a vector or a matrix.")}}function outerprodVectors(e,r,t){var a
const n=e.length,i=r.length
var o=new Matrix(n,i)
if(3==arguments.length)for(a=0;a<n;a++)o.val.set(mulScalarVector(t*e[a],r),a*i)
else for(a=0;a<n;a++)o.val.set(mulScalarVector(e[a],r),a*i)
return o}function outerprod(e,r,t){return"number"==typeof e?"number"==typeof r?2==arguments.length?e*r:e*r*t:2==arguments.length?new Matrix(1,r.length,mulScalarVector(e,r),!0):new Matrix(1,r.length,mulScalarVector(e*t,r),!0):1==e.length?"number"==typeof r?2==arguments.length?e[0]*r:e[0]*r*t:2==arguments.length?new Matrix(1,r.length,mulScalarVector(e[0],r),!0):new Matrix(1,r.length,mulScalarVector(e[0]*t,r),!0):"number"==typeof r?2==arguments.length?mulScalarVector(r,e):mulScalarVector(t*r,e):1==r.length?2==arguments.length?mulScalarVector(r[0],e):mulScalarVector(t*r[0],e):2==arguments.length?outerprodVectors(e,r):outerprodVectors(e,r,t)}function addScalarVector(e,r){const t=r.length
for(var a=new Float64Array(r),n=0;n<t;n++)a[n]+=e
return a}function addScalarMatrix(e,r){return new Matrix(r.m,r.n,addScalarVector(e,r.val),!0)}function addVectors(e,r){const t=e.length
for(var a=new Float64Array(e),n=0;n<t;n++)a[n]+=r[n]
return a}function addMatrices(e,r){return new Matrix(e.m,e.n,addVectors(e.val,r.val),!0)}function add(e,r){const t=type(e),a=type(r)
if("number"==t&&"number"==a||"string"==t||"string"==a)return e+r
if("number"==t)switch(a){case"Complex":return addComplexReal(r,e)
case"vector":return addScalarVector(e,r)
case"matrix":return addScalarMatrix(e,r)
case"spvector":return addScalarspVector(e,r)
case"spmatrix":return addScalarspMatrix(e,r)
case"ComplexVector":return addScalarComplexVector(e,r)
case"ComplexMatrix":return addScalarComplexMatrix(e,r)
default:return}else if("number"==a)switch(t){case"Complex":return addComplexReal(e,r)
case"vector":return addScalarVector(r,e)
case"matrix":return addScalarMatrix(r,e)
case"spvector":return addScalarspVector(r,e)
case"spmatrix":return addScalarspMatrix(r,e)
case"ComplexVector":return addScalarComplexVector(r,e)
case"ComplexMatrix":return addScalarComplexMatrix(r,e)
default:return}else if("vector"==t)switch(a){case"vector":return e.length!=r.length?void error("Error in add(a,b): a.length = "+e.length+" != "+r.length+" = b.length."):addVectors(e,r)
case"spvector":return e.length!=r.length?void error("Error in add(a,b): a.length = "+e.length+" != "+r.length+" = b.length."):addVectorspVector(e,r)
case"ComplexVector":return e.length!=r.length?void error("Error in add(a,b): a.length = "+e.length+" != "+r.length+" = b.length."):addComplexVectorVector(r,e)
case"matrix":case"spmatrix":default:return void error("Error in add(a,B): a is a vector and B is a "+a+".")}else if("matrix"==t)switch(a){case"matrix":return e.m!=r.m||e.n!=r.n?void error("Error in add(A,B): size(A) = ["+e.m+","+e.n+"] != ["+r.m+","+r.n+"] = size(B)."):addMatrices(e,r)
case"spmatrix":return e.m!=r.m||e.n!=r.n?void error("Error in add(A,B): size(A) = ["+e.m+","+e.n+"] != ["+r.m+","+r.n+"] = size(B)."):addMatrixspMatrix(e,r)
case"ComplexMatrix":return e.m!=r.m||e.n!=r.n?void error("Error in add(A,B): size(A) = ["+e.m+","+e.n+"] != ["+r.m+","+r.n+"] = size(B)."):addComplexMatrixMatrix(r,e)
case"vector":case"spvector":default:return void error("Error in add(A,b): a is a matrix and B is a "+a+".")}else if("spvector"==t)switch(a){case"vector":return e.length!=r.length?void error("Error in add(a,b): a.length = "+e.length+" != "+r.length+" = b.length."):addVectorspVector(r,e)
case"spvector":return e.length!=r.length?void error("Error in add(a,b): a.length = "+e.length+" != "+r.length+" = b.length."):addspVectors(e,r)
case"matrix":case"spmatrix":default:return void error("Error in add(a,B): a is a sparse vector and B is a "+a+".")}else if("spmatrix"==t)switch(a){case"matrix":return e.m!=r.m||e.n!=r.n?void error("Error in add(A,B): size(A) = ["+e.m+","+e.n+"] != ["+r.m+","+r.n+"] = size(B)."):addMatrixspMatrix(r,e)
case"spmatrix":return e.m!=r.m||e.n!=r.n?void error("Error in add(A,B): size(A) = ["+e.m+","+e.n+"] != ["+r.m+","+r.n+"] = size(B)."):addspMatrices(e,r)
case"vector":case"spvector":default:return void error("Error in add(A,b): a is a sparse matrix and B is a "+a+".")}else if("ComplexVector"==t)switch(a){case"vector":return e.length!=r.length?void error("Error in add(a,b): a.length = "+e.length+" != "+r.length+" = b.length."):addComplexVectorVector(e,r)
case"spvector":return e.length!=r.length?void error("Error in add(a,b): a.length = "+e.length+" != "+r.length+" = b.length."):addComplexVectorspVector(e,r)
case"ComplexVector":return e.length!=r.length?void error("Error in add(a,b): a.length = "+e.length+" != "+r.length+" = b.length."):addComplexVectors(r,e)
case"matrix":case"spmatrix":default:return void error("Error in add(a,B): a is a vector and B is a "+a+".")}else{if("ComplexMatrix"!=t)return
switch(a){case"matrix":return e.m!=r.m||e.n!=r.n?void error("Error in add(A,B): size(A) = ["+e.m+","+e.n+"] != ["+r.m+","+r.n+"] = size(B)."):addComplexMatrixMatrix(e,r)
case"spmatrix":return e.m!=r.m||e.n!=r.n?void error("Error in add(A,B): size(A) = ["+e.m+","+e.n+"] != ["+r.m+","+r.n+"] = size(B)."):addComplexMatrixspMatrix(e,r)
case"ComplexMatrix":return e.m!=r.m||e.n!=r.n?void error("Error in add(A,B): size(A) = ["+e.m+","+e.n+"] != ["+r.m+","+r.n+"] = size(B)."):addComplexMatrices(e,r)
case"vector":case"spvector":default:return void error("Error in add(A,b): a is a matrix and B is a "+a+".")}}}function subScalarVector(e,r){const t=r.length
for(var a=new Float64Array(t),n=0;n<t;n++)a[n]=e-r[n]
return a}function subVectorScalar(e,r){const t=e.length
for(var a=new Float64Array(e),n=0;n<t;n++)a[n]-=r
return a}function subScalarMatrix(e,r){return new Matrix(r.m,r.n,subScalarVector(e,r.val),!0)}function subMatrixScalar(e,r){return new Matrix(e.m,e.n,subVectorScalar(e.val,r),!0)}function subVectors(e,r){const t=e.length
for(var a=new Float64Array(e),n=0;n<t;n++)a[n]-=r[n]
return a}function subMatrices(e,r){return new Matrix(e.m,e.n,subVectors(e.val,r.val),!0)}function sub(e,r){const t=type(e),a=type(r)
if("number"==t&&"number"==a)return e-r
if("number"==t)switch(a){case"Complex":return addComplexReal(minusComplex(r),e)
case"vector":return subScalarVector(e,r)
case"matrix":return subScalarMatrix(e,r)
case"spvector":return subScalarspVector(e,r)
case"spmatrix":return subScalarspMatrix(e,r)
default:return}else if("number"==a)switch(t){case"Complex":return addComplexReal(r,-e)
case"vector":return subVectorScalar(e,r)
case"matrix":return subMatrixScalar(e,r)
case"spvector":return addScalarspVector(-r,e)
case"spmatrix":return addScalarspMatrix(-r,e)
default:return}else if("vector"==t)switch(a){case"vector":return e.length!=r.length?void error("Error in sub(a,b): a.length = "+e.length+" != "+r.length+" = b.length."):subVectors(e,r)
case"spvector":return e.length!=r.length?void error("Error in sub(a,b): a.length = "+e.length+" != "+r.length+" = b.length."):subVectorspVector(e,r)
case"matrix":case"spmatrix":default:return void error("Error in sub(a,B): a is a vector and B is a "+a+".")}else if("matrix"==t)switch(a){case"matrix":return e.m!=r.m||e.n!=r.n?void error("Error in sub(A,B): size(A) = ["+e.m+","+e.n+"] != ["+r.m+","+r.n+"] = size(B)."):subMatrices(e,r)
case"spmatrix":return e.m!=r.m||e.n!=r.n?void error("Error in sub(A,B): size(A) = ["+e.m+","+e.n+"] != ["+r.m+","+r.n+"] = size(B)."):subMatrixspMatrix(e,r)
case"vector":case"spvector":default:return void error("Error in sub(A,b): A is a matrix and b is a "+a+".")}else if("spvector"==t)switch(a){case"vector":return e.length!=r.length?void error("Error in sub(a,b): a.length = "+e.length+" != "+r.length+" = b.length."):subspVectorVector(e,r)
case"spvector":return e.length!=r.length?void error("Error in sub(a,b): a.length = "+e.length+" != "+r.length+" = b.length."):subspVectors(e,r)
case"matrix":case"spmatrix":default:return void error("Error in sub(a,B): a is a sparse vector and B is a "+a+".")}else{if("spmatrix"!=t)return
switch(a){case"matrix":return e.m!=r.m||e.n!=r.n?void error("Error in sub(A,B): size(A) = ["+e.m+","+e.n+"] != ["+r.m+","+r.n+"] = size(B)."):subspMatrixMatrix(e,r)
case"spmatrix":return e.m!=r.m||e.n!=r.n?void error("Error in sub(A,B): size(A) = ["+e.m+","+e.n+"] != ["+r.m+","+r.n+"] = size(B)."):subspMatrices(e,r)
case"vector":case"spvector":default:return void error("Error in sub(A,b): a is a sparse matrix and B is a "+a+".")}}}function pow(e,r){var t
const a=type(e),n=type(r)
if("number"==a&&"number"==n)return Math.pow(e,r)
if("number"==a){if("vector"==n){var i=zeros(r.length)
if(!isZero(e))for(t=0;t<r.length;t++)i[t]=Math.pow(e,r[t])
return i}var i=new Matrix(r.m,r.n,pow(e,r.val),!0)
return i}if("number"==n){if("vector"==a){var i=zeros(e.length)
for(t=0;t<e.length;t++)i[t]=Math.pow(e[t],r)
return i}var i=new Matrix(e.m,e.n,pow(e.val,r),!0)
return i}if("vector"==a){if("vector"==n){if(e.length!=r.length)return void error("Error in pow(a,b): a.length = "+e.length+" != "+r.length+" = b.length.")
var i=zeros(e.length)
for(t=0;t<e.length;t++)i[t]=Math.pow(e[t],r[t])
return i}return"undefined"}if("vector"==n)return"undefined"
var i=new Matrix(e.m,e.n,pow(e.val,r.val),!0)
return i}function minus(e){switch(type(e)){case"number":return-e
case"vector":return minusVector(e)
case"spvector":return new spVector(e.length,minusVector(e.val),e.ind)
case"ComplexVector":return minusComplexVector(e)
case"matrix":return new Matrix(e.m,e.n,minusVector(e.val),!0)
case"spmatrix":return new spMatrix(e.m,e.n,minusVector(e.val),e.cols,e.rows)
case"ComplexMatrix":return minusComplexMatrix(e)
default:return}}function minusVector(e){for(var r=new Float64Array(e.length),t=0;t<e.length;t++)r[t]=-e[t]
return r}function minusMatrix(e){return new Matrix(e.m,e.n,minusVector(e.val),!0)}function minVector(e){const r=e.length
for(var t=e[0],a=1;a<r;a++)e[a]<t&&(t=e[a])
return t}function minMatrix(e){return minVector(e.val)}function minVectorScalar(e,r){for(var t=e.length,a=new Float64Array(e),n=0;n<t;n++)r<e[n]&&(a[n]=r)
return a}function minMatrixScalar(e,r){return new Matrix(e.m,e.n,minVectorScalar(e.val,r),!0)}function minMatrixRows(e){const r=e.m,t=e.n
for(var a,n=new Float64Array(e.val.subarray(0,t)),i=t,o=1;o<r;o++){for(a=0;a<t;a++)e.val[i+a]<n[a]&&(n[a]=e.val[i+a])
i+=t}return new Matrix(1,t,n,!0)}function minMatrixCols(e){for(var r=e.m,t=new Float64Array(r),a=0,n=0;n<r;n++)t[n]=minVector(e.val.subarray(a,a+e.n)),a+=e.n
return t}function minVectorVector(e,r){const t=e.length
for(var a=new Float64Array(e),n=0;n<t;n++)r[n]<e[n]&&(a[n]=r[n])
return a}function minMatrixMatrix(e,r){return new Matrix(e.m,e.n,minVectorVector(e.val,r.val),!0)}function min(e,r){var t=type(e)
if(1==arguments.length)switch(t){case"vector":return minVector(e)
case"spvector":var a=minVector(e.val)
return a>0&&e.val.length<e.length?0:a
case"matrix":return minMatrix(e)
case"spmatrix":var a=minVector(e.val)
return a>0&&e.val.length<e.m*e.n?0:a
default:return e}var n=type(r)
return"spvector"==t&&(e=fullVector(e),t="vector"),"spmatrix"==t&&(e=fullMatrix(e),t="matrix"),"spvector"==n&&(r=fullVector(r),n="vector"),"spmatrix"==n&&(r=fullMatrix(r),n="matrix"),"number"==t&&"number"==n?Math.min(e,r):"number"==t?"vector"==n?minVectorScalar(r,e):minMatrixScalar(r,e):"number"==n?"vector"==t?minVectorScalar(e,r):1==r?minMatrixRows(e):2==r?minMatrixCols(e):minMatrixScalar(e,r):"vector"==t?"vector"==n?minVectorVector(e,r):"undefined":"matrix"==n?minMatrixMatrix(e,r):"undefined"}function maxVector(e){const r=e.length
for(var t=e[0],a=1;a<r;a++)e[a]>t&&(t=e[a])
return t}function maxMatrix(e){return maxVector(e.val)}function maxVectorScalar(e,r){const t=e.length
for(var a=new Float64Array(e),n=0;n<t;n++)r>e[n]&&(a[n]=r)
return a}function maxMatrixScalar(e,r){return maxVectorScalar(e.val,r)}function maxMatrixRows(e){const r=e.m,t=e.n
for(var a,n=new Float64Array(e.val.subarray(0,t)),i=t,o=1;o<r;o++){for(a=0;a<t;a++)e.val[i+a]>n[a]&&(n[a]=e.val[i+a])
i+=t}return new Matrix(1,t,n,!0)}function maxMatrixCols(e){const r=e.m
for(var t=new Float64Array(r),a=0,n=0;n<r;n++)t[n]=maxVector(e.val.subarray(a,a+e.n)),a+=e.n
return t}function maxVectorVector(e,r){for(var t=e.length,a=new Float64Array(e),n=0;n<t;n++)r[n]>e[n]&&(a[n]=r[n])
return a}function maxMatrixMatrix(e,r){return new Matrix(e.m,e.n,maxVectorVector(e.val,r.val),!0)}function max(e,r){var t=type(e)
if(1==arguments.length)switch(t){case"vector":return maxVector(e)
case"spvector":var a=maxVector(e.val)
return a<0&&e.val.length<e.length?0:a
case"matrix":return maxMatrix(e)
case"spmatrix":var a=maxVector(e.val)
return a<0&&e.val.length<e.m*e.n?0:a
default:return e}var n=type(r)
return"spvector"==t&&(e=fullVector(e),t="vector"),"spmatrix"==t&&(e=fullMatrix(e),t="matrix"),"spvector"==n&&(r=fullVector(r),n="vector"),"spmatrix"==n&&(r=fullMatrix(r),n="matrix"),"number"==t&&"number"==n?Math.max(e,r):"number"==t?"vector"==n?maxVectorScalar(r,e):maxMatrixScalar(r,e):"number"==n?"vector"==t?maxVectorScalar(e,r):1==r?maxMatrixRows(e):2==r?maxMatrixCols(e):maxMatrixScalar(e,r):"vector"==t?"vector"==n?maxVectorVector(e,r):"undefined":"matrix"==n?maxMatrixMatrix(e,r):"undefined"}function transposeMatrix(e){var r,t
const a=e.m,n=e.n
if(a>1){var i=zeros(n,a),o=0
for(t=0;t<a;t++){var l=0
for(r=0;r<n;r++)i.val[l+t]=e.val[o+r],l+=a
o+=n}return i}return e.val}function transposeVector(e){return new Matrix(1,e.length,e)}function transpose(e){switch(type(e)){case"number":return e
case"vector":var r=new Matrix(1,e.length,e)
return r
case"spvector":return transposespVector(e)
case"ComplexVector":var r=new ComplexMatrix(1,e.length,conj(e))
return r
case"matrix":return transposeMatrix(e)
case"spmatrix":return transposespMatrix(e)
case"ComplexMatrix":return transposeComplexMatrix(e)
default:return}}function det(e){const r=e.n
if(e.m==r&&void 0!==e.m){if(2==r)return e.val[0]*e.val[3]-e.val[1]*e.val[2]
var t,a,n=0
for(t=0;t<r;t++){var i=1
for(a=0;a<r;a++)i*=e.val[(t+a)%r*r+a]
n+=i}for(t=0;t<r;t++){var i=1
for(a=0;a<r;a++)i*=e.val[(t+r-1-a)%r*r+a]
n-=i}return n}}function trace(e){if("matrix"==type(e)){var r=e.length
if(e.m!=r)return"undefined"
for(var t=0,a=0;a<r;a++)t+=e.val[a*r+a]
return t}}function triu(e){var r,t
const a=e.n,n=e.m
var i=zeros(n,a),o=n
a<n&&(o=a)
var l=0
for(r=0;r<o;r++){for(t=r;t<a;t++)i.val[l+t]=e.val[l+t]
l+=a}return i}function tril(e){var r,t
const a=e.n,n=e.m
var i=zeros(n,a),o=n
a<n&&(o=a)
var l=0
for(r=0;r<o;r++){for(t=0;t<=r;t++)i.val[l+t]=e.val[l+t]
l+=a}if(n>o)for(r=o;r<n;r++){for(t=0;t<a;t++)i.val[l+t]=e.val[l+t]
l+=a}return i}function issymmetric(e){const r=e.m,t=e.n
if(r!=t)return!1
for(var a=0;a<r;a++)for(var n=0;n<t;n++)if(e.val[a*t+n]!=e.val[n*t+a])return!1
return!0}function mat(e,r){var t,a=!1,n=new Array(e.length)
for(t=0;t<e.length;t++)n[t]=type(e[t]),"number"==n[t]&&(a=!0)
if(void 0===r){if("vector"==type(e))return new Float64Array(e)
var r=!0
for(t=0;t<e.length;t++)if((!Array.isArray(e[t])||"vector"==n[t])&&(r=!1,"string"==n[t]))return e}if(0==e.length)return[]
var i,o,l=0,s=0
if(r){var c=new Array
for(t=0;t<e.length;t++)switch(n[t]){case"matrix":c.push(e[t].val),l+=e[t].m,s=e[t].n
break
case"vector":if(a){for(var u=0;u<e[t].length;u++)c.push(e[t][u])
s=1,l+=e[t].length}else c.push(e[t]),l+=1,s=e[t].length
break
case"number":c.push(e[t]),l+=1,s=1
break
case"spvector":return spmat(e)
default:return e}if(1==s){var f=new Float64Array(c)
return f}var f=new Matrix(l,s),d=0
for(t=0;t<c.length;t++)if(c[t].buffer)f.val.set(c[t],d),d+=c[t].length
else{for(o=0;o<c[t].length;o++)f.val[d+o]=c[t][o]
d+=c[t].length}return f}for(l=size(e[0],1),t=0;t<e.length;t++)if("matrix"==n[t]?s+=e[t].n:s++,size(e[t],1)!=l)return"undefined"
var h,c=new Matrix(l,s)
for(i=0;i<l;i++)for(h=0,t=0;t<e.length;t++)switch(n[t]){case"matrix":for(o=0;o<e[t].n;o++)c.val[i*s+o+h]=e[t].val[i*e[t].n+o]
h+=e[t].n
break
case"vector":c.val[i*s+h]=e[t][i],h++
break
case"number":c.val[i*s+h]=e[t],h++}return c}function isEqual(e,r){var t,a,n=type(e),i=type(r)
if("number"==n&&"number"!=i)return isEqual(r,e)
if("number"!=n&&"number"==i)switch(n){case"vector":for(a=new Float64Array(e.length),t=0;t<e.length;t++)isZero(e[t]-r)&&(a[t]=1)
return a
case"matrix":return a=new Matrix(e.m,e.n,isEqual(e.val,r),!0)
default:return e==r?1:0}else{if(n!=i)return"undefined"
switch(n){case"number":return isZero(e-r)?1:0
case"vector":for(a=new Float64Array(e.length),t=0;t<e.length;t++)isZero(e[t]-r[t])&&(a[t]=1)
return a
case"matrix":return a=new Matrix(e.m,e.n,isEqual(e.val,r.val),!0)
default:return e==r?1:0}}}function isNotEqual(e,r){var t,a,n=type(e),i=type(r)
if("number"==n&&"number"!=i)return isNotEqual(r,e)
if("number"!=n&&"number"==i)switch(n){case"vector":for(a=new Float64Array(e.length),t=0;t<e.length;t++)isZero(e[t]-r)||(a[t]=1)
return a
case"matrix":return a=new Matrix(e.m,e.n,isNotEqual(e.val,r),!0)
default:return e!=r?1:0}else{if(n!=i)return"undefined"
switch(n){case"number":return isZero(e-r)?0:1
case"vector":for(a=new Float64Array(e.length),t=0;t<e.length;t++)isZero(get(e,t)-get(r,t))||(a[t]=1)
return a
case"matrix":return a=new Matrix(e.m,e.n,isNotEqual(e.val,r.val),!0)
default:return e!=r?1:0}}}function isGreater(e,r){var t,a,n=type(e),i=type(r)
if("number"==n&&"number"!=i)return isGreater(r,e)
if("number"!=n&&"number"==i)switch(n){case"vector":for(a=new Float64Array(e.length),t=0;t<e.length;t++)e[t]-r>EPS&&(a[t]=1)
return a
case"matrix":return a=new Matrix(e.m,e.n,isGreater(e.val,r),!0)
default:return e>r?1:0}else{if(n!=i)return"undefined"
switch(n){case"number":return e>r?1:0
case"vector":for(a=new Float64Array(e.length),t=0;t<e.length;t++)e[t]-r[t]>EPS&&(a[t]=1)
return a
case"matrix":return a=new Matrix(e.m,e.n,isGreater(e.val,r.val),!0)
default:return e>r?1:0}}}function isGreaterOrEqual(e,r){var t,a,n=type(e),i=type(r)
if("number"==n&&"number"!=i)return isGreaterOrEqual(r,e)
if("number"!=n&&"number"==i)switch(n){case"vector":for(a=new Float64Array(e.length),t=0;t<e.length;t++)e[t]-r>-EPS&&(a[t]=1)
return a
case"matrix":return a=new Matrix(e.m,e.n,isGreaterOrEqual(e.val,r),!0)
default:return e>=r?1:0}else{if(n!=i)return"undefined"
switch(n){case"number":return e>=r
case"vector":for(a=new Float64Array(e.length),t=0;t<e.length;t++)e[t]-r[t]>-EPS&&(a[t]=1)
return a
case"matrix":return a=new Matrix(e.m,e.n,isGreaterOrEqual(e.val,r.val),!0)
default:return e>=r?1:0}}}function isLower(e,r){var t,a,n=type(e),i=type(r)
if("number"==n&&"number"!=i)return isLower(r,e)
if("number"!=n&&"number"==i)switch(n){case"vector":for(a=new Float64Array(e.length),t=0;t<e.length;t++)r-e[t]>EPS&&(a[t]=1)
return a
case"matrix":return a=new Matrix(e.m,e.n,isLower(e.val,r),!0)
default:return e<r?1:0}else{if(n!=i)return"undefined"
switch(n){case"number":return e<r?1:0
case"vector":for(a=new Float64Array(e.length),t=0;t<e.length;t++)r[t]-e[t]>EPS&&(a[t]=1)
return a
case"matrix":return a=new Matrix(e.m,e.n,isLower(e.val,r.val),!0)
default:return e<r?1:0}}}function isLowerOrEqual(e,r){var t,a,n=type(e),i=type(r)
if("number"==n&&"number"!=i)return isLowerOrEqual(r,e)
if("number"!=n&&"number"==i)switch(n){case"vector":for(a=new Float64Array(e.length),t=0;t<e.length;t++)r-e[t]>-EPS&&(a[t]=1)
return a
case"matrix":return a=new Matrix(e.m,e.n,isLowerOrEqual(e.val,r),!0)
default:return e<=r?1:0}else{if(n!=i)return"undefined"
switch(n){case"number":return e<=r?1:0
case"vector":for(a=new Float64Array(e.length),t=0;t<e.length;t++)r[t]-e[t]>-EPS&&(a[t]=1)
return a
case"matrix":return a=new Matrix(e.m,e.n,isLowerOrEqual(e.val,r.val),!0)
default:return e<=r?1:0}}}function find(e){var r,t=e.length,a=new Array
for(r=0;r<t;r++)0!=e[r]&&a.push(r)
return a}function findmax(e){var r
switch(type(e)){case"number":return 0
case"vector":var t=0,a=e[0]
for(r=1;r<e.length;r++)e[r]>a&&(a=e[r],t=r)
return t
case"spvector":var a=e.val[0],t=e.ind[0]
for(r=1;r<e.val.length;r++)e.val[r]>a&&(a=e.val[r],t=e.ind[r])
if(a<0&&e.val.length<e.length)for(t=0;e.ind.indexOf(t)>=0&&t<e.length;)t++
return t
default:return"undefined"}}function findmin(e){var r
switch(type(e)){case"number":return 0
case"vector":var t=0,a=e[0]
for(r=1;r<e.length;r++)e[r]<a&&(a=e[r],t=r)
return t
case"spvector":var a=e.val[0],t=e.ind[0]
for(r=1;r<e.val.length;r++)e.val[r]<a&&(a=e.val[r],t=e.ind[r])
if(a>0&&e.val.length<e.length)for(t=0;e.ind.indexOf(t)>=0&&t<e.length;)t++
return t
default:return"undefined"}}function sort(e,r,t){if(void 0===r)var r=!1
if(void 0===t)var t=!1
var a,n,i
const o=e.length
if(t){var l=range(o)
for(a=0;a<o-1;a++)n=r?findmax(get(e,range(a,o)))+a:findmin(get(e,range(a,o)))+a,a!=n&&(i=e[a],e[a]=e[n],e[n]=i,i=l[a],l[a]=l[n],l[n]=i)
return l}var s=vectorCopy(e)
for(a=0;a<o-1;a++)n=r?findmax(get(s,range(a,o)))+a:findmin(get(s,range(a,o)))+a,a!=n&&(i=s[a],s[a]=s[n],s[n]=i)
return s}function sumVector(e){var r
const t=e.length
var a=e[0]
for(r=1;r<t;r++)a+=e[r]
return a}function sumMatrix(e){return sumVector(e.val)}function sumMatrixRows(e){var r,t
const a=e.m,n=e.n
var i=new Float64Array(n),o=0
for(r=0;r<a;r++){for(t=0;t<n;t++)i[t]+=e.val[o+t]
o+=n}return new Matrix(1,n,i,!0)}function sumMatrixCols(e){const r=e.m
for(var t=new Float64Array(r),a=0,n=0;n<r;n++){for(var i=0;i<e.n;i++)t[n]+=e.val[a+i]
a+=e.n}return t}function sum(e,r){switch(type(e)){case"vector":return 1==arguments.length||1==r?sumVector(e):vectorCopy(e)
case"spvector":return 1==arguments.length||1==r?sumVector(e.val):e.copy()
case"matrix":return 1==arguments.length?sumMatrix(e):1==r?sumMatrixRows(e):2==r?sumMatrixCols(e):void 0
case"spmatrix":return 1==arguments.length?sumVector(e.val):1==r?sumspMatrixRows(e):2==r?sumspMatrixCols(e):void 0
default:return e}}function prodVector(e){var r
const t=e.length
var a=e[0]
for(r=1;r<t;r++)a*=e[r]
return a}function prodMatrix(e){return prodVector(e.val)}function prodMatrixRows(e){var r,t
const a=e.m,n=e.n
var i=new Float64Array(e.row(0)),o=n
for(r=1;r<a;r++){for(t=0;t<n;t++)i[t]*=e.val[o+t]
o+=e.n}return new Matrix(1,n,i,!0)}function prodMatrixCols(e){const r=e.m
for(var t=new Float64Array(r),a=0,n=0;n<r;n++){t[n]=e.val[a]
for(var i=1;i<e.n;i++)t[n]*=e.val[a+i]
a+=e.n}return t}function prod(e,r){switch(type(e)){case"vector":return 1==arguments.length||1==r?prodVector(e):vectorCopy(e)
case"spvector":return 1==arguments.length||1==r?e.val.length<e.length?0:prodVector(e.val):e.copy()
case"matrix":return 1==arguments.length?prodMatrix(e):1==r?prodMatrixRows(e):2==r?prodMatrixCols(e):void 0
case"spmatrix":return 1==arguments.length?e.val.length<e.m*e.n?0:prodVector(e.val):1==r?prodspMatrixRows(e):2==r?prodspMatrixCols(e):void 0
default:return e}}function mean(e,r){switch(type(e)){case"vector":return 1==arguments.length||1==r?sumVector(e)/e.length:vectorCopy(e)
case"spvector":return 1==arguments.length||1==r?sumVector(e.val)/e.length:e.copy()
case"matrix":return 1==arguments.length?sumMatrix(e)/(e.m*e.n):1==r?mulScalarMatrix(1/e.m,sumMatrixRows(e)):2==r?mulScalarVector(1/e.n,sumMatrixCols(e)):void 0
case"spmatrix":return 1==arguments.length?sumVector(e.val)/(e.m*e.n):1==r?mulScalarMatrix(1/e.m,sumspMatrixRows(e)):2==r?mulScalarVector(1/e.n,sumspMatrixCols(e)):void 0
default:return e}}function variance(e,r){if(arguments.length>1)var t=mean(e,r)
else var t=mean(e)
switch(type(e)){case"number":return 0
case"vector":if(1==arguments.length||1==r){var a=dot(e,e)/e.length-t*t
return a}return zeros(e.length)
case"spvector":if(1==arguments.length||1==r){var a=dot(e.val,e.val)/e.length-t*t
return a}return zeros(e.length)
case"matrix":case"spmatrix":if(void 0===r){var a=sum(entrywisemul(e,e))/(e.m*e.n)-t*t
return a}if(1==r){var a=sub(entrywisediv(sum(entrywisemul(e,e),1),e.length),entrywisemul(t,t))
return a}return 2==r?a=sub(entrywisediv(sum(entrywisemul(e,e),2),e.n),entrywisemul(t,t)):void 0
default:return}}function std(e,r){return arguments.length>1?sqrt(variance(e,r)):sqrt(variance(e))}function cov(e){switch(type(e)){case"number":return 0
case"vector":var r=mean(e)
return dot(e,e)/e.length-r*r
case"spvector":var r=mean(e)
return dot(e.val,e.val)/e.length-r*r
case"matrix":var r=mean(e,1).row(0)
return divMatrixScalar(xtx(subMatrices(e,outerprod(ones(e.m),r))),e.m)
case"spmatrix":var r=mean(e,1).row(0)
return divMatrixScalar(xtx(subspMatrixMatrix(e,outerprod(ones(e.m),r))),e.m)
default:return}}function xtx(e){const r=e.m,t=e.n
for(var a=new Matrix(t,t),n=0;n<r;n++)for(var i=e.row(n),o=0;o<t;o++)for(var l=i[o],s=o;s<t;s++)a.val[o*t+s]+=l*i[s]
for(var o=0;o<t;o++)for(var c=o*t,s=o;s<t;s++)a.val[s*t+o]=a.val[c+s]
return a}function norm(e,r){var t,a
switch(type(e)){case"number":return Math.abs(e)
case"vector":return 1==arguments.length||1==r?Math.sqrt(dot(e,e)):abs(e)
case"spvector":return 1==arguments.length||1==r?Math.sqrt(dot(e.val,e.val)):abs(e)
case"matrix":if(1==arguments.length)return Math.sqrt(dot(e.val,e.val))
if(1==r){const n=e.n
var i=zeros(1,n),o=0
for(t=0;t<e.m;t++){for(a=0;a<n;a++)i.val[a]+=e.val[o+a]*e.val[o+a]
o+=n}for(a=0;a<n;a++)i.val[a]=Math.sqrt(i.val[a])
return i}if(2==r){var i=zeros(e.m),o=0
for(t=0;t<e.m;t++){for(a=0;a<e.n;a++)i[t]+=e.val[o+a]*e.val[o+a]
o+=e.n,i[t]=Math.sqrt(i[t])}return i}return"undefined"
case"spmatrix":if(1==arguments.length)return Math.sqrt(dot(e.val,e.val))
if(1!=r||e.rowmajor){if(2==r&&e.rowmajor){var i=zeros(e.m)
for(t=0;t<e.m;t++){for(var l=e.rows[t],s=e.rows[t+1],c=l;c<s;c++)i[t]+=e.val[c]*e.val[c]
i[t]=Math.sqrt(i[t])}return i}return"undefined"}const u=e.n
var i=zeros(1,u)
for(a=0;a<u;a++){for(var l=e.cols[a],s=e.cols[a+1],c=l;c<s;c++)i.val[a]+=e.val[c]*e.val[c]
i.val[a]=Math.sqrt(i.val[a])}return i
default:return"undefined"}}function norm1(e,r){return 1==arguments.length?sum(abs(e)):sum(abs(e),r)}function norminf(e,r){return 1==arguments.length?max(abs(e)):max(abs(e),r)}function normp(e,r,t){return 2==arguments.length?Math.pow(sum(pow(abs(e),r)),1/r):pow(sum(pow(abs(e),r),t),1/r)}function normnuc(e){switch(type(e)){case"matrix":return sumVector(svd(e))
case"spmatrix":return sumVector(svd(fullMatrix(e)))
case"number":return e
case"vector":case"spvector":return 1
default:return}}function norm0(e,r,t){var n=EPS
3==arguments.length&&(n=t)
var i,o
switch(type(e)){case"number":return Math.abs(e)>n
case"vector":return 1==arguments.length||1==r?norm0Vector(e,n):isGreater(abs(a),n)
case"spvector":return 1==arguments.length||1==r?norm0Vector(e.val,n):isGreater(abs(a),n)
case"matrix":if(1==arguments.length)return norm0Vector(e.val,n)
if(1==r){var l=zeros(1,e.n)
for(i=0;i<e.m;i++)for(o=0;o<e.n;o++)Math.abs(e[i*e.n+o])>n&&l.val[o]++
return l}if(2==r){var l=zeros(e.m)
for(i=0;i<e.m;i++)for(o=0;o<e.n;o++)Math.abs(e[i*e.n+o])>n&&l[i]++
return l}return
case"spmatrix":if(1==arguments.length)return norm0Vector(e.val,n)
if(1==r){var l=zeros(1,e.n)
if(e.rowmajor)for(var s=0;s<e.val.length;s++)Math.abs(e.val[s])>n&&l.val[e.cols[s]]++
else for(var i=0;i<e.n;i++)l.val[i]=norm0Vector(e.col(i).val,n)
return l}if(2==r){var l=zeros(e.m)
if(e.rowmajor)for(var i=0;i<e.m;i++)l[i]=norm0Vector(e.row(i).val,n)
else for(var s=0;s<e.val.length;s++)Math.abs(e.val[s])>n&&l[e.rows[s]]++
return l}return
default:return}}function norm0Vector(e,r){const t=e.length
for(var a=0,n=0;n<t;n++)Math.abs(e[n])>r&&a++
return a}function solve(e,r){var t=type(e)
if("vector"==t||"spvector"==t||"matrix"==t&&1==e.m){var a=mul(transpose(e),e)
return mul(transpose(e),r)/a}return"spmatrix"==t?spcgnr(e,r):"vector"==type(r)?e.m==e.n?solveGaussianElimination(e,r):solveWithQRcolumnpivoting(e,r):solveWithQRcolumnpivotingMultipleRHS(e,r)}function cholsolve(e,r){var t=forwardsubstitution(e,r)
return backsubstitution(transposeMatrix(e),t)}function solveWithQRfactorization(e,r){const t=e.length,a=e.n
var n,i,o,l=qr(e),s=l.R,c=l.beta,u=vectorCopy(r)
for(n=0;n<a-1;n++)i=get(s,range(n,t),n),i[0]=1,o=get(u,range(n,t)),set(u,range(n,t),sub(o,mul(c[n]*mul(i,o),i)))
return t>a&&(n=a-1,i=get(s,range(n,t),n),i[0]=1,o=get(u,range(n,t)),set(u,range(n,t),sub(o,mul(c[n]*mul(i,o),i)))),backsubstitution(s,get(u,range(a)))}function backsubstitution(e,r){const t=r.length
var a=t-1,n=zeros(t)
for(isZero(e.val[a*t+a])||(n[a]=r[a]/e.val[a*t+a]),a=t-2,isZero(e.val[a*t+a])||(n[a]=(r[a]-e.val[a*t+t-1]*n[t-1])/e.val[a*t+a]),a=t-3;a>=0;a--)isZero(e.val[a*t+a])||(n[a]=(r[a]-dot(e.row(a).subarray(a+1,t),n.subarray(a+1,t)))/e.val[a*t+a])
return n}function forwardsubstitution(e,r){const t=r.length
var a,n=zeros(t)
for(isZero(e.val[0])||(n[0]=r[0]/e.val[0]),isZero(e.val[t+1])||(n[1]=(r[1]-e.val[t]*n[0])/e.val[t+1]),a=2;a<t;a++)isZero(e.val[a*t+a])||(n[a]=(r[a]-dot(e.row(a).subarray(0,a),n.subarray(0,a)))/e.val[a*t+a])
return n}function solveWithQRcolumnpivoting(e,r){var t,a,n,i,o,l,s
if("matrix"==type(e)){t=e.m,a=e.n
var c=qr(e)
n=c.R,i=c.V,o=c.beta,l=c.rank,s=c.piv}else n=e.R,l=e.rank,i=e.V,o=e.beta,s=e.piv,t=n.m,a=n.n
var u,f,d=vectorCopy(r)
for(u=0;u<l;u++)f=get(d,range(u,t)),set(d,range(u,t),sub(f,mul(o[u]*mul(i[u],f),i[u])))
var h=zeros(a)
for(l>1?set(h,range(0,l),backsubstitution(n,get(d,range(l)))):h[0]=d[0]/n.val[0],u=l-1;u>=0;u--)if(s[u]!=u){var m=h[u]
h[u]=h[s[u]],h[s[u]]=m}return h}function solveWithQRcolumnpivotingMultipleRHS(e,r){var t,a,n,i,o,l,s
if("matrix"==type(e)){t=e.m,a=e.n
var c=qr(e)
n=c.R,i=c.V,o=c.beta,l=c.rank,s=c.piv}else n=e.R,l=e.rank,i=e.V,o=e.beta,s=e.piv,t=n.m,a=n.n
var u,f,d=matrixCopy(r)
for(u=0;u<l;u++)f=get(d,range(u,t),[]),set(d,range(u,t),[],sub(f,mul(mul(o[u],i[u]),mul(transpose(i[u]),f))))
var h=zeros(a,t)
if(l>1)for(u=0;u<t;u++)set(h,range(0,l),u,backsubstitution(n,get(d,range(l),u)))
else set(h,0,[],entrywisediv(get(d,0,[]),n.val[0]))
for(u=l-1;u>=0;u--)s[u]!=u&&swaprows(h,u,s[u])
return h}function solveGaussianElimination(e,r){var t,a,n,i=matrixCopy(e).toArrayOfFloat64Array(),o=vectorCopy(r)
const l=e.m,s=e.n
if(l==s){for(n=0;n<l;n++){var c=n,u=Math.abs(i[c][n])
for(t=n+1;t<l;t++){var f=Math.abs(i[t][n])
f>u&&(c=t,u=f)}if(isZero(u))return console.log("** Warning in solve(A,b), A is square but singular, switching from Gaussian elimination to QR method."),solveWithQRcolumnpivoting(i,o)
if(c!=n){var d=i[n]
i[n]=i[c],i[c]=d
var h=o[n]
o[n]=o[c],o[c]=h}var m=i[n],p=m[n]
for(o[n]/=p,a=n+1;a<s;a++)m[a]/=p
Math.abs(p)<1e-8&&console.log("** Warning in solveGaussianElimination: "+p+" "+n+":"+l)
var f,v=o[n]
for(t=0;t<l;t++)if(t!=n){var b=i[t]
for(f=b[n],a=n+1;a<s;a++)b[a]-=f*m[a]
o[t]-=f*v}}return o}}function inv(e){if("number"==typeof e)return 1/e
var r,t,a
const n=e.length,i=e.n
if(n!=i)return"undefined"
var o=matrixCopy(e),l=eye(i)
for(a=0;a<n;a++){var s=a*i,c=a,u=Math.abs(o.val[c*i+a])
for(r=a+1;r<n;r++)Math.abs(o.val[r*i+a])>u&&(c=r,u=Math.abs(o.val[r*i+a]))
if(Math.abs(u)<1e-12)return"singular"
c!=a&&(swaprows(o,a,c),swaprows(l,a,c))
var f=o.val[s+a]
for(t=0;t<i;t++)o.val[s+t]/=f,l.val[s+t]/=f
Math.abs(f)<1e-8&&console.log("!! Warning in inv(): "+f+" "+a+":"+n)
var d
for(r=0;r<n;r++)if(r!=a){var h=r*i
if(d=o.val[h+a],!isZero(d))for(t=0;t<i;t++)o.val[h+t]-=d*o.val[s+t],l.val[h+t]-=d*l.val[s+t]}}return l}function chol(e){const r=e.m
if(e.n!=r)return void error("Cannot compute the cholesky factorization: the matrix is not square.")
const t=r*r,a=e.val
var n,i,o=new Float64Array(t),l=Math.sqrt(a[0])
for(n=0;n<t;n+=r)o[n]=a[n]/l
i=1
for(var s=r;i<r&&!isNaN(l);){for(n=s;n<t;n+=r){for(var c=a[n+i],u=0;u<i;u++)c-=o[s+u]*o[n+u]
n==s&&(l=Math.sqrt(c)),o[n+i]=c/l}i++,s+=r}return isNaN(l)?void 0:new Matrix(r,r,o,!0)}function ldlsymmetricpivoting(e){var r=matrixCopy(e),t=r.length
if(r.m!=t)return void error("Error in ldl(): the matrix is not square.")
var a,n,i,o=zeros(t)
for(a=0;a<t-1;a++){o[a]=findmax(get(diag(r),range(a,t))),swaprows(r,a,o[a]),swapcols(r,a,o[a]),n=r.val[a*t+a],i=getCols(r,[a]).subarray(a+1,t)
for(var l=a+1;l<t;l++)r.val[l*t+a]/=n
set(r,range(a+1,t),range(a+1,t),sub(get(r,range(a+1,t),range(a+1,t)),outerprod(i,i,1/n)))}for(var s=0;s<t-1;s++)for(var a=s+1;a<t;a++)r.val[s*t+a]=0
return{L:r,piv:o}}function house(e){const r=e.length
var t,a,n,i,o,l=zeros(r),s=e[0],c=dot(e,e)
if(o=c-s*s,isZero(o))n=0,l[0]=1
else for(a=Math.sqrt(c),i=s<EPS?s-a:-o/(s+a),n=2*i*i/(o+i*i),l[0]=1,t=1;t<r;t++)l[t]=e[t]/i
return{v:l,beta:n}}function qroriginal(e,r){var t=e.length,a=e.n
if(a>t)return"QR factorization unavailable for n > m."
var n,i,o,l,s=matrixCopy(e),c=zeros(a),u=new Array
for(n=0;n<a-1;n++)i=house(get(s,range(n,t),n)),o=get(s,range(n,t),range(n,a)),set(s,range(n,t),range(n,a),subMatrices(o,outerprodVectors(i.v,mulMatrixVector(transposeMatrix(o),i.v),i.beta))),u[n]=i.v,c[n]=i.beta
if(t>a&&(n=a-1,o=get(s,range(n,t),n),i=house(o),set(s,range(n,t),a-1,subVectors(o,mulScalarVector(dot(i.v,o)*i.beta,i.v))),u[n]=vectorCopy(i.v),c[n]=i.beta),r){var f
"number"==typeof r?(f=r,l=eye(t,f)):(l=eye(t),f=t)
var d,h=a-1
for(t<=a&&(h=a-2),h>=f&&(h=f-1),n=h;n>=0;n--)d=get(l,range(n,t),range(n,f)),f>1?n==f-1?set(l,range(n,t),[n],subVectors(d,mulScalarVector(dot(d,u[n])*c[n],u[n]))):set(l,range(n,t),range(n,f),sub(d,outerprod(u[n],mul(transpose(d),u[n]),c[n]))):l=subVectors(d,mulScalarVector(dot(d,u[n])*c[n],u[n]))}return{Q:l,R:s,beta:c}}function qr(e,r){const t=e.m,a=e.n
var n,i,o,l=transpose(e),s=new Array,c=zeros(a),u=zeros(a),f=-1,d=norm(e),h=d
var m=1e-5*d
m*=m
var p=0,v=0,b=zeros(a)
for(n=0;n<a;n++){var g=l.val.subarray(n*l.n,n*l.n+l.n)
b[n]=dot(g,g),b[n]>p&&(p=b[n],v=n)}for(var x=function(e,r,n){var i,o,s,c=t-e
for(i=e;i<a;i++){var u=0,f=i*t+e,d=l.val.subarray(f,f+c)
for(s=0;s<c;s++)u+=d[s]*r[s]
for(u*=n,o=0;o<c;o++)d[o]-=u*r[o]}};p>EPS&&f<a-1&&h>m;)f++,u[f]=v,swaprows(l,f,v),b[v]=b[f],b[f]=p,f<t-1?i=house(l.val.subarray(f*l.n+f,f*l.n+t)):(i.v=[1],i.beta=0),f<a-1?x(f,i.v,i.beta):f<t-1&&x(f,i.v,i.beta),s[f]=vectorCopy(i.v),c[f]=i.beta,f<a-1&&(!function(e){var r
for(r=e+1;r<a;r++){var n=l.val[r*t+e]
b[r]-=n*n}for(v=e+1,p=b[e+1],r=e+2;r<a;r++)b[r]>p&&(p=b[r],v=r)}(f),h=f<t-1?function(e){for(var r,n=0,i=e+1,o=i*t;i<a&&n<=m;){for(r=e+1;r<t;r++){var s=l.val[o+r]
n+=s*s}i++,o+=t}return n}(f):0)
if(r){o=eye(t)
var y,w=f
for(t>f+1&&(w=f-1),n=w;n>=0;n--)if(n==t-1)o.val[n*t+n]-=c[n]*s[n][0]*s[n][0]*o.val[n*t+n]
else{var M=range(n,t)
y=get(o,M,M),set(o,M,M,subMatrices(y,outerprodVectors(s[n],mulMatrixVector(transposeMatrix(y),s[n]),c[n])))}}return{Q:o,R:transpose(l),V:s,beta:c,piv:u,rank:f+1}}function qrRnotTransposed(e,r){var t,a,n,i,o,l=e.m,s=e.n,c=matrixCopy(e),u=new Array,f=zeros(s),d=zeros(s),h=-1,m=norm(e),p=m,v=0,b=0,g=zeros(s)
for(a=0;a<s;a++){var x=getCols(e,[a])
g[a]=dot(x,x),g[a]>v&&(v=g[a],b=a)}for(;v>EPS&&h<s-1&&p>1e-6*m;)if(h++,d[h]=b,swapcols(c,h,b),g[b]=g[h],g[h]=v,h<l-1?(n=house(get(c,range(h,l),h)),o=get(c,range(h,l),range(h,s))):(n.v=[1],n.beta=0,o=c[l-1][l-1]),h<s-1?set(c,range(h,l),range(h,s),subMatrices(o,outerprodVectors(n.v,mulMatrixVector(transposeMatrix(o),n.v),n.beta))):set(c,range(h,l),h,sub(o,mul(n.beta*mul(o,n.v),n.v))),l>h+1&&(u[h]=vectorCopy(n.v)),f[h]=n.beta,h<s-1){for(a=h+1;a<s;a++)g[a]-=c[h][a]*c[h][a]
for(b=h+1,v=g[h+1],a=h+2;a<s;a++)g[a]>v&&(v=g[a],b=a)
if(h<l-1){for(p=0,t=h+1;t<l;t++)for(a=h+1;a<s;a++)Rij=c[t][a],p+=Rij*Rij
p=Math.sqrt(p)}else p=0}if(r){i=eye(l)
var y,w=h
for(l>h+1&&(w=h-1),a=w;a>=0;a--)a==l-1?i.val[a*l+a]-=f[a]*u[a][0]*u[a][0]*i.val[a*l+a]:(y=get(i,range(a,l),range(a,l)),set(i,range(a,l),range(a,l),subMatrices(y,outerprodVectors(u[a],mulMatrixVector(transposeMatrix(y),u[a]),f[a]))))}return{Q:i,R:c,V:u,beta:f,piv:d,rank:h+1}}function solvecg(e,r){return"spmatrix"==e.type?spsolvecg(e,r):solvecgdense(e,r)}function solvecgdense(e,r){const t=e.n,a=e.m
var n=randn(t),i=subVectors(r,mulMatrixVector(e,n)),o=dot(i,i)
var l=1e-8*norm(r)
l*=l
var s=vectorCopy(i),c=mulMatrixVector(e,s),u=o/dot(s,c)
saxpy(u,s,n),saxpy(-u,c,i)
var f=o
o=dot(i,i)
for(var d=1;o>l&&d<t;)!function(e,r){for(var t=0;t<a;t++)s[t]=r[t]+e*s[t]}(o/f,i),c=mulMatrixVector(e,s),u=o/dot(s,c),saxpy(u,s,n),saxpy(-u,c,i),f=o,o=dot(i,i),d++
return n}function cgnr(e,r){return"spmatrix"==e.type?spcgnr(e,r):cgnrdense(e,r)}function cgnrdense(e,r){const t=e.n,a=e.m
var n=randn(t),i=transposeMatrix(e),o=subVectors(r,mulMatrixVector(e,n))
var l=1e-8*norm(r)
l*=l
var s=mulMatrixVector(i,o),c=dot(s,s),u=vectorCopy(s),f=mulMatrixVector(e,u),d=c/dot(f,f)
saxpy(d,u,n),saxpy(-d,f,o),s=mulMatrixVector(i,o)
var h=c
c=dot(s,s)
for(var m=1;c>l&&m<t;)!function(e,r){for(var t=0;t<a;t++)u[t]=r[t]+e*u[t]}(c/h,s),f=mulMatrixVector(e,u),d=c/dot(f,f),saxpy(d,u,n),saxpy(-d,f,o),s=mulMatrixVector(i,o),h=c,c=dot(s,s),m++
return n}function lanczos(e,r){const t=EPS*norm(e),a=e.n
var n,i=0,o=vectorCopy(r),l=mulMatrixVector(e,o),s=dot(o,l)
for(saxpy(-s,o,l),beta=norm(b);beta>t&&i<300;){for(n=0;n<a;n++){var c=o[n]
o[n]=l[n]/beta,l[n]=-beta/c}var u=mulMatrixVector(e,o)
for(n=0;n<a;n++)l[n]+=u[n]
s=dot(o,l),saxpy(-s,o,l),beta=norm(l),i++}}function tridiagonalize(e,r){var t
const a=e.length
var n,i
if(r){n=e,i=eye(a)
var o=[],l=[]}else n=matrixCopy(e)
var s,c,u,f,d
for(t=0;t<a-2;t++)Tkp1k=get(n,range(t+1,a),t),Tkp1kp1=get(n,range(t+1,a),range(t+1,a)),d=house(Tkp1k),s=mulScalarVector(d.beta,mulMatrixVector(Tkp1kp1,d.v)),c=subVectors(s,mulScalarVector(.5*d.beta*dot(s,d.v),d.v)),f=zeros(a-t-1),f[0]=norm(Tkp1k),set(n,t,range(t+1,a),f),set(n,range(t+1,a),t,f),u=outerprodVectors(d.v,c),set(n,range(t+1,a),range(t+1,a),subMatrices(subMatrices(Tkp1kp1,u),transpose(u))),r&&(l[t]=d.v,o[t]=d.beta)
if(r){for(t=a-3;t>=0;t--)!function(e,r,t){var n,o,l=zeros(a-e),s=a-e
for(n=0;n<s;n++){var c=(n+e)*a+e
for(o=0;o<s;o++)l[o]+=r[n]*i.val[c+o]}for(n=0;n<s;n++){var c=(n+e)*a+e,u=t*r[n]
for(o=0;o<s;o++)i.val[c+o]-=u*l[o]}}(t+1,l[t],o[t])
return i}return n}function givens(e,r,t,a,n){var i,o,l,s
return 0==r?(i=1,o=0):Math.abs(r)>Math.abs(e)?(l=-e/r,o=1/Math.sqrt(1+l*l),i=o*l):(l=-r/e,i=1/Math.sqrt(1+l*l),o=i*l),5==arguments.length?(s=eye(n),s.val[t*n+t]=i,s.val[t*n+a]=o,s.val[a*n+t]=-o,s.val[a*n+a]=i,s):[i,o]}function premulGivens(e,r,t,a,n){const i=n.n
var o
const l=t*i,s=a*i
var c,u
for(o=0;o<i;o++)c=n.val[l+o],u=n.val[s+o],n.val[l+o]=e*c-r*u,n.val[s+o]=r*c+e*u}function postmulGivens(e,r,t,a,n){const i=n.length
var o,l,s,c=0
for(o=0;o<i;o++)l=n.val[c+t],s=n.val[c+a],n.val[c+t]=e*l-r*s,n.val[c+a]=r*l+e*s,c+=n.n}function implicitSymQRWilkinsonShift(e,r){const t=e.length,a=t*(t-2),n=t*(t-1),i=(e.val[a+t-2]-e.val[n+t-1])/2,o=e.val[n+t-2]*e.val[n+t-2],l=e.val[n+t-1]-o/(i+Math.sign(i)*Math.sqrt(i*i+o))
var s,c=e.val[0]-l,u=e.val[t]
if(r)var f=new Array(t-1)
var d
for(d=0;d<t-1;d++)if(s=givens(c,u),postmulGivens(s[0],s[1],d,d+1,e),premulGivens(s[0],s[1],d,d+1,e),r&&(f[d]=[s[0],s[1]]),d<t-2){var h=t*(d+1)+d
c=e.val[h],u=e.val[h+t]}return r?{T:e,cs:f}:e}function eig(e,r){var t,a
r?(a=matrixCopy(e),t=tridiagonalize(a,!0)):a=tridiagonalize(e)
var n,i
const o=e.length
var l
do{for(l=0;l<o-1;l++)Math.abs(a.val[l*o+l+1])<1e-12*(Math.abs(a.val[l*o+l])+Math.abs(a.val[(l+1)*o+l+1]))&&(a.val[l*o+l+1]=0,a.val[(l+1)*o+l]=0)
if(isZero(a.val[(o-1)*o+o-2])&&isZero(a.val[(o-2)*o+o-1])){for(n=1;n<o-1&&isZero(a.val[(o-n-1)*o+o-n-2])&&isZero(a.val[(o-n-2)*o+o-n-1]);)n++
n>=o-1&&(n=o)}else n=0
i=-1
var s
do{for(i++,s=!1,k=i;k<o-n-1&&0==s;)isZero(a.val[(k+1)*o+k])&&(s=!0),k++}while(s&&i+n<o)
if(n<o)if(r){var c=implicitSymQRWilkinsonShift(get(a,range(i,o-n),range(i,o-n)),!0)
set(a,range(i,o-n),range(i,o-n),c.T)
for(var u=0;u<o-n-i-1;u++)postmulGivens(c.cs[u][0],c.cs[u][1],i+u,i+u+1,t)}else set(a,range(i,o-n),range(i,o-n),implicitSymQRWilkinsonShift(get(a,range(i,o-n),range(i,o-n)),!1))}while(n<o)
return r?{V:diag(a),U:t}:diag(a)}function eigs(e,r,t){if(void 0===r)var r=1
return void 0===t||0==t||"smallest"!=t?1==r?eig_powerIteration(e):eig_orthogonalIteration(e,r):1==r?eig_inverseIteration(e,0):eig_bisect(e,r)}function eig_powerIteration(e,r){var t
const a=e.length
var n
n=void 0===r?randn(a):r,n=mulScalarVector(1/norm(n),n)
var i=1
for(t=0;t<1e3;t++)n=mulMatrixVector(e,n),i=norm(n),n=mulScalarVector(1/i,n)
return{v:i,u:n}}function eig_orthogonalIteration(e,r){if(1==r)return eig_powerIteration(e)
var t
const a=e.length
var n=randn(a,r),i=norm(n,1)
n=entrywisediv(n,mul(ones(a),i))
var o
var l
for(t=0;t<1e3&&(o=mulMatrixMatrix(e,n),!(Math.floor(t/50)==t/50&&(l=mulMatrixMatrix(transpose(n),o),norm(subMatrices(o,mulMatrixMatrix(n,diag(diag(l)))))<1e-11)));t++)n=qroriginal(o,r).Q
return l=mulMatrixMatrix(transpose(n),mulMatrixMatrix(e,n)),{V:diag(l),U:n}}function eig_inverseIteration(e,r){var t=1e-4*r
if(void 0===a)var a=100
var n
const i=e.length
for(var o=sub(e,mul(r+t,eye(i))),l=qr(o);l.rank<i;)t*=10,o=sub(e,mul(r+t,eye(i))),l=qr(o)
var s=sub(mul(2,rand(i)),1)
s=mulScalarVector(1/norm(s),s)
var c,u,f=norminf(e)
n=0
do{s=solveWithQRcolumnpivoting(l,s),c=norm(s),s=entrywisediv(s,c),u=mulMatrixVector(o,s),n++}while(n<a&&maxVector(absVector(u))<1e-10*f)
return s}function eigenvector(e,r){return eig_inverseIteration(e,r,2)}function eig_inverseOrthogonalIteration(e,r){if(1==r)return eig_inverseIteration(e)
var t
const a=e.length
var n=qr(e),i=randn(a,r),o=norm(i,1)
i=entrywisediv(i,mul(ones(a),o))
var n,l
var s
for(t=0;t<1e3&&(l=solveWithQRcolumnpivotingMultipleRHS(n,i),!(Math.floor(t/50)==t/50&&(s=mulMatrixMatrix(transpose(i),l),norm(subMatrices(l,mulMatrixMatrix(i,s)))<1e-11)));t++)i=qroriginal(l,r).Q
return s=mulMatrixMatrix(transpose(i),mulMatrixMatrix(e,i)),{V:diag(s),U:i,iters:t}}function eig_bisect(e,r){var t,a,n,i=tridiagonalize(e)
const o=i.n
var l,s=diag(i),c=zeros(o)
for(l=0;l<o-1;l++)c[l]=i.val[l*o+l+1]
for(var u=s[0]-c[0],f=s[0]+c[0],l=1;l<o;l++){var d=s[l]-c[l]-c[l-1],h=s[l]+c[l]+c[l-1]
d<u&&(u=d),h>f&&(f=h)}var m=zeros(r),p=entrywisemul(f,ones(r))
a=u
for(var v,b=1;b<=r;b++){for(n=p[b-1];Math.abs(n-a)>1e-10*(Math.abs(a)+Math.abs(n));){t=(a+n)/2,v=function(e,r,t,a){var n,i=r[0]-e,o=0
i<EPS&&(o=1)
var l
for(l=1;l<a;l++)n=r[l]-e-t[l-1]*t[l-1]/i,n<EPS&&o++,i=Math.abs(n)<EPS?EPS:n
return o}(t,s,c,o),v>=b?n=t:a=t
for(var g=b+1;g<=r;g++)v>=g&&(p[g-1]=t)}m[b-1]=(a+n)/2}var x=eigenvector(e,m[0]),y=mat([x],!1)
for(b=1;b<r;b++){var w=10*Math.max(EPS,Math.abs(EPS*m[b-1]))
m[b]<m[b-1]+w&&(m[b]=m[b-1]+w),x=eigenvector(e,m[b]),y=mat([y,x],!1),y=qroriginal(y,y.n).Q}return{U:y,V:m}}function bidiagonalize(e,r,t,a){var n
const i=e.length,o=e.n
var l
l=matrixCopy(e)
var s
if(r)if(t)var c=eye(i,o),u=o
else var c=eye(i),u=i
if(a)var f=eye(o)
if(a)var d=function(e,r,t){var a,n,i=o-e-1
for(a=0;a<o;a++){var l=a*o+e+1,s=0
for(n=0;n<i;n++)s+=f.val[l+n]*r[n]
var c=t*s
for(n=0;n<i;n++)f.val[l+n]-=c*r[n]}}
if(r)var h=new Array(o),m=new Array(o)
for(n=0;n<o;n++)n<i-1&&(s=house(get(l,range(n,i),n)),function(e,r,t){var a,n,s=zeros(o-e),c=o-e,u=i-e
for(a=0;a<u;a++){var f=(a+e)*o+e
for(n=0;n<c;n++)s[n]+=r[a]*l.val[f+n]}for(a=0;a<u;a++){var d=t*r[a],f=(a+e)*o+e
for(n=0;n<c;n++)l.val[f+n]-=d*s[n]}}(n,s.v,s.beta),r&&(h[n]=vectorCopy(s.v),m[n]=s.beta)),n<o-2&&(s=house(l.row(n).subarray(n+1,o)),function(e,r,t){var a,n,s=o-e-1
for(a=e;a<i;a++){var c=a*o+e+1,u=0
for(n=0;n<s;n++)u+=l.val[c+n]*r[n]
var f=t*u
for(n=0;n<s;n++)l.val[c+n]-=f*r[n]}}(n,s.v,s.beta),a&&d(n,s.v,s.beta))
if(r){var p=Math.min(o-1,i-2)
for(n=p;n>=0;n--)!function(e,r,t){var a,n,o=zeros(u)
for(a=e;a<i;a++){var l=a*u,s=a-e
for(n=0;n<u;n++)o[n]+=r[s]*c.val[l+n]}for(a=e;a<i;a++){var f=t*r[a-e],l=a*u
for(n=0;n<u;n++)c.val[l+n]-=f*o[n]}}(n,h[n],m[n])}return r&&a?{U:c,V:f,B:l}:a?{V:f,B:l}:r?{U:c,B:l}:l}function GolubKahanSVDstep(e,r,t,a,n,i){if("matrix"!=type(e))return e
if(n<2)return e
const o=(r+n-2)*e.n+t,l=e.val[o+n-2],s=e.val[o+n-1]
var c
c=n>2?e.val[(r+n-3)*e.n+t+n-2]:0
const u=e.val[(r+n-1)*e.n+t+n-1],f=(l*l+c*c-u*u-s*s)/2,d=l*s*l*s,h=u*u+s*s-d/(f+Math.sign(f)*Math.sqrt(f*f+d))
var m,p=-h,v=0,b=r*e.n+t
for(m=0;m<n;m++)p+=e.val[b]*e.val[b],v+=e.val[b]*e.val[b+1],b+=e.n
var g
if(i)var x=new Array(n-1),y=new Array(n-1)
for(m=0;m<n-1;m++)g=givens(p,v),function(n,i,o,l){var s,c,u,f=r*e.n+t
for(s=0;s<a;s++)c=e.val[f+o],u=e.val[f+l],e.val[f+o]=n*c-i*u,e.val[f+l]=i*c+n*u,f+=e.n}(g[0],g[1],m,m+1),i&&(y[m]=[g[0],g[1]]),p=e.val[(r+m)*e.n+t+m],v=e.val[(r+m+1)*e.n+t+m],g=givens(p,v),function(a,i,o,l){var s
const c=(r+o)*e.n+t,u=(r+l)*e.n+t
var f,d
for(s=0;s<n;s++)f=e.val[c+s],d=e.val[u+s],e.val[c+s]=a*f-i*d,e.val[u+s]=i*f+a*d}(g[0],g[1],m,m+1),i&&(x[m]=[g[0],g[1]]),m<n-2&&(p=e.val[(r+m)*e.n+t+m+1],v=e.val[(r+m)*e.n+t+m+2])
return i?{csU:x,csV:y}:void 0}function svd(e,r){if("vector"==type(e)||"matrix"==type(e)&&1==e.n)return{U:matrixCopy(e),S:ones(1,1),V:ones(1,1),s:[1]}
if(1==e.m)return{U:ones(1,1),S:ones(1,1),V:transpose(e),s:[1]}
var t,a=e.length,n=e.n,i=!1
if(n>a){i=!0
var o=transposeMatrix(e)
n=a,a=o.length}var l=!1,s=!1,c=!1
if(void 0!==r&&!1!==r){"full"===r?(l=!0,s=!0,c=!1):!0===r||"thin"===r?(l=!0,s=!0,c=!0):"string"==typeof r&&(r.indexOf("U")>=0&&(l=!0),r.indexOf("V")>=0&&(s=!0),r.indexOf("thin")>=0&&(c=!0))
var u
if(i){var f=l
l=s,s=f,u=bidiagonalize(o,l,c,s)}else u=bidiagonalize(e,l,c,s)
if(l)var d=transpose(u.U)
else var d=void 0
if(s)var h=u.V,m=transposeMatrix(h)
else var h=void 0
var p=u.B}else if(i)var p=bidiagonalize(o,!1,!1,!1)
else var p=bidiagonalize(matrixCopy(e),!1,!1,!1)
var v,b,g,x
const y=1e-11
do{for(t=0;t<n-1;t++)Math.abs(p.val[t*p.n+t+1])<y*(Math.abs(p.val[t*p.n+t])+Math.abs(p.val[(t+1)*p.n+t+1]))&&(p.val[t*p.n+t+1]=0)
if(Math.abs(p.val[(n-1)*p.n+n-2])>y||Math.abs(p.val[(n-2)*p.n+n-1])>y)b=0
else{for(b=1;b<n-1&&Math.abs(p.val[(n-b-1)*p.n+n-b-2])<y&&Math.abs(p.val[(n-b-2)*p.n+n-b-1])<y;)b++
b>=n-1&&(b=n)}for(g=n-b-1;g>0&&!isZero(p.val[(g-1)*p.n+g]);)g--
if(b<n){var w=-1
for(x=g;x<n-b-1;x++)if(Math.abs(p.val[x*p.n+x])<y){w=x
break}if(w>=0)if(w<n-b-1)for(j=w+1;j<n;j++)v=givens(-p.val[j*p.n+j],p.val[w*p.n+j]),premulGivens(v[0],v[1],w,j,p),l&&premulGivens(v[0],v[1],w,j,d)
else for(j=w-1;j>=g;j--)v=givens(p.val[j*p.n*j],p.val[j*p.n+n-b-1]),postmulGivens(v[0],v[1],j,n-b-1,p),s&&premulGivens(v[0],v[1],j,n-b-1,m)
else if(r)for(var M=GolubKahanSVDstep(p,g,g,n-b-g,n-b-g,!0),_=0;_<n-b-g-1;_++)l&&premulGivens(M.csU[_][0],M.csU[_][1],g+_,g+_+1,d),s&&premulGivens(M.csV[_][0],M.csV[_][1],g+_,g+_+1,m)
else GolubKahanSVDstep(p,g,g,n-b-g,n-b-g)}}while(b<n)
if(r){s&&(h=transposeMatrix(m))
var k=diag(p)
zeros(n)
for(t=0;t<n;t++)k[t]<0&&(s&&set(h,[],t,minus(get(h,[],t))),k[t]=-k[t])
var A=sort(k,!0,!0)
if(s&&(h=get(h,[],A)),l){if(!c)for(t=n;t<a;t++)A.push(t)
d=get(d,A,[])}if(c)var L=diag(k)
else var L=mat([diag(k),zeros(a-n,n)],!0)
var C=void 0
return l&&(C=transpose(d)),i?c?{U:h,S:L,V:C,s:k}:{U:h,S:transpose(L),V:C,s:k}:{U:C,S:L,V:h,s:k}}return sort(abs(diag(p)),!0)}function rank(e){const r=svd(e)
var t,a=0
for(t=0;t<r.length;t++)r[t]>1e-10&&a++
return a}function nullspace(e){const r=svd(e,"V"),t=e.n
var a=0
for(;a<t&&r.s[a]>1e-8;)a++
return a<t?get(r.V,[],range(a,t)):zeros(t)}function orth(e){const r=svd(e,"thinU"),t=e.n
var a=0
for(;a<t&&r.s[a]>1e-8;)a++
return get(r.U,[],range(0,a))}function spVector(e,r,t){if(this.length=e,this.size=[e,1],this.type="spvector",arguments.length<=2){if(1==arguments.length)var a=e
else var a=r
this.val=new Float64Array(a),this.ind=new Uint32Array(a)}else{var a=r.length
this.val=new Float64Array(r),this.ind=new Uint32Array(t)}this.nnz=a}function spMatrix(e,r,t,a,n){if(this.length=e,this.m=e,this.n=r,this.size=[e,r],this.type="spmatrix",arguments.length<=3){if(2==arguments.length)var i=e*r
else var i=t
this.rowmajor=!0,this.val=new Float64Array(i),this.cols=new Uint32Array(i),this.rows=new Uint32Array(e+1)}else{var i=t.length
n.length==i&&a.length==r+1&&a[a.length-1]==i?(this.rowmajor=!1,this.val=new Float64Array(t),this.cols=new Uint32Array(a),this.rows=new Uint32Array(n)):(this.rowmajor=!0,this.val=new Float64Array(t),this.cols=new Uint32Array(a),this.rows=new Uint32Array(n))}this.nnz=i}function spgetRows(e,r){var t=r.length
if(e.rowmajor){if(t>1){for(var a=sort(r),n=new Array(t),i=0,o=0;o<t;o++)n[o]=e.row(a[o]),i+=n[o].val.length
for(var l=new Float64Array(i),s=new Uint32Array(i),c=new Uint32Array(t+1),u=0,o=0;o<t;o++)c[o]=u,l.set(n[o].val,u),s.set(n[o].ind,u),u+=n[o].val.length
return c[o]=u,new spMatrix(t,e.n,l,s,c)}return e.row(r[0])}return getRows(fullMatrix(e),r)}function fullVector(e){var r
const t=e.length,a=e.val.length
var n=new Float64Array(t)
for(r=0;r<a;r++)n[e.ind[r]]=e.val[r]
return n}function fullMatrix(e){const r=e.n
if(e.rowmajor){var t
const a=e.m
for(var n=new Float64Array(a*r),i=0,o=0;o<a;o++){var l=e.rows[o],s=e.rows[o+1]
for(t=l;t<s;t++)n[i+e.cols[t]]=e.val[t]
i+=r}return new Matrix(a,r,n,!0)}for(var t,n=new Float64Array(e.m*r),c=0;c<r;c++){var l=e.cols[c],s=e.cols[c+1]
for(t=l;t<s;t++){var o=e.rows[t]
n[o*r+c]=e.val[t]}}return new Matrix(e.m,r,n,!0)}function full(e){switch(type(e)){case"spvector":return fullVector(e)
case"spmatrix":return fullMatrix(e)
default:return e}}function sparseVector(e){var r
const t=e.length
var a=new Array,n=new Array
for(r=0;r<t;r++)isZero(e[r])||(a.push(e[r]),n.push(r))
return new spVector(t,a,n)}function sparseMatrix(e){var r,t
const a=e.m,n=e.n
var i,o=new Array,l=new Array,s=new Uint32Array(n+1)
for(t=0;t<n;t++)for(i=t,r=0;r<a;r++)isZero(e.val[i])||(o.push(e.val[i]),l.push(r),s[t+1]++),i+=n
for(t=1;t<n;t++)s[t+1]+=s[t]
return new spMatrix(a,n,o,s,l)}function sparseMatrixRowMajor(e){var r,t
const a=e.m,n=e.n
var i=new Array,o=new Array,l=new Uint32Array(a+1),s=0
for(r=0;r<a;r++)for(t=0;t<n;t++)isZero(e.val[s])||(i.push(e.val[s]),l[r+1]++,o.push(t)),s++
for(r=1;r<a;r++)l[r+1]+=l[r]
return new spMatrix(a,n,i,o,l)}function sparse(e,r){if(void 0===r)var r=!0
switch(type(e)){case"vector":return sparseVector(e)
case"matrix":return r?sparseMatrixRowMajor(e):sparseMatrix(e)
case"spvector":case"spmatrix":return e.copy()
default:return e}}function speye(e,r){if(void 0===r)var r=e
if(1==e&&1==r)return 1
var t=e<r?e:r,a=ones(t),n=range(t+1)
return new spMatrix(e,r,a,n.slice(0,t),n)}function spdiag(e){var r=e.length,t=range(r+1),a=t.slice(0,r),n=type(e)
return"vector"==n?new spMatrix(r,r,e,a,t):void error("Error in spdiag( x ): x is a "+n+" but should be a vector.")}function transposespVector(e){return new Matrix(1,e.length,fullVector(e),!0)}function transposespMatrix(e){return new spMatrix(e.n,e.m,e.val,e.rows,e.cols)}function spmat(e,r){var t,a=new Array(e.length)
for(t=0;t<e.length;t++)a[t]=type(e[t])
if(void 0===r)var r=!0
if(0==e.length)return[]
var n=0,i=0,o=0
if(r){var l=new Array
for(t=0;t<e.length;t++)switch(a[t]){case"vector":var s=sparseVector(e[t])
l.push(s),n+=1,i=e[t].length,o+=s.val.length
break
case"spvector":l.push(e[t]),i=e[t].length,n+=1,o+=e[t].val.length
break
case"spmatrix":for(var c=0;c<e[t].m;c++)l.push(e[t].row(c))
l.push(e[t]),i=e[t].length,n+=1,o+=e[t].val.length
break
default:return}var u=new spMatrix(n,i,o),f=0
for(u.rows[0]=0,t=0;t<l.length;t++)l[t].val.length>1?(u.val.set(new Float64Array(l[t].val),f),u.cols.set(new Uint32Array(l[t].ind),f),u.rows[t+1]=u.rows[t]+l[t].val.length,f+=l[t].val.length):1==l[t].val.length&&(u.val[f]=l[t].val[0],u.cols[f]=l[t].ind[0],u.rows[t+1]=u.rows[t]+1,f+=1)
return u}return error("spmat(..., false) for columnwise concatenation of sparse vectors not yet implemented"),l}function mulScalarspVector(e,r){const t=r.val.length
for(var a=r.copy(),n=0;n<t;n++)a.val[n]*=e
return a}function mulScalarspMatrix(e,r){const t=r.nnz
for(var a=r.copy(),n=0;n<t;n++)a.val[n]*=e
return a}function spdot(e,r){const t=e.val.length,a=r.val.length
for(var n=0,i=0,o=0;i<t&&o<a;){for(var l=e.ind[i];r.ind[o]<l&&o<a;)o++
r.ind[o]==l&&(n+=e.val[i]*r.val[o]),i++}return n}function dotspVectorVector(e,r){const t=e.val.length
for(var a=0,n=0;n<t;n++)a+=e.val[n]*r[e.ind[n]]
return a}function mulMatrixspVector(e,r){const t=e.m,a=e.n,n=r.val.length
for(var i=zeros(t),o=0,l=0;l<a;l++){for(var s=0;s<n;s++)i[l]+=e.val[o+r.ind[s]]*r.val[s]
o+=a}return i}function mulspMatrixVector(e,r){const t=e.m,a=e.n
var n=zeros(t)
if(e.rowmajor)for(var i=0;i<t;i++)for(var o=e.rows[i],l=e.rows[i+1],s=o;s<l;s++)n[i]+=e.val[s]*r[e.cols[s]]
else for(var c=0;c<a;c++)for(var o=e.cols[c],l=e.cols[c+1],u=r[c],s=o;s<l;s++)n[e.rows[s]]+=e.val[s]*u
return n}function mulspMatrixTransVector(e,r){const t=e.m,a=e.n
var n=zeros(a)
if(e.rowmajor)for(var i=0;i<t;i++)for(var o=e.rows[i],l=e.rows[i+1],s=r[i],c=o;c<l;c++)n[e.cols[c]]+=e.val[c]*s
else for(var i=0;i<a;i++)for(var o=e.cols[i],l=e.cols[i+1],c=o;c<l;c++)n[i]+=e.val[c]*r[e.rows[c]]
return n}function mulspMatrixspVector(e,r){const t=e.m
e.n
var a=zeros(t)
const n=r.val.length
if(e.rowmajor)for(var i=0;i<t;i++)a[i]=spdot(e.row(i),r)
else for(var o=0;o<n;o++)for(var l=r.ind[o],s=r.val[o],c=e.cols[l],u=e.cols[l+1],f=c;f<u;f++)a[e.rows[f]]+=e.val[f]*s
return a}function mulspMatrixTransspVector(e,r){const t=(e.m,e.n)
var a=zeros(t)
const n=r.val.length
if(e.rowmajor)for(var i=0;i<n;i++)for(var o=r.ind[i],l=r.val[i],s=e.rows[o],c=e.rows[o+1],u=s;u<c;u++)a[e.cols[u]]+=e.val[u]*l
else for(var f=0;f<t;f++)for(var i=0,s=e.cols[f],c=e.cols[f+1],d=s;d<c;d++){for(var o=e.rows[d];r.ind[i]<o&&i<n;)i++
r.ind[i]==f&&(a[f]+=e.val[d]*r.val[i])}return a}function mulspMatrixspMatrix(e,r){const t=e.m,a=e.n,n=r.n
var i=zeros(t,n)
if(e.rowmajor)if(r.rowmajor)for(var o=0;o<t;o++)for(var l=e.rows[o],s=e.rows[o+1],c=l;c<s;c++)for(var u=e.cols[c],f=e.val[c],d=r.rows[u],h=r.rows[u+1],m=o*n,p=d;p<h;p++)i.val[m+r.cols[p]]+=f*r.val[p]
else for(var v=0,b=0;b<t;b++)for(var u=0;u<n;u++)i.val[v]=spdot(e.row(b),r.col(u)),v++
else if(r.rowmajor)for(var g=0;g<a;g++)for(var l=e.cols[g],s=e.cols[g+1],x=r.rows[g],y=r.rows[g+1],c=l;c<s;c++)for(var m=e.rows[c]*n,w=e.val[c],M=x;M<y;M++)i.val[m+r.cols[M]]+=w*r.val[M]
else for(var _=0;_<n;_++)for(var x=r.cols[_],y=r.cols[_+1],M=x;M<y;M++)for(var u=r.rows[M],k=r.val[M],d=e.cols[u],h=e.cols[u+1],p=d;p<h;p++)i.val[e.rows[p]*n+_]+=e.val[p]*k
return i}function mulMatrixspMatrix(e,r){const t=e.m,a=e.n,n=r.n
var i=zeros(t,n)
if(r.rowmajor)for(var o=0;o<a;o++)for(var l=r.rows[o],s=r.rows[o+1],c=0;c<t;c++)for(var u=c*n,f=e.val[c*a+o],d=l;d<s;d++)i.val[u+r.cols[d]]+=f*r.val[d]
else for(var h=0;h<n;h++)for(var l=r.cols[h],s=r.cols[h+1],d=l;d<s;d++){var m=r.rows[d],p=r.val[d]
for(c=0;c<t;c++)i.val[c*n+h]+=e.val[c*a+m]*p}return i}function mulspMatrixMatrix(e,r){const t=e.m,a=e.n,n=r.n
var i=zeros(t,n)
if(e.rowmajor)for(var o=0;o<t;o++)for(var l=e.rows[o],s=e.rows[o+1],c=l;c<s;c++){var u=e.val[c],f=e.cols[c]*n,d=o*n
for(h=0;h<n;h++)i.val[d+h]+=u*r.val[f+h]}else for(var h=0;h<a;h++)for(var m=e.cols[h],p=e.cols[h+1],v=m;v<p;v++)for(var o=e.rows[v],b=0;b<n;b++)i.val[o*n+b]+=e.val[v]*r.val[h*n+b]
return i}function entrywisemulspVectors(e,r){const t=e.val.length,a=r.val.length
for(var n=new Array,i=new Array,o=0,l=0;o<t&&l<a;){for(var s=e.ind[o];r.ind[l]<s&&l<a;)l++
if(r.ind[l]==s){var c=e.val[o]*r.val[l]
isZero(c)||(n.push(c),i.push(s))}o++}return new spVector(e.length,n,i)}function entrywisemulspVectorVector(e,r){var t=e.copy()
const a=e.val.length
for(var n=0;n<a;n++)t.val[n]*=r[e.ind[n]]
return t}function entrywisemulspMatrices(e,r){if(e.rowmajor){if(r.rowmajor){var t,a,n,i=new Array,o=new Array,l=new Uint32Array(e.m+1)
for(n=0;n<e.m;n++){t=e.rows[n],a=r.rows[n]
for(var s=e.rows[n+1],c=r.rows[n+1];t<s&a<c;){for(var u=e.cols[t];r.cols[a]<u&&a<c;)a++
r.cols[a]==u&&(i.push(e.val[t]*r.val[a]),o.push(u),l[n+1]++),t++}}for(n=1;n<e.m;n++)l[n+1]+=l[n]
return new spMatrix(e.m,e.n,i,o,l)}return entrywisemulspMatrixMatrix(r,fullMatrix(e))}if(r.rowmajor)return entrywisemulspMatrixMatrix(e,fullMatrix(r))
var t,a,u,i=new Array,o=new Uint32Array(e.n+1),l=new Array
for(u=0;u<e.n;u++){t=e.cols[u],a=r.cols[u]
for(var s=e.cols[u+1],c=r.cols[u+1];t<s&a<c;){for(var n=e.rows[t];r.rows[a]<n&&a<c;)a++
r.rows[a]==n&&(i.push(e.val[t]*r.val[a]),l.push(n),o[u+1]++),t++}}for(u=1;u<e.n;u++)o[u+1]+=o[u]
return new spMatrix(e.m,e.n,i,o,l)}function entrywisemulspMatrixMatrix(e,r){var t=e.copy()
const a=(e.val.length,e.n),n=e.m
if(e.rowmajor)for(i=0;i<n;i++)for(var o=t.rows[i],l=t.rows[i+1],s=i*a,c=o;c<l;c++)t.val[c]*=r.val[s+t.cols[c]]
else for(j=0;j<a;j++)for(var o=t.cols[j],l=t.cols[j+1],c=o;c<l;c++)t.val[c]*=r.val[t.rows[c]*a+j]
return t}function addScalarspVector(e,r){const t=r.val.length,a=r.length
var n,i=zeros(a)
for(n=0;n<a;n++)i[n]=e
for(n=0;n<t;n++)i[r.ind[n]]+=r.val[n]
return i}function addVectorspVector(e,r){const t=r.val.length
r.length
for(var a=new Float64Array(e),n=0;n<t;n++)a[r.ind[n]]+=r.val[n]
return a}function addspVectors(e,r){const t=e.val.length,a=r.val.length
var n,i=zeros(e.length)
for(n=0;n<t;n++)i[e.ind[n]]=e.val[n]
for(n=0;n<a;n++)i[r.ind[n]]+=r.val[n]
return sparseVector(i)}function addScalarspMatrix(e,r){const t=(r.val.length,r.m),a=r.n,n=t*a
var i,o=zeros(t,a)
for(i=0;i<n;i++)o.val[i]=e
if(r.rowmajor){var l=0
for(i=0;i<t;i++){for(var s=r.rows[i],c=r.rows[i+1],u=s;u<c;u++)o.val[l+r.cols[u]]+=r.val[u]
l+=a}}else for(i=0;i<a;i++)for(var s=r.cols[i],c=r.cols[i+1],u=s;u<c;u++)o.val[r.rows[u]*a+i]+=r.val[u]
return o}function addMatrixspMatrix(e,r){const t=(r.val.length,r.m),a=r.n
var n,i=matrixCopy(e)
if(r.rowmajor){var o=0
for(n=0;n<t;n++){for(var l=r.rows[n],s=r.rows[n+1],c=l;c<s;c++)i.val[o+r.cols[c]]+=r.val[c]
o+=a}}else for(n=0;n<a;n++)for(var l=r.cols[n],s=r.cols[n+1],c=l;c<s;c++)i.val[r.rows[c]*a+n]+=r.val[c]
return i}function addspMatrices(e,r){const t=(e.val.length,r.val.length,e.m),a=e.n
var n,i=fullMatrix(e)
if(r.rowmajor){var o=0
for(n=0;n<t;n++){for(var l=r.rows[n],s=r.rows[n+1],c=l;c<s;c++)i.val[o+r.cols[c]]+=r.val[c]
o+=a}}else for(n=0;n<a;n++)for(var l=r.cols[n],s=r.cols[n+1],c=l;c<s;c++)i.val[r.rows[c]*a+n]+=r.val[c]
return sparseMatrixRowMajor(i)}function spsaxpy(e,r,t){const a=r.val.length
for(var n=0;n<a;n++)t[r.ind[n]]+=e*r.val[n]}function subScalarspVector(e,r){const t=r.val.length,a=r.length
var n,i=zeros(a)
for(n=0;n<a;n++)i[n]=e
for(n=0;n<t;n++)i[r.ind[n]]-=r.val[n]
return i}function subVectorspVector(e,r){const t=r.val.length
r.length
for(var a=new Float64Array(e),n=0;n<t;n++)a[r.ind[n]]-=r.val[n]
return a}function subspVectorVector(e,r){return subVectors(fullVector(e),r)}function subspVectors(e,r){const t=e.val.length,a=r.val.length
var n,i=zeros(e.length)
for(n=0;n<t;n++)i[e.ind[n]]=e.val[n]
for(n=0;n<a;n++)i[r.ind[n]]-=r.val[n]
return sparseVector(i)}function subScalarspMatrix(e,r){const t=(r.val.length,r.m),a=r.n,n=t*a
var i,o=zeros(t,a)
for(i=0;i<n;i++)o.val[i]=e
if(r.rowmajor){var l=0
for(i=0;i<t;i++){for(var s=r.rows[i],c=r.rows[i+1],u=s;u<c;u++)o.val[l+r.cols[u]]-=r.val[u]
l+=a}}else for(i=0;i<a;i++)for(var s=r.cols[i],c=r.cols[i+1],u=s;u<c;u++)o.val[r.rows[u]*a+i]-=r.val[u]
return o}function subspMatrixMatrix(e,r){return subMatrices(fullMatrix(e),r)}function subMatrixspMatrix(e,r){const t=(r.val.length,r.m),a=r.n
var n,i=matrixCopy(e)
if(r.rowmajor){var o=0
for(n=0;n<t;n++){for(var l=r.rows[n],s=r.rows[n+1],c=l;c<s;c++)i.val[o+r.cols[c]]-=r.val[c]
o+=a}}else for(n=0;n<a;n++)for(var l=r.cols[n],s=r.cols[n+1],c=l;c<s;c++)i.val[r.rows[c]*a+n]-=r.val[c]
return i}function subspMatrices(e,r){const t=(e.val.length,r.val.length,e.m),a=e.n
var n,i=fullMatrix(e)
if(r.rowmajor){var o=0
for(n=0;n<t;n++){for(var l=r.rows[n],s=r.rows[n+1],c=l;c<s;c++)i.val[o+r.cols[c]]-=r.val[c]
o+=a}}else for(n=0;n<a;n++)for(var l=r.cols[n],s=r.cols[n+1],c=l;c<s;c++)i.val[r.rows[c]*a+n]-=r.val[c]
return sparseMatrixRowMajor(i)}function applyspVector(e,r){const t=r.val.length,a=r.length
var n,i=new Float64Array(a)
const o=e(0)
for(n=0;n<a;n++)i[n]=o
for(n=0;n<t;n++)i[r.ind[n]]=e(r.val[n])
return i}function applyspMatrix(e,r){const t=(r.val.length,r.m),a=r.n,n=t*a,i=e(0)
var o,l=zeros(t,a)
if(!isZero(i))for(o=0;o<n;o++)l.val[o]=i
if(r.rowmajor){var s=0
for(o=0;o<t;o++){for(var c=r.rows[o],u=r.rows[o+1],f=c;f<u;f++)l.val[s+r.cols[f]]=e(r.val[f])
s+=a}}else for(o=0;o<a;o++)for(var c=r.cols[o],u=r.cols[o+1],f=c;f<u;f++)l.val[r.rows[f]*a+o]+=e(r.val[f])
return l}function sumspVector(e){return sumVector(e.val)}function sumspMatrix(e){return sumVector(e.val)}function sumspMatrixRows(e){var r=zeros(e.n)
if(e.rowmajor)for(var t=0;t<e.val.length;t++)r[e.cols[t]]+=e.val[t]
else for(var a=0;a<e.n;a++)r[a]=sumspVector(e.col(a))
return new Matrix(1,e.n,r,!0)}function sumspMatrixCols(e){var r=zeros(e.m)
if(e.rowmajor)for(var t=0;t<e.m;t++)r[t]=sumspVector(e.row(t))
else for(var a=0;a<e.val.length;a++)r[e.rows[a]]+=e.val[a]
return r}function prodspMatrixRows(e){if(e.rowmajor)for(var r=ones(e.n),t=0;t<e.m;t++){for(var a=e.rows[t],n=e.rows[t+1],i=0;i<e.n;i++)e.cols.subarray(a,n).indexOf(i)<0&&(r[i]=0)
for(var o=a;o<n;o++)r[e.cols[o]]*=e.val[o]}else for(var r=zeros(e.n),t=0;t<e.n;t++){var l=e.col(t)
l.val.length==l.length&&(r[t]=prodVector(l.val))}return new Matrix(1,e.n,r,!0)}function prodspMatrixCols(e){if(e.rowmajor)for(var r=zeros(e.m),t=0;t<e.m;t++){var a=e.row(t)
a.val.length==a.length&&(r[t]=prodVector(a.val))}else for(var r=ones(e.m),n=0;n<e.n;n++){for(var i=e.cols[n],o=e.cols[n+1],t=0;t<e.m;t++)e.rows.subarray(i,o).indexOf(t)<0&&(r[t]=0)
for(var l=i;l<o;l++)r[e.rows[l]]*=e.val[l]}return r}function spsolvecg(e,r){const t=e.n,a=e.m
var n=randn(t),i=subVectors(r,mulspMatrixVector(e,n)),o=dot(i,i)
var l=1e-8*norm(r)
l*=l
var s=vectorCopy(i),c=mulspMatrixVector(e,s),u=o/dot(s,c)
saxpy(u,s,n),saxpy(-u,c,i)
var f=o
o=dot(i,i)
for(var d=1;o>l&&d<t;)!function(e,r){for(var t=0;t<a;t++)s[t]=r[t]+e*s[t]}(o/f,i),c=mulspMatrixVector(e,s),u=o/dot(s,c),saxpy(u,s,n),saxpy(-u,c,i),f=o,o=dot(i,i),d++
return n}function spcgnr(e,r){const t=e.n,a=e.m
var n=randn(t),i=subVectors(r,mulspMatrixVector(e,n))
var o=1e-8*norm(r)
o*=o
var l=mulspMatrixTransVector(e,i),s=dot(l,l),c=vectorCopy(l),u=mulspMatrixVector(e,c),f=s/dot(u,u)
saxpy(f,c,n),saxpy(-f,u,i),l=mulspMatrixTransVector(e,i)
var d=s
s=dot(l,l)
for(var h=1;s>o&&h<t;)!function(e,r){for(var t=0;t<a;t++)c[t]=r[t]+e*c[t]}(s/d,l),u=mulspMatrixVector(e,c),f=s/dot(u,u),saxpy(f,c,n),saxpy(-f,u,i),l=mulspMatrixTransVector(e,i),d=s,s=dot(l,l),h++
return n}function glp(e,r,t,a,n,i,o,l,s){var c=glp_create_prob()
if(glp_set_obj_dir(c,GLP_MIN),void 0===a)var a=[]
glp_add_cols(c,e.length),r.length+a.length>0&&glp_add_rows(c,r.length+a.length)
var u,f,d,h,m=e.length
if(i){var p=vectorCopy(i)
for(u=0;u<p.length;u++)isFinite(p[u])||(p[u]=NaN)}else var p=[]
if(o){var v=vectorCopy(o)
for(u=0;u<v.length;u++)isFinite(v[u])||(p[u]=NaN)}else var v=[]
for(u=0;u<e.length;u++){var b=NaN,g=NaN
p.length>0&&(b=p[u]),v.length>0&&(g=v[u]),isNaN(b)||isNaN(g)?isNaN(b)?isNaN(g)?glp_set_col_bnds(c,u+1,GLP_FR):glp_set_col_bnds(c,u+1,GLP_UP,0,g):glp_set_col_bnds(c,u+1,GLP_LO,b):glp_set_col_bnds(c,u+1,GLP_DB,b,g),glp_set_obj_coef(c,u+1,e[u])}if(l)for(u=0;u<l.length;u++)glp_set_col_kind(c,l[u]+1,GLP_IV)
for(1==r.length&&"number"==typeof t&&(t=[t]),u=0;u<r.length;u++){for(glp_set_row_bnds(c,u+1,GLP_UP,0,t[u]),d=new Array,h=new Array,d.push(0),h.push(0),f=0;f<m;f++)isZero(r.val[u*m+f])||(d.push(f+1),h.push(r.val[u*m+f]))
glp_set_mat_row(c,u+1,d.length-1,d,h)}for(1==a.length&&"number"==typeof n&&(n=[n]),u=0;u<a.length;u++){for(glp_set_row_bnds(c,r.length+u+1,GLP_FX,n[u]),d=new Array,h=new Array,d.push(0),h.push(0),f=0;f<m;f++)isZero(a.val[u*m+f])||(d.push(f+1),h.push(a.val[u*m+f]))
glp_set_mat_row(c,r.length+u+1,d.length-1,d,h)}var x
if(l&&l.length>0){var y=new IOCP({presolve:GLP_ON})
if(glp_scale_prob(c,GLP_SF_AUTO),0==(x=glp_intopt(c,y))){var w=zeros(m)
for(u=0;u<m;u++)w[u]=glp_mip_col_val(c,u+1)
if(s){var M=glp_mip_obj_val(c)
console.log("Status : "+glp_mip_status(c)),console.log("Obj : "+M)}return w}return"Status : "+glp_get_prim_stat(c)}var _=new SMCP({presolve:GLP_ON})
if(glp_scale_prob(c,GLP_SF_AUTO),0==(x=glp_simplex(c,_))){var w=zeros(m)
for(u=0;u<m;u++)w[u]=glp_get_col_prim(c,u+1)
if(s){var M=glp_get_obj_val(c)
console.log("Status : "+glp_get_status(c)+"(OPT="+GLP_OPT+",FEAS="+GLP_FEAS+",INFEAS="+GLP_INFEAS+",NOFEAS="+GLP_NOFEAS+",UNBND="+GLP_UNBND+",UNDEF="+GLP_UNDEF+")"),console.log("Obj : "+M)}return w}return GLPLASTLP="",glp_write_lp(c,void 0,function(e){GLPLASTLP+=e+"<br>"}),"RC="+x+" ; Status : "+glp_get_status(c)+"(OPT="+GLP_OPT+",FEAS="+GLP_FEAS+",INFEAS="+GLP_INFEAS+",NOFEAS="+GLP_NOFEAS+",UNBND="+GLP_UNBND+",UNDEF="+GLP_UNDEF+")"}function minl1(e,r){const t=e.n
var a,n=zeros(2*t,2*t)
for(a=0;a<t;a++)n.val[a*n.n+a]=1,n.val[a*n.n+t+a]=-1,n.val[(t+a)*n.n+a]=-1,n.val[(t+a)*n.n+t+a]=-1
var i=zeros(2*t),o=zeros(e.length,2*t)
set(o,[],range(0,t),e)
var l=zeros(2*t)
set(l,range(t,2*t),ones(t))
var s=zeros(2*t)
return set(s,range(t),mulScalarVector(-1/0,ones(t))),get(glp(l,n,i,o,r,s),range(t))}function minl0(e,r,t){if(void 0===t)var t=10
var a,n=e.n,i=zeros(2*n,2*n)
for(a=0;a<n;a++)i.val[a*i.n+a]=1,i.val[a*i.n+n+a]=-t,i.val[(n+a)*i.n+a]=-1,i.val[(n+a)*i.n+n+a]=-t
var o=zeros(2*n),l=zeros(e.length,2*n)
set(l,[],range(0,n),e)
var s=zeros(2*n)
set(s,range(n,2*n),ones(n))
var c=zeros(2*n)
set(c,range(n),mulScalarVector(-t,ones(n)))
var u=ones(2*n)
set(u,range(n),mulScalarVector(t,ones(n)))
var f=glp(s,i,o,l,r,c,u,range(n,2*n))
return entrywisemulVector(getSubVector(f,range(n)),getSubVector(f,range(n,2*n)))}function qp(e,r,t,a,n,i,o,l,s,c){if(void 0===c)var c=.001
var u,f,d,h,m,p,v
if(void 0===s){if("string"==typeof(v=glp(zeros(r.length),t,a,n,i,o,l,[],!1)))return"infeasible"}else v=vectorCopy(s)
var b=0
do{d=add(mul(e,v),r),f=norm(d),h=glp(d,t,a,n,i,o,l,[],!1),p=sub(h,v),numerator=-mul(p,d),denominator=mul(p,mul(e,p)),m=Math.abs(denominator)>1e-8&&denominator>0?numerator/denominator:0,m>1&&(m=1),m>0?(v=add(v,mul(m,p)),u=m*norm(p)):u=0,b++}while(u>c&&f>c&&b<1e4)
return v}function minimize(e,r,t){var a,n=1
return 3==arguments.length?"number"==typeof t?t>0&&Math.floor(t)==t?(n=t,a=sub(mul(20,rand(n)),10)):(n=1,a=t):(n=t.length,a=t):(n=1,a=20*Math.random()-10),1==n?secant(e,r,a):n>500?steepestdescent(e,r,a):bfgs(e,r,a)}function secant(e,r,t){var a=t,n=r(a),i=-.01*n
a+=i
var o,l
do{o=n,n=r(a),l=n-o,i*=-n/l,a+=i}while(Math.abs(i)>1e-6)
return a}function steepestdescent(e,r,t){var a,n=t,i=e(n),o=r(n),l=norm(o),s=0
do{var c=armijo(e,n,i,o,l)
a=vectorCopy(n),prevobj=i,n=c.x,i=c.obj,o=r(n),l=norm(o),s++}while(l>1e-4&&prevobj-i>1e-8&&norm(subVectors(n,a))>1e-6)
return console.log(" OBJ: "+i+", norm(grad): "+l,"prevobj - obj",prevobj-i,"iter: ",s),n}function bfgs(e,r,t){const a=t.length
var n,i,o,l,s,c,u,f,d=t,h=e(d),m=eye(a),p=0
do{i=r(d),c=norm(i),o=minusVector(mulMatrixVector(m,i))
var v=armijodir(e,d,h,i,o)
n=vectorCopy(d),prevobj=h,d=v.x,h=v.obj,l=subVectors(d,n),s=subVectors(r(d),i),u=mulMatrixVector(m,s)
var b=dot(l,s),g=mulScalarVector(1/b,l),x=outerprodVectors(g,u)
f=subMatrices(outerprodVectors(g,l,1+dot(s,u)/b),addMatrices(x,transposeMatrix(x))),m=add(m,f),p++}while(c>1e-4&&prevobj-h>1e-8&&norm(subVectors(d,n))>1e-6)
return console.log(" OBJ: "+h+", norm(grad): "+c,"prevobj - obj",prevobj-h,"iters: ",p),d}function mincubic(e,r,t,a,n,i,o,l){const s=t*t,c=n*n
var u=new Matrix(2,2,[s,t*s,c,n*c]),f=new Float64Array([a-e-r*t,i-e-r*n]),d=solve(u,f),h=(-d[0]+Math.sqrt(d[0]*d[0]-3*d[1]*r))/(3*d[1])
return Math.min(l,Math.max(o,h))}function minquadratic(e,r,t,a,n,i){var o=-r/(2*a*(t-e-r))
return Math.min(i,Math.max(n,o))}function armijo(e,r,t,a,n){const i=n*n
var o=Math.min(1,100/(1+n)),l=t-1e-4*o*i,s=o,c=subVectors(r,mulScalarVector(o,a)),u=t,f=e(c),d=1
o=minquadratic(t,-i,s,f,.1*s,.5*s)
var u=f,h=s
for(s=o,d++;f>l&&d<=10;)o=mincubic(t,-i,s,f,h,u,.1*s,.5*s),h=s,s=o,c=subVectors(r,mulScalarVector(o,a)),u=f,f=e(c),l=t-1e-4*o*i,d++
return{lambda:o,x:c,obj:f}}function armijodir(e,r,t,a,n){const i=dot(a,n)
var o=Math.min(1,100/(1+norm(a))),l=t+1e-4*o*i,s=o,c=addVectors(r,mulScalarVector(o,n)),u=t,f=e(c),d=1
o=minquadratic(t,i,s,f,.1*s,.5*s)
var u=f,h=s
for(s=o,d++;f>l&&d<=10;)o=mincubic(t,i,s,f,h,u,.1*s,.5*s),h=s,s=o,c=addVectors(r,mulScalarVector(o,n)),u=f,f=e(c),l=t+1e-4*o*i,d++
return{lambda:o,x:c,obj:f}}function nchoosek(e,r){if(r>e||r<0||e<0)return 0
var t,a=1
for(t=e-r+1;t<=e;t++)a*=t
for(t=2;t<=r;t++)a/=t
return a}function mvnrnd(e,r,t){if(arguments.length<3)var t=1
var a=randn(t,e.length)
if(issymmetric(r))var n=chol(r)
else var n=r
return add(mul(ones(t),transpose(e)),mul(a,transpose(n)))}function Distribution(distrib,arg1,arg2){if(arguments.length<1)return void error("Error in new Distribution(name): name is undefined.")
"string"==typeof distrib&&(distrib=eval(distrib)),this.type="Distribution:"+distrib.name,this.distribution=distrib.name,this.construct=distrib.prototype.construct,this.estimate=distrib.prototype.estimate,this.sample=distrib.prototype.sample,this.pdf=distrib.prototype.pdf,distrib.prototype.pmf&&(this.pmf=distrib.prototype.pmf),distrib.prototype.logpdf?this.logpdf=distrib.prototype.logpdf:this.logpdf=function(e){return log(this.pdf(e))},this.construct(arg1,arg2)}function Uniform(e){return new Distribution(Uniform,e)}function Gaussian(e){return new Distribution(Gaussian,e)}function mvGaussian(e){return new Distribution(mvGaussian,e)}function Bernoulli(e){return new Distribution(Bernoulli,e)}function Poisson(e){return new Distribution(Poisson,e)}function Complex(e,r,t){this.type="Complex",void 0===e?(this.re=0,this.im=0):e instanceof Complex?(this.re=e.re,this.im=e.im):"number"!=typeof e||t?(this.re=e*Math.cos(r),this.im=e*Math.sin(r)):(this.re=e,this.im=r)}function addComplex(e,r){var t=new Complex(e)
return t.re+=r.re,t.im+=r.im,t}function addComplexReal(e,r){var t=new Complex(e)
return t.re+=r,t}function subComplex(e,r){var t=new Complex(e)
return t.re-=r.re,t.im-=r.im,t}function minusComplex(e){return new Complex(-e.re,-e.im)}function mulComplex(e,r){return new Complex(e.re*r.re-e.im*r.im,e.im*r.re+e.re*r.im)}function mulComplexReal(e,r){return new Complex(e.re*r,e.im*r)}function divComplex(e,r){var t=r.re*r.re+r.im*r.im
return new Complex((e.re*r.re+e.im*r.im)/t,(e.im*r.re-e.re*r.im)/t)}function conj(e){if(e instanceof Complex)return new Complex(e.re,-e.im)
if(e instanceof ComplexVector){for(var r=new ComplexVector(e),t=0;t<e.length;t++)r.im[t]=-r.im[t]
return r}if(e instanceof ComplexMatrix){for(var r=new ComplexMatrix(e),t=0;t<e.length;t++)r.im[t]=-r.im[t]
return r}return new Complex(e)}function modulus(e){return e instanceof Complex?Math.sqrt(e.re*e.re+e.im*e.im):e instanceof ComplexVector?sqrt(addVectors(entrywisemulVector(e.re,e.re),entrywisemulVector(e.im,e.im))):e instanceof ComplexVector?new Matrix(e.m,e.n,sqrt(addVectors(entrywisemulVector(e.re,e.re),entrywisemulVector(e.im,e.im)),!0)):void 0}function expComplex(e){return new Complex(Math.exp(e.re),e.im,!0)}function ComplexVector(e,r,t){this.type="ComplexVector",0==arguments.length||(e instanceof ComplexVector?(this.length=e.length,this.re=vectorCopy(e.re),this.im=vectorCopy(e.im)):"number"==typeof e?(this.length=e,this.re=new Float64Array(e),this.im=new Float64Array(e)):e instanceof Float64Array&&r instanceof Float64Array?(this.length=e.length,void 0!==t&&t?(this.re=e,this.im=r):(this.re=vectorCopy(e),this.im=vectorCopy(r))):error("Bad arguments to new ComplexVector()"))}function ComplexMatrix(e,r,t,a){this.type="ComplexMatrix",0==arguments.length||(e instanceof ComplexMatrix?(this.length=e.length,this.m=e.m,this.n=e.n,this.size=[e.m,e.n],this.re=vectorCopy(e.re),this.im=vectorCopy(e.im)):"number"==typeof e&&"number"==typeof r?(this.length=e,this.m=e,this.n=r,this.size=[e,r],void 0===t?(this.re=new Float64Array(e*r),this.im=new Float64Array(e*r)):t instanceof ComplexVector?(this.re=vectorCopy(t.re),this.im=vectorCopy(t.im)):t instanceof Float64Array&&void 0!==a&&a instanceof Float64Array&&(this.re=t,this.im=a)):e instanceof Matrix&&r instanceof Matrix?(this.length=e.length,this.m=e.m,this.n=e.n,this.size=[e.m,e.n],this.re=vectorCopy(e.val),this.im=vectorCopy(r.val)):error("Bad arguments to new ComplexMatrix()"))}function real(e){return e instanceof Complex?e.re:e instanceof ComplexVector?vectorCopy(e.re):e instanceof ComplexMatrix?new Matrix(e.m,e.n,e.re):copy(e)}function imag(e){return e instanceof Complex?e.im:e instanceof ComplexVector?vectorCopy(e.im):e instanceof ComplexMatrix?new Matrix(e.m,e.n,e.im):0}function transposeComplexMatrix(e){const r=e.m,t=e.n
if(r>1){var a,n,i=new ComplexMatrix(t,r),o=0
for(n=0;n<r;n++){var l=0
for(a=0;a<t;a++)i.re[l+n]=e.re[o+a],i.im[l+n]=-e.im[o+a],l+=r
o+=t}return i}return new ComplexVector(e.re,minusVector(e.im))}function addComplexVectors(e,r){var t=new ComplexVector(e)
const a=e.length
for(var n=0;n<a;n++)t.re[n]+=r.re[n],t.im[n]+=r.im[n]
return t}function subComplexVectors(e,r){var t=new ComplexVector(e)
const a=e.length
for(var n=0;n<a;n++)t.re[n]-=r.re[n],t.im[n]-=r.im[n]
return t}function addComplexMatrices(e,r){var t=new ComplexMatrix(e)
const a=e.m*e.n
for(var n=0;n<a;n++)t.re[n]+=r.re[n],t.im[n]+=r.im[n]
return t}function subComplexMatrices(e,r){var t=new ComplexMatrix(e)
const a=e.m*e.n
for(var n=0;n<a;n++)t.re[n]-=r.re[n],t.im[n]-=r.im[n]
return t}function addComplexVectorVector(e,r){var t=new ComplexVector(e)
const a=e.length
for(var n=0;n<a;n++)t.re[n]+=r[n]
return t}function subComplexVectorVector(e,r){var t=new ComplexVector(e)
const a=e.length
for(var n=0;n<a;n++)t.re[n]-=r[n]
return t}function addComplexMatrixMatrix(e,r){var t=new ComplexMatrix(e)
const a=e.m*e.n
for(var n=0;n<a;n++)t.re[n]+=r.val[n]
return t}function subComplexMatrixMatrix(e,r){var t=new ComplexMatrix(e)
const a=e.m*e.n
for(var n=0;n<a;n++)t.re[n]-=r.val[n]
return t}function addScalarComplexVector(e,r){var t=new ComplexVector(r)
const a=r.length
for(var n=0;n<a;n++)t.re[n]+=e
return t}function subScalarComplexVector(e,r){var t=minusComplexVector(r)
const a=r.length
for(var n=0;n<a;n++)t.re[n]+=e
return t}function addScalarComplexMatrix(e,r){var t=new ComplexMatrix(r)
const a=r.m*r.n
for(var n=0;n<a;n++)t.re[n]+=e
return t}function entrywisemulComplexVectors(e,r){const t=e.length
for(var a=new ComplexVector(t),n=0;n<t;n++)a.re[n]=e.re[n]*r.re[n]-e.im[n]*r.im[n],a.im[n]=e.im[n]*r.re[n]+e.re[n]*r.im[n]
return a}function entrywisedivComplexVectors(e,r){const t=e.length
for(var a=new ComplexVector(t),n=0;n<t;n++){var i=r.re[n],o=r.im[n],l=i*i+o*o
a.re[n]=(e.re[n]*i+e.im[n]*o)/l,a.im[n]=(e.im[n]*i-e.re[n]*o)/l}return a}function entrywisemulComplexMatrices(e,r){const t=e.m*e.n
for(var a=new ComplexMatrix(e.m,e.n),n=0;n<t;n++)a.re[n]=e.re[n]*r.re[n]-e.im[n]*r.im[n],a.im[n]=e.im[n]*r.re[n]+e.re[n]*r.im[n]
return a}function entrywisedivComplexMatrices(e,r){const t=e.m*e.n
for(var a=new ComplexMatrix(e.m,e.n),n=0;n<t;n++){var i=r.re[n],o=r.im[n],l=i*i+o*o
a.re[n]=(e.re[n]*i+e.im[n]*o)/l,a.im[n]=(e.im[n]*i-e.re[n]*o)/l}return a}function entrywisemulComplexVectorVector(e,r){const t=e.length
for(var a=new ComplexVector(t),n=0;n<t;n++)a.re[n]=e.re[n]*r[n],a.im[n]=e.im[n]*r[n]
return a}function entrywisemulComplexMatrixMatrix(e,r){const t=e.m*e.n
for(var a=new ComplexMatrix(e.m,e.n),n=0;n<t;n++)a.re[n]=e.re[n]*r.val[n],a.im[n]=e.im[n]*r.val[n]
return a}function minusComplexVector(e){const r=e.length
for(var t=new ComplexVector(r),a=0;a<r;a++)t.re[a]=-e.re[a],t.im[a]=-e.im[a]
return t}function minusComplexMatrix(e){var r=new ComplexMatrix(e.m,e.n)
const t=e.m*e.n
for(var a=0;a<t;a++)r.re[a]=-e.re[a],r.im[a]=-e.im[a]
return r}function sumComplexVector(e){var r=new Complex
const t=e.length
for(var a=0;a<t;a++)r.re+=e.re[a],r.im+=e.im[a]
return r}function sumComplexMatrix(e){var r=new Complex
const t=e.m*e.n
for(var a=0;a<t;a++)r.re+=e.re[a],r.im+=e.im[a]
return r}function norm1ComplexVector(e){var r=0
const t=e.length
for(var a=0;a<t;a++)r+=Math.sqrt(e.re[a]*e.re[a]+e.im[a]*e.im[a])
return r}function norm2ComplexVector(e){var r=0
const t=e.length
for(var a=0;a<t;a++)r+=e.re[a]*e.re[a]+e.im[a]*e.im[a]
return Math.sqrt(r)}function normFroComplexMatrix(e){var r=0
const t=e.m*e.n
for(var a=0;a<t;a++)r+=e.re[a]*e.re[a]+e.im[a]*e.im[a]
return Math.sqrt(r)}function dotComplexVectors(e,r){var t=new Complex
const a=e.length
for(var n=0;n<a;n++)t.re+=e.re[n]*r.re[n]+e.im[n]*r.im[n],t.im+=e.im[n]*r.re[n]-e.re[n]*r.im[n]
return t}function dotComplexVectorVector(e,r){var t=new Complex
const a=e.length
for(var n=0;n<a;n++)t.re+=e.re[n]*r[n],t.im+=e.im[n]*r[n]
return t}function mulScalarComplexVector(e,r){return new ComplexVector(mulScalarVector(e,r.re),mulScalarVector(e,r.im),!0)}function mulComplexComplexVector(e,r){const t=r.length
for(var a=new ComplexVector(t),n=e.re,i=e.im,o=0;o<t;o++)a.re[o]=n*r.re[o]-i*r.im[o],a.im[o]=i*r.re[o]+n*r.im[o]
return a}function mulComplexVector(e,r){const t=r.length
for(var a=new ComplexVector(t),n=e.re,i=e.im,o=0;o<t;o++)a.re[o]=n*r[o],a.im[o]=i*r[o]
return a}function mulScalarComplexMatrix(e,r){var t=mulScalarVector(e,r.re),a=mulScalarVector(e,r.im)
return new ComplexMatrix(r.m,r.n,t,a)}function mulComplexComplexMatrix(e,r){const t=r.m*r.n
for(var a=new ComplexMatrix(r.m,r.n),n=e.re,i=e.im,o=0;o<t;o++)a.re[o]=n*r.re[o]-i*r.im[o],a.im[o]=i*r.re[o]+n*r.im[o]
return a}function mulComplexMatrix(e,r){const t=r.m*r.n
for(var a=new ComplexMatrix(r.m,r.n),n=e.re,i=e.im,o=0;o<t;o++)a.re[o]=n*r.val[o],a.im[o]=i*r.val[o]
return a}function mulComplexMatrixVector(e,r){const t=e.m,a=e.n
for(var n=new ComplexVector(t),i=0,o=0;o<t;o++){for(j=0;j<a;j++)n.re[o]+=e.re[i+j]*r[j],n.im[o]+=e.im[i+j]*r[j]
i+=a}return n}function mulComplexMatrixComplexVector(e,r){const t=e.m,a=e.n
for(var n=new ComplexVector(t),i=0,o=0;o<t;o++){for(j=0;j<a;j++)n.re[o]+=e.re[i+j]*r.re[j]-e.im[i+j]*r.im[j],n.im[o]+=e.im[i+j]*r.re[j]+e.re[i+j]*r.im[j]
i+=a}return n}function mulComplexMatrices(e,r){const t=e.length,a=r.n,n=r.length
for(var i=e.re,o=e.im,l=r.re,s=r.im,c=new Float64Array(t*a),u=new Float64Array(t*a),f=0,d=0,h=0;h<t;h++){for(var m=0,p=0;p<n;p++){aikre=i[f],aikim=o[f]
for(var v=0;v<a;v++)c[d+v]+=aikre*l[m]-aikim*s[m],u[d+v]+=aikre*s[m]+aikim*l[m],m++
f++}d+=a}return new ComplexMatrix(t,a,c,u)}function mulComplexMatrixMatrix(e,r){const t=e.m,a=r.n,n=r.m
for(var i=e.re,o=e.im,l=r.val,s=new Float64Array(t*a),c=new Float64Array(t*a),u=0,f=0,d=0;d<t;d++){for(var h=0,m=0;m<n;m++){aikre=i[u],aikim=o[u]
for(var p=0;p<a;p++)s[f+p]+=aikre*l[h],c[f+p]+=aikim*l[h],h++
u++}f+=a}return new ComplexMatrix(t,a,s,c)}function fft(e){const r=e.length,t=Math.log2(r),a=r/2
if(t%1!=0)return void error("fft(x) only implemented for x.length = 2^m. Use dft(x) instead.")
for(var n=new ComplexVector(e,zeros(r)),i=0,o=0;o<r-1;o++){if(o<i){var l=n.re[o]
n.re[o]=n.re[i],n.re[i]=l,l=n.im[o],n.im[o]=n.im[i],n.im[i]=l}for(var s=a;s<=i;)i-=s,s/=2
i+=s}for(var c=1,u=new Complex(-1,0),f=new Complex,d=0;d<t;d++){var h=c
c*=2,f.re=1,f.im=0
for(var i=0;i<h;i++){for(var o=i;o<r;o+=c){var m=o+h,p=f.re*n.re[m]-f.im*n.im[m],v=f.im*n.re[m]+f.re*n.im[m]
n.re[m]=n.re[o]-p,n.im[m]=n.im[o]-v,n.re[o]+=p,n.im[o]+=v}f=mulComplex(f,u)}u.im=-Math.sqrt((1-u.re)/2),u.re=Math.sqrt((1+u.re)/2)}return n}function ifft(e){const r=e.length,t=Math.log2(r),a=r/2
if(t%1!=0)return void error("ifft(x) only implemented for x.length = 2^m. Use idft(x) instead.")
for(var n=new ComplexVector(e,zeros(r)),i=0,o=0;o<r-1;o++){if(o<i){var l=n.re[o]
n.re[o]=n.re[i],n.re[i]=l,l=n.im[o],n.im[o]=n.im[i],n.im[i]=l}for(var s=a;s<=i;)i-=s,s/=2
i+=s}for(var c=1,u=new Complex(-1,0),f=new Complex,d=0;d<t;d++){var h=c
c*=2,f.re=1,f.im=0
for(var i=0;i<h;i++){for(var o=i;o<r;o+=c){var m=o+h,p=f.re*n.re[m]-f.im*n.im[m],v=f.im*n.re[m]+f.re*n.im[m]
n.re[m]=n.re[o]-p,n.im[m]=n.im[o]-v,n.re[o]+=p,n.im[o]+=v}f=mulComplex(f,u)}u.im=Math.sqrt((1-u.re)/2),u.re=Math.sqrt((1+u.re)/2)}for(var b=!1,o=0;o<r;o++)n.re[o]/=r,n.im[o]/=r,Math.abs(n.im[o])>1e-6&&(b=!0)
return b?n:n.re}function dft(e){if("number"==typeof e)return new Complex(e,0)
const r=e.length
if(1==r)return new Complex(e[0],0)
if(Math.log2(r)%1==0)return fft(e)
for(var t=new ComplexVector(r),a=0,n=0;n<r;n++){for(var i=0,o=0;o<r;o++)t.re[n]+=e[o]*Math.cos(i),t.im[n]+=e[o]*Math.sin(i),i+=a
a-=2*Math.PI/r}return t}function idft(e){if(!(e instanceof ComplexVector))return e instanceof Complex?e.re:"number"==typeof e?e:e instanceof Float64Array?idft(new ComplexVector(e,zeros(e.length),!0)):void 0
const r=e.length
if(1==r)return e.re[0]
if(Math.log2(r)%1==0)return ifft(e)
for(var t=new Float64Array(r),a=0,n=0;n<r;n++){for(var i=0,o=0,l=0;l<r;l++)o+=e.re[l]*Math.cos(i)-e.im[l]*Math.sin(i),i+=a
t[n]=o/r,a+=2*Math.PI/r}return t}function spectrum(e){return e instanceof Float64Array?absComplex(dft(e)):void 0}function Diagram(e){void 0===e&&(e="diagram"),this.canvasId=e,this.shapes=new Array,this.selectedShape=-1,this.selectedShapes=new Array,this.mousexprev=-1,this.mouseyprev=-1
var r=document.getElementById(this.canvasId).getContext("2d")
r.setLineDash||(r.setLineDash=function(){})}function Plot(e){void 0===e&&(e="plotcanvas"),this.canvasId=e,this.minX=0,this.maxX=10,this.Nsamples=1e3,this.scaleX=1,this.scaleY=1,this.minY=0,this.maxY=1.5,this.fcts=new Array,this.lines=new Array,this.areas=new Array,this.points=new Array,this.paths=new Array,this.legend="topright"
var r=document.getElementById(this.canvasId)
this.buffer=document.createElement("canvas"),this.buffer.width=r.width,this.buffer.height=r.height,this.viewX=0,this.viewY=0
var t=this.buffer.getContext("2d")
t.setLineDash||(t.setLineDash=function(){})}function ColorPlot(e){void 0===e&&(e="plotcanvas"),this.canvasId=e,this.minX=0,this.maxX=10,this.scaleX=1,this.scaleY=1,this.minY=0,this.maxY=1.5,this.minZ=0,this.maxZ=1,this.x=new Array,this.y=new Array,this.z=new Array,this.cmap=this.colormap()
var r=document.getElementById(this.canvasId)
this.buffer=document.createElement("canvas"),this.buffer.width=r.width,this.buffer.height=r.height,this.viewX=0,this.viewY=0}function Plot2D(e,r){this.canvasId=void 0===e?"plotcanvas2D":e,this.tableId=void 0===r?"":r,this.minX1=-10,this.maxX1=10,this.minX2=-10,this.maxX2=10,this.scaleX1,this.scaleX2,this.NsamplesX1=500,this.NsamplesX2=500,this.Xapp=new Array,this.Yapp=new Array,this.m=0
var t=document.getElementById(this.canvasId).getContext("2d")
t.setLineDash||(t.setLineDash=function(){})}function Plot3D(e){this.canvasId=void 0===e?"plotcanvas3D":e
var r=document.getElementById(this.canvasId)
this.minX1=-10,this.maxX1=10,this.minX2=-10,this.maxX2=10,this.minX3=-10,this.maxX3=10,this.scaleX1,this.scaleX2,this.scaleX3,this.NsamplesX1=50,this.NsamplesX2=50,this.NsamplesX3=50,this.axisNameX1="x1",this.axisNameX2="x2",this.axisNameX3="x3",this.X=new Array,this.Y=new Array,this.lines=new Array,this.planes=new Array,this.spheres=new Array,this.view2D=new Array,this.viewminX1=-10,this.viewmaxX1=10,this.viewminX2=-10,this.viewmaxX2=10,this.viewscaleX1=r.width/(this.viewmaxX1-this.viewminX1),this.viewscaleX2=r.width/(this.viewmaxX2-this.viewminX2),this.angleX=0,this.angleY=0,this.angleZ=0,this.cameraDistance=20,this.ROTATING=!1,this.mouseX=0,this.mouseY=0,this.animation=null,this.animateAuto=0
var t=document.getElementById(this.canvasId).getContext("2d")
t.setLineDash||(t.setLineDash=function(){}),window.addEventListener&&r.addEventListener("DOMMouseScroll",this.mousezoom,!1),r.onmousewheel=this.mousezoom}function setcolor(e,r){if(r>10)return void setcolortransparent(e,r-10,.5)
switch(r){case-1:e.fillStyle="white",e.strokeStyle="white"
break
case 0:e.fillStyle="rgb(0,0,0)",e.strokeStyle="rgb(0,0,0)"
break
case 1:e.fillStyle="rgb(0,0,200)",e.strokeStyle="rgb(0,0,200)"
break
case 2:e.fillStyle="rgb(200,0,0)",e.strokeStyle="rgb(200,0,0)"
break
case 3:e.fillStyle="rgb(0,200,0)",e.strokeStyle="rgb(0,200,0)"
break
case 4:e.fillStyle="rgb(200,0,200)",e.strokeStyle="rgb(200,0,200)"
break
case 5:e.fillStyle="rgb(255,255,0)",e.strokeStyle="rgb(255,255,0)"
break
case 6:e.fillStyle="rgb(0,255,255)",e.strokeStyle="rgb(0,255,255)"
break
case 7:e.fillStyle="rgb(102,51,0)",e.strokeStyle="rgb(102,51,0)"
break
case 8:e.fillStyle="rgb(204,51,0)",e.strokeStyle="rgb(204,51,0)"
break
case 9:e.fillStyle="rgb(255,102,204)",e.strokeStyle="rgb(255,102,204)"
break
case 10:e.fillStyle="rgb(120,120,120)",e.strokeStyle="rgb(120,120,120)"
break
default:e.fillStyle="rgb(0,0,200)",e.strokeStyle="rgb(0,0,200)"}}function setcolortransparent(e,r,t){switch(r){case 0:e.fillStyle="rgba(0,0,0,"+t+" )",e.strokeStyle="rgba(0,0,0,"+t+" )"
break
case 1:e.fillStyle="rgba(0,0,200,"+t+" )",e.strokeStyle="rgba(0,0,200,"+t+" )"
break
case 2:e.fillStyle="rgba(200,0,0,"+t+" )",e.strokeStyle="rgba(200,0,0,"+t+" )"
break
case 3:e.fillStyle="rgba(0,200,0,"+t+" )",e.strokeStyle="rgba(0,200,0,"+t+" )"
break
case 4:e.fillStyle="rgba(200,0,200,"+t+" )",e.strokeStyle="rgba(200,0,200,"+t+" )"
break
case 5:e.fillStyle="rgba(255,255,0,"+t+" )",e.strokeStyle="rgba(255,255,0,"+t+" )"
break
case 6:e.fillStyle="rgba(0,255,255,"+t+" )",e.strokeStyle="rgba(0,255,255,"+t+" )"
break
case 7:e.fillStyle="rgba(102,51,0,"+t+" )",e.strokeStyle="rgba(102,51,0,"+t+" )"
break
case 8:e.fillStyle="rgba(204,51,0,"+t+" )",e.strokeStyle="rgba(204,51,0,"+t+" )"
break
case 9:e.fillStyle="rgab(255,102,204,"+t+" )",e.strokeStyle="rgba(255,102,204,"+t+" )"
break
case 10:e.fillStyle="rgba(120,120,120,"+t+" )",e.strokeStyle="rgba(120,120,120,"+t+" )"
break
default:e.fillStyle="rgba(0,0,200,"+t+" )",e.strokeStyle="rgba(0,0,200,"+t+" )"}}function setcolorgradient(e,r,t){if(void 0===t)var t=400*Math.sqrt(2)
var a=e.createRadialGradient(0,0,t,0,2*Math.PI,!0)
switch(a.addColorStop(1,"white"),r){case 0:a.addColorStop(0,"rgb(0,0,0 )")
break
case 1:a.addColorStop(0,"rgb(0,0,200 )")
break
case 2:a.addColorStop(0,"rgb(200,0,0 )")
break
case 3:a.addColorStop(0,"rgb(0,200,0 )")
break
case 4:a.addColorStop(0,"rgb(200,0,200 )")
break
case 5:a.addColorStop(0,"rgb(255,255,0 )")
break
default:a.addColorStop(0,"rgb(0,0,200 )")}e.fillStyle=a}function setcolortransparentgradient(e,r,t,a){if(void 0===a)var a=400*Math.sqrt(2)
var n=e.createRadialGradient(0,0,a,0,2*Math.PI,!0)
switch(n.addColorStop(1,"white"),r){case 0:n.addColorStop(.3,"rgba(0,0,0,"+t+" )"),n.addColorStop(0,"rgb(0,0,0 )")
break
case 1:n.addColorStop(.3,"rgba(0,0,200,"+t+" )"),n.addColorStop(0,"rgb(0,0,200 )")
break
case 2:n.addColorStop(.3,"rgba(200,0,0,"+t+" )"),n.addColorStop(0,"rgb(200,0,0 )")
break
case 3:n.addColorStop(.3,"rgba(0,200,0,"+t+" )"),n.addColorStop(0,"rgb(0,200,0 )")
break
case 4:n.addColorStop(.3,"rgba(200,0,200,"+t+" )"),n.addColorStop(0,"rgb(200,0,200 )")
break
case 5:n.addColorStop(.3,"rgba(255,255,0,"+t+" )"),n.addColorStop(0,"rgb(255,255,0 )")
break
default:n.addColorStop(.3,"rgba(0,0,200,"+t+" )"),n.addColorStop(0,"rgb(0,0,200 )")}e.fillStyle=n}var printPrecision=3,LALOLibPlotsIndex=0,LALOLibPlots=new Array,LALOLABPLOTMOVING=!1
if(void 0===console)var console={log:function(){}}
void 0===Math.sign&&(Math.sign=function(e){return e>=0?0==e?0:1:-1}),Lalolab.prototype.close=function(){this.worker.terminate(),this.worker.parent=null},Lalolab.prototype.onprogress=function(e){},Lalolab.prototype.onresult=function(e){if(void 0!==e.data.progress)this.parent.onprogress(e.data.progress)
else{var r=this.parent.callbacks.splice(0,1)[0]
if("function"==typeof r){var t=e.data.cmd
r(e.data.output,t,this.parent.id)}}},Lalolab.prototype.do=function(e,r){this.callbacks.push(r),this.worker.postMessage({cmd:e,parse:!0})},Lalolab.prototype.exec=function(e,r){this.callbacks.push(r),this.worker.postMessage({cmd:e,parse:!1})},Lalolab.prototype.parse=function(e,r){this.callbacks.push(r),this.worker.postMessage({cmd:e,parse:!1})},Lalolab.prototype.load=function(e,r,t){this.callbacks.push(t),"string"==typeof e?this.worker.postMessage({cmd:r+'= load_data ("'+e+'")',parse:!1}):this.worker.postMessage({cmd:"load_mat",data:e,varname:r,parse:!1})},Lalolab.prototype.import=function(e,r){this.do('importLaloScript("'+e+'")',r)},Lalolab.prototype.importjs=function(e,r){this.exec("importScripts('"+e+"');",r)},Lalolab.prototype.getObject=function(e,r){this.exec("getObjectWithoutFunc("+e+")",function(e){r(renewObject(e))})}
var LALOLIB_ERROR=""
const EPS=2.2205e-16
Matrix.prototype.get=function(e,r){return this.val[e*this.n+r]},Matrix.prototype.set=function(e,r,t){this.val[e*this.n+r]=t},Matrix.prototype.row=function(e){return this.val.subarray(e*this.n,(e+1)*this.n)},Matrix.prototype.toArray=function(){for(var e=new Array(this.m),r=0,t=0;t<this.m;t++){e[t]=new Array(this.n)
for(var a=0;a<this.n;a++)e[t][a]=this.val[r+a]
r+=this.n}return e},Matrix.prototype.toArrayOfFloat64Array=function(){for(var e=new Array(this.m),r=0;r<this.m;r++)e[r]=this.val.subarray(r*this.n,(r+1)*this.n)
return e}
var MathFunctions=Object.getOwnPropertyNames(Math)
for(var mf in MathFunctions)"function"==eval("typeof(Math."+MathFunctions[mf]+")")?1==eval("Math."+MathFunctions[mf]+".length")&&(eval(MathFunctions[mf]+" = function (x) { return apply(Math."+MathFunctions[mf]+" , x );};"),eval(MathFunctions[mf]+"Vector = function (x) { return applyVector(Math."+MathFunctions[mf]+" , x );};"),eval(MathFunctions[mf]+"Matrix = function (x) { return applyMatrix(Math."+MathFunctions[mf]+" , x );};")):"number"==eval("typeof(Math."+MathFunctions[mf]+")")&&eval(MathFunctions[mf]+" = Math."+MathFunctions[mf])
argmax=findmax,argmin=findmin,spVector.prototype.get=function(e){var r=this.ind.indexOf(e)
return r<0?0:this.val[r]},spVector.prototype.set=function(e,r){if(e>this.n)return void error("Error in spVector.set(i,value): i > this.length)")
var t=this.ind.indexOf(e)
if(t<0){var a=new Uint32Array(this.nnz+1),n=new Float64Array(this.nnz+1)
for(t=0;this.ind[t]<e;)a[t]=this.ind[t],n[t]=this.val.ind[t],t++
a[t]=e,n[t]=r,a.set(this.ind.subarray(t),t+1),n.set(this.val.subarray(t),t+1),this.nnz++}else this.val[t]=r
return r},spVector.prototype.copy=function(){return new spVector(this.n,this.val,this.ind)},spMatrix.prototype.copy=function(){return new spMatrix(this.m,this.n,this.val,this.cols,this.rows)},spMatrix.prototype.toRowmajor=function(){return this.rowmajor?this.copy():sparseMatrixRowMajor(fullMatrix(this))},spMatrix.prototype.row=function(e){return this.rowmajor?new spVector(this.n,this.val.subarray(this.rows[e],this.rows[e+1]),this.cols.subarray(this.rows[e],this.rows[e+1])):void error("Cannot extract sparse column from a sparse matrix in row major format.")},spMatrix.prototype.col=function(e){return this.rowmajor?void error("Cannot extract sparse column from a sparse matrix in row major format."):new spVector(this.m,this.val.subarray(this.cols[e],this.cols[e+1]),this.rows.subarray(this.cols[e],this.cols[e+1]))},spMatrix.prototype.get=function(e,r){if(this.rowmajor){var t=this.cols.subarray(this.rows[e],this.rows[e+1]),a=t.indexOf(r)
return a<0?0:this.val[this.rows[e]+a]}var n=this.rows.subarray(this.cols[r],this.cols[r+1]),a=n.indexOf(e)
return a<0?0:this.val[this.cols[r]+a]},"undefined"==typeof lp&&(lp=glp,linprog=glp),quadprog=qp,function(e){function r(e){throw Error(e)}function t(){}function a(e,r){for(var t in r)e[t]=r[t]}function n(e,r,t,a,n){for(;0<n;r++,a++,n--)e[r]=t[a]}function i(e,r,t,a){for(;0<a;r++,a--)e[r]=t}function o(e,r,t){for(;0<t;r++,t--)e[r]={}}function l(){return(new Date).getTime()}function s(e){return(l()-e)/1e3}function c(e,r,t){var a=Array(r)
n(a,0,e,1,r),a.sort(t),n(e,1,a,0,r)}function u(e){return 0<=(e="string"==typeof e?e.charCodeAt(0):-1)&&31>=e||127==e}function f(e){return 65<=(e="string"==typeof e?e.charCodeAt(0):-1)&&90>=e||97<=e&&122>=e}function d(e){return 65<=(e="string"==typeof e?e.charCodeAt(0):-1)&&90>=e||97<=e&&122>=e||48<=e&&57>=e}function h(e){return 48<=(e="string"==typeof e?e.charCodeAt(0):-1)&&57>=e}function m(){function e(e,a,n,i,o,l,s){return e>>>=0,n=n&&e&&{2:"0b",8:"0",16:"0x"}[a]||"",e=n+t(e.toString(a),l||0,"0",!1),r(e,n,i,o,s)}function r(e,r,a,n,i,o){var l=n-e.length
return 0<l&&(e=a||!i?t(e,n,o,a):e.slice(0,r.length)+t("",l,"0",!0)+e.slice(r.length)),e}function t(e,r,t,a){return t||(t=" "),r=e.length>=r?"":Array(1+r-e.length>>>0).join(t),a?e+r:r+e}var a=arguments,n=0
return a[n++].replace(/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuideEfFgG])/g,function(i,o,l,s,c,u,f){var d,h
if("%%"==i)return"%"
var m=!1
h=""
var p=c=!1
d=" "
for(var v=l.length,b=0;l&&b<v;b++)switch(l.charAt(b)){case" ":h=" "
break
case"+":h="+"
break
case"-":m=!0
break
case"'":d=l.charAt(b+1)
break
case"0":c=!0
break
case"#":p=!0}if(s=s?"*"==s?+a[n++]:"*"==s.charAt(0)?+a[s.slice(1,-1)]:+s:0,0>s&&(s=-s,m=!0),!isFinite(s))throw Error("sprintf: (minimum-)width must be finite")
switch(u=u?"*"==u?+a[n++]:"*"==u.charAt(0)?+a[u.slice(1,-1)]:+u:-1<"fFeE".indexOf(f)?6:"d"==f?0:void 0,o=o?a[o.slice(0,-1)]:a[n++],f){case"s":return f=String(o),null!=u&&(f=f.slice(0,u)),r(f,"",m,s,c,d)
case"c":return f=String.fromCharCode(+o),null!=u&&(f=f.slice(0,u)),r(f,"",m,s,c,void 0)
case"b":return e(o,2,p,m,s,u,c)
case"o":return e(o,8,p,m,s,u,c)
case"x":return e(o,16,p,m,s,u,c)
case"X":return e(o,16,p,m,s,u,c).toUpperCase()
case"u":return e(o,10,p,m,s,u,c)
case"i":case"d":return d=+o||0,d=Math.round(d-d%1),i=0>d?"-":h,o=i+t(String(Math.abs(d)),u,"0",!1),r(o,i,m,s,c)
case"e":case"E":case"f":case"F":case"g":case"G":return d=+o,i=0>d?"-":h,h=["toExponential","toFixed","toPrecision"]["efg".indexOf(f.toLowerCase())],f=["toString","toUpperCase"]["eEfFgG".indexOf(f)%2],o=i+Math.abs(d)[h](u),r(o,i,m,s,c)[f]()
default:return i}})}function p(e){e.Dd=3621377730,e.ke=null,e.V=null,e.name=null,e.eb=null,e.dir=sl,e.ha=0,e.hb=100,e.K=200,e.g=e.i=0,e.L=0,e.n=Array(1+e.hb),e.f=Array(1+e.K),e.fc={},e.Lc={},e.valid=0,e.head=new Int32Array(1+e.hb),e.Qd=null,e.U=null,e.na=e.sa=Sl,e.aa=0,e.$=0,e.some=0,e.df=Sl,e.ae=0,e.za=Sl,e.ta=0}function v(e){var r={}
Po(e,r),e=e.U,e.type=r.type,e.Cd=r.Cd,e.cc=r.cc,e.xc=r.xc,e.gc=r.gc,e.Mb=r.Mb,e.sc=r.sc,e.$c=r.$c,e.ic=r.ic,e.vc=r.vc,e.kd=r.kd}function b(e,t,a,n,i,o,l){var s,c,u,f,d
for(e.na==Sl&&r("glp_analyze_row: primal basic solution components are undefined"),e.sa!=jl&&r("glp_analyze_row: basic solution is not dual feasible"),0<=t&&t<=e.i||r("glp_analyze_row: len = "+t+"; invalid row length"),d=0,s=1;s<=t;s++)c=a[s],1<=c&&c<=e.g+e.i||r("glp_analyze_row: ind["+s+"] = "+c+"; row/column index out of range"),c<=e.g?(e.n[c].m==gl&&r("glp_analyze_row: ind["+s+"] = "+c+"; basic auxiliary variable is not allowed"),f=e.n[c].r):(e.f[c-e.g].m==gl&&r("glp_analyze_row: ind["+s+"] = "+c+"; basic structural variable is not allowed"),f=e.f[c-e.g].r),d+=n[s]*f
if(i==ml){if(d>=o)return 1
u=1}else if(i==pl){if(d<=o)return 1
u=-1}else r("glp_analyze_row: type = "+i+"; invalid parameter")
return i=o-d,0==(t=To(e,t,a,n,u,1e-9))?2:(c=a[t],f=c<=e.g?e.n[c].r:e.f[c-e.g].r,a=i/n[t],l(t,f,a,d,i,c<=e.g?e.n[c].J*a:e.f[c-e.g].J*a),0)}function g(e){return e.reason!=ws&&r("glp_ios_pool_size: operation not allowed"),e.Bd.size}function x(e,t,a,n,i,o,l){e.reason!=ws&&r("glp_ios_add_row: operation not allowed")
var s,c,u=e.Bd
for(s={name:null},0<=t&&255>=t||r("glp_ios_add_row: klass = "+t+"; invalid cut class"),s.qc=t,s.k=null,0<=a&&a<=e.i||r("glp_ios_add_row: len = "+a+"; invalid cut length"),c=1;c<=a;c++)t={},1<=n[c]&&n[c]<=e.i||r("glp_ios_add_row: ind["+c+"] = "+n[c]+"; column index out of range"),t.C=n[c],t.j=i[c],t.e=s.k,s.k=t
o!=ml&&o!=pl&&o!=bl&&r("glp_ios_add_row: type = "+o+"; invalid cut type"),s.type=o,s.cg=l,s.ca=u.Xa,s.e=null,null==s.ca?u.head=s:s.ca.e=s,u.Xa=s,u.size++}function y(e,t){return 1<=t&&t<=e.A.i||r("glp_ios_can_branch: j = "+t+"; column number out of range"),e.ad[t]}function w(e,r){var a,n,i=e.A,o=e.wc,l=e.i
for(n=i.ha,a=1;a<=l;a++){var s=i.f[a]
if(s.kind==fl&&r[a]!=Math.floor(r[a]))return 1
n+=s.u*r[a]}if(i.za==jl)switch(i.dir){case sl:if(n>=e.A.ta)return 1
break
case cl:if(n<=e.A.ta)return 1}for(e.p.o>=Dl&&t("Solution found by heuristic: "+n),i.za=jl,i.ta=n,a=1;a<=l;a++)i.f[a].Sa=r[a]
for(l=1;l<=o;l++)for(a=i.n[l],a.Sa=0,n=a.k;null!=n;n=n.B)a.Sa+=n.j*n.f.Sa
return 0}function M(e,r){var t,a,n
for(t=null,a=e.root;null!=a;)t=a,0>=e.yg(e.info,r,t.key)?(n=0,a=t.left,t.pa++):(n=1,a=t.right)
for(a={},a.key=r,a.type=0,a.link=null,a.pa=1,a.R=t,a.ba=null==t?0:n,a.wa=0,a.left=null,a.right=null,e.size++,null==t?e.root=a:0==n?t.left=a:t.right=a;null!=t;){if(0==n){if(0<t.wa){t.wa=0
break}if(0>t.wa){_(e,t)
break}t.wa=-1}else{if(0>t.wa){t.wa=0
break}if(0<t.wa){_(e,t)
break}t.wa=1}n=t.ba,t=t.R}return null==t&&e.height++,a}function _(e,r){var t,a,n,i,o
0>r.wa?(t=r.R,a=r.left,n=a.right,0>=a.wa?(null==t?e.root=a:0==r.ba?t.left=a:t.right=a,r.pa-=a.pa,a.R=t,a.ba=r.ba,a.wa++,a.right=r,r.R=a,r.ba=1,r.wa=-a.wa,r.left=n,null!=n&&(n.R=r,n.ba=0)):(i=n.left,o=n.right,null==t?e.root=n:0==r.ba?t.left=n:t.right=n,r.pa-=a.pa+n.pa,n.pa+=a.pa,r.wa=0<=n.wa?0:1,a.wa=0>=n.wa?0:-1,n.R=t,n.ba=r.ba,n.wa=0,n.left=a,n.right=r,r.R=n,r.ba=1,r.left=o,a.R=n,a.ba=0,a.right=i,null!=i&&(i.R=a,i.ba=1),null!=o&&(o.R=r,o.ba=0))):(t=r.R,a=r.right,n=a.left,0<=a.wa?(null==t?e.root=a:0==r.ba?t.left=a:t.right=a,a.pa+=r.pa,a.R=t,a.ba=r.ba,a.wa--,a.left=r,r.R=a,r.ba=0,r.wa=-a.wa,r.right=n,null!=n&&(n.R=r,n.ba=1)):(i=n.left,o=n.right,null==t?e.root=n:0==r.ba?t.left=n:t.right=n,a.pa-=n.pa,n.pa+=r.pa,r.wa=0>=n.wa?0:-1,a.wa=0<=n.wa?0:1,n.R=t,n.ba=r.ba,n.wa=0,n.left=r,n.right=a,r.R=n,r.ba=0,r.right=i,a.R=n,a.ba=1,a.left=o,null!=i&&(i.R=r,i.ba=1),null!=o&&(o.R=a,o.ba=0)))}function k(e,a,i,o){var l,s
switch(s=e.valid=0,e.type){case Bl:e.Za=null,null==e.gb&&(s={},s.hb=s.g=0,s.valid=0,s.ia=_e(),s.$d=50,s.Pb=0,s.Ze=s.af=s.$e=null,s.je=s.ie=null,s.ug=null,s.vg=null,s.ic=1e-6,s.ag=0,e.gb=s,s=1)
break
case zl:case Tl:e.gb=null,null==e.Za&&(Gs&&t("lpf_create_it: warning: debug mode enabled"),s={valid:0},s.Nc=s.ef=0,s.ia=_e(),s.g=0,s.Cf=null,s.K=50,s.i=0,s.Md=s.Ld=null,s.Od=s.Nd=null,s.Qc=null,s.Ge=s.Fe=null,s.Ie=s.He=null,s.Jd=1e3,s.od=0,s.Wb=null,s.Xb=null,s.jb=s.Gc=null,e.Za=s,s=1)}if(null!=e.gb?l=e.gb.ia:null!=e.Za&&(l=e.Za.ia),s&&(l.Va=e.Cd),l.cc=e.cc,l.xc=e.xc,l.gc=e.gc,l.Mb=e.Mb,l.sc=e.sc,null!=e.gb&&(s&&(e.gb.$d=e.$c),e.gb.ic=e.ic),null!=e.Za&&(s&&(e.Za.K=e.vc),s&&(e.Za.Jd=e.kd)),null!=e.gb){e:{switch(l=e.gb,1>a&&r("fhv_factorize: m = "+a+"; invalid parameter"),1e8<a&&r("fhv_factorize: m = "+a+"; matrix too big"),l.g=a,l.valid=0,null==l.Ze&&(l.Ze=new Int32Array(1+l.$d)),null==l.af&&(l.af=new Int32Array(1+l.$d)),null==l.$e&&(l.$e=new Int32Array(1+l.$d)),l.hb<a&&(l.hb=a+100,l.je=new Int32Array(1+l.hb),l.ie=new Int32Array(1+l.hb),l.ug=new Int32Array(1+l.hb),l.vg=new Float64Array(1+l.hb)),Oe(l.ia,a,i,o)){case kc:a=Wo
break e
case Ac:a=Zo
break e}l.valid=1,l.Pb=0,n(l.je,1,l.ia.kb,1,a),n(l.ie,1,l.ia.vb,1,a),a=l.ag=0}switch(a){case Wo:return e=Do
case Zo:return e=Go}}else if(null!=e.Za){e:{if(l=e.Za,Gs)var c,u,f,d,h,m
switch(1>a&&r("lpf_factorize: m = "+a+"; invalid parameter"),1e8<a&&r("lpf_factorize: m = "+a+"; matrix too big"),l.ef=l.g=a,l.valid=0,null==l.Md&&(l.Md=new Int32Array(1+l.K)),null==l.Ld&&(l.Ld=new Int32Array(1+l.K)),null==l.Od&&(l.Od=new Int32Array(1+l.K)),null==l.Nd&&(l.Nd=new Int32Array(1+l.K)),null==l.Qc&&(s=l.K,Ch&&t("scf_create_it: warning: debug mode enabled"),1<=s&&32767>=s||r("scf_create_it: n_max = "+s+"; invalid parameter"),c={},c.K=s,c.i=0,c.Nb=new Float64Array(1+s*s),c.v=new Float64Array(1+s*(s+1)/2),c.s=new Int32Array(1+s),c.fg=_h,c.pa=0,c.l=Ch?new Float64Array(1+s*s):null,c.ig=new Float64Array(1+s),l.Qc=c),null==l.Wb&&(l.Wb=new Int32Array(1+l.Jd)),null==l.Xb&&(l.Xb=new Float64Array(1+l.Jd)),l.Nc<a&&(l.Nc=a+100,l.Ge=new Int32Array(1+l.Nc+l.K),l.Fe=new Int32Array(1+l.Nc+l.K),l.Ie=new Int32Array(1+l.Nc+l.K),l.He=new Int32Array(1+l.Nc+l.K),l.jb=new Float64Array(1+l.Nc+l.K),l.Gc=new Float64Array(1+l.Nc+l.K)),Oe(l.ia,a,i,o)){case kc:a=Ds
break e
case Ac:a=LPF_ECOND
break e}if(l.valid=1,Gs){for(l.Cf=h=new Float64Array(1+a*a),d=new Int32Array(1+a),m=new Float64Array(1+a),s=1;s<=a*a;s++)h[s]=0
for(u=1;u<=a;u++)for(f=i(o,u,d,m),s=1;s<=f;s++)c=d[s],h[(c-1)*a+u]=m[s]}for(l.i=0,i=l.Qc,i.i=i.pa=0,s=1;s<=a;s++)l.Ge[s]=l.Fe[s]=s,l.Ie[s]=l.He[s]=s
l.od=1,a=0}switch(a){case 0:switch(e.type){case zl:e.Za.Qc.fg=_h
break
case Tl:e.Za.Qc.fg=kh}break
case Ds:return e=Do
case LPF_ECOND:return e=Go}}return e.valid=1,e.hg=0}function A(e,t){if(null!=e.gb){var a=e.gb,n=a.ia.kb,i=a.ia.vb,o=a.je,l=a.ie
a.valid||r("fhv_ftran: the factorization is not valid"),a.ia.kb=o,a.ia.vb=l,Xe(a.ia,0,t),a.ia.kb=n,a.ia.vb=i,P(a,0,t),Ee(a.ia,0,t)}else if(null!=e.Za){var s,c,a=e.Za,n=a.ef,i=a.g,u=a.i,f=a.Fe,o=a.He,l=a.jb
if(Gs)var d
if(a.valid||r("lpf_ftran: the factorization is not valid"),Gs)for(d=new Float64Array(1+i),s=1;s<=i;s++)d[s]=t[s]
for(s=1;s<=n+u;s++)l[s]=(c=f[s])<=i?t[c]:0
Xe(a.ia,0,l),pe(a,l,n,l),ui(a.Qc,0,l,n),u=a.i,f=a.Md,s=a.Ld,c=a.Wb
var h,m,p,v,b=a.Xb
for(h=1;h<=u;h++)if(0!=l[h+n])for(v=-1*l[h+n],m=f[h],p=m+s[h];m<p;m++)l[c[m]]+=v*b[m]
for(Ee(a.ia,0,l),s=1;s<=i;s++)t[s]=l[o[s]]
Gs&&qs(a,0,t,d)}}function L(e,t){if(null!=e.gb){var a=e.gb,n=a.ia.kb,i=a.ia.vb,o=a.je,l=a.ie
a.valid||r("fhv_btran: the factorization is not valid"),Ee(a.ia,1,t),P(a,1,t),a.ia.kb=o,a.ia.vb=l,Xe(a.ia,1,t),a.ia.kb=n,a.ia.vb=i}else if(null!=e.Za){var s,c,a=e.Za,n=a.ef,i=a.g,u=a.i,o=a.Ge,f=a.Ie,l=a.jb
if(Gs)var d
if(a.valid||r("lpf_btran: the factorization is not valid"),Gs)for(d=new Float64Array(1+i),s=1;s<=i;s++)d[s]=t[s]
for(s=1;s<=n+u;s++)l[s]=(c=f[s])<=i?t[c]:0
Ee(a.ia,1,l),me(a,l,n,l),ui(a.Qc,1,l,n),u=a.i,f=a.Od,s=a.Nd,c=a.Wb
var h,m,p,v,b=a.Xb
for(h=1;h<=u;h++)if(0!=l[h+n])for(v=-1*l[h+n],m=f[h],p=m+s[h];m<p;m++)l[c[m]]+=v*b[m]
for(Xe(a.ia,1,l),s=1;s<=i;s++)t[s]=l[o[s]]
Gs&&qs(a,1,t,d)}}function C(e,t,a,i,o,l){if(null!=e.gb)switch(V(e.gb,t,a,i,o,l)){case Wo:return e.valid=0,e=Do
case Jo:return e.valid=0,e=qo
case Qo:return e.valid=0,e=Yo
case $o:return e.valid=0,e=Uo}else if(null!=e.Za){e:{var s=e.Za,c=s.ef,u=s.g
if(Gs)var f=s.Cf
var d,h,m,p=s.i,v=s.Md,b=s.Ld,g=s.Od,x=s.Nd,y=s.Ge,w=s.Fe,M=s.Ie,_=s.He,k=s.od,A=s.Wb,L=s.Xb,C=s.Gc,P=s.jb,I=s.Gc
if(s.valid||r("lpf_update_it: the factorization is not valid"),1<=t&&t<=u||r("lpf_update_it: j = "+t+"; column number out of range"),p==s.K)s.valid=0,t=LPF_ELIMIT
else{for(d=1;d<=u;d++)C[d]=0
for(m=1;m<=a;m++)d=i[o+m],1<=d&&d<=u||r("lpf_update_it: ind["+m+"] = "+d+"; row number out of range"),0!=C[d]&&r("lpf_update_it: ind["+m+"] = "+d+"; duplicate row index not allowed"),0==l[m]&&r("lpf_update_it: val["+m+"] = "+l[m]+"; zero element not allowed"),C[d]=l[m]
if(Gs)for(d=1;d<=u;d++)f[(d-1)*u+t]=C[d]
for(d=1;d<=c+p;d++)P[d]=(h=w[d])<=u?C[h]:0
for(d=1;d<=c+p;d++)I[d]=0
if(I[_[t]]=1,Xe(s.ia,0,P),Ee(s.ia,1,I),s.Jd<k+c+c){for(d=s.Jd,a=s.od-1,i=s.Wb,o=s.Xb;d<k+c+c;)d+=d
s.Jd=d,s.Wb=new Int32Array(1+d),s.Xb=new Float64Array(1+d),n(s.Wb,1,i,1,a),n(s.Xb,1,o,1,a),A=s.Wb,L=s.Xb}for(v[p+1]=k,d=1;d<=c;d++)0!=P[d]&&(A[k]=d,L[k]=P[d],k++)
for(b[p+1]=k-s.od,s.od=k,g[p+1]=k,d=1;d<=c;d++)0!=I[d]&&(A[k]=d,L[k]=I[d],k++)
for(x[p+1]=k-s.od,s.od=k,pe(s,P,0,P),me(s,I,0,I),b=0,d=1;d<=c;d++)b-=I[d]*P[d]
if(v=s.Qc,k=b,d=v.K,b=v.i,a=v.Nb,i=v.v,o=v.s,Ch)var S=v.l
if(x=v.ig,g=0,b==d)g=Lh
else{for(v.i=++b,l=1,u=(l-1)*v.K+b;l<b;l++,u+=d)a[u]=0
for(u=1,l=(b-1)*v.K+u;u<b;u++,l++)a[l]=0
for(l=a[(b-1)*v.K+b]=1;l<b;l++){for(A=0,u=1,f=(l-1)*v.K+1;u<b;u++,f++)A+=a[f]*P[u+c]
i[li(v,l,b)]=A}for(u=1;u<b;u++)x[u]=I[o[u]+c]
if(x[b]=k,o[b]=b,Ch){for(l=1,u=(l-1)*v.K+b;l<b;l++,u+=d)S[u]=P[l+c]
for(u=1,l=(b-1)*v.K+u;u<b;u++,l++)S[l]=I[u+c]
S[(b-1)*v.K+b]=k}for(P=1;P<b&&0==x[P];P++);switch(v.fg){case _h:for(I=v.i,S=v.Nb,k=v.v;P<I;P++){if(o=li(v,P,P),a=(P-1)*v.K+1,l=(I-1)*v.K+1,Math.abs(k[o])<Math.abs(x[P])){for(d=P,i=o;d<=I;d++,i++)f=k[i],k[i]=x[d],x[d]=f
for(d=1,i=a,u=l;d<=I;d++,i++,u++)f=S[i],S[i]=S[u],S[u]=f}if(Math.abs(k[o])<Ph&&(k[o]=x[P]=0),0!=x[P]){for(f=x[P]/k[o],d=P+1,i=o+1;d<=I;d++,i++)x[d]-=f*k[i]
for(d=1,i=a,u=l;d<=I;d++,i++,u++)S[u]-=f*S[i]}}Math.abs(x[I])<Ph&&(x[I]=0),k[li(v,I,I)]=x[I]
break
case kh:ci(v,P,x)}for(d=v.K,P=v.i,I=v.v,k=0,S=1,x=li(v,S,S);S<=P;S++,x+=d,d--)0!=I[x]&&k++
v.pa=k,v.pa!=b&&(g=Ah),Ch&&qs(v,"scf_update_exp")}switch(g){case Ah:s.valid=0,t=Ds
break e}y[c+p+1]=w[c+p+1]=c+p+1,M[c+p+1]=_[c+p+1]=c+p+1,d=_[t],h=_[c+p+1],M[d]=c+p+1,_[c+p+1]=d,M[h]=t,_[t]=h,s.i++,t=0}}switch(t){case Ds:return e.valid=0,e=Do
case LPF_ELIMIT:return e.valid=0,e=Yo}}return e.hg++,0}function P(e,t,a){var n,i,o,l=e.Pb,s=e.Ze,c=e.af,u=e.$e,f=e.ia.wb,d=e.ia.xb
if(e.valid||r("fhv_h_solve: the factorization is not valid"),t){for(t=l;1<=t;t--)if(e=s[t],0!=(o=a[e]))for(n=c[t],i=n+u[t]-1;n<=i;n++)a[f[n]]-=d[n]*o}else for(t=1;t<=l;t++){for(e=s[t],o=a[e],n=c[t],i=n+u[t]-1;n<=i;n++)o-=d[n]*a[f[n]]
a[e]=o}}function V(e,t,a,i,o,l){var s,c,u=e.g,f=e.ia,d=f.Fc,h=f.Ec,m=f.pd,p=f.Af,v=f.Dc,b=f.Cc,g=f.Rc,x=f.kb,y=f.vb,w=f.sf,M=f.me,_=f.wb,k=f.xb,A=f.ze,L=f.Mb,C=e.Ze,V=e.af,I=e.$e,S=e.je,j=e.ie,O=e.ug,X=e.vg,E=e.ic
if(e.valid||r("fhv_update_it: the factorization is not valid"),1<=t&&t<=u||r("fhv_update_it: j = "+t+"; column number out of range"),e.Pb==e.$d)return e.valid=0,e=Qo
for(s=1;s<=u;s++)X[s]=0
for(c=1;c<=a;c++)s=i[o+c],1<=s&&s<=u||r("fhv_update_it: ind["+c+"] = "+s+"; row number out of range"),0!=X[s]&&r("fhv_update_it: ind["+c+"] = "+s+"; duplicate row index not allowed"),0==l[c]&&r("fhv_update_it: val["+c+"] = "+l[c]+"; zero element not allowed"),X[s]=l[c]
for(e.ia.kb=S,e.ia.vb=j,Xe(e.ia,0,X),e.ia.kb=x,e.ia.vb=y,P(e,0,X),a=0,s=1;s<=u;s++)0==(o=X[s])||Math.abs(o)<L||(a++,O[a]=s,X[a]=o)
for(j=v[t],S=j+b[t]-1;j<=S;j++){for(s=_[j],l=d[s],c=l+h[s]-1;_[l]!=t;l++);_[l]=_[c],k[l]=k[c],h[s]--}for(f.Qb-=b[t],b[t]=0,o=w[t],i=0,c=1;c<=a;c++){if(s=O[c],h[s]+1>m[s]&&Ae(f,s,h[s]+10))return e.valid=0,f.Va=f.Ga+f.Ga,e=$o
l=d[s]+h[s],_[l]=t,k[l]=X[c],h[s]++,i<y[s]&&(i=y[s])}if(g[t]<a&&Le(f,t,a))return e.valid=0,f.Va=f.Ga+f.Ga,e=$o
if(j=v[t],n(_,j,O,1,a),n(k,j,X,1,a),b[t]=a,f.Qb+=a,o>i)return e.valid=0,e=Wo
for(s=x[o],t=M[o],c=o;c<i;c++)x[c]=x[c+1],y[x[c]]=c,M[c]=M[c+1],w[M[c]]=c
for(x[i]=s,y[s]=i,M[i]=t,w[t]=i,t=1;t<=u;t++)A[t]=0
for(l=d[s],c=l+h[s]-1;l<=c;l++){for(t=_[l],A[t]=k[l],j=v[t],S=j+b[t]-1;_[j]!=s;j++);_[j]=_[S],k[j]=k[S],b[t]--}if(f.Qb-=h[s],h[s]=0,e.Pb++,C[e.Pb]=s,I[e.Pb]=0,f.Ma-f.Fa<i-o&&(ke(f),f.Ma-f.Fa<i-o))return e.valid=f.valid=0,f.Va=f.Ga+f.Ga,e=$o
for(c=o;c<i;c++)if(t=x[c],a=M[c],0!=A[a]){for(y=A[a]/p[t],w=d[t],a=w+h[t]-1;w<=a;w++)A[_[w]]-=y*k[w]
f.Ma--,_[f.Ma]=t,k[f.Ma]=y,I[e.Pb]++}for(0==I[e.Pb]?e.Pb--:(V[e.Pb]=f.Ma,e.ag+=I[e.Pb]),p[s]=A[M[i]],a=0,c=i+1;c<=u;c++)if(t=M[c],o=A[t],!(Math.abs(o)<L)){if(b[t]+1>g[t]&&Le(f,t,b[t]+10))return e.valid=0,f.Va=f.Ga+f.Ga,e=$o
j=v[t]+b[t],_[j]=s,k[j]=o,b[t]++,a++,O[a]=t,X[a]=o}if(m[s]<a&&Ae(f,s,a))return e.valid=0,f.Va=f.Ga+f.Ga,e=$o
for(l=d[s],n(_,l,O,1,a),n(k,l,X,1,a),h[s]=a,f.Qb+=a,o=0,s=x[i],l=d[s],c=l+h[s]-1;l<=c;l++)o<Math.abs(k[l])&&(o=Math.abs(k[l]))
for(t=M[i],j=v[t],S=j+b[t]-1;j<=S;j++)o<Math.abs(k[j])&&(o=Math.abs(k[j]))
return Math.abs(p[s])<E*o?(e.valid=0,e=Jo):0}function I(e){function a(e,t,a,n,i,o){var l,s,c,u,f,d,h,m,p,v,b,g,x,y,w=0
for(0<e&&0<t||r("triang: m = "+e+"; n = "+t+"; invalid dimension"),l=new Int32Array(1+(e>=t?e:t)),s=new Int32Array(1+e),c=new Int32Array(1+t),u=new Int32Array(1+e),f=new Int32Array(1+e),h=new Int32Array(1+t),m=new Int32Array(1+t),v=1;v<=t;v++)b=n(a,-v,l),h[v]=s[b],s[b]=v
for(b=d=0;b<=e;b++)for(v=s[b];0!=v;v=h[v])m[v]=d,d=v
for(b=0,v=d;0!=v;v=m[v])h[v]=b,b=v
for(p=1;p<=e;p++)s[p]=b=n(a,+p,l),u[p]=0,f[p]=c[b],0!=f[p]&&(u[f[p]]=p),c[b]=p
for(p=1;p<=e;p++)i[p]=0
for(v=1;v<=t;v++)o[v]=0
for(g=1,x=t;g<=x;){if(0!=(p=c[1])){for(v=0,y=n(a,+p,l);1<=y;y--)b=l[y],0==o[b]&&(v=b)
i[p]=o[v]=g,g++,w++}else v=d,o[v]=x,x--
for(0==h[v]?d=m[v]:m[h[v]]=m[v],0!=m[v]&&(h[m[v]]=h[v]),y=n(a,-v,l);1<=y;y--)p=l[y],b=s[p],0==u[p]?c[b]=f[p]:f[u[p]]=f[p],0!=f[p]&&(u[f[p]]=u[p]),s[p]=--b,u[p]=0,f[p]=c[b],0!=f[p]&&(u[f[p]]=p),c[b]=p}for(p=1;p<=e;p++)0==i[p]&&(i[p]=g++)
for(v=1;v<=t;v++);for(u=1;u<=e;u++)s[u]=0
for(p=1;p<=e;p++)u=i[p],s[u]=p
for(b=1;b<=t;b++)c[b]=0
for(v=1;v<=t;v++)b=o[v],c[b]=v
for(u=1;u<=w;u++)for(p=s[u],y=n(a,+p,l);1<=y;y--);return w}function n(e,r,t){var a=Fi(e)
Bi(e)
var n,i,o,l=0
if(0<r){for(n=+r,o=Ui(e,n,t,null),r=1;r<=o;r++)we(e,t[r],function(e){e!=Ws&&(t[++l]=a+t[r])})
ge(e,n,function(e){e!=Ws&&(t[++l]=n)})}else i=-r,o=function(r){r!=Ws&&(i<=a?t[++l]=i:l=Hi(e,i-a,t,null))},i<=a?ge(e,i,o):we(e,i-a,o)
return l}0==e.g||0==e.i?io(e):function(e){var r,i,o,l,s,c,u,f=Fi(e),d=Bi(e),h=new Int32Array(1+f+d)
if(t("Constructing initial basis..."),0==f||0==d)io(e)
else{for(s=new Int32Array(1+f),i=new Int32Array(1+f+d),l=a(f,f+d,e,n,s,i),3<=Me(e)&&t("Size of triangular part = "+l),c=new Int32Array(1+f),u=new Int32Array(1+f+d),r=1;r<=f;r++)c[s[r]]=r
for(r=1;r<=f+d;r++)u[i[r]]=r
for(o=1;o<=f+d;o++)h[o]=-1
for(i=1;i<=l;i++)r=u[i],h[r]=Zs
for(i=l+1;i<=f;i++)r=c[i],h[r]=Zs
for(o=1;o<=f+d;o++)h[o]!=Zs&&(l=function(e,r,t){switch(e){case Ys:h[o]=$s
break
case Us:h[o]=Js
break
case Hs:h[o]=Qs
break
case Ks:h[o]=Math.abs(r)<=Math.abs(t)?Js:Qs
break
case Ws:h[o]=ec}},o<=f?ge(e,o,l):we(e,o-f,l))
for(o=1;o<=f+d;o++)o<=f?ao(e,o,h[o]-Zs+gl):no(e,o-f,h[o]-Zs+gl)}}(e)}function S(e,r){var t,a
if(0==e.Sc)for(t=e.fe,a=e.ya,e.fe=0==t?20:t+t,e.ya=Array(1+e.fe),o(e.ya,0,1+e.fe),null!=a&&n(e.ya,1,a,1,t),a=e.fe;a>t;a--)e.ya[a].rb=null,e.ya[a].e=e.Sc,e.Sc=a
return a=e.Sc,e.Sc=e.ya[a].e,e.ya[a].e=0,t=a,a={},e.ya[t].rb=a,a.s=t,a.R=r,a.La=null==r?0:r.La+1,a.count=0,a.Na=null,a.zc=null,a.ec=null,a.eg=0,a.rc=null==r?e.A.dir==sl?-hi:+hi:r.rc,a.bound=null==r?e.A.dir==sl?-hi:+hi:r.bound,a.Tc=0,a.tg=0,a.Ag=0,a.Zc=0,a.Rd=0,a.data=0==e.p.Me?null:{},a.ja=null,a.ca=e.Xa,a.e=null,null==e.head?e.head=a:e.Xa.e=a,e.Xa=a,e.Pd++,e.Zf++,e.Jg++,null!=r&&r.count++,a}function j(e,r){var t,a,n,i,o=e.A
if(t=e.ya[r].rb,e.N=t,a=e.ya[1].rb,t!=a){for(t.ja=null;null!=t;t=t.R)null!=t.R&&(t.R.ja=t)
for(t=a;null!=t;t=t.ja){var l=o.g
if(a=o.i,null==t.ja){for(e.Fg=l,e.Gg<l+a&&(n=l+a+100,e.Gg=n,e.qf=new Int8Array(1+n),e.of=new Float64Array(1+n),e.rf=new Float64Array(1+n),e.pf=new Int8Array(1+n)),n=1;n<=l;n++)i=o.n[n],e.qf[n]=i.type,e.of[n]=i.c,e.rf[n]=i.d,e.pf[n]=i.m
for(n=1;n<=a;n++)i=o.f[n],e.qf[o.g+n]=i.type,e.of[o.g+n]=i.c,e.rf[o.g+n]=i.d,e.pf[o.g+n]=i.m}for(n=t.Na;null!=n;n=n.e)n.pc<=l?Ai(o,n.pc,n.type,n.c,n.d):Li(o,n.pc-l,n.type,n.c,n.d)
for(n=t.zc;null!=n;n=n.e)n.pc<=l?ao(o,n.pc,n.m):no(o,n.pc-l,n.m)
if(null!=t.ec){var s,c,l=new Int32Array(1+a)
for(c=new Float64Array(1+a),a=t.ec;null!=a;a=a.e){for(n=wi(o,1),_i(o,n,a.name),o.n[n].La=t.La,o.n[n].origin=a.origin,o.n[n].qc=a.qc,Ai(o,n,a.type,a.c,a.d),s=0,i=a.k;null!=i;i=i.e)s++,l[s]=i.C,c[s]=i.j
Pi(o,n,s,l,c),Qi(o,n,a.ma),ao(o,n,a.m)}}}for(t=e.N;null!=t.Na;)n=t.Na,t.Na=n.e
for(;null!=t.zc;)n=t.zc,t.zc=n.e
for(;null!=t.ec;)for(a=t.ec,t.ec=a.e;null!=a.k;)i=a.k,a.k=i.e}}function O(e){var r,t,a,n=e.A,i=n.g,o=n.i,l=e.N
if(null==l.R)for(e.Ig=i,e.se=new Int8Array(1+i+o),e.qe=new Float64Array(1+i+o),e.te=new Float64Array(1+i+o),e.re=new Int8Array(1+i+o),r=1;r<=i+o;r++)a=r<=i?n.n[r]:n.f[r-i],e.se[r]=a.type,e.qe[r]=a.c,e.te[r]=a.d,e.re[r]=a.m
else{var s=e.Ig,c=e.Fg
for(r=1;r<=c+o;r++){var u,f,d,h,m,p
u=e.qf[r],d=e.of[r],h=e.rf[r],t=e.pf[r],a=r<=c?n.n[r]:n.f[r-c],f=a.type,m=a.c,p=a.d,a=a.m,u==f&&d==m&&h==p||(u={},u.pc=r,u.type=f,u.c=m,u.d=p,u.e=l.Na,l.Na=u),t!=a&&(t={},t.pc=r,t.m=a,t.e=l.zc,l.zc=t)}if(c<i)for(f=new Int32Array(1+o),m=new Float64Array(1+o),t=i;t>c;t--){for(a=n.n[t],p={},r=zi(n,t),p.name=null==r?null:r,p.type=a.type,p.c=a.c,p.d=a.d,p.k=null,u=Ui(n,t,f,m),r=1;r<=u;r++)d={},d.C=f[r],d.j=m[r],d.e=p.k,p.k=d
p.ma=a.ma,p.m=a.m,p.e=l.ec,l.ec=p}if(i!=s){for(i-=s,l=new Int32Array(1+i),t=1;t<=i;t++)l[t]=s+t
Si(n,i,l)}for(i=n.g,t=1;t<=i;t++)Ai(n,t,e.se[t],e.qe[t],e.te[t]),ao(n,t,e.re[t])
for(s=1;s<=o;s++)Li(n,s,e.se[i+s],e.qe[i+s],e.te[i+s]),no(n,s,e.re[i+s])}e.N=null}function X(e,r,t){var a
for(r=e.ya[r].rb,null==r.ca?e.head=r.e:r.ca.e=r.e,null==r.e?e.Xa=r.ca:r.e.ca=r.ca,r.ca=r.e=null,e.Pd--,a=1;2>=a;a++)t[a]=S(e,r).s}function E(e,r){var t
for(t=e.ya[r].rb,null==t.ca?e.head=t.e:t.ca.e=t.e,null==t.e?e.Xa=t.ca:t.e.ca=t.ca,t.ca=t.e=null,e.Pd--;;){for(var a;null!=t.Na;)a=t.Na,t.Na=a.e
for(;null!=t.zc;)a=t.zc,t.zc=a.e
for(;null!=t.ec;){for(a=t.ec,a.name=null;null!=a.k;)a.k=a.k.e
t.ec=a.e}if(r=t.s,e.ya[r].rb=null,e.ya[r].e=e.Sc,e.Sc=r,t=t.R,e.Zf--,null==t||0!=--t.count)break}}function F(e,r,t){var a,n,i,o,l,s,c=e.A,u=c.g,f=e.Bg,d=e.Tg
for(so(c),Lo(c),e=c.f[r].r,r=Eo(c,u+r,f,d),a=-1;1>=a;a+=2)if(i=f,n=To(c,r,i,d,a,1e-9),0==(n=0==n?0:i[n]))c.dir==sl?0>a?l=+hi:s=+hi:c.dir==cl&&(0>a?l=-hi:s=-hi)
else{for(i=1;i<=r&&f[i]!=n;i++);i=d[i],n<=u?(o=c.n[n].m,n=c.n[n].J):(o=c.f[n-u].m,n=c.f[n-u].J),c.dir==sl?(o==xl&&0>n||o==yl&&0<n||o==wl)&&(n=0):c.dir==cl&&(o==xl&&0<n||o==yl&&0>n||o==wl)&&(n=0),o=(0>a?Math.floor(e):Math.ceil(e))-e,o/=i,i=n*o,0>a?l=c.aa+i:s=c.aa+i}t(l,s)}function B(e,r){var t,a,n,i,o=e.A,l=o.i,s=e.Bg
for(n=0,i=o.ha,t=0,a=1;a<=l;a++){var c=o.f[a]
if(0!=c.u)if(c.type==bl)i+=c.u*c.r
else{if(c.kind!=fl||c.u!=Math.floor(c.u))return r
2147483647>=Math.abs(c.u)?s[++n]=0|Math.abs(c.u):t=1}}if(0==t){if(0==n)return r
for(l=0,t=1;t<=n;t++){if(1==t)l=s[1]
else for(a=s[t],c=void 0;0<a;)c=l%a,l=a,a=c
if(1==l)break}t=l}return o.dir==sl?r!=+hi&&(o=(r-i)/t)>=Math.floor(o)+.001&&(o=Math.ceil(o),r=t*o+i):o.dir==cl&&r!=-hi&&(o=(r-i)/t)<=Math.ceil(o)-.001&&(o=Math.floor(o),r=t*o+i),r}function z(e,r){var t,a=e.A,n=1
if(a.za==jl)switch(t=e.p.we*(1+Math.abs(a.ta)),a.dir){case sl:r>=a.ta-t&&(n=0)
break
case cl:r<=a.ta+t&&(n=0)}else switch(a.dir){case sl:r==+hi&&(n=0)
break
case cl:r==-hi&&(n=0)}return n}function T(e){var r=null
switch(e.A.dir){case sl:for(e=e.head;null!=e;e=e.e)(null==r||r.bound>e.bound)&&(r=e)
break
case cl:for(e=e.head;null!=e;e=e.e)(null==r||r.bound<e.bound)&&(r=e)}return null==r?0:r.s}function N(e){var r=e.A,t=new lo
switch(e.p.o){case Nl:t.o=Nl
break
case Rl:t.o=Rl
break
case Dl:case Gl:t.o=Dl
break
case ql:t.o=Gl}if(t.cb=Ul,t.fb=e.p.o<ql?e.p.fb:0,r.za==jl)switch(e.A.dir){case sl:t.jf=r.ta
break
case cl:t.hf=r.ta}return r=oo(r,t),e.N.eg++,r}function R(e){for(;null!=e.head;){var r=e.head
for(e.head=r.e;null!=r.k;)r.k=r.k.e}e.size=0,e.head=e.Xa=null,e.fh=0,e.N=null}function D(e,r){function t(e,r,t,a,n){var i,o,l
for(o=l=0,i=1;i<=e;i++)if(0<r[i])if(t[i]==-hi){if(0!=o){l=-hi,o=0
break}o=i}else l+=r[i]*t[i]
else if(0>r[i])if(a[i]==+hi){if(0!=o){l=-hi,o=0
break}o=i}else l+=r[i]*a[i]
for(n.Wd=l,n.Uf=o,o=l=0,i=1;i<=e;i++)if(0<r[i])if(a[i]==+hi){if(0!=o){l=+hi,o=0
break}o=i}else l+=r[i]*a[i]
else if(0>r[i])if(t[i]==-hi){if(0!=o){l=+hi,o=0
break}o=i}else l+=r[i]*t[i]
n.Vd=l,n.Tf=o}function a(e,r){r(0==e.Uf?e.Wd:-hi,0==e.Tf?e.Vd:+hi)}function n(e,r,t,a,n,i,o,l){var s,c,u,f
t==-hi||e.Vd==+hi?s=-hi:0==e.Tf?0<r[o]?s=t-(e.Vd-r[o]*i[o]):0>r[o]&&(s=t-(e.Vd-r[o]*n[o])):s=e.Tf==o?t-e.Vd:-hi,a==+hi||e.Wd==-hi?c=+hi:0==e.Uf?0<r[o]?c=a-(e.Wd-r[o]*n[o]):0>r[o]&&(c=a-(e.Wd-r[o]*i[o])):c=e.Uf==o?a-e.Wd:+hi,1e-6>Math.abs(r[o])?(u=-hi,f=+hi):0<r[o]?(u=s==-hi?-hi:s/r[o],f=c==+hi?+hi:c/r[o]):0>r[o]&&(u=c==+hi?-hi:c/r[o],f=s==-hi?+hi:s/r[o]),l(u,f)}function i(e,r,t,n,i){var o=r[t],l=n[i],s=null,c=null
return a(e,function(e,r){s=e,c=r}),o!=-hi&&(e=.001*(1+Math.abs(o)),c<o-e)||l!=+hi&&(e=.001*(1+Math.abs(l)),s>l+e)?1:(o!=-hi&&(e=1e-12*(1+Math.abs(o)),s>o-e&&(r[t]=-hi)),l!=+hi&&(e=1e-12*(1+Math.abs(l)),c<l+e&&(n[i]=+hi)),0)}function o(e,r,t,a,i,o,l,s,c){var u,f,d=null,h=null
return u=i[s],f=o[s],n(e,r,t,a,i,o,s,function(e,r){d=e,h=r}),l&&(d!=-hi&&(d=.001>d-Math.floor(d)?Math.floor(d):Math.ceil(d)),h!=+hi&&(h=.001>Math.ceil(h)-h?Math.ceil(h):Math.floor(h))),u!=-hi&&(e=.001*(1+Math.abs(u)),h<u-e)||f!=+hi&&(e=.001*(1+Math.abs(f)),d>f+e)?1:(d!=-hi&&(e=.001*(1+Math.abs(d)),u<d-e&&(u=d)),h!=+hi&&(e=.001*(1+Math.abs(h)),f>h+e&&(f=h)),u!=-hi&&f!=+hi&&(e=Math.abs(u),r=Math.abs(f),u>f-1e-10*(1+(e<=r?e:r))&&(u==i[s]?f=u:f==o[s]?u=f:e<=r?f=u:u=f)),c(u,f),0)}function l(e,r,t,a,n){var i,o=0
return r<a&&(e||r==-hi?o++:(i=t==+hi?1+Math.abs(r):t-r+1,a-r>=.25*i&&o++)),t>n&&(e||t==+hi?o++:(i=r==-hi?1+Math.abs(t):t-r+1,t-n>=.25*i&&o++)),o}var s,c,u,f,d,h,m,p=e.A,v=p.g,b=p.i
switch(f=new Float64Array(1+v),d=new Float64Array(1+v),p.za){case Sl:f[0]=-hi,d[0]=+hi
break
case jl:switch(p.dir){case sl:f[0]=-hi,d[0]=p.ta-p.ha
break
case cl:f[0]=p.ta-p.ha,d[0]=+hi}}for(s=1;s<=v;s++)f[s]=Ri(p,s),d[s]=Di(p,s)
for(h=new Float64Array(1+b),m=new Float64Array(1+b),s=1;s<=b;s++)h[s]=qi(p,s),m[s]=Yi(p,s)
for(c=v+1,u=new Int32Array(1+c),s=1;s<=c;s++)u[s]=s-1
if(function(e,r,a,n,s,c,u,f){var d,h,m,p,v,b,g,x,y,w,M=e.g,_=e.i,k={},A=0
for(m=new Int32Array(1+_),p=new Int32Array(1+M+1),v=new Int32Array(1+M+1),b=new Int32Array(1+M+1),g=new Float64Array(1+_),x=new Float64Array(1+_),y=new Float64Array(1+_),h=0,d=1;d<=c;d++)M=u[d],p[++h]=M,v[M]=1
for(;0<h;)if(M=p[h--],v[M]=0,b[M]++,r[M]!=-hi||a[M]!=+hi){if(c=0,0==M)for(u=1;u<=_;u++)w=e.f[u],0!=w.u&&(c++,m[c]=u,g[c]=w.u)
else for(u=e.n[M].k;null!=u;u=u.B)c++,m[c]=u.f.C,g[c]=u.j
for(d=1;d<=c;d++)u=m[d],x[d]=n[u],y[d]=s[u]
if(t(c,g,x,y,k),i(k,r,M,a,M)){A=1
break}if(r[M]!=-hi||a[M]!=+hi)for(d=1;d<=c;d++){var L,C=null,P=null
if(u=m[d],w=e.f[u],L=w.kind!=ul,o(k,g,r[M],a[M],x,y,L,d,function(e,r){C=e,P=r}))return A=1
if(L=l(L,n[u],s[u],C,P),n[u]=C,s[u]=P,0<L)for(u=w.k;null!=u;u=u.I)w=u.n.ea,b[w]>=f||r[w]==-hi&&a[w]==+hi||0!=v[w]||(p[++h]=w,v[w]=1)}}return A}(p,f,d,h,m,c,u,r))return 1
for(s=1;s<=v;s++)ho(p,s)==gl&&(f[s]==-hi&&d[s]==+hi?Ai(p,s,hl,0,0):d[s]==+hi?Ai(p,s,ml,f[s],0):f[s]==-hi&&Ai(p,s,pl,0,d[s]))
for(s=1;s<=b;s++)Li(p,s,h[s]==-hi&&m[s]==+hi?hl:m[s]==+hi?ml:h[s]==-hi?pl:h[s]!=m[s]?vl:bl,h[s],m[s])
return 0}function G(e){function a(e,r){var a,n,i,o
n=e.A.za==jl?String(e.A.ta):"not found yet",a=T(e),0==a?i="tree is empty":(a=e.ya[a].rb.bound,i=a==-hi?"-inf":a==+hi?"+inf":a),e.A.dir==sl?o=">=":e.A.dir==cl&&(o="<="),a=el(e),t("+"+e.A.$+": "+(r?">>>>>":"mip =")+" "+n+" "+o+" "+i+" "+(0==a?"  0.0%":.001>a?" < 0.1%":9.999>=a?"  "+Number(100*a).toFixed(1)+"%":"")+" ("+e.Pd+"; "+(e.Jg-e.Zf)+")"),e.Lg=l()}function n(e,r){return z(e,e.ya[r].rb.bound)}function i(e){var r,a=e.A,n=0,i=0,o=0,l=0,s=0
for(r=a.g;0<r;r--){var c=a.n[r]
c.origin==fs&&(c.qc==ds?n++:c.qc==hs?i++:c.qc==ms?o++:c.qc==ps?l++:s++)}0<n+i+o+l+s&&(t("Cuts on level "+e.N.La+":"),0<n&&t(" gmi = "+n+";"),0<i&&t(" mir = "+i+";"),0<o&&t(" cov = "+o+";"),0<l&&t(" clq = "+l+";"),0<s&&t(" app = "+s+";"),t(""))}var o,c,u,f,d=0,h=e.hc
for(c=0;;){switch(u=null,c){case 0:if(null==e.head){e.p.o>=ql&&t("Active list is empty!"),f=0,u=3
break}if(null!=e.p.ob&&(e.reason=_s,e.p.ob(e,e.p.Uc),e.reason=0,e.stop)){f=Ns,u=3
break}0==e.gf&&(e.gf=1==e.Pd?e.head.s:0!=e.ud?e.ud:se(e)),j(e,e.gf),e.gf=e.ud=0,null!=e.N.R&&e.N.R.s!=d&&(d=0),o=e.N.s,e.p.o>=ql&&(t("------------------------------------------------------------------------"),t("Processing node "+o+" at level "+e.N.La)),1==o&&(e.p.Ad==vs&&e.p.o>=Gl&&t("Gomory's cuts enabled"),e.p.Ed==vs&&(e.p.o>=Gl&&t("MIR cuts enabled"),e.Xf=Z(e)),e.p.xd==vs&&e.p.o>=Gl&&t("Cover cuts enabled"),e.p.vd==vs&&(e.p.o>=Gl&&t("Clique cuts enabled"),e.Ne=Q(e.A)))
case 1:if((e.p.o>=ql||e.p.o>=Dl&&e.p.bc-1<=1e3*s(e.Lg))&&a(e,0),e.p.o>=Gl&&60<=s(h)&&(t("Time used: "+s(e.hc)+" secs"),h=l()),0<e.p.ce&&el(e)<=e.p.ce){e.p.o>=ql&&t("Relative gap tolerance reached; search terminated "),f=Rs,u=3
break}if(2147483647>e.p.sb&&e.p.sb-1<=1e3*s(e.hc)){e.p.o>=ql&&t("Time limit exhausted; search terminated"),f=Fs,u=3
break}if(null!=e.p.ob&&(e.reason=ks,e.p.ob(e,e.p.Uc),e.reason=0,e.stop)){f=Ns,u=3
break}if(e.p.ed!=ls)if(e.p.ed==ss){if(0==e.N.La&&D(e,100)){u=2
break}}else if(e.p.ed==cs&&D(e,0==e.N.La?100:10)){u=2
break}if(!n(e,o)){t("*** not tested yet ***"),u=2
break}if(e.p.o>=ql&&t("Solving LP relaxation..."),0!=(f=N(e))&&f!=Os&&f!=Xs){e.p.o>=Rl&&t("ios_driver: unable to solve current LP relaxation; glp_simplex returned "+f),f=js,u=3
break}if(c=e.A.na,u=e.A.sa,c==jl&&u==jl)e.p.o>=ql&&t("Found optimal solution to LP relaxation")
else{if(u==Xl){e.p.o>=Rl&&t("ios_driver: current LP relaxation has no dual feasible solution"),f=js,u=3
break}if(c==Ol&&u==jl){e.p.o>=ql&&t("LP relaxation has no solution better than incumbent objective value"),u=2
break}if(c==Xl){e.p.o>=ql&&t("LP relaxation has no feasible solution"),u=2
break}}if(c=e.N.rc=e.A.aa,c=B(e,c),e.A.dir==sl?e.N.bound<c&&(e.N.bound=c):e.A.dir==cl&&e.N.bound>c&&(e.N.bound=c),e.p.o>=ql&&t("Local bound is "+c),!n(e,o)){e.p.o>=ql&&t("Current branch is hopeless and can be pruned"),u=2
break}if(null!=e.p.ob){if(e.reason=gs,e.p.ob(e,e.p.Uc),e.reason=0,e.stop){f=Ns,u=3
break}if(e.pe){e.pe=e.tf=0,u=1
break}e.tf&&(e.tf=0,Co(e.A))}if(function(e){var r,a,n,i,o,l,s,c=e.A,u=0,f=0
for(r=1;r<=c.i;r++)if(o=c.f[r],e.ad[r]=0,o.kind==fl&&o.m==gl){if(a=o.type,n=o.c,i=o.d,o=o.r,a==ml||a==vl||a==bl){if(l=n-e.p.Ub,s=n+e.p.Ub,l<=o&&o<=s)continue
if(o<n)continue}if(a==pl||a==vl||a==bl){if(l=i-e.p.Ub,s=i+e.p.Ub,l<=o&&o<=s)continue
if(o>i)continue}l=Math.floor(o+.5)-e.p.Ub,s=Math.floor(o+.5)+e.p.Ub,l<=o&&o<=s||(e.ad[r]=1,u++,l=o-Math.floor(o),s=Math.ceil(o)-o,f+=l<=s?l:s)}e.N.Ag=u,e.N.Zc=f,e.p.o>=ql&&t(0==u?"There are no fractional columns":1==u?"There is one fractional column, integer infeasibility is "+f:"There are "+u+" fractional columns, integer infeasibility is "+f)}(e),0==e.N.Ag){if(e.p.o>=ql&&t("New integer feasible solution found"),e.p.o>=Gl&&i(e),function(e){var r,t=e.A
for(t.za=jl,t.ta=t.aa,r=1;r<=t.g;r++){var a=t.n[r]
a.Sa=a.r}for(r=1;r<=t.i;r++)a=t.f[r],a.kind==ul?a.Sa=a.r:a.kind==fl&&(a.Sa=Math.floor(a.r+.5))
e.qh++}(e),e.p.o>=Dl&&a(e,1),null!=e.p.ob&&(e.reason=xs,e.p.ob(e,e.p.Uc),e.reason=0,e.stop)){f=Ns,u=3
break}u=2
break}if(e.A.za==jl&&function(e){var r,a,n,i,o,l,s=e.A,c=0
for(n=s.aa,r=1;r<=s.i;r++)if(l=s.f[r],l.kind==fl)switch(i=l.c,o=l.d,a=l.m,l=l.J,s.dir){case sl:a==xl?(0>l&&(l=0),n+l>=s.ta&&(Li(s,r,bl,i,i),c++)):a==yl&&(0<l&&(l=0),n-l>=s.ta&&(Li(s,r,bl,o,o),c++))
break
case cl:a==xl?(0<l&&(l=0),n+l<=s.ta&&(Li(s,r,bl,i,i),c++)):a==yl&&(0>l&&(l=0),n-l<=s.ta&&(Li(s,r,bl,o,o),c++))}e.p.o>=ql&&0!=c&&t(1==c?"One column has been fixed by reduced cost":c+" columns have been fixed by reduced costs")}(e),null!=e.p.ob){if(e.reason=ys,e.p.ob(e,e.p.Uc),e.reason=0,e.stop){f=Ns,u=3
break}if(!n(e,o)){e.p.o>=ql&&t("Current branch became hopeless and can be pruned"),u=2
break}}if(e.p.Xe&&(e.reason=ys,oe(e),e.reason=0,!n(e,o))){e.p.o>=ql&&t("Current branch became hopeless and can be pruned"),u=2
break}if(null!=e.p.ob&&(e.reason=ws,e.p.ob(e,e.p.Uc),e.reason=0,e.stop)){f=Ns,u=3
break}if(0!=e.N.La&&0!=d||(e.reason=ws,function(e){if(e.p.Ed==vs||e.p.Ad==vs||e.p.xd==vs||e.p.vd==vs){var t,a,n
for(a=e.i,1e3>a&&(a=1e3),n=0,t=e.wc+1;t<=e.A.g;t++)e.A.n[t].origin==fs&&n++
if(!(n>=a)){if(e.p.Ad==vs&&5>e.N.Rd&&W(e),e.p.Ed==vs&&J(e,e.Xf),e.p.xd==vs){t=e.A,a=Fi(t)
var i,o,l,s,c,u=Bi(t)
for(so(t),n=new Int32Array(1+u),s=new Float64Array(1+u),c=new Float64Array(1+u),u=1;u<=a;u++)for(l=1;2>=l;l++){if(o=Ni(t,u)-hl+Ys,1==l){if(o!=Hs&&o!=Ks)continue
o=Ui(t,u,n,s),s[0]=be(t,u)}else{if(o!=Us&&o!=Ks)continue
for(o=Ui(t,u,n,s),i=1;i<=o;i++)s[i]=-s[i]
s[0]=-ve(t,u)}e:{var f=t
i=n
for(var d=s,h=c,m=null,p=null,v=Array(5),b=void 0,g=void 0,y=void 0,w=y=void 0,M=void 0,_=w=w=void 0,y=0,g=1;g<=o;g++)b=i[g],Gi(f,b)-hl+Ys==Ws?d[0]-=d[g]*xe(f,b):(y++,i[y]=i[g],d[y]=d[g])
for(o=y,y=0,g=1;g<=o;g++)b=i[g],(yo(f,b)==ul?rc:tc)==tc&&Gi(f,b)-hl+Ys==Ks&&0==xe(f,b)&&1==ye(f,b)&&(y++,M=i[y],w=d[y],i[y]=i[g],d[y]=d[g],i[g]=M,d[g]=w)
if(2>y)o=0
else{for(M=w=0,g=y+1;g<=o;g++){if(b=i[g],Gi(f,b)-hl+Ys!=Ks){o=0
break e}0<d[g]?(M+=d[g]*xe(f,b),w+=d[g]*ye(f,b)):(M+=d[g]*ye(f,b),w+=d[g]*xe(f,b))}for(w-=M,_=0,g=y+1;g<=o;g++)b=i[g],_+=d[g]*bo(f,b)
for(_-=M,0>_&&(_=0),_>w&&(_=w),d[0]-=M,g=1;g<=y;g++)b=i[g],h[g]=bo(f,b),0>h[g]&&(h[g]=0),1<h[g]&&(h[g]=1)
for(g=1;g<=y;g++)0>d[g]&&(i[g]=-i[g],d[g]=-d[g],d[0]+=d[g],h[g]=1-h[g])
for(f=y,g=d[0],b=_,_=void 0,_=1;_<=f;_++);for(_=1;_<=f;_++);_=void 0
r:{for(var k=_=void 0,A=0,L=0,C=void 0,P=void 0,V=.001,C=.001*(1+Math.abs(g)),_=1;_<=f;_++)for(k=_+1;k<=f;k++){if(1e3<++A){_=L
break r}d[_]+d[k]+b>g+C&&(P=d[_]+d[k]-g,m=1/(P+w),p=2-m*P,P=h[_]+h[k]+m*b-p,V<P&&(V=P,v[1]=_,v[2]=k,L=1))}_=L}if(k=void 0,_)k=2
else{_=_=void 0
r:{for(var A=k=_=void 0,C=L=0,V=P=void 0,I=.001,P=.001*(1+Math.abs(g)),_=1;_<=f;_++)for(k=_+1;k<=f;k++)for(A=k+1;A<=f;A++){if(1e3<++L){_=C
break r}d[_]+d[k]+d[A]+b>g+P&&(V=d[_]+d[k]+d[A]-g,m=1/(V+w),p=3-m*V,V=h[_]+h[k]+h[A]+m*b-p,I<V&&(I=V,v[1]=_,v[2]=k,v[3]=A,C=1))}_=C}if(_)_=3
else{_=void 0
r:{for(var L=A=k=_=void 0,P=C=0,I=V=void 0,S=.001,V=.001*(1+Math.abs(g)),_=1;_<=f;_++)for(k=_+1;k<=f;k++)for(A=k+1;A<=f;A++)for(L=A+1;L<=f;L++){if(1e3<++C){_=P
break r}d[_]+d[k]+d[A]+d[L]+b>g+V&&(I=d[_]+d[k]+d[A]+d[L]-g,m=1/(I+w),p=4-m*I,I=h[_]+h[k]+h[A]+h[L]+m*b-p,S<I&&(S=I,v[1]=_,v[2]=k,v[3]=A,v[4]=L,P=1))}_=P}_=_?4:0}k=_}if(0==(w=k))o=0
else{for(i[0]=0,d[0]=p,b=1;b<=w;b++)v[b]=i[v[b]]
for(g=1;g<=w;g++)0<v[g]?(i[g]=+v[g],d[g]=1):(i[g]=-v[g],d[g]=-1,d[0]-=1)
for(g=y+1;g<=o;g++)w++,i[w]=i[g],d[w]=m*d[g]
d[0]+=m*M,o=w}}}if(0!=o){for(i=t,d=o,h=n,m=s,p=Bi(i),y=v=void 0,M=0,0>d&&r("lpx_eval_row: len = "+d+"; invalid row length"),y=1;y<=d;y++)v=h[y],1<=v&&v<=p||r("lpx_eval_row: j = "+v+"; column number out of range"),M+=m[y]*bo(i,v)
i=M-s[0],.001>i||x(e,ms,o,n,s,pl,s[0])}}}e.p.vd==vs&&null!=e.Ne&&(0==e.N.La&&50>e.N.Rd||0<e.N.La&&5>e.N.Rd)&&(a=e.Ne,n=Bi(e.A),t=new Int32Array(1+n),n=new Float64Array(1+n),0<(a=ee(e.A,a,t,n))&&x(e,ps,a,t,n,pl,n[0]))}}}(e),e.reason=0),0<e.Bd.size&&(e.reason=ws,le(e),e.reason=0),R(e.Bd),e.pe){e.pe=0,e.N.Rd++,u=1
break}if(function(e){var r,t=0,a=null
for(r=e.wc+1;r<=e.A.g;r++)e.A.n[r].origin==fs&&e.A.n[r].La==e.N.La&&e.A.n[r].m==gl&&(null==a&&(a=new Int32Array(1+e.A.g)),a[++t]=r)
0<t&&(Si(e.A,t,a),Co(e.A))}(e),e.p.o>=Gl&&0==e.N.La&&i(e),null!=e.Fd&&ne(e),null!=e.p.ob&&(e.reason=Ms,e.p.ob(e,e.p.Uc),e.reason=0,e.stop)){f=Ns,u=3
break}if(0==e.Tc&&(e.Tc=re(e,function(r){e.Jf=r})),c=e.N.s,f=function(e,r,a){var n,i,o,l,s,c,u,f,d,h,m,p=e.A,v=p.g,b=Array(3),g=null,x=null
switch(i=p.f[r].type,u=p.f[r].c,f=p.f[r].d,n=p.f[r].r,d=Math.floor(n),h=Math.ceil(n),i){case hl:o=pl,l=ml
break
case ml:o=u==d?bl:vl,l=ml
break
case pl:o=pl,l=h==f?bl:vl
break
case vl:o=u==d?bl:vl,l=h==f?bl:vl}return F(e,r,function(e,r){g=e,x=r}),i=B(e,g),m=B(e,x),s=!z(e,i),c=!z(e,m),s&&c?(e.p.o>=ql&&t("Both down- and up-branches are hopeless"),2):c?(e.p.o>=ql&&t("Up-branch is hopeless"),Li(p,r,o,u,d),e.N.rc=g,p.dir==sl?e.N.bound<i&&(e.N.bound=i):p.dir==cl&&e.N.bound>i&&(e.N.bound=i),1):s?(e.p.o>=ql&&t("Down-branch is hopeless"),Li(p,r,l,h,f),e.N.rc=x,p.dir==sl?e.N.bound<m&&(e.N.bound=m):p.dir==cl&&e.N.bound>m&&(e.N.bound=m),1):(e.p.o>=ql&&t("Branching on column "+r+", primal value is "+n),s=e.N.s,e.N.Tc=r,e.N.tg=n,O(e),X(e,s,b),e.p.o>=ql&&t("Node "+b[1]+" begins down branch, node "+b[2]+" begins up branch "),n=e.ya[b[1]].rb,n.Na={},n.Na.pc=v+r,n.Na.type=o,n.Na.c=u,n.Na.d=d,n.Na.e=null,n.rc=g,p.dir==sl?n.bound<i&&(n.bound=i):p.dir==cl&&n.bound>i&&(n.bound=i),n=e.ya[b[2]].rb,n.Na={},n.Na.pc=v+r,n.Na.type=l,n.Na.c=h,n.Na.d=f,n.Na.e=null,n.rc=x,p.dir==sl?n.bound<m&&(n.bound=m):p.dir==cl&&n.bound>m&&(n.bound=m),a==As?e.ud=0:a==Ls?e.ud=b[1]:a==Cs&&(e.ud=b[2]),0)}(e,e.Tc,e.Jf),e.Tc=e.Jf=0,0==f){d=c,u=0
break}if(1==f){e.N.eg=e.N.Rd=0,u=1
break}if(2==f){u=2
break}case 2:e.p.o>=ql&&t("Node "+o+" fathomed"),O(e),E(e,o),e.A.za==jl&&function(e){var r,a,i=0
for(r=e.head;null!=r;r=a)a=r.e,n(e,r.s)||(E(e,r.s),i++)
e.p.o>=ql&&(1==i?t("One hopeless branch has been pruned"):1<i&&t(i+" hopeless branches have been pruned"))}(e),u=d=0
break
case 3:return e.p.o>=Dl&&a(e,0),e.Xf=null,e.Ne=null,f}if(null==u)break
c=u}}function q(e){var r
return r={},r.i=e,r.L=0,r.Ja=new Int32Array(1+e),r.Z=new Int32Array(1+e),r.j=new Float64Array(1+e),r}function Y(e,r,t){var a=e.Ja[r]
0==t?0!=a&&(e.Ja[r]=0,a<e.L&&(e.Ja[e.Z[e.L]]=a,e.Z[a]=e.Z[e.L],e.j[a]=e.j[e.L]),e.L--):(0==a&&(a=++e.L,e.Ja[r]=a,e.Z[a]=r),e.j[a]=t)}function U(e){for(var r=1;r<=e.L;r++)e.Ja[e.Z[r]]=0
e.L=0}function H(e,r){for(var t=0,a=1;a<=e.L;a++)0==Math.abs(e.j[a])||Math.abs(e.j[a])<r?e.Ja[e.Z[a]]=0:(t++,e.Ja[e.Z[a]]=t,e.Z[t]=e.Z[a],e.j[t]=e.j[a])
e.L=t}function K(e,r){U(e),e.L=r.L,n(e.Z,1,r.Z,1,e.L),n(e.j,1,r.j,1,e.L)
for(var t=1;t<=e.L;t++)e.Ja[e.Z[t]]=t}function W(e){function r(e){return e-Math.floor(e)}var t,a,n=e.A,i=n.g,o=n.i,l={}
for(t=Array(1+o),l.Z=new Int32Array(1+o),l.j=new Float64Array(1+o),l.kh=new Float64Array(1+i+o),i=0,a=1;a<=o;a++){var s=n.f[a]
s.kind==fl&&s.type!=bl&&s.m==gl&&.05<=(s=r(s.r))&&.95>=s&&(i++,t[i].C=a,t[i].Nb=s)}for(c(t,i,function(e,r){return e.Nb>r.Nb?-1:e.Nb<r.Nb?1:0}),o=g(e),n=1;n<=i&&!(50<=g(e)-o);n++)!function(e,t,a){var n=e.A,i=n.g,o=n.i,l=t.Z,s=t.j
t=t.kh
var c,u,f,d,h,m,p,v,b,g,y
for(u=Eo(n,i+a,l,s),v=n.f[a].r,c=1;c<=i+o;c++)t[c]=0
for(y=r(v),a=1;a<=u;a++){if(c=l[a],c<=i?(d=n.n[c],f=ul):(d=n.f[c-i],f=d.kind),h=d.c,m=d.d,d=d.m,b=s[a],1e5<Math.abs(b))return
if(!(1e-10>Math.abs(b))){switch(d){case wl:return
case xl:p=-b
break
case yl:p=+b
break
case Ml:continue}switch(f){case fl:if(1e-10>Math.abs(p-Math.floor(p+.5)))continue
g=r(p)<=r(v)?r(p):r(v)/(1-r(v))*(1-r(p))
break
case ul:g=0<=p?+p:r(v)/(1-r(v))*-p}switch(d){case xl:t[c]=+g,y+=g*h
break
case yl:t[c]=-g,y-=g*m}}}for(a=1;a<=i;a++)if(!(1e-10>Math.abs(t[a])))for(d=n.n[a],p=d.k;null!=p;p=p.B)t[i+p.f.C]+=t[a]*p.j
for(u=0,a=1;a<=o;a++)1e-10>Math.abs(t[i+a])||(d=n.f[a],d.type==bl?y-=t[i+a]*d.c:(u++,l[u]=a,s[u]=t[i+a]))
for(1e-12>Math.abs(y)&&(y=0),c=1;c<=u;c++)if(.001>Math.abs(s[c])||1e3<Math.abs(s[c]))return
x(e,ds,u,l,s,ml,y)}(e,l,t[n].C)}function Z(e){var r,a=e.A,n=a.g,a=a.i
return rl&&t("ios_mir_init: warning: debug mode enabled"),r={},r.g=n,r.i=a,r.Eb=new Int8Array(1+n),r.ab=new Int8Array(1+n+a),r.c=new Float64Array(1+n+a),r.Yb=new Int32Array(1+n+a),r.d=new Float64Array(1+n+a),r.zb=new Int32Array(1+n+a),r.x=new Float64Array(1+n+a),r.Ef=new Int32Array(1+tl),r.Ya=q(n+a),r.lb=new Int8Array(1+n+a),r.oa=q(n+a),r.G=q(n+a),function(e,r){var t,a=e.A,n=r.g
for(t=1;t<=n;t++){var i=a.n[t]
switch(r.Eb[t]=0,r.ab[t]=0,i.type){case hl:r.c[t]=-hi,r.d[t]=+hi
break
case ml:r.c[t]=i.c,r.d[t]=+hi
break
case pl:r.c[t]=-hi,r.d[t]=i.d
break
case vl:r.c[t]=i.c,r.d[t]=i.d
break
case bl:r.c[t]=r.d[t]=i.c}r.Yb[t]=r.zb[t]=0}}(e,r),function(e,r){var t,a=e.A,n=r.g,i=r.i
for(t=n+1;t<=n+i;t++){var o=a.f[t-n]
switch(o.kind){case ul:r.ab[t]=0
break
case fl:r.ab[t]=1}switch(o.type){case hl:r.c[t]=-hi,r.d[t]=+hi
break
case ml:r.c[t]=o.c,r.d[t]=+hi
break
case pl:r.c[t]=-hi,r.d[t]=o.d
break
case vl:r.c[t]=o.c,r.d[t]=o.d
break
case bl:r.c[t]=r.d[t]=o.c}r.Yb[t]=r.zb[t]=0}}(e,r),function(e,r){var t,a,n,i,o,l,s=e.A,c=r.g
for(a=1;a<=c;a++)if((0==r.c[a]&&r.d[a]==+hi||r.c[a]==-hi&&0==r.d[a])&&null!=(t=s.n[a].k)&&(n=c+t.f.C,o=t.j,null!=(t=t.B)&&(i=c+t.f.C,l=t.j,null==t.B))){if(r.ab[n]||!r.ab[i]){if(!r.ab[n]||r.ab[i])continue
i=n,l=o,n=c+t.f.C,o=t.j}r.c[i]!=-hi&&r.d[i]!=+hi&&r.c[i]!=r.d[i]&&(0==r.d[a]&&(o=-o,l=-l),0<o?0==r.Yb[n]&&(r.c[n]=-l/o,r.Yb[n]=i,r.Eb[a]=1):0==r.zb[n]&&(r.d[n]=-l/o,r.zb[n]=i,r.Eb[a]=1))}}(e,r),function(e,r){var t,a,n,i,o=e.A,l=r.g
for(a=1;a<=l;a++)if(r.c[a]==-hi&&r.d[a]==+hi)r.Eb[a]=1
else{for(i=0,t=o.n[a].k;null!=t;t=t.B){if(n=l+t.f.C,r.c[n]==-hi&&r.d[n]==+hi){r.Eb[a]=1
break}if(r.ab[n]&&r.c[n]==-hi||r.ab[n]&&r.d[n]==+hi){r.Eb[a]=1
break}0==r.Yb[n]&&0==r.zb[n]&&r.c[n]==r.d[n]||i++}0==i&&(r.Eb[a]=1)}}(e,r),r}function J(e,r){function t(e,r,t,i,o,l,s){function u(e,r,t,i,o,l,s){var c
for(c=t,t=1;t<=e;t++)s[t]=r[t]/l,o[t]&&(s[t]=-s[t]),c-=r[t]*i[t]
r=c/l
var u
if(.01>Math.abs(r-Math.floor(r+.5)))r=1
else{for(c=r-Math.floor(r),t=1;t<=e;t++)u=s[t]-Math.floor(s[t])-c,s[t]=0>=u?Math.floor(s[t]):Math.floor(s[t])+u/(1-c)
a=Math.floor(r),n=1/(1-c),r=0}if(r)return 1
for(t=1;t<=e;t++)o[t]&&(s[t]=-s[t],a+=s[t]*i[t])
return n/=l,0}var f,d,h,m,p
h=Array(4)
var v,b,g,x
for(g=new Int8Array(1+e),x=Array(1+e),d=1;d<=e;d++)g[d]=o[d]>=.5*i[d]
for(b=p=0,d=1;d<=e;d++)if(f=1e-9*(1+Math.abs(i[d])),!(o[d]<f||o[d]>i[d]-f||(f=u(e,r,t,i,g,Math.abs(r[d]),s)))){for(v=-a-n*l,f=1;f<=e;f++)v+=s[f]*o[f]
b<v&&(b=v,p=Math.abs(r[d]))}if(.001>b&&(b=0),0==b)return b
for(h[1]=p/2,h[2]=p/4,h[3]=p/8,d=1;3>=d;d++)if(!(f=u(e,r,t,i,g,h[d],s))){for(v=-a-n*l,f=1;f<=e;f++)v+=s[f]*o[f]
b<v&&(b=v,p=h[d])}for(h=0,d=1;d<=e;d++)f=1e-9*(1+Math.abs(i[d])),o[d]<f||o[d]>i[d]-f||(h++,x[h].C=d,x[h].xf=Math.abs(o[d]-.5*i[d]))
for(c(x,h,function(e,r){return e.xf<r.xf?-1:e.xf>r.xf?1:0}),m=1;m<=h;m++)if(d=x[m].C,g[d]=!g[d],f=u(e,r,t,i,g,p,s),g[d]=!g[d],!f){for(v=-a-n*l,f=1;f<=e;f++)v+=s[f]*o[f]
b<v&&(b=v,g[d]=!g[d])}return f=u(e,r,t,i,g,p,s),b}var a,n,o,l,s,u=r.g,f=r.i
for(function(e,r){var t,a=e.A,n=r.g,i=r.i
for(t=1;t<=n;t++)r.x[t]=a.n[t].r
for(t=n+1;t<=n+i;t++)r.x[t]=a.f[t-n].r}(e,r),i(r.lb,1,al,u+f),o=1;o<=u;o++)if(!r.Eb[o]){for(function(e,r,t){var a=e.A
for(e=r.g,r.Eb[t]=2,r.Je=1,r.Ef[1]=t,U(r.Ya),Y(r.Ya,t,1),t=a.n[t].k;null!=t;t=t.B)Y(r.Ya,e+t.f.C,-t.j)
r.Df=0}(e,r,o);;){if(function(e){var r,t
for(r=1;r<=e.Ya.L;r++)t=e.Ya.Z[r],0==e.Yb[t]&&0==e.zb[t]&&e.c[t]==e.d[t]&&(e.Df-=e.Ya.j[r]*e.c[t],e.Ya.j[r]=0)
H(e.Ya,2.220446049250313e-16)}(r),rl)for(l=1;l<=u+f;l++);!function(e){var r,t,a,n
for(r=1;r<=e.Ya.L;r++)t=e.Ya.Z[r],e.ab[t]||(a=e.Yb[t],n=0==a?e.c[t]==-hi?hi:e.x[t]-e.c[t]:e.x[t]-e.c[t]*e.x[a],a=e.zb[t],a=0==a?e.zb[t]==+hi?hi:e.d[t]-e.x[t]:e.d[t]*e.x[a]-e.x[t],e.lb[t]=n<=a?nl:il)}(r),function(e){var r,t,a,n
for(K(e.oa,e.Ya),e.tc=e.Df,r=e.oa.L;1<=r;r--)a=e.oa.Z[r],e.ab[a]||(e.lb[a]==nl?(n=e.Yb[a],0==n?e.tc-=e.oa.j[r]*e.c[a]:(t=e.oa.Ja[n],0==t&&(Y(e.oa,n,1),t=e.oa.Ja[n],e.oa.j[t]=0),e.oa.j[t]+=e.oa.j[r]*e.c[a])):e.lb[a]==il&&(n=e.zb[a],0==n?e.tc-=e.oa.j[r]*e.d[a]:(t=e.oa.Ja[n],0==t&&(Y(e.oa,n,1),t=e.oa.Ja[n],e.oa.j[t]=0),e.oa.j[t]+=e.oa.j[r]*e.d[a]),e.oa.j[r]=-e.oa.j[r]))
for(r=1;r<=e.oa.L;r++)a=e.oa.Z[r],e.ab[a]&&(Math.abs(e.c[a])<=Math.abs(e.d[a])?(e.lb[a]=nl,e.tc-=e.oa.j[r]*e.c[a]):(e.lb[a]=il,e.tc-=e.oa.j[r]*e.d[a],e.oa.j[r]=-e.oa.j[r]))}(r),s=function(e){var r,a,n,i,o,l,s,c=e.g,u=e.i
for(o=0,K(e.G,e.oa),e.Lb=e.tc,H(e.G,2.220446049250313e-16),r=1;r<=e.G.L;r++)a=e.G.Z[r],!e.ab[a]&&0<e.G.j[r]&&(e.G.j[r]=0)
for(H(e.G,0),i=0,r=1;r<=e.G.L;r++)a=e.G.Z[r],e.ab[a]&&(i++,n=e.G.Z[i],e.G.Ja[a]=i,e.G.Ja[n]=r,e.G.Z[i]=a,e.G.Z[r]=n,a=e.G.j[i],e.G.j[i]=e.G.j[r],e.G.j[r]=a)
if(0==i)return o
for(l=new Float64Array(1+i),n=new Float64Array(1+i),s=new Float64Array(1+i),r=1;r<=i;r++)a=e.G.Z[r],l[r]=e.d[a]-e.c[a],e.lb[a]==nl?n[r]=e.x[a]-e.c[a]:e.lb[a]==il&&(n[r]=e.d[a]-e.x[a]),0>n[r]&&(n[r]=0)
for(o=0,r=i+1;r<=e.G.L;r++)a=e.G.Z[r],e.lb[a]==nl?(n=e.Yb[a],n=0==n?e.x[a]-e.c[a]:e.x[a]-e.c[a]*e.x[n]):e.lb[a]==il&&(n=e.zb[a],n=0==n?e.d[a]-e.x[a]:e.d[a]*e.x[n]-e.x[a]),0>n&&(n=0),o-=e.G.j[r]*n
if(0==(o=t(i,e.G.j,e.Lb,l,n,o,s)))return o
for(r=1;r<=i;r++)e.G.j[r]=s[r]
for(r=i+1;r<=e.G.L;r++)(a=e.G.Z[r])<=c+u&&(e.G.j[r]*=0)
return e.Lb=null,o}(r),0<s&&(function(e){var r,t,a,n
for(r=1;r<=e.G.L;r++)a=e.G.Z[r],e.ab[a]&&(e.lb[a]==nl?e.Lb+=e.G.j[r]*e.c[a]:e.lb[a]==il&&(e.Lb-=e.G.j[r]*e.d[a],e.G.j[r]=-e.G.j[r]))
for(r=1;r<=e.G.L;r++)a=e.G.Z[r],e.ab[a]||(e.lb[a]==nl?(n=e.Yb[a],0==n?e.Lb+=e.G.j[r]*e.c[a]:(t=e.G.Ja[n],0==t&&(Y(e.G,n,1),t=e.G.Ja[n],e.G.j[t]=0),e.G.j[t]-=e.G.j[r]*e.c[a])):e.lb[a]==il&&(n=e.zb[a],0==n?e.Lb-=e.G.j[r]*e.d[a]:(t=e.G.Ja[n],0==t&&(Y(e.G,n,1),t=e.G.Ja[n],e.G.j[t]=0),e.G.j[t]+=e.G.j[r]*e.d[a]),e.G.j[r]=-e.G.j[r]))}(r),function(e,r){var t,a,n,i,o=e.A,l=r.g
for(a=r.G.L;1<=a;a--)if(!((t=r.G.Z[a])>l)){for(t=o.n[t].k;null!=t;t=t.B)n=l+t.f.C,i=r.G.Ja[n],0==i&&(Y(r.G,n,1),i=r.G.Ja[n],r.G.j[i]=0),r.G.j[i]+=r.G.j[a]*t.j
r.G.j[a]=0}H(r.G,0)}(e,r),function(e,r){var t,a,n=r.g,i=r.i,o=new Int32Array(1+i),l=new Float64Array(1+i)
for(a=0,i=r.G.L;1<=i;i--)t=r.G.Z[i],a++,o[a]=t-n,l[a]=r.G.j[i]
x(e,hs,a,o,l,pl,r.Lb)}(e,r))
for(var d=1;d<=r.oa.L;d++)l=r.oa.Z[d],r.lb[l]=al
if(!(0==s&&r.Je<tl&&0==function(e,r){var t,a,n,i,o=e.A,l=r.g,s=r.i,c=0,u=0
for(t=1;t<=r.Ya.L;t++)(a=r.Ya.Z[t])<=l||r.ab[a]||.001>Math.abs(r.Ya.j[t])||(n=r.Yb[a],i=0==n?r.c[a]==-hi?hi:r.x[a]-r.c[a]:r.x[a]-r.c[a]*r.x[n],n=r.zb[a],n=0==n?r.zb[a]==+hi?hi:r.d[a]-r.x[a]:r.d[a]*r.x[n]-r.x[a],!(.001>(i=i<=n?i:n))&&u<i&&(u=i,c=a))
if(0==c)return 1
for(a=1;a<=l;a++)if(!r.Eb[a]){for(t=o.n[a].k;null!=t&&t.f.C!=c-l;t=t.B);if(null!=t&&.001<=Math.abs(t.j))break}if(a>l)return 2
for(r.Je++,r.Ef[r.Je]=a,r.Eb[a]=2,s=q(l+s),Y(s,a,1),t=o.n[a].k;null!=t;t=t.B)Y(s,l+t.f.C,-t.j)
for(t=r.Ya.Ja[c],o=r.Ya,l=-r.Ya.j[t]/s.j[s.Ja[c]],a=1;a<=s.L;a++)t=s.Z[a],u=void 0,u=o.Ja[t],u=0==u?0:o.j[u],i=s.j[a],Y(o,t,u+l*i)
return Y(r.Ya,c,0),0}(e,r)))break}for(l=1;l<=r.Je;l++)s=r.Ef[l],r.Eb[s]=0}}function Q(e){function r(e,r){var t
switch(Ni(e,r)-hl+Ys){case Ys:case Hs:t=-hi
break
case Us:case Ks:case Ws:t=ve(e,r)}return t}function a(e,r){var t
switch(Ni(e,r)-hl+Ys){case Ys:case Us:t=+hi
break
case Hs:case Ks:case Ws:t=be(e,r)}return t}function n(e,r){var t
switch(Gi(e,r)-hl+Ys){case Ys:case Hs:t=-hi
break
case Us:case Ks:case Ws:t=xe(e,r)}return t}function i(e,r){var t
switch(Gi(e,r)-hl+Ys){case Ys:case Us:t=+hi
break
case Hs:case Ks:case Ws:t=ye(e,r)}return t}function o(e,r){return(yo(e,r)==ul?rc:tc)==tc&&Gi(e,r)-hl+Ys==Ks&&0==xe(e,r)&&1==ye(e,r)}function l(e,r,t,a){var o,l,s
for(s=0,l=1;l<=r;l++)if(o=t[l],0<a[l]){if((o=n(e,o))==-hi){s=-hi
break}s+=a[l]*o}else if(0>a[l]){if((o=i(e,o))==+hi){s=-hi
break}s+=a[l]*o}return s}function s(e,r,t,a){var o,l,s
for(s=0,l=1;l<=r;l++)if(o=t[l],0<a[l]){if((o=i(e,o))==+hi){s=+hi
break}s+=a[l]*o}else if(0>a[l]){if((o=n(e,o))==-hi){s=+hi
break}s+=a[l]*o}return s}function c(e,r,t,a,n,i,o,l){return r!=-hi&&o&&(r-=e[i]),t!=+hi&&o&&(t-=e[i]),a!=-hi&&(0>e[i]&&(a-=e[i]),0>e[l]&&(a-=e[l])),n!=+hi&&(0<e[i]&&(n-=e[i]),0<e[l]&&(n-=e[l])),.001<(i=0<e[l]?r==-hi||n==+hi?-hi:(r-n)/e[l]:t==+hi||a==-hi?-hi:(t-a)/e[l])?2:(i=0<e[l]?t==+hi||a==-hi?+hi:(t-a)/e[l]:r==-hi||n==+hi?+hi:(r-n)/e[l],.999>i?1:0)}var u,f,d,h,m,p,v,b,g,x,y,w,M,_,k,A,L=null
for(t("Creating the conflict graph..."),u=Fi(e),f=Bi(e),d=0,x=new Int32Array(1+f),y=new Int32Array(1+f),g=new Int32Array(1+f),A=new Float64Array(1+f),h=1;h<=u;h++)if(!(w=r(e,h),M=a(e,h),w==-hi&&M==+hi||500<(b=Ui(e,h,g,A))))for(_=l(e,b,g,A),k=s(e,b,g,A),p=1;p<=b;p++)if(o(e,g[p]))for(v=p+1;v<=b;v++)o(e,g[v])&&(c(A,w,M,_,k,p,0,v)||c(A,w,M,_,k,p,1,v))&&(m=g[p],0==x[m]&&(d++,x[m]=d,y[d]=m),m=g[v],0==x[m]&&(d++,x[m]=d,y[d]=m))
if(0==d||4e3<d)return t("The conflict graph is either empty or too big"),L
for(L={},L.i=f,L.Cb=d,L.Dg=0,L.yf=x,L.ge=y,b=d+d,b=(b*(b-1)/2+0)/1,L.Jc=Array(b),m=1;m<=d;m++)$(L,+y[m],-y[m])
for(h=1;h<=u;h++)if(!(w=r(e,h),M=a(e,h),w==-hi&&M==+hi||500<(b=Ui(e,h,g,A))))for(_=l(e,b,g,A),k=s(e,b,g,A),p=1;p<=b;p++)if(o(e,g[p]))for(v=p+1;v<=b;v++)if(o(e,g[v])){switch(c(A,w,M,_,k,p,0,v)){case 1:$(L,-g[p],+g[v])
break
case 2:$(L,-g[p],-g[v])}switch(c(A,w,M,_,k,p,1,v)){case 1:$(L,+g[p],+g[v])
break
case 2:$(L,+g[p],-g[v])}}return t("The conflict graph has 2*"+L.Cb+" vertices and "+L.Dg+" edges"),L}function $(e,r,t){var a
0<r?r=e.yf[r]:(r=e.yf[-r],r+=e.Cb),0<t?t=e.yf[t]:(t=e.yf[-t],t+=e.Cb),r<t&&(a=r,r=t,t=a),a=(r-1)*(r-2)/2+(t-1),e.Jc[a/1]|=1<<0-a%1,e.Dg++}function ee(e,r,a,n){function i(e,r,t){return r==t?0:r>t?o(e,r*(r-1)/2+t):o(e,t*(t-1)/2+r)}function o(e,r){return e.Jc[r/1]&1<<0-r%1}function c(e,r,t,a,n,o){var l,s,u,f,d,h,m,p
if(p=new Int32Array(e.i),0>=r){if(0==r&&(e.set[a++]=t[0],n+=o),n>e.gd)for(e.gd=n,e.bg=a,l=0;l<a;l++)e.oh[l+1]=e.set[l]}else for(l=r;0<=l&&!(0==a&&l<r)&&(u=t[l],!(0<a&&e.wg[u]<=e.gd-n))&&(e.set[a]=u,f=n+e.Ic[u+1],!((o-=e.Ic[u+1])<=e.gd-f));l--){for(d=m=h=0;m<t+l;)s=t[m],m++,i(e,s,u)&&(p[h]=s,h++,d+=e.Ic[s+1])
d<=e.gd-f||c(e,h-1,p,a+1,f,d)}}var u,f,d,h,m,p,v=Bi(e),b=0
for(d=new Int32Array(1+2*r.Cb),h=new Int32Array(1+2*r.Cb),p=new Float64Array(1+v),f=1;f<=r.Cb;f++)u=r.ge[f],u=bo(e,u),u=100*u+.5|0,0>u&&(u=0),100<u&&(u=100),d[f]=u,d[r.Cb+f]=100-u
for(d=function(e,r,a,n){var o,u,f,d,h,m,p={}
for(p.i=e,p.Ic=r,p.Jc=a,p.gd=0,p.bg=0,p.oh=n,p.wg=new Int32Array(p.i),p.set=new Int32Array(p.i),h=new Int32Array(p.i),m=new Int32Array(p.i),r=new Int32Array(p.i),a=l(),e=0;e<p.i;e++)for(o=m[e]=0;o<p.i;o++)i(p,e,o)&&(m[e]+=p.Ic[o+1])
for(e=0;e<p.i;e++)h[e]=0
for(e=p.i-1;0<=e;e--){for(d=f=-1,o=0;o<p.i;o++)!h[o]&&(p.Ic[o+1]>f||p.Ic[o+1]==f&&m[o]>d)&&(f=p.Ic[o+1],d=m[o],u=o)
for(r[e]=u,h[u]=1,o=0;o<p.i;o++)!h[o]&&o!=u&&i(p,u,o)&&(m[o]-=p.Ic[u+1])}for(e=u=0;e<p.i;e++)u+=p.Ic[r[e]+1],c(p,e,r,0,0,u),p.wg[r[e]]=p.gd,4.999<=s(a)&&(t("level = "+e+"1 ("+p.i+"); best = "+p.gd),a=l())
for(e=1;e<=p.bg;e++)n[e]++
return p.bg}(2*r.Cb,d,r.Jc,h),m=0,f=1;f<=d;f++)u=h[f],u<=r.Cb?(u=r.ge[u],u=bo(e,u),m+=u):(u=r.ge[u-r.Cb],u=bo(e,u),m+=1-u)
if(1.01<=m){for(f=e=1;f<=d;f++)u=h[f],u<=r.Cb?(u=r.ge[u],p[u]+=1):(u=r.ge[u-r.Cb],p[u]-=1,e-=1)
for(u=1;u<=v;u++)0!=p[u]&&(b++,a[b]=u,n[b]=p[u])
a[0]=0,n[0]=e}return b}function re(e,r){var a
if(e.p.Jb==Ql){var n,i
for(n=1;n<=e.i&&!e.ad[n];n++);i=bo(e.A,n),r(i-Math.floor(i)<Math.ceil(i)-i?Ls:Cs),a=n}else if(e.p.Jb==$l){for(n=e.i;1<=n&&!e.ad[n];n--);i=bo(e.A,n),r(i-Math.floor(i)<Math.ceil(i)-i?Ls:Cs),a=n}else if(e.p.Jb==es)a=te(e,r)
else if(e.p.Jb==rs){a=e.A
var o,l,s,c,u,f,d,h,m,p,v,b,g,x,y=a.g,w=a.i,M=e.ad
for(so(a),d=new Int32Array(1+w),x=new Float64Array(1+w),l=0,g=-1,o=1;o<=w;o++)if(M[o]){for(h=bo(a,o),f=Eo(a,y+o,d,x),u=-1;1>=u;u+=2){if(s=To(a,f,d,x,u,1e-9),0!=s&&(s=d[s]),0==s)s=e.A.dir==sl?+hi:-hi
else{for(c=1;c<=f&&d[c]!=s;c++);switch(c=x[c],m=(0>u?Math.floor(h):Math.ceil(h))-h,m/=c,s>y&&yo(a,s-y)!=ul&&.001<Math.abs(m-Math.floor(m+.5))&&(m=0<m?Math.ceil(m):Math.floor(m)),s<=y?(c=ho(a,s),s=po(a,s)):(c=vo(a,s-y),s=go(a,s-y)),e.A.dir){case sl:(c==xl&&0>s||c==yl&&0<s||c==wl)&&(s=0)
break
case cl:(c==xl&&0<s||c==yl&&0>s||c==wl)&&(s=0)}s*=m}0>u?i=s:p=s}if((g<Math.abs(i)||g<Math.abs(p))&&(l=o,Math.abs(i)<Math.abs(p)?(n=Ls,g=Math.abs(p)):(n=Cs,g=Math.abs(i)),v=i,b=p,g==hi))break}g<1e-6*(1+.001*Math.abs(a.aa))?l=te(e,r):(e.p.o>=ql&&(t("branch_drtom: column "+l+" chosen to branch on"),t(Math.abs(v)==hi?"branch_drtom: down-branch is infeasible":"branch_drtom: down-branch bound is "+(fo(a)+v)),t(Math.abs(b)==hi?"branch_drtom: up-branch   is infeasible":"branch_drtom: up-branch   bound is "+(fo(a)+b))),r(n)),a=l}else e.p.Jb==ts&&(a=ie(e,r))
return a}function te(e,r){var t,a,n,i,o,l
for(a=0,o=hi,t=1;t<=e.i;t++)e.ad[t]&&(i=bo(e.A,t),l=Math.floor(i)+.5,o>Math.abs(i-l)&&(a=t,o=Math.abs(i-l),n=i<l?Ls:Cs))
return r(n),a}function ae(e){e=e.i
var r,t={}
for(t.yd=new Int32Array(1+e),t.Ud=new Float64Array(1+e),t.Id=new Int32Array(1+e),t.ye=new Float64Array(1+e),r=1;r<=e;r++)t.yd[r]=t.Id[r]=0,t.Ud[r]=t.ye[r]=0
return t}function ne(e){var r,t,a=e.Fd
null!=e.N.R&&(r=e.N.R.Tc,t=e.A.f[r].r-e.N.R.tg,e=e.A.aa-e.N.R.rc,e=Math.abs(e/t),0>t?(a.yd[r]++,a.Ud[r]+=e):(a.Id[r]++,a.ye[r]+=e))}function ie(e,r){function a(e,r,t){var a,n
return so(e),a=bi(),ji(a,e,0),Li(a,r,bl,t,t),r=new lo,r.o=Nl,r.cb=Hl,r.oc=30,r.fb=1e3,r.cb=Hl,r=oo(a,r),0==r||r==Es?co(a)==Xl?n=hi:uo(a)==jl?(e.dir==sl?n=a.aa-e.aa:e.dir==cl&&(n=e.aa-a.aa),n<1e-6*(1+.001*Math.abs(e.aa))&&(n=0)):n=0:n=0,n}function n(e,r,t){var n,i=e.Fd
if(t==Ls){if(0==i.yd[r]){if(t=e.A.f[r].r,(e=a(e.A,r,Math.floor(t)))==hi)return n=hi
i.yd[r]=1,i.Ud[r]=e/(t-Math.floor(t))}n=i.Ud[r]/i.yd[r]}else if(t==Cs){if(0==i.Id[r]){if(t=e.A.f[r].r,(e=a(e.A,r,Math.ceil(t)))==hi)return n=hi
i.Id[r]=1,i.ye[r]=e/(Math.ceil(t)-t)}n=i.ye[r]/i.Id[r]}return n}var i,o,c,u,f,d,h,m=l()
for(null==e.Fd&&(e.Fd=ae(e)),o=0,h=-1,i=1;i<=e.i;i++)if(y(e,i)){if(u=e.A.f[i].r,(f=n(e,i,Ls))==hi)return o=i,c=Ls,r(c),o
if(d=f*(u-Math.floor(u)),(f=n(e,i,Cs))==hi)return o=i,c=Cs,r(c),o
u=f*(Math.ceil(u)-u),f=d>u?d:u,h<f&&(h=f,o=i,c=d<=u?Ls:Cs),e.p.o>=vs&&10<=s(m)&&(function(e){var r,a=e.Fd,n=0,i=0
for(r=1;r<=e.i;r++)y(e,r)&&(n++,0<a.yd[r]&&0<a.Id[r]&&i++)
t("Pseudocosts initialized for "+i+" of "+n+" variables")}(e),m=l())}return 0==h?o=te(e,r):(r(c),o)}function oe(e){var r,a,n,i,l,u,f,d,h=e.A,m=h.i,p=null,v=null,b=null
for(i=0;;){var g=null
switch(i){case 0:if(so(h),0!=e.N.La||1!=e.N.eg){g=5
break}for(f=0,n=1;n<=m;n++)if(r=h.f[n],r.kind!=ul&&r.type!=bl){if(r.type!=vl||0!=r.c||1!=r.d){e.p.o>=Gl&&t("FPUMP heuristic cannot be applied due to general integer variables"),g=5
break}f++}if(null!=g)break
if(0==f){g=5
break}for(e.p.o>=Gl&&t("Applying FPUMP heuristic..."),v=Array(1+f),o(v,1,f),i=0,n=1;n<=m;n++)r=h.f[n],r.kind==fl&&r.type==vl&&(v[++i].C=n)
p=bi()
case 1:if(ji(p,h,bs),h.za==jl){for(wi(p,1),l=new Int32Array(1+m),u=new Float64Array(1+m),n=1;n<=m;n++)l[n]=n,u[n]=h.f[n].u
Pi(p,p.g,m,l,u),l=.1*h.aa+.9*h.ta,h.dir==sl?Ai(p,p.g,pl,0,l-h.ha):h.dir==cl&&Ai(p,p.g,ml,l-h.ha,0)}for(u=0,i=1;i<=f;i++)v[i].x=-1
case 2:if(u++,e.p.o>=Gl&&t("Pass "+u),d=hi,l=0,1<u){for(null==b&&(b=ti()),i=1;i<=f;i++)n=v[i].C,r=p.f[n],g=oi(b),0>g&&(g=0),.5<(r=Math.abs(v[i].x-r.r))+g&&(v[i].x=1-v[i].x)
g=4
break}case 3:for(i=a=1;i<=f;i++)r=p.f[v[i].C],r=.5>r.r?0:1,v[i].x!=r&&(a=0,v[i].x=r)
if(a){for(i=1;i<=f;i++)r=p.f[v[i].C],v[i].Td=Math.abs(r.r-v[i].x)
for(c(v,f,function(e,r){return e.Td>r.Td?-1:e.Td<r.Td?1:0}),i=1;i<=f&&!(5<=i&&.35>v[i].Td||10<=i);i++)v[i].x=1-v[i].x}case 4:if(2147483647>e.p.sb&&e.p.sb-1<=1e3*s(e.hc)){g=5
break}for(p.dir=sl,p.ha=0,n=1;n<=m;n++)p.f[n].u=0
for(i=1;i<=f;i++)n=v[i].C,0==v[i].x?p.f[n].u=1:(p.f[n].u=-1,p.ha+=1)
if(a=new lo,e.p.o<=Rl?a.o=e.p.o:e.p.o<=Gl&&(a.o=Dl,a.fb=1e4),0!=(i=oo(p,a))){e.p.o>=Rl&&t("Warning: glp_simplex returned "+i),g=5
break}if((i=so(p))!=El){e.p.o>=Rl&&t("Warning: glp_get_status returned "+i),g=5
break}for(e.p.o>=ql&&t("delta = "+p.aa),n=.3*e.p.Ub,i=1;i<=f&&(r=p.f[v[i].C],!(n<r.r&&r.r<1-n));i++);if(i>f){for(r=new Float64Array(1+m),n=1;n<=m;n++)r[n]=p.f[n].r,h.f[n].kind==fl&&(r[n]=Math.floor(r[n]+.5))
for(p.ha=h.ha,p.dir=h.dir,i=1;i<=f;i++)p.f[v[i].C].c=r[v[i].C],p.f[v[i].C].d=r[v[i].C],p.f[v[i].C].type=bl
for(n=1;n<=m;n++)p.f[n].u=h.f[n].u
if(0!=(i=oo(p,a))){e.p.o>=Rl&&t("Warning: glp_simplex returned "+i),g=5
break}if((i=so(p))!=El){e.p.o>=Rl&&t("Warning: glp_get_status returned "+i),g=5
break}for(n=1;n<=m;n++)h.f[n].kind!=fl&&(r[n]=p.f[n].r)
if(0==(i=w(e,r))){g=z(e,e.N.bound)?1:5
break}}if(d==hi||p.aa<=d-1e-6*(1+d)?(l=0,d=p.aa):l++,3>l){g=3
break}5>u&&(g=2)}if(null==g)break
i=g}}function le(e){var r,t,a,n,i,o,l,s,u,f
for(r=e.Bd,n=Array(1+r.size),s=new Int32Array(1+e.i),u=new Float64Array(1+e.i),f=new Float64Array(1+e.i),i=0,t=r.head;null!=t;t=t.e)i++,n[i].Re=t,n[i].ba=0
for(i=1;i<=r.size;i++){var d=null,h=null
for(t=n[i].Re,o=l=0,a=t.k;null!=a;a=a.e)l++,s[l]=a.C,u[l]=a.j,o+=a.j*a.j
4.930380657631324e-32>o&&(o=2.220446049250313e-16),l=Bo(e.A,l,s,u),t=b(e.A,l,s,u,t.type,t.cg,function(e,r,t,a,n,i){d=n,h=i}),0==t?(n[i].Xc=Math.abs(d)/Math.sqrt(o),e.A.dir==sl?(0>h&&(h=0),n[i].Ab=+h):(0<h&&(h=0),n[i].Ab=-h)):1==t?n[i].Xc=n[i].Ab=0:2==t&&(n[i].Xc=1,n[i].Ab=hi),.01>n[i].Ab&&(n[i].Ab=0)}for(c(n,r.size,function(e,r){if(0==e.Ab&&0==r.Ab){if(e.Xc>r.Xc)return-1
if(e.Xc<r.Xc)return 1}else{if(e.Ab>r.Ab)return-1
if(e.Ab<r.Ab)return 1}return 0}),o=0==e.N.La?90:10,o>r.size&&(o=r.size),i=1;i<=o;i++)if(!(.01>n[i].Ab&&.01>n[i].Xc)){for(r=1;r<i&&!(n[r].ba&&.9<function(e,r,t){var a,n=0,i=0,o=0
for(a=e.k;null!=a;a=a.e)t[a.C]=a.j,i+=a.j*a.j
for(a=r.k;null!=a;a=a.e)n+=t[a.C]*a.j,o+=a.j*a.j
for(a=e.k;null!=a;a=a.e)t[a.C]=0
return e=Math.sqrt(i)*Math.sqrt(o),4.930380657631324e-32>e&&(e=2.220446049250313e-16),n/e}(n[i].Re,n[r].Re,f));r++);if(!(r<i)){for(t=n[i].Re,n[i].ba=1,r=wi(e.A,1),null!=t.name&&_i(e.A,r,t.name),e.A.n[r].qc=t.qc,l=0,a=t.k;null!=a;a=a.e)l++,s[l]=a.C,u[l]=a.j
Pi(e.A,r,l,s,u),Ai(e.A,r,t.type,t.cg,t.cg)}}}function se(e){var r
return e.p.kc==as?r=e.Xa.s:e.p.kc==ns?r=e.head.s:e.p.kc==is?r=function(e){var r,t,a,n=null
switch(e.A.dir){case sl:for(t=+hi,r=e.head;null!=r;r=r.e)t>r.bound&&(t=r.bound)
for(a=.001*(1+Math.abs(t)),r=e.head;null!=r;r=r.e)r.bound<=t+a&&(null==n||n.R.Zc>r.R.Zc)&&(n=r)
break
case cl:for(t=-hi,r=e.head;null!=r;r=r.e)t<r.bound&&(t=r.bound)
for(a=.001*(1+Math.abs(t)),r=e.head;null!=r;r=r.e)r.bound>=t-a&&(null==n||n.rc<r.rc)&&(n=r)}return n.s}(e):e.p.kc==os&&(r=e.A.za==Sl?function(e){var r,t
for(r=0,t=hi,e=e.head;null!=e;e=e.e)t>e.R.Zc&&(r=e.s,t=e.R.Zc)
return r}(e):function(e){var r,t,a,n,i
for(r=e.ya[1].rb,n=(e.A.ta-r.bound)/r.Zc,t=0,a=hi,r=e.head;null!=r;r=r.e)i=r.R.bound+n*r.R.Zc,e.A.dir==cl&&(i=-i),a>i&&(t=r.s,a=i)
return t}(e)),r}function ce(e){var r=Math.floor(Math.log(e)/Math.log(2))+1
return Math.pow(2,.75>=e/Math.pow(2,r)?r-1:r)}function ue(e,r){var t=Number(e)
if(isNaN(t))return 2
switch(t){case Number.POSITIVE_INFINITY:case Number.NEGATIVE_INFINITY:return 1
default:return r(t),0}}function fe(e,r){var t=Number(e)
if(isNaN(t))return 2
switch(t){case Number.POSITIVE_INFINITY:case Number.NEGATIVE_INFINITY:return 1
default:return 0==t%1?(r(t),0):2}}function de(e,r,t){var a,n
return 1<=e&&31>=e&&1<=r&&12>=r&&1<=t&&4e3>=t?(3<=r?r-=3:(r+=9,t--),a=t/100|0,t=(146097*a/4|0)+(1461*(t-100*a)/4|0),t+=(153*r+2)/5|0,t+=e+1721119,he(t,function(e){n=e}),e!=n&&(t=-1),t):-1}function he(e,r){var t,a,n
1721426<=e&&3182395>=e&&(e-=1721119,n=(4*e-1)/146097|0,t=(4*e-1)%146097/4|0,e=(4*t+3)/1461|0,t=((4*t+3)%1461+4)/4|0,a=(5*t-3)/153|0,t=(5*t-3)%153,t=(t+5)/5|0,n=100*n+e,9>=a?a+=3:(a-=9,n++),r(t,a,n))}function me(e,r,t,a){var n=e.i,i=e.Md,o=e.Ld,l=e.Wb
e=e.Xb
var s,c,u,f
for(s=1;s<=n;s++){for(f=0,c=i[s],u=c+o[s];c<u;c++)f+=e[c]*a[l[c]]
r[s+t]+=-1*f}}function pe(e,r,t,a){var n=e.i,i=e.Od,o=e.Nd,l=e.Wb
e=e.Xb
var s,c,u,f
for(s=1;s<=n;s++){for(f=0,c=i[s],u=c+o[s];c<u;c++)f+=e[c]*a[l[c]]
r[s+t]+=-1*f}}function ve(e,r){var t=Ri(e,r)
return t==-hi&&(t=0),t}function be(e,r){var t=Di(e,r)
return t==+hi&&(t=0),t}function ge(e,r,t){t(Ni(e,r)-hl+Ys,ve(e,r),be(e,r))}function xe(e,r){var t=qi(e,r)
return t==-hi&&(t=0),t}function ye(e,r){var t=Yi(e,r)
return t==+hi&&(t=0),t}function we(e,r,t){t(Gi(e,r)-hl+Ys,xe(e,r),ye(e,r))}function Me(e){var t,a=ac
null==e.ke&&(e.ke={},t=e.ke,t.o=3,t.scale=1,t.J=0,t.mh=1,t.yh=.07,t.Gb=1e-7,t.tb=1e-7,t.xe=1e-9,t.round=0,t.hf=-hi,t.jf=+hi,t.oc=-1,t.sb=-1,t.bc=200,t.fb=0,t.Og=2,t.Pg=3,t.Ub=1e-5,t.we=1e-7,t.Xg=1,t.Yg=2,t.Zg=0,t.ah=1,t.Wg=0,t.$g=0,t.Vg=0,t.lh=0,t.sd=0,t.wh=0,t.ce=0),t=e.ke
var n=0
switch(a){case ac:n=t.o
break
case nc:n=t.scale
break
case ic:n=t.J
break
case oc:n=t.mh
break
case lc:n=t.round
break
case sc:n=t.oc
break
case cc:n=e.$
break
case uc:n=t.bc
break
case fc:n=t.Og
break
case dc:n=t.Pg
break
case hc:n=t.Xg
break
case mc:n=t.Yg
break
case pc:n=t.Zg
break
case vc:n=t.ah
break
case bc:n=t.Wg
break
case gc:n=t.$g
break
case xc:n=t.Vg
break
case yc:n=t.lh
break
case wc:n=t.sd
break
case Mc:n=t.wh
break
case _c:switch(a={},Po(e,a),a.type){case Bl:n=1
break
case zl:n=2
break
case Tl:n=3}break
default:r("lpx_get_int_parm: parm = "+a+"; invalid parameter")}return n}function _e(){var e={}
return e.K=e.i=0,e.valid=0,e.Rf=e.Ye=null,e.Yd=e.Xd=null,e.Fc=e.Ec=e.pd=null,e.Af=null,e.Dc=e.Cc=e.Rc=null,e.kb=e.vb=null,e.sf=e.me=null,e.Ga=0,e.Fa=e.Ma=0,e.wb=null,e.xb=null,e.ld=e.Sb=0,e.Hd=e.md=null,e.zf=null,e.vf=e.dg=e.wf=null,e.Oe=e.Qe=e.Pe=null,e.ba=null,e.ze=null,e.Va=0,e.cc=.1,e.xc=4,e.gc=1,e.Mb=1e-15,e.sc=1e10,e.dh=e.$f=e.Qb=0,e.Cg=e.rd=0,e.pa=0,e}function ke(e){var r,t,a=e.i,i=e.Fc,o=e.Ec,l=e.pd,s=e.Dc,c=e.Cc,u=e.Rc,f=e.wb,d=e.xb,h=e.md,m=1
for(t=e.ld;0!=t;t=h[t])if(t<=a){if(r=t,i[r]!=m)break
l[r]=o[r],m+=l[r]}else{if(r=t-a,s[r]!=m)break
u[r]=c[r],m+=u[r]}for(;0!=t;t=h[t])t<=a?(r=t,n(f,m,f,i[r],o[r]),n(d,m,d,i[r],o[r]),i[r]=m,l[r]=o[r],m+=l[r]):(r=t-a,n(f,m,f,s[r],c[r]),n(d,m,d,s[r],c[r]),s[r]=m,u[r]=c[r],m+=u[r])
e.Fa=m}function Ae(e,r,t){var a,i=e.i,o=e.Fc,l=e.Ec,s=e.pd,c=e.Rc,u=e.wb,f=e.xb,d=e.Hd,h=e.md
return e.Ma-e.Fa<t&&(ke(e),e.Ma-e.Fa<t)?1:(a=s[r],n(u,e.Fa,u,o[r],l[r]),n(f,e.Fa,f,o[r],l[r]),o[r]=e.Fa,s[r]=t,e.Fa+=t,0==d[r]?e.ld=h[r]:(t=d[r],t<=i?s[t]+=a:c[t-i]+=a,h[d[r]]=h[r]),0==h[r]?e.Sb=d[r]:d[h[r]]=d[r],d[r]=e.Sb,h[r]=0,0==d[r]?e.ld=r:h[d[r]]=r,e.Sb=r,0)}function Le(e,r,t){var a,i=e.i,o=e.pd,l=e.Dc,s=e.Cc,c=e.Rc,u=e.wb,f=e.xb,d=e.Hd,h=e.md
return e.Ma-e.Fa<t&&(ke(e),e.Ma-e.Fa<t)?1:(a=c[r],n(u,e.Fa,u,l[r],s[r]),n(f,e.Fa,f,l[r],s[r]),l[r]=e.Fa,c[r]=t,e.Fa+=t,r=i+r,0==d[r]?e.ld=h[r]:(t=d[r],t<=i?o[t]+=a:c[t-i]+=a,h[d[r]]=h[r]),0==h[r]?e.Sb=d[r]:d[h[r]]=d[r],d[r]=e.Sb,h[r]=0,0==d[r]?e.ld=r:h[d[r]]=r,e.Sb=r,0)}function Ce(e,r){var t=e.K
e.i=r,r<=t||(e.K=t=r+100,e.Rf=new Int32Array(1+t),e.Ye=new Int32Array(1+t),e.Yd=new Int32Array(1+t),e.Xd=new Int32Array(1+t),e.Fc=new Int32Array(1+t),e.Ec=new Int32Array(1+t),e.pd=new Int32Array(1+t),e.Af=new Float64Array(1+t),e.Dc=new Int32Array(1+t),e.Cc=new Int32Array(1+t),e.Rc=new Int32Array(1+t),e.kb=new Int32Array(1+t),e.vb=new Int32Array(1+t),e.sf=new Int32Array(1+t),e.me=new Int32Array(1+t),e.Hd=new Int32Array(1+t+t),e.md=new Int32Array(1+t+t),e.zf=new Float64Array(1+t),e.vf=new Int32Array(1+t),e.dg=new Int32Array(1+t),e.wf=new Int32Array(1+t),e.Oe=new Int32Array(1+t),e.Qe=new Int32Array(1+t),e.Pe=new Int32Array(1+t),e.ba=new Int32Array(1+t),e.ze=new Float64Array(1+t))}function Pe(e,t,a){var n,i,o,l,s,c,u,f=e.i,d=e.Yd,h=e.Xd,m=e.Fc,p=e.Ec,v=e.pd,b=e.Dc,g=e.Cc,x=e.Rc,y=e.kb,w=e.vb,M=e.sf,_=e.me,k=e.wb,A=e.xb,L=e.Hd,C=e.md,P=e.zf,V=e.vf,I=e.dg,S=e.wf,j=e.Oe,O=e.Qe,X=e.Pe,E=e.ba,F=e.ze,B=0
for(l=1,s=e.Ga+1,i=1;i<=f;i++)d[i]=s,h[i]=0
for(n=1;n<=f;n++)p[n]=v[n]=0,E[n]=0
for(h=d=0,i=1;i<=f;i++){var z=y,T=F
if(o=t(a,i,z,T),0<=o&&o<=f||r("luf_factorize: j = "+i+"; len = "+o+"; invalid column length"),s-l<o)return B=1
for(b[i]=l,g[i]=x[i]=o,d+=o,c=1;c<=o;c++)n=z[c],u=T[c],1<=n&&n<=f||r("luf_factorize: i = "+n+"; j = "+i+"; invalid row index"),E[n]&&r("luf_factorize: i = "+n+"; j = "+i+"; duplicate element not allowed"),0==u&&r("luf_factorize: i = "+n+"; j = "+i+"; zero element not allowed"),k[l]=n,A[l]=u,l++,0>u&&(u=-u),h<u&&(h=u),E[n]=1,v[n]++
for(c=1;c<=o;c++)E[z[c]]=0}for(n=1;n<=f;n++){if(o=v[n],s-l<o)return B=1
m[n]=l,l+=o}for(i=1;i<=f;i++)for(n=b[i],t=n+g[i]-1,v=n;v<=t;v++)n=k[v],u=A[v],a=m[n]+p[n],k[a]=i,A[a]=u,p[n]++
for(v=1;v<=f;v++)y[v]=w[v]=M[v]=_[v]=v
for(e.Fa=l,e.Ma=s,e.ld=f+1,e.Sb=f,n=1;n<=f;n++)L[n]=n-1,C[n]=n+1
for(L[1]=f+f,C[f]=0,i=1;i<=f;i++)L[f+i]=f+i-1,C[f+i]=f+i+1
for(L[f+1]=0,v=C[f+f]=1;v<=f;v++)E[v]=0,F[v]=0
for(e.dh=d,e.$f=0,e.Qb=d,e.Cg=h,e.rd=h,e.pa=-1,n=1;n<=f;n++)P[n]=-1
for(o=0;o<=f;o++)V[o]=0
for(n=1;n<=f;n++)o=p[n],I[n]=0,S[n]=V[o],0!=S[n]&&(I[S[n]]=n),V[o]=n
for(o=0;o<=f;o++)j[o]=0
for(i=1;i<=f;i++)o=g[i],O[i]=0,X[i]=j[o],0!=X[i]&&(O[X[i]]=i),j[o]=i
return B}function Ve(e,r){function t(){return r(a,n),0==a}var a,n,i,o,l,s,c,u,f,d,h,m,p,v,b,g,x,y,w=e.i,M=e.Fc,_=e.Ec,k=e.Dc,A=e.Cc,L=e.wb,C=e.xb,P=e.zf,V=e.vf,I=e.wf,S=e.Oe,j=e.Qe,O=e.Pe,X=e.cc,E=e.xc,F=e.gc
if(a=n=0,g=hi,h=0,0!=(u=S[1]))return a=L[k[u]],n=u,t()
if(0!=(o=V[1]))return a=o,n=L[M[o]],t()
for(i=2;i<=w;i++){for(u=S[i];0!=u;u=m){for(o=k[u],f=o+A[u]-1,m=O[u],p=v=0,b=2147483647,d=o;d<=f;d++)if(o=L[d],l=M[o],s=l+_[o]-1,!(_[o]>=b)){if(0>(x=P[o])){for(c=l;c<=s;c++)y=C[c],0>y&&(y=-y),x<y&&(x=y)
P[o]=x}for(c=M[o];L[c]!=u;c++);if(y=C[c],0>y&&(y=-y),!(y<X*x)&&(p=o,v=u,(b=_[o])<=i))return a=p,n=v,t()}if(0!=p){if(h++,u=(b-1)*(i-1),u<g&&(a=p,n=v,g=u),h==E)return t()}else F&&(0==j[u]?S[i]=O[u]:O[j[u]]=O[u],0!=O[u]&&(j[O[u]]=j[u]),j[u]=O[u]=u)}for(o=V[i];0!=o;o=I[o]){if(l=M[o],s=l+_[o]-1,0>(x=P[o])){for(c=l;c<=s;c++)y=C[c],0>y&&(y=-y),x<y&&(x=y)
P[o]=x}for(p=v=0,b=2147483647,c=l;c<=s;c++)if(u=L[c],!(A[u]>=b)&&(y=C[c],0>y&&(y=-y),!(y<X*x)&&(p=o,v=u,(b=A[u])<=i)))return a=p,n=v,t()
if(0!=p&&(h++,u=(i-1)*(b-1),u<g&&(a=p,n=v,g=u),h==E))return t()}}return t()}function Ie(e,r,t){var a,n,i,o,l,s,c,u,f,d,h,m,p=e.i,v=e.Yd,b=e.Xd,g=e.Fc,x=e.Ec,y=e.pd,w=e.Af,M=e.Dc,_=e.Cc,k=e.Rc,A=e.wb,L=e.xb,C=e.Hd,P=e.md,V=e.zf,I=e.vf,S=e.dg,j=e.wf,O=e.Oe,X=e.Qe,E=e.Pe,F=e.ba,B=e.ze,z=e.Mb,T=e.Ye,N=0
for(0==S[r]?I[x[r]]=j[r]:j[S[r]]=j[r],0!=j[r]&&(S[j[r]]=S[r]),0==X[t]?O[_[t]]=E[t]:E[X[t]]=E[t],0!=E[t]&&(X[E[t]]=X[t]),u=g[r],f=u+x[r]-1,n=u;A[n]!=t;n++);for(m=w[r]=L[n],A[n]=A[f],L[n]=L[f],x[r]--,f--,w=M[t],d=w+_[t]-1,i=w;A[i]!=r;i++);for(A[i]=A[d],_[t]--,d--,n=u;n<=f;n++){for(o=A[n],F[o]=1,B[o]=L[n],0==X[o]?O[_[o]]=E[o]:E[X[o]]=E[o],0!=E[o]&&(X[E[o]]=X[o]),s=M[o],c=s+_[o]-1;A[s]!=r;s++);A[s]=A[c],_[o]--}for(;w<=d;){for(i=A[w],0==S[i]?I[x[i]]=j[i]:j[S[i]]=j[i],0!=j[i]&&(S[j[i]]=S[i]),o=g[i],a=o+x[i]-1,l=o;A[l]!=t;l++);for(h=L[l]/m,A[l]=A[a],L[l]=L[a],x[i]--,a--,A[w]=A[d],_[t]--,d--,n=x[r],l=o;l<=a;l++)if(o=A[l],F[o])if(s=L[l]-=h*B[o],0>s&&(s=-s),F[o]=0,n--,0==s||s<z){for(A[l]=A[a],L[l]=L[a],x[i]--,l--,a--,s=M[o],c=s+_[o]-1;A[s]!=i;s++);A[s]=A[c],_[o]--}else e.rd<s&&(e.rd=s)
if(x[i]+n>y[i]){if(Ae(e,i,x[i]+n))return N=1
u=g[r],f=u+x[r]-1,w=M[t],d=w+_[t]-1}for(a=0,n=u;n<=f;n++)o=A[n],F[o]?(s=c=-h*B[o],0>s&&(s=-s),0==s||s<z||(l=g[i]+x[i],A[l]=o,L[l]=c,x[i]++,T[++a]=o,e.rd<s&&(e.rd=s))):F[o]=1
for(l=1;l<=a;l++){if(o=T[l],_[o]+1>k[o]){if(Le(e,o,_[o]+10))return N=1
u=g[r],f=u+x[r]-1,w=M[t],d=w+_[t]-1}s=M[o]+_[o],A[s]=i,_[o]++}if(S[i]=0,j[i]=I[x[i]],0!=j[i]&&(S[j[i]]=i),I[x[i]]=i,V[i]=-1,1>e.Ma-e.Fa){if(ke(e),1>e.Ma-e.Fa)return N=1
u=g[r],f=u+x[r]-1,w=M[t],d=w+_[t]-1}e.Ma--,A[e.Ma]=i,L[e.Ma]=h,b[r]++}for(k[t]=0,l=p+t,0==C[l]?e.ld=P[l]:P[C[l]]=P[l],0==P[l]?e.Sb=C[l]:C[P[l]]=C[l],v[r]=e.Ma,n=u;n<=f;n++)o=A[n],F[o]=0,B[o]=0,(1==_[o]||X[o]!=o||E[o]!=o)&&(X[o]=0,E[o]=O[_[o]],0!=E[o]&&(X[E[o]]=o),O[_[o]]=o)
return N}function Se(e){var r,t,a,n,i=e.i,o=e.Fc,l=e.Ec,s=e.Dc,c=e.Cc,u=e.Rc,f=e.wb,d=e.xb,h=e.Hd,m=e.md
for(n=0,r=1;r<=i;r++){for(t=o[r],a=t+l[r]-1;t<=a;t++)u[f[t]]++
n+=l[r]}if(e.Qb=n,e.Ma-e.Fa<n)return 1
for(n=1;n<=i;n++)s[n]=e.Fa,e.Fa+=u[n]
for(r=1;r<=i;r++)for(t=o[r],a=t+l[r]-1;t<=a;t++)n=f[t],u=s[n]+c[n],f[u]=r,d[u]=d[t],c[n]++
for(o=i+1;o<=i+i;o++)h[o]=o-1,m[o]=o+1
return h[i+1]=e.Sb,m[e.Sb]=i+1,m[i+i]=0,e.Sb=i+i,0}function je(e){var r,t,a,n,i=e.i,o=e.Rf,l=e.Ye,s=e.Yd,c=e.Xd,u=e.wb,f=e.xb
for(r=1;r<=i;r++)l[r]=0
for(r=0,t=1;t<=i;t++){for(a=s[t],n=a+c[t]-1;a<=n;a++)l[u[a]]++
r+=c[t]}if(e.$f=r,e.Ma-e.Fa<r)return 1
for(r=1;r<=i;r++)o[r]=e.Ma,e.Ma-=l[r]
for(t=1;t<=i;t++)for(a=s[t],n=a+c[t]-1;a<=n;a++)r=u[a],e=--o[r],u[e]=t,f[e]=f[a]
return 0}function Oe(e,t,a,n){var i,o,l,s,c,u,f,d,h,m,p=e.sc,v=null
for(1>t&&r("luf_factorize: n = "+t+"; invalid parameter"),1e8<t&&r("luf_factorize: n = "+t+"; matrix too big"),e.valid=0,Ce(e,t),i=e.kb,o=e.vb,l=e.sf,s=e.me,0==e.Ga&&0==e.Va&&(e.Va=5*(t+10));function(){if(0<e.Va&&(e.Ga=e.Va,e.wb=new Int32Array(1+e.Ga),e.xb=new Float64Array(1+e.Ga),e.Va=0),Pe(e,a,n))return e.Va=e.Ga+e.Ga,!0
for(f=1;f<=t;f++){if(Ve(e,function(e,r){d=e,h=r}))return e.pa=f-1,v=kc,!1
if(c=o[d],u=l[h],m=i[f],i[c]=m,o[m]=c,i[f]=d,o[d]=f,m=s[f],s[u]=m,l[m]=u,s[f]=h,l[h]=f,Ie(e,d,h))return e.Va=e.Ga+e.Ga,!0
if(e.rd>p*e.Cg)return e.pa=f-1,v=Ac,!1}return ke(e),!(!Se(e)&&!je(e))&&(e.Va=e.Ga+e.Ga,!0)}(););if(null!=v)return v
if(e.valid=1,e.pa=t,v=0,m=3*(t+e.Qb)+2*e.$f,e.Ga<m)for(e.Va=e.Ga;e.Va<m;)f=e.Va,e.Va=f+f
return v}function Xe(e,t,a){var n,i=e.i,o=e.Rf,l=e.Ye,s=e.Yd,c=e.Xd,u=e.kb,f=e.wb,d=e.xb
if(e.valid||r("luf_f_solve: LU-factorization is not valid"),t){for(;1<=i;i--)if(n=u[i],0!=(e=a[n]))for(t=o[n],n=t+l[n]-1;t<=n;t++)a[f[t]]-=d[t]*e}else for(o=1;o<=i;o++)if(n=u[o],0!=(e=a[n]))for(t=s[n],n=t+c[n]-1;t<=n;t++)a[f[t]]-=d[t]*e}function Ee(e,t,a){var n,i,o,l=e.i,s=e.Fc,c=e.Ec,u=e.Af,f=e.Dc,d=e.Cc,h=e.kb,m=e.me,p=e.wb,v=e.xb,b=e.ze
for(e.valid||r("luf_v_solve: LU-factorization is not valid"),e=1;e<=l;e++)b[e]=a[e],a[e]=0
if(t){for(e=1;e<=l;e++)if(n=h[e],i=m[e],0!=(t=b[i]))for(a[n]=t/=u[n],o=s[n],n=o+c[n]-1;o<=n;o++)b[p[o]]-=v[o]*t}else for(e=l;1<=e;e--)if(n=h[e],i=m[e],0!=(t=b[n]))for(a[i]=t/=u[n],o=f[i],n=o+d[i]-1;o<=n;o++)b[p[o]]-=v[o]*t}function Fe(){return{index:{},S:{},set:{},t:{},H:{},a:{},loop:{}}}function Be(e){var r
r=e.b==ru?"_|_":e.b==iu?"'...'":e.h,e.Zb[e.lc++]=" ",e.lc==eu&&(e.lc=0)
for(var t=0;t<r.length;t++)e.Zb[e.lc++]=r[t],e.lc==eu&&(e.lc=0)}function ze(e){var r
e.l!=Lc&&("\n"==e.l&&(e.bb++,e.Vc=0),r=e.cf(),0>r&&(r=Lc),e.Vc++,r==Lc?"\n"==e.l?e.bb--:Ha(e,"final NL missing before end of file"):"\n"!=r&&(0<=" \t\n\v\f\r".indexOf(r)?r=" ":u(r)&&(Be(e),Ua(e,"control character "+r+" not allowed"))),e.l=r)}function Te(e){e.h+=e.l,e.Bb++,ze(e)}function Ne(e){function r(){Be(e),Ua(e,"keyword s.t. incomplete")}function t(){Be(e),Ua(e,"cannot convert numeric literal "+e.h+" to floating-point number")}function a(){if("e"==e.l||"E"==e.l)for(Te(e),"+"!=e.l&&"-"!=e.l||Te(e),h(e.l)||(Be(e),Ua(e,"numeric literal "+e.h+" incomplete"));h(e.l);)Te(e);(f(e.l)||"_"==e.l)&&(Be(e),Ua(e,"symbol "+e.h+e.l+"... should be enclosed in quotes"))}if(e.Hf=e.b,e.Gf=e.Bb,e.Ff=e.h,e.If=e.value,e.Ue)e.Ue=0,e.b=e.Mf,e.Bb=e.Lf,e.h=e.Kf,e.value=e.Nf
else{for(;;){for(e.b=0,e.Bb=0,e.h="",e.value=0;" "==e.l||"\n"==e.l;)ze(e)
if(e.l==Lc)e.b=ru
else{if("#"==e.l){for(;"\n"!=e.l&&e.l!=Lc;)ze(e)
continue}if(e.nc||!f(e.l)&&"_"!=e.l)if(!e.nc&&h(e.l)){for(e.b=nu;h(e.l);)Te(e)
var n=!1
if("."==e.l)if(Te(e),"."==e.l)e.Bb--,e.h=e.h.substr(0,e.h.length-1),e.Te=1,n=!0
else for(;h(e.l);)Te(e)
n||a(),ue(e.h,function(r){e.value=r})&&t()}else if("'"==e.l||'"'==e.l){var i=e.l,o=!1
e.b=iu,ze(e),n=function(){for(;;){if(("\n"==e.l&&!o||e.l==Lc)&&(Be(e),Ua(e,"unexpected end of line; string literal incomplete")),e.l==i)if(ze(e),e.l==i){if(o){if(ze(e),e.l==i){ze(e)
break}e.h+='""',e.Bb+=2}}else{if(!o)break
e.h+='"',e.Bb++}Te(e)}},e.l==i?(ze(e),e.l==i&&(o=!0,ze(e),n())):n()}else if(e.nc||"+"!=e.l)if(e.nc||"-"!=e.l){if("*"==e.l)e.b=Cu,Te(e),"*"==e.l&&(e.b=Vu,Te(e))
else if("/"==e.l){if(e.b=Pu,Te(e),"*"==e.l){for(ze(e);;)if(e.l==Lc)Ua(e,"unexpected end of file; comment sequence incomplete")
else if("*"==e.l){if(ze(e),"/"==e.l)break}else ze(e)
ze(e)
continue}}else if("^"==e.l)e.b=Vu,Te(e)
else if("<"==e.l)e.b=Iu,Te(e),"="==e.l?(e.b=Su,Te(e)):">"==e.l?(e.b=Eu,Te(e)):"-"==e.l&&(e.b=Qu,Te(e))
else if("="==e.l)e.b=ju,Te(e),"="==e.l&&Te(e)
else if(">"==e.l)e.b=Xu,Te(e),"="==e.l?(e.b=Ou,Te(e)):">"==e.l&&(e.b=Zu,Te(e))
else if("!"==e.l)e.b=gu,Te(e),"="==e.l&&(e.b=Eu,Te(e))
else if("&"==e.l)e.b=Fu,Te(e),"&"==e.l&&(e.b=ou,Te(e))
else if("|"==e.l)e.b=Bu,Te(e),"|"==e.l&&(e.b=xu,Te(e))
else if(e.nc||"."!=e.l)if(","==e.l)e.b=Tu,Te(e)
else if(":"==e.l)e.b=Nu,Te(e),"="==e.l&&(e.b=Du,Te(e))
else if(";"==e.l)e.b=Ru,Te(e)
else if("("==e.l)e.b=qu,Te(e)
else if(")"==e.l)e.b=Yu,Te(e)
else if("["==e.l)e.b=Uu,Te(e)
else if("]"==e.l)e.b=Hu,Te(e)
else if("{"==e.l)e.b=Ku,Te(e)
else if("}"==e.l)e.b=Wu,Te(e)
else if("~"==e.l)e.b=Ju,Te(e)
else if(d(e.l)||0<="+-._".indexOf(e.l)){for(e.b=au;d(e.l)||0<="+-._".indexOf(e.l);)Te(e)
switch(ue(e.h,function(r){e.value=r})){case 0:e.b=nu
break
case 1:t()}}else Be(e),Ua(e,"character "+e.l+" not allowed")
else if(e.b=zu,Te(e),e.Te)e.b=Gu,e.Bb=2,e.h="..",e.Te=0
else if("."==e.l)e.b=Gu,Te(e)
else if(h(e.l)){for(e.b=nu,Te(e);h(e.l);)Te(e)
a(),ue(e.h,function(r){e.value=r})&&t()}}else e.b=Lu,Te(e)
else e.b=Au,Te(e)
else{for(e.b=tu;d(e.l)||"_"==e.l;)Te(e)
"and"==e.h?e.b=ou:"by"==e.h?e.b=lu:"cross"==e.h?e.b=su:"diff"==e.h?e.b=cu:"div"==e.h?e.b=uu:"else"==e.h?e.b=fu:"if"==e.h?e.b=du:"in"==e.h?e.b=hu:"Infinity"==e.h?e.b=mu:"inter"==e.h?e.b=pu:"less"==e.h?e.b=vu:"mod"==e.h?e.b=bu:"not"==e.h?e.b=gu:"or"==e.h?e.b=xu:"s"==e.h&&"."==e.l?(e.b=yu,Te(e),"t"!=e.l&&r(),Te(e),"."!=e.l&&r(),Te(e)):"symdiff"==e.h?e.b=wu:"then"==e.h?e.b=Mu:"union"==e.h?e.b=_u:"within"==e.h&&(e.b=ku)}}break}Be(e),e.Pf=0}}function Re(e){e.Ue=1,e.Mf=e.b,e.Lf=e.Bb,e.Kf=e.h,e.Nf=e.value,e.b=e.Hf,e.Bb=e.Gf,e.h=e.Ff,e.value=e.If}function De(e,r){return e.b==tu&&e.h==r}function Ge(e){return e.b==ou&&"a"==e.h[0]||e.b==lu||e.b==su||e.b==cu||e.b==uu||e.b==fu||e.b==du||e.b==hu||e.b==pu||e.b==vu||e.b==bu||e.b==gu&&"n"==e.h[0]||e.b==xu&&"o"==e.h[0]||e.b==wu||e.b==Mu||e.b==_u||e.b==ku}function qe(e,r,t,a){var n={}
switch(n.Ta=e,n.T=0,n.a=Fe(),n.value={},e){case of:n.a.Q=r.Q
break
case lf:n.a.M=r.M
break
case sf:n.a.index.ya=r.index.ya,n.a.index.e=r.index.e
break
case cf:case uf:for(e=r.S.list;null!=e;e=e.e)e.x.R=n,n.T|=e.x.T
n.a.S.S=r.S.S,n.a.S.list=r.S.list
break
case ff:for(e=r.set.list;null!=e;e=e.e)e.x.R=n,n.T|=e.x.T
n.a.set.set=r.set.set,n.a.set.list=r.set.list
break
case df:for(e=r.t.list;null!=e;e=e.e)e.x.R=n,n.T|=e.x.T
n.a.t.t=r.t.t,n.a.t.list=r.t.list,n.a.t.Ac=r.t.Ac
break
case hf:for(e=r.H.list;null!=e;e=e.e)e.x.R=n,n.T|=e.x.T
n.a.H.H=r.H.H,n.a.H.list=r.H.list,n.a.H.Ac=r.H.Ac
break
case mf:case pf:for(e=r.list;null!=e;e=e.e)e.x.R=n,n.T|=e.x.T
n.a.list=r.list
break
case vf:n.a.slice=r.slice
break
case bf:case gf:case xf:case yf:n.T=1
break
case wf:case Mf:case _f:case kf:case Af:case Lf:case Cf:case Pf:case Vf:case If:case Sf:case jf:case Of:case Xf:case Ef:case Ff:case Bf:case zf:case Tf:case Nf:case Rf:case Df:r.a.x.R=n,n.T|=r.a.x.T,n.a.a.x=r.a.x
break
case Gf:case qf:case Yf:case Uf:case Hf:case Kf:case Wf:case Zf:case Jf:case Qf:case $f:case ed:e==ed&&(n.T=1)
case rd:e==rd&&(n.T=1)
case td:case ad:case nd:case id:case od:case ld:case sd:case cd:case ud:case fd:case dd:case hd:case md:case pd:case vd:case bd:case gd:case xd:case yd:case wd:case Md:r.a.x.R=n,n.T|=r.a.x.T,r.a.y.R=n,n.T|=r.a.y.T,n.a.a.x=r.a.x,n.a.a.y=r.a.y
break
case _d:case kd:case Ad:r.a.x.R=n,n.T|=r.a.x.T,r.a.y.R=n,n.T|=r.a.y.T,null!=r.a.z&&(r.a.z.R=n,n.T|=r.a.z.T),n.a.a.x=r.a.x,n.a.a.y=r.a.y,n.a.a.z=r.a.z
break
case Ld:case Cd:for(e=r.list;null!=e;e=e.e)e.x.R=n,n.T|=e.x.T
n.a.list=r.list
break
case Pd:case Vd:case Id:case Sd:case jd:case Od:case Xd:case Ed:for(e=r.loop.domain,null!=e.code&&(e.code.R=n,n.T|=e.code.T),e=e.list;null!=e;e=e.e)e.code.R=n,n.T|=e.code.T
null!=r.loop.x&&(r.loop.x.R=n,n.T|=r.loop.x.T),n.a.loop.domain=r.loop.domain,n.a.loop.x=r.loop.x}return n.type=t,n.q=a,n.R=null,n.valid=0,n.value={},n}function Ye(e,r,t,a){var n=Fe()
return n.a.x=r,qe(e,n,t,a)}function Ue(e,r,t,a,n){var i=Fe()
return i.a.x=r,i.a.y=t,qe(e,i,a,n)}function He(e,r,t,a,n,i){var o=Fe()
return o.a.x=r,o.a.y=t,o.a.z=a,qe(e,o,n,i)}function Ke(e,r){var t,a={}
if(a.x=r,a.e=null,null==e)e=a
else{for(t=e;null!=t.e;t=t.e);t.e=a}return e}function We(e){var r
for(r=0;null!=e;e=e.e)r++
return r}function Ze(e){var r,t,a,n,i,o,l,s,c,u=Fe(),f=e.V[e.h]
switch(null==f&&Ua(e,e.h+" not defined"),f.type){case Bc:r=f.link,s=r.name,c=0
break
case Kc:t=f.link,s=t.name,c=t.q,0==t.X&&(t.X=1)
break
case Uc:a=f.link,s=a.name,c=a.q
break
case $c:n=f.link,s=n.name,c=n.q
break
case Vc:i=f.link,s=i.name,c=i.q}if(Ne(e),e.b==Uu){0==c&&Ua(e,s+" cannot be subscripted"),Ne(e)
for(var d=null;;)if(o=hr(e),o.type==qc&&(o=Ye(Mf,o,Zc,0)),o.type!=Zc&&Ua(e,"subscript expression has invalid type"),d=Ke(d,o),e.b==Tu)Ne(e)
else{if(e.b==Hu)break
Ua(e,"syntax error in subscript list")}o=d,c!=We(o)&&Ua(e,s+" must have "+c+" subscript"+(1==c?"":"s")+" rather than "+We(o)),Ne(e)}else 0!=c&&Ua(e,s+" must be subscripted"),o=null
switch(c=e.Ob||f.type!=$c?af:$u,e.b==zu&&(Ne(e),e.b!=tu&&Ua(e,"invalid use of period"),f.type!=$c&&f.type!=Vc&&Ua(e,s+" cannot have a suffix"),"lb"==e.h?c=ef:"ub"==e.h?c=rf:"status"==e.h?c=tf:"val"==e.h?c=af:"dual"==e.h?c=nf:Ua(e,"suffix ."+e.h+" invalid"),Ne(e)),f.type){case Bc:u.index.ya=r,u.index.e=r.list,l=qe(sf,u,Zc,0),r.list=l
break
case Kc:u.set.set=t,u.set.list=o,l=qe(ff,u,jc,t.X)
break
case Uc:u.S.S=a,u.S.list=o,l=a.type==Zc?qe(uf,u,Zc,0):qe(cf,u,qc,0)
break
case $c:e.Ob||c!=tf&&c!=af&&c!=nf||Ua(e,"invalid reference to status, primal value, or dual value of variable "+n.name+" above solve statement"),u.t.t=n,u.t.list=o,u.t.Ac=c,l=qe(df,u,c==$u?Fc:qc,0)
break
case Vc:e.Ob||c!=tf&&c!=af&&c!=nf||Ua(e,"invalid reference to status, primal value, or dual value of "+(i.type==Vc?"constraint":"objective")+" "+i.name+" above solve statement"),u.H.H=i,u.H.list=o,u.H.Ac=c,l=qe(hf,u,qc,0)}return l}function Je(e,r){var t=hr(e)
return t.type==Zc&&(t=Ye(wf,t,qc,0)),t.type!=qc&&Ua(e,"argument for "+r+" has invalid type"),t}function Qe(e,r){var t=hr(e)
return t.type==qc&&(t=Ye(Mf,t,Zc,0)),t.type!=Zc&&Ua(e,"argument for "+r+" has invalid type"),t}function $e(e,r,t){var a={}
if(a.name=r,a.code=t,a.value=null,a.list=null,a.e=null,null==e.list)e.list=a
else{for(e=e.list;null!=e.e;e=e.e);e.e=a}}function er(e){var r,t=Fe(),a=Array(21)
o(a,0,21)
var n,i,l,s=0
for(n=e.Pf,Ne(e),l=1;;l++){20<l&&Ua(e,"too many components within parentheses")
var c=function(){r=wr(e),(e.b==Tu||1<l)&&(r.type==qc&&(r=Ye(Mf,r,Zc,0)),r.type!=Zc&&Ua(e,"component expression has invalid type")),a[l].name=null,a[l].code=r}
if(e.b==tu)if(Ne(e),i=e.b,Re(e),!n||i!=Tu&&i!=Yu||null!=e.V[e.h])c()
else{for(i=1;i<l;i++)null!=a[i].name&&a[i].name==e.h&&Ua(e,"duplicate dummy index "+e.h+" not allowed")
a[l].name=e.h,a[l].code=null,Ne(e),s=1,1==l&&e.b==Yu&&Ua(e,a[l].name+" not defined")}else c()
if(e.b==Tu)Ne(e)
else{if(e.b==Yu)break
Ua(e,"right parenthesis missing where expected")}}if(1!=l||s)if(s){for(t.slice={},i=1;i<=l;i++)$e(t.slice,a[i].name,a[i].code)
r=qe(vf,t,Qc,l)}else{for(t.list=null,i=1;i<=l;i++)t.list=Ke(t.list,a[i].code)
r=qe(mf,t,Qc,l)}else r=a[1].code
return Ne(e),s&&e.b!=hu&&Ua(e,"keyword in missing where expected"),n&&e.b==hu&&!s&&(1==l?Ua(e,"syntax error in indexing expression"):Ua(e,"0-ary slice not allowed")),r}function rr(e){var r,t,a,n
for(Ne(e),e.b==Wu&&Ua(e,"empty indexing expression not allowed"),r={};;){if(n=t=null,e.b==tu?(Ne(e),a=e.b,Re(e),a==hu&&null==e.V[e.h]&&(t={},a=e.h,$e(t,a,null),Ne(e),Ne(e))):e.b==qu&&(e.Pf=1,n=br(e),n.Ta==vf&&(t=n.a.slice,n=null,Ne(e))),null==n&&(n=br(e)),n.type!=jc){null!=t&&Ua(e,"domain expression has invalid type"),a=e
var i=Fe(),o=void 0
for(i.list=null,o=1;;o++){if(n.type==qc&&(n=Ye(Mf,n,Zc,0)),n.type==Zc&&(n=Ye(kf,n,Qc,1)),n.type!=Qc&&Ua(a,"member expression has invalid type"),null!=i.list&&i.list.x.q!=n.q&&Ua(a,"member "+(o-1)+" has "+i.list.x.q+" component"+(1==i.list.x.q?"":"s")+" while member "+o+" has "+n.q+" component"+(1==n.q?"":"s")),i.list=Ke(i.list,n),a.b==Tu)Ne(a)
else{if(a.b==Wu)break
Ua(a,"syntax error in literal set")}n=hr(a)}n=qe(pf,i,jc,i.list.x.q)}if(null==t)for(t={},a=1;a<=n.q;a++)$e(t,null,null)
for(i=0,a=t.list;null!=a;a=a.e)i++
if(i!=n.q&&Ua(e,i+" "+(1==i?"index":"indices")+" specified for set of dimension "+n.q),t.code=n,n=r,a=t,i=void 0,null==n.list)n.list=a
else{for(i=n.list;null!=i.e;i=i.e);i.e=a}for(a=t.list;null!=a;a=a.e)null!=a.name&&(e.V[a.name]={type:Bc,link:a})
if(e.b==Tu)Ne(e)
else{if(e.b==Nu||e.b==Wu)break
Ua(e,"syntax error in indexing expression")}}return e.b==Nu&&(Ne(e),n=wr(e),n.type==Zc&&(n=Ye(wf,n,qc,0)),n.type==qc&&(n=Ye(_f,n,Nc,0)),n.type!=Nc&&Ua(e,"expression following colon has invalid type"),r.code=n,e.b!=Wu&&Ua(e,"syntax error in indexing expression")),Ne(e),r}function tr(e,r){var t,a
for(t=r.list;null!=t;t=t.e)for(a=t.list;null!=a;a=a.e)null!=a.name&&delete e.V[a.name]}function ar(e){var r,t
for(r=e.a.loop.domain.list;null!=r;r=r.e)for(t=r.list;null!=t;t=t.e)null!=t.code&&(t.code.R=e)}function nr(e){function r(){Ua(e,"integrand following "+n+"{...} has invalid type")}var t,a,n,i=Fe()
switch("sum"==e.h?a=Pd:"prod"==e.h?a=Vd:"min"==e.h?a=Id:"max"==e.h?a=Sd:"forall"==e.h?a=jd:"exists"==e.h?a=Od:"setof"==e.h?a=Xd:Ua(e,"operator "+e.h+" unknown"),n=e.h,Ne(e),i.loop.domain=rr(e),a){case Pd:case Vd:case Id:case Sd:i.loop.x=fr(e),i.loop.x.type==Zc&&(i.loop.x=Ye(wf,i.loop.x,qc,0)),i.loop.x.type==qc||a==Pd&&i.loop.x.type==Fc||r(),t=qe(a,i,i.loop.x.type,0)
break
case jd:case Od:i.loop.x=yr(e),i.loop.x.type==Zc&&(i.loop.x=Ye(wf,i.loop.x,qc,0)),i.loop.x.type==qc&&(i.loop.x=Ye(_f,i.loop.x,Nc,0)),i.loop.x.type!=Nc&&r(),t=qe(a,i,Nc,0)
break
case Xd:i.loop.x=hr(e),i.loop.x.type==qc&&(i.loop.x=Ye(Mf,i.loop.x,Zc,0)),i.loop.x.type==Zc&&(i.loop.x=Ye(kf,i.loop.x,Qc,1)),i.loop.x.type!=Qc&&r(),t=qe(a,i,jc,i.loop.x.q)}return tr(e,i.loop.domain),ar(t),t}function ir(e){var r=0
for(e=e.list;null!=e;e=e.e)for(var t=e.list;null!=t;t=t.e)null==t.code&&r++
return r}function or(e,r){Ua(e,"operand preceding "+r+" has invalid type")}function lr(e,r){Ua(e,"operand following "+r+" has invalid type")}function sr(e,r,t,a){Ua(e,"operands preceding and following "+r+" have different dimensions "+t+" and "+a+", respectively")}function cr(e){var r,t
if(e.b==nu)r=Fe(),r.Q=e.value,r=qe(of,r,qc,0),Ne(e),t=r
else if(e.b==mu)r=Fe(),r.Q=hi,t=qe(of,r,qc,0),Ne(e)
else if(e.b==iu)r=Fe(),r.M=e.h,r=qe(lf,r,Zc,0),Ne(e),t=r
else if(e.b==tu)switch(Ne(e),t=e.b,Re(e),t){case Uu:t=Ze(e)
break
case qu:t=Fe()
var a
if("abs"==e.h?r=Vf:"ceil"==e.h?r=If:"floor"==e.h?r=Sf:"exp"==e.h?r=jf:"log"==e.h?r=Of:"log10"==e.h?r=Xf:"sqrt"==e.h?r=Ef:"sin"==e.h?r=Ff:"cos"==e.h?r=Bf:"atan"==e.h?r=zf:"min"==e.h?r=Ld:"max"==e.h?r=Cd:"round"==e.h?r=Tf:"trunc"==e.h?r=Nf:"Irand224"==e.h?r=bf:"Uniform01"==e.h?r=gf:"Uniform"==e.h?r=ed:"Normal01"==e.h?r=xf:"Normal"==e.h?r=rd:"card"==e.h?r=Rf:"length"==e.h?r=Df:"substr"==e.h?r=yd:"str2time"==e.h?r=wd:"time2str"==e.h?r=Md:"gmtime"==e.h?r=yf:Ua(e,"function "+e.h+" unknown"),a=e.h,Ne(e),Ne(e),r==Ld||r==Cd)for(t.list=null;;)if(t.list=Ke(t.list,Je(e,a)),e.b==Tu)Ne(e)
else{if(e.b==Yu)break
Ua(e,"syntax error in argument list for "+a)}else if(r==bf||r==gf||r==xf||r==yf)e.b!=Yu&&Ua(e,a+" needs no arguments")
else if(r==ed||r==rd)t.a.x=Je(e,a),e.b!=Tu&&(e.b==Yu?Ua(e,a+" needs two arguments"):Ua(e,"syntax error in argument for "+a)),Ne(e),t.a.y=Je(e,a),e.b==Tu?Ua(e,a+" needs two argument"):e.b!=Yu&&Ua(e,"syntax error in argument for "+a)
else if(r==zf||r==Tf||r==Nf){if(t.a.x=Je(e,a),e.b==Tu){switch(r){case zf:r=Jf
break
case Tf:r=Qf
break
case Nf:r=$f}Ne(e),t.a.y=Je(e,a)}e.b==Tu?Ua(e,a+" needs one or two arguments"):e.b!=Yu&&Ua(e,"syntax error in argument for "+a)}else if(r==yd)t.a.x=Qe(e,a),e.b!=Tu&&(e.b==Yu?Ua(e,a+" needs two or three arguments"):Ua(e,"syntax error in argument for "+a)),Ne(e),t.a.y=Je(e,a),e.b==Tu&&(r=Ad,Ne(e),t.a.z=Je(e,a)),e.b==Tu?Ua(e,a+" needs two or three arguments"):e.b!=Yu&&Ua(e,"syntax error in argument for "+a)
else if(r==wd)t.a.x=Qe(e,a),e.b!=Tu&&(e.b==Yu?Ua(e,a+" needs two arguments"):Ua(e,"syntax error in argument for "+a)),Ne(e),t.a.y=Qe(e,a),e.b==Tu?Ua(e,a+" needs two argument"):e.b!=Yu&&Ua(e,"syntax error in argument for "+a)
else if(r==Md)t.a.x=Je(e,a),e.b!=Tu&&(e.b==Yu?Ua(e,a+" needs two arguments"):Ua(e,"syntax error in argument for "+a)),Ne(e),t.a.y=Qe(e,a),e.b==Tu?Ua(e,a+" needs two argument"):e.b!=Yu&&Ua(e,"syntax error in argument for "+a)
else{var n,i=t.a
r==Rf?(n=br(e),n.type!=jc&&Ua(e,"argument for "+a+" has invalid type")):n=r==Df?Qe(e,a):Je(e,a),i.x=n,e.b==Tu?Ua(e,a+" needs one argument"):e.b!=Yu&&Ua(e,"syntax error in argument for "+a)}r=r==yd||r==Ad||r==Md?qe(r,t,Zc,0):qe(r,t,qc,0),Ne(e),t=r
break
case Ku:t=nr(e)
break
default:t=Ze(e)}else e.b==qu?t=er(e):e.b==Ku?(r=Fe(),Ne(e),e.b==Wu?(r.list=null,r=qe(pf,r,jc,1),Ne(e)):(Re(e),r.loop.domain=rr(e),r.loop.x=null,tr(e,r.loop.domain),r=qe(Ed,r,jc,ir(r.loop.domain)),ar(r)),t=r):e.b==du?(Ne(e),r=wr(e),r.type==Zc&&(r=Ye(wf,r,qc,0)),r.type==qc&&(r=Ye(_f,r,Nc,0)),r.type!=Nc&&Ua(e,"expression following if has invalid type"),e.b!=Mu&&Ua(e,"keyword then missing where expected"),Ne(e),t=br(e),t.type!=qc&&t.type!=Zc&&t.type!=jc&&t.type!=Fc&&Ua(e,"expression following then has invalid type"),e.b!=fu?(t.type==jc&&Ua(e,"keyword else missing where expected"),a=null):(Ne(e),a=br(e),a.type!=qc&&a.type!=Zc&&a.type!=jc&&a.type!=Fc&&Ua(e,"expression following else has invalid type"),t.type!=Fc&&a.type!=Fc||(t.type==Zc&&(t=Ye(wf,t,qc,0)),t.type==qc&&(t=Ye(Af,t,Fc,0)),a.type==Zc&&(a=Ye(wf,a,qc,0)),a.type==qc&&(a=Ye(Af,a,Fc,0))),t.type!=Zc&&a.type!=Zc||(t.type==qc&&(t=Ye(Mf,t,Zc,0)),a.type==qc&&(a=Ye(Mf,a,Zc,0))),t.type!=a.type&&Ua(e,"expressions following then and else have incompatible types"),t.q!=a.q&&Ua(e,"expressions following then and else have different dimensions "+t.q+" and "+a.q+", respectively")),t=He(kd,r,t,a,t.type,t.q)):Ge(e)?Ua(e,"invalid use of reserved keyword "+e.h):Ua(e,"syntax error in expression")
return e.b==Vu&&(a=e.h,t.type==Zc&&(t=Ye(wf,t,qc,0)),t.type!=qc&&or(e,a),Ne(e),r=e.b==Au||e.b==Lu?ur(e):cr(e),r.type==Zc&&(r=Ye(wf,r,qc,0)),r.type!=qc&&lr(e,a),t=Ue(Zf,t,r,qc,0)),t}function ur(e){var r
return e.b==Au?(Ne(e),r=cr(e),r.type==Zc&&(r=Ye(wf,r,qc,0)),r.type!=qc&&r.type!=Fc&&lr(e,"+"),r=Ye(Lf,r,r.type,0)):e.b==Lu?(Ne(e),r=cr(e),r.type==Zc&&(r=Ye(wf,r,qc,0)),r.type!=qc&&r.type!=Fc&&lr(e,"-"),r=Ye(Cf,r,r.type,0)):r=cr(e),r}function fr(e){for(var r,t=ur(e);;)if(e.b==Cu)t.type==Zc&&(t=Ye(wf,t,qc,0)),t.type!=qc&&t.type!=Fc&&or(e,"*"),Ne(e),r=ur(e),r.type==Zc&&(r=Ye(wf,r,qc,0)),r.type!=qc&&r.type!=Fc&&lr(e,"*"),t.type==Fc&&r.type==Fc&&Ua(e,"multiplication of linear forms not allowed"),t=t.type==qc&&r.type==qc?Ue(Uf,t,r,qc,0):Ue(Uf,t,r,Fc,0)
else if(e.b==Pu)t.type==Zc&&(t=Ye(wf,t,qc,0)),t.type!=qc&&t.type!=Fc&&or(e,"/"),Ne(e),r=ur(e),r.type==Zc&&(r=Ye(wf,r,qc,0)),r.type!=qc&&lr(e,"/"),t=t.type==qc?Ue(Hf,t,r,qc,0):Ue(Hf,t,r,Fc,0)
else if(e.b==uu)t.type==Zc&&(t=Ye(wf,t,qc,0)),t.type!=qc&&or(e,"div"),Ne(e),r=ur(e),r.type==Zc&&(r=Ye(wf,r,qc,0)),r.type!=qc&&lr(e,"div"),t=Ue(Kf,t,r,qc,0)
else{if(e.b!=bu)break
t.type==Zc&&(t=Ye(wf,t,qc,0)),t.type!=qc&&or(e,"mod"),Ne(e),r=ur(e),r.type==Zc&&(r=Ye(wf,r,qc,0)),r.type!=qc&&lr(e,"mod"),t=Ue(Wf,t,r,qc,0)}return t}function dr(e){for(var r,t=fr(e);;)if(e.b==Au)t.type==Zc&&(t=Ye(wf,t,qc,0)),t.type!=qc&&t.type!=Fc&&or(e,"+"),Ne(e),r=fr(e),r.type==Zc&&(r=Ye(wf,r,qc,0)),r.type!=qc&&r.type!=Fc&&lr(e,"+"),t.type==qc&&r.type==Fc&&(t=Ye(Af,t,Fc,0)),t.type==Fc&&r.type==qc&&(r=Ye(Af,r,Fc,0)),t=Ue(Gf,t,r,t.type,0)
else if(e.b==Lu)t.type==Zc&&(t=Ye(wf,t,qc,0)),t.type!=qc&&t.type!=Fc&&or(e,"-"),Ne(e),r=fr(e),r.type==Zc&&(r=Ye(wf,r,qc,0)),r.type!=qc&&r.type!=Fc&&lr(e,"-"),t.type==qc&&r.type==Fc&&(t=Ye(Af,t,Fc,0)),t.type==Fc&&r.type==qc&&(r=Ye(Af,r,Fc,0)),t=Ue(qf,t,r,t.type,0)
else{if(e.b!=vu)break
t.type==Zc&&(t=Ye(wf,t,qc,0)),t.type!=qc&&or(e,"less"),Ne(e),r=fr(e),r.type==Zc&&(r=Ye(wf,r,qc,0)),r.type!=qc&&lr(e,"less"),t=Ue(Yf,t,r,qc,0)}return t}function hr(e){for(var r,t=dr(e);e.b==Fu;)t.type==qc&&(t=Ye(Mf,t,Zc,0)),t.type!=Zc&&or(e,"&"),Ne(e),r=dr(e),r.type==qc&&(r=Ye(Mf,r,Zc,0)),r.type!=Zc&&lr(e,"&"),t=Ue(td,t,r,Zc,0)
return t}function mr(e){var r,t,a=hr(e)
return e.b==Gu&&(a.type==Zc&&(a=Ye(wf,a,qc,0)),a.type!=qc&&or(e,".."),Ne(e),r=hr(e),r.type==Zc&&(r=Ye(wf,r,qc,0)),r.type!=qc&&lr(e,".."),e.b==lu?(Ne(e),t=hr(e),t.type==Zc&&(t=Ye(wf,t,qc,0)),t.type!=qc&&lr(e,"by")):t=null,a=He(_d,a,r,t,jc,1)),a}function pr(e){for(var r,t=mr(e);e.b==su;)t.type!=jc&&or(e,"cross"),Ne(e),r=mr(e),r.type!=jc&&lr(e,"cross"),t=Ue(pd,t,r,jc,t.q+r.q)
return t}function vr(e){for(var r,t=pr(e);e.b==pu;)t.type!=jc&&or(e,"inter"),Ne(e),r=pr(e),r.type!=jc&&lr(e,"inter"),t.q!=r.q&&sr(e,"inter",t.q,r.q),t=Ue(md,t,r,jc,t.q)
return t}function br(e){for(var r,t=vr(e);;)if(e.b==_u)t.type!=jc&&or(e,"union"),Ne(e),r=vr(e),r.type!=jc&&lr(e,"union"),t.q!=r.q&&sr(e,"union",t.q,r.q),t=Ue(fd,t,r,jc,t.q)
else if(e.b==cu)t.type!=jc&&or(e,"diff"),Ne(e),r=vr(e),r.type!=jc&&lr(e,"diff"),t.q!=r.q&&sr(e,"diff",t.q,r.q),t=Ue(dd,t,r,jc,t.q)
else{if(e.b!=wu)break
t.type!=jc&&or(e,"symdiff"),Ne(e),r=vr(e),r.type!=jc&&lr(e,"symdiff"),t.q!=r.q&&sr(e,"symdiff",t.q,r.q),t=Ue(hd,t,r,jc,t.q)}return t}function gr(e){var r,t=-1,a="",n=br(e)
switch(e.b){case Iu:t=ad
break
case Su:t=nd
break
case ju:t=id
break
case Ou:t=od
break
case Xu:t=ld
break
case Eu:t=sd
break
case hu:t=vd
break
case ku:t=gd
break
case gu:a=e.h,Ne(e),e.b==hu?t=bd:e.b==ku?t=xd:Ua(e,"invalid use of "+a),a+=" "
break
default:return n}switch(a+=e.h,t){case id:case sd:case ad:case nd:case ld:case od:n.type!=qc&&n.type!=Zc&&or(e,a),Ne(e),r=br(e),r.type!=qc&&r.type!=Zc&&lr(e,a),n.type==qc&&r.type==Zc&&(n=Ye(Mf,n,Zc,0)),n.type==Zc&&r.type==qc&&(r=Ye(Mf,r,Zc,0)),n=Ue(t,n,r,Nc,0)
break
case vd:case bd:n.type==qc&&(n=Ye(Mf,n,Zc,0)),n.type==Zc&&(n=Ye(kf,n,Qc,1)),n.type!=Qc&&or(e,a),Ne(e),r=br(e),r.type!=jc&&lr(e,a),n.q!=r.q&&sr(e,a,n.q,r.q),n=Ue(t,n,r,Nc,0)
break
case gd:case xd:n.type!=jc&&or(e,a),Ne(e),r=br(e),r.type!=jc&&lr(e,a),n.q!=r.q&&sr(e,a,n.q,r.q),n=Ue(t,n,r,Nc,0)}return n}function xr(e){var r,t
return e.b==gu?(t=e.h,Ne(e),r=gr(e),r.type==Zc&&(r=Ye(wf,r,qc,0)),r.type==qc&&(r=Ye(_f,r,Nc,0)),r.type!=Nc&&lr(e,t),r=Ye(Pf,r,Nc,0)):r=gr(e),r}function yr(e){for(var r,t="",a=xr(e);e.b==ou;)t=e.h,a.type==Zc&&(a=Ye(wf,a,qc,0)),a.type==qc&&(a=Ye(_f,a,Nc,0)),a.type!=Nc&&or(e,t),Ne(e),r=xr(e),r.type==Zc&&(r=Ye(wf,r,qc,0)),r.type==qc&&(r=Ye(_f,r,Nc,0)),r.type!=Nc&&lr(e,t),a=Ue(cd,a,r,Nc,0)
return a}function wr(e){for(var r,t=yr(e);e.b==xu;){var a=e.h
t.type==Zc&&(t=Ye(wf,t,qc,0)),t.type==qc&&(t=Ye(_f,t,Nc,0)),t.type!=Nc&&or(e,a),Ne(e),r=yr(e),r.type==Zc&&(r=Ye(wf,r,qc,0)),r.type==qc&&(r=Ye(_f,r,Nc,0)),r.type!=Nc&&lr(e,a),t=Ue(ud,t,r,Nc,0)}return t}function Mr(e){function r(){Ua(e,"at most one := or default/data allowed")}function t(){Ua(e,e.h+" not a plain set")}function a(){Ua(e,"dimension of "+e.h+" too small")}function n(){Ua(e,"component number must be integer between 1 and "+l.set.X)}var i,o,l,s=0
for(Ne(e),e.b!=tu&&(Ge(e)?Ua(e,"invalid use of reserved keyword "+e.h):Ua(e,"symbolic name missing where expected")),null!=e.V[e.h]&&Ua(e,e.h+" multiply declared"),i={},i.name=e.h,i.Ib=null,i.q=0,i.domain=null,i.X=0,i.Bf=null,i.assign=null,i.xa=null,i.Yc=null,i.data=0,i.O=null,Ne(e),e.b==iu&&(i.Ib=e.h,Ne(e)),e.b==Ku&&(i.domain=rr(e),i.q=ir(i.domain)),o=e.V[i.name]={},o.type=Kc,o.link=i;;){if(e.b==Tu)Ne(e)
else if(e.b==Ru)break
if(De(e,"dimen")){var c
Ne(e),e.b==nu&&1<=e.value&&20>=e.value&&Math.floor(e.value)==e.value||Ua(e,"dimension must be integer between 1 and 20"),c=e.value+.5|0,s&&Ua(e,"at most one dimension attribute allowed"),0<i.X&&Ua(e,"dimension "+c+" conflicts with dimension "+i.X+" already determined"),i.X=c,s=1,Ne(e)}else if(e.b==ku||e.b==hu){if(e.b!=hu||e.rg||(Ha(e,"keyword in understood as within"),e.rg=1),Ne(e),c={code:null,e:null},null==i.Bf)i.Bf=c
else{for(o=i.Bf;null!=o.e;o=o.e);o.e=c}c.code=br(e),c.code.type!=jc&&Ua(e,"expression following within has invalid type"),0==i.X&&(i.X=c.code.q),i.X!=c.code.q&&Ua(e,"set expression following within must have dimension "+i.X+" rather than "+c.code.q)}else if(e.b==Du)null==i.assign&&null==i.xa&&null==i.Yc||r(),Ne(e),i.assign=br(e),i.assign.type!=jc&&Ua(e,"expression following := has invalid type"),0==i.X&&(i.X=i.assign.q),i.X!=i.assign.q&&Ua(e,"set expression following := must have dimension "+i.X+" rather than "+i.assign.q)
else if(De(e,"default"))null==i.assign&&null==i.xa||r(),Ne(e),i.xa=br(e),i.xa.type!=jc&&Ua(e,"expression following default has invalid type"),0==i.X&&(i.X=i.xa.q),i.X!=i.xa.q&&Ua(e,"set expression following default must have dimension "+i.X+" rather than "+i.xa.q)
else if(De(e,"data")){var u=0
for(c=Array(20),null==i.assign&&null==i.Yc||r(),Ne(e),i.Yc=l={},e.b!=tu&&(Ge(e)?Ua(e,"invalid use of reserved keyword "+e.h):Ua(e,"set name missing where expected")),o=e.V[e.h],null==o&&Ua(e,e.h+" not defined"),o.type!=Kc&&t(),l.set=o.link,0!=l.set.q&&t(),l.set==i&&Ua(e,"set cannot be initialized by itself"),i.q>=l.set.X&&a(),0==i.X&&(i.X=l.set.X-i.q),i.q+i.X>l.set.X?a():i.q+i.X<l.set.X&&Ua(e,"dimension of "+e.h+" too big"),Ne(e),e.b==qu?Ne(e):Ua(e,"left parenthesis missing where expected"),o=0;o<l.set.X;o++)c[o]=0
for(o=0;;)if(e.b!=nu&&Ua(e,"component number missing where expected"),0!=fe(e.h,function(e){u=e})&&n(),1<=u&&u<=l.set.X||n(),0!=c[u-1]&&Ua(e,"component "+u+" multiply specified"),l.Z[o++]=u,c[u-1]=1,Ne(e),e.b==Tu)Ne(e)
else{if(e.b==Yu)break
Ua(e,"syntax error in data attribute")}o<l.set.X&&Ua(e,"there are must be "+l.set.X+" components rather than "+o),Ne(e)}else Ua(e,"syntax error in set statement")}return null!=i.domain&&tr(e,i.domain),0==i.X&&(i.X=1),Ne(e),i}function _r(e){function r(){o&&Ua(e,"at most one binary allowed"),a.type==Zc&&Ua(e,"symbolic parameter cannot be binary"),a.type=Cc,o=1,Ne(e)}function t(){Ua(e,"at most one := or default allowed")}var a,n,i=0,o=0,l=0
for(Ne(e),e.b!=tu&&(Ge(e)?Ua(e,"invalid use of reserved keyword "+e.h):Ua(e,"symbolic name missing where expected")),null!=e.V[e.h]&&Ua(e,e.h+" multiply declared"),a={},a.name=e.h,a.Ib=null,a.q=0,a.domain=null,a.type=qc,a.wd=null,a.qa=null,a.assign=null,a.xa=null,a.data=0,a.Wc=null,a.O=null,Ne(e),e.b==iu&&(a.Ib=e.h,Ne(e)),e.b==Ku&&(a.domain=rr(e),a.q=ir(a.domain)),n=e.V[a.name]={},n.type=Uc,n.link=a;;){if(e.b==Tu)Ne(e)
else if(e.b==Ru)break
if(De(e,"integer"))i&&Ua(e,"at most one integer allowed"),a.type==Zc&&Ua(e,"symbolic parameter cannot be integer"),a.type!=Cc&&(a.type=Tc),i=1,Ne(e)
else if(De(e,"binary"))r()
else if(De(e,"logical"))e.Ke||(Ha(e,"keyword logical understood as binary"),e.Ke=1),r()
else if(De(e,"symbolic"))l&&Ua(e,"at most one symbolic allowed"),a.type!=qc&&Ua(e,"integer or binary parameter cannot be symbolic"),null==a.wd&&null==a.qa&&null==a.assign&&null==a.xa||Ua(e,"keyword symbolic must precede any other parameter attributes"),a.type=Zc,l=1,Ne(e)
else if(e.b==Iu||e.b==Su||e.b==ju||e.b==Ou||e.b==Xu||e.b==Eu){var s,c={}
switch(e.b){case Iu:c.jd=ad,s=e.h
break
case Su:c.jd=nd,s=e.h
break
case ju:c.jd=id,s=e.h
break
case Ou:c.jd=od,s=e.h
break
case Xu:c.jd=ld,s=e.h
break
case Eu:c.jd=sd,s=e.h}if(c.code=null,c.e=null,null==a.wd)a.wd=c
else{for(n=a.wd;null!=n.e;n=n.e);n.e=c}Ne(e),c.code=hr(e),c.code.type!=qc&&c.code.type!=Zc&&Ua(e,"expression following "+s+" has invalid type"),a.type!=Zc&&c.code.type==Zc&&(c.code=Ye(wf,c.code,qc,0)),a.type==Zc&&c.code.type!=Zc&&(c.code=Ye(Mf,c.code,Zc,0))}else if(e.b==hu||e.b==ku){if(e.b!=ku||e.qg||(Ha(e,"keyword within understood as in"),e.qg=1),Ne(e),c={code:null,e:null},null==a.qa)a.qa=c
else{for(n=a.qa;null!=n.e;n=n.e);n.e=c}c.code=br(e),c.code.type!=jc&&Ua(e,"expression following in has invalid type"),1!=c.code.q&&Ua(e,"set expression following in must have dimension 1 rather than "+c.code.q)}else e.b==Du?(null==a.assign&&null==a.xa||t(),Ne(e),a.assign=hr(e),a.assign.type!=qc&&a.assign.type!=Zc&&Ua(e,"expression following := has invalid type"),a.type!=Zc&&a.assign.type==Zc&&(a.assign=Ye(wf,a.assign,qc,0)),a.type==Zc&&a.assign.type!=Zc&&(a.assign=Ye(Mf,a.assign,Zc,0))):De(e,"default")?(null==a.assign&&null==a.xa||t(),Ne(e),a.xa=hr(e),a.xa.type!=qc&&a.xa.type!=Zc&&Ua(e,"expression following default has invalid type"),a.type!=Zc&&a.xa.type==Zc&&(a.xa=Ye(wf,a.xa,qc,0)),a.type==Zc&&a.xa.type!=Zc&&(a.xa=Ye(Mf,a.xa,Zc,0))):Ua(e,"syntax error in parameter statement")}return null!=a.domain&&tr(e,a.domain),Ne(e),a}function kr(e){function r(){a&&Ua(e,"at most one binary allowed"),n.type=Cc,a=1,Ne(e)}var t=0,a=0
e.Ob&&Ua(e,"variable statement must precede solve statement"),Ne(e),e.b!=tu&&(Ge(e)?Ua(e,"invalid use of reserved keyword "+e.h):Ua(e,"symbolic name missing where expected")),null!=e.V[e.h]&&Ua(e,e.h+" multiply declared")
var n={}
n.name=e.h,n.Ib=null,n.q=0,n.domain=null,n.type=qc,n.P=null,n.W=null,n.O=null,Ne(e),e.b==iu&&(n.Ib=e.h,Ne(e)),e.b==Ku&&(n.domain=rr(e),n.q=ir(n.domain))
var i=e.V[n.name]={}
for(i.type=$c,i.link=n;;){if(e.b==Tu)Ne(e)
else if(e.b==Ru)break
De(e,"integer")?(t&&Ua(e,"at most one integer allowed"),n.type!=Cc&&(n.type=Tc),t=1,Ne(e)):De(e,"binary")?r():De(e,"logical")?(e.Ke||(Ha(e,"keyword logical understood as binary"),e.Ke=1),r()):De(e,"symbolic")?Ua(e,"variable cannot be symbolic"):e.b==Ou?(null!=n.P&&(n.P==n.W?Ua(e,"both fixed value and lower bound not allowed"):Ua(e,"at most one lower bound allowed")),Ne(e),n.P=hr(e),n.P.type==Zc&&(n.P=Ye(wf,n.P,qc,0)),n.P.type!=qc&&Ua(e,"expression following >= has invalid type")):e.b==Su?(null!=n.W&&(n.W==n.P?Ua(e,"both fixed value and upper bound not allowed"):Ua(e,"at most one upper bound allowed")),Ne(e),n.W=hr(e),n.W.type==Zc&&(n.W=Ye(wf,n.W,qc,0)),n.W.type!=qc&&Ua(e,"expression following <= has invalid type")):e.b==ju?(null==n.P&&null==n.W||(n.P==n.W?Ua(e,"at most one fixed value allowed"):null!=n.P?Ua(e,"both lower bound and fixed value not allowed"):Ua(e,"both upper bound and fixed value not allowed")),i=e.h,Ne(e),n.P=hr(e),n.P.type==Zc&&(n.P=Ye(wf,n.P,qc,0)),n.P.type!=qc&&Ua(e,"expression following "+i+" has invalid type"),n.W=n.P):e.b==Iu||e.b==Xu||e.b==Eu?Ua(e,"strict bound not allowed"):Ua(e,"syntax error in variable statement")}return null!=n.domain&&tr(e,n.domain),Ne(e),n}function Ar(e){function r(){Ua(e,"syntax error in constraint statement")}var t,a,n,i
e.Ob&&Ua(e,"constraint statement must precede solve statement"),De(e,"subject")?(Ne(e),De(e,"to")||Ua(e,"keyword subject to incomplete"),Ne(e)):De(e,"subj")?(Ne(e),De(e,"to")||Ua(e,"keyword subj to incomplete"),Ne(e)):e.b==yu&&Ne(e),e.b!=tu&&(Ge(e)?Ua(e,"invalid use of reserved keyword "+e.h):Ua(e,"symbolic name missing where expected")),null!=e.V[e.h]&&Ua(e,e.h+" multiply declared")
var o={}
switch(o.name=e.h,o.Ib=null,o.q=0,o.domain=null,o.type=Vc,o.code=null,o.P=null,o.W=null,o.O=null,Ne(e),e.b==iu&&(o.Ib=e.h,Ne(e)),e.b==Ku&&(o.domain=rr(e),o.q=ir(o.domain)),t=e.V[o.name]={},t.type=Vc,t.link=o,e.b!=Nu&&Ua(e,"colon missing where expected"),Ne(e),t=hr(e),t.type==Zc&&(t=Ye(wf,t,qc,0)),t.type!=qc&&t.type!=Fc&&Ua(e,"expression following colon has invalid type"),e.b==Tu&&Ne(e),e.b){case Su:case Ou:case ju:break
case Iu:case Xu:case Eu:Ua(e,"strict inequality not allowed")
break
case Ru:Ua(e,"constraint must be equality or inequality")
break
default:r()}if(i=e.b,n=e.h,Ne(e),a=hr(e),a.type==Zc&&(a=Ye(wf,a,qc,0)),a.type!=qc&&a.type!=Fc&&Ua(e,"expression following "+n+" has invalid type"),e.b==Tu&&(Ne(e),e.b==Ru&&r()),e.b==Iu||e.b==Su||e.b==ju||e.b==Ou||e.b==Xu||e.b==Eu?(i!=ju&&e.b==i||Ua(e,"double inequality must be ... <= ... <= ... or ... >= ... >= ..."),t.type==Fc&&Ua(e,"leftmost expression in double inequality cannot be linear form"),Ne(e),n=hr(e),n.type==Zc&&(n=Ye(wf,a,qc,0)),n.type!=qc&&n.type!=Fc&&Ua(e,"rightmost expression in double inequality constraint has invalid type"),n.type==Fc&&Ua(e,"rightmost expression in double inequality cannot be linear form")):n=null,null!=o.domain&&tr(e,o.domain),t.type!=Fc&&(t=Ye(Af,t,Fc,0)),a.type!=Fc&&(a=Ye(Af,a,Fc,0)),null!=n&&(n=Ye(Af,n,Fc,0)),null==n)switch(i){case Su:o.code=t,o.P=null,o.W=a
break
case Ou:o.code=t,o.P=a,o.W=null
break
case ju:o.code=t,o.P=a,o.W=a}else switch(i){case Su:o.code=a,o.P=t,o.W=n
break
case Ou:o.code=a,o.P=n,o.W=t}return e.b!=Ru&&r(),Ne(e),o}function Lr(e){var r,t={domain:null}
for(t.list=r=null,Ne(e),e.b==Ku&&(t.domain=rr(e)),e.b==Nu&&Ne(e);;){var a={v:{}},n=function(){a.type=Xc,a.v.code=wr(e)}
if(a.type=0,a.e=null,null==t.list?t.list=a:r.e=a,r=a,e.b==tu){var i
if(Ne(e),i=e.b,Re(e),i!=Tu&&i!=Ru)n()
else{switch(n=e.V[e.h],null==n&&Ua(e,e.h+" not defined"),a.type=n.type,n.type){case Bc:a.v.ya=n.link
break
case Kc:a.v.set=n.link
break
case Uc:a.v.S=n.link
break
case $c:a.v.t=n.link,e.Ob||Ua(e,"invalid reference to variable "+a.v.t.name+" above solve statement")
break
case Vc:a.v.H=n.link,e.Ob||Ua(e,"invalid reference to "+(a.v.H.type==Vc?"constraint":"objective")+" "+a.v.H.name+" above solve statement")}Ne(e)}}else n()
if(e.b!=Tu)break
Ne(e)}return null!=t.domain&&tr(e,t.domain),e.b!=Ru&&Ua(e,"syntax error in display statement"),Ne(e),t}function Cr(e){!e.nc&&De(e,"end")||e.nc&&Er(e,"end")?(Ne(e),e.b==Ru?Ne(e):Ha(e,"no semicolon following end statement; missing semicolon inserted")):Ha(e,"unexpected end of file; missing end statement inserted"),e.b!=ru&&Ha(e,"some text detected beyond end statement; text ignored")}function Pr(e,r){var t={v:{}}
if(t.bb=e.bb,t.Vc=e.Vc,t.e=null,De(e,"set"))r&&Ua(e,"set statement not allowed here"),t.type=Kc,t.v.set=Mr(e)
else if(De(e,"param"))r&&Ua(e,"parameter statement not allowed here"),t.type=Uc,t.v.S=_r(e)
else if(De(e,"var"))r&&Ua(e,"variable statement not allowed here"),t.type=$c,t.v.t=kr(e)
else if(De(e,"subject")||De(e,"subj")||e.b==yu)r&&Ua(e,"constraint statement not allowed here"),t.type=Vc,t.v.H=Ar(e)
else if(De(e,"minimize")||De(e,"maximize")){r&&Ua(e,"objective statement not allowed here"),t.type=Vc
var a,n,i=t.v
De(e,"minimize")?n=Dc:De(e,"maximize")&&(n=Rc),e.Ob&&Ua(e,"objective statement must precede solve statement"),Ne(e),e.b!=tu&&(Ge(e)?Ua(e,"invalid use of reserved keyword "+e.h):Ua(e,"symbolic name missing where expected")),null!=e.V[e.h]&&Ua(e,e.h+" multiply declared"),a={},a.name=e.h,a.Ib=null,a.q=0,a.domain=null,a.type=n,a.code=null,a.P=null,a.W=null,a.O=null,Ne(e),e.b==iu&&(a.Ib=e.h,Ne(e)),e.b==Ku&&(a.domain=rr(e),a.q=ir(a.domain)),n=e.V[a.name]={},n.type=Vc,n.link=a,e.b!=Nu&&Ua(e,"colon missing where expected"),Ne(e),a.code=hr(e),a.code.type==Zc&&(a.code=Ye(wf,a.code,qc,0)),a.code.type==qc&&(a.code=Ye(Af,a.code,Fc,0)),a.code.type!=Fc&&Ua(e,"expression following colon has invalid type"),null!=a.domain&&tr(e,a.domain),e.b!=Ru&&Ua(e,"syntax error in objective statement"),Ne(e),i.H=a}else if(De(e,"table")){r&&Ua(e,"table statement not allowed here"),t.type=Jc
var o,l,s,i=t.v
for(Ne(e),e.b!=tu&&(Ge(e)?Ua(e,"invalid use of reserved keyword "+e.h):Ua(e,"symbolic name missing where expected")),null!=e.V[e.h]&&Ua(e,e.h+" multiply declared"),a={v:{qa:{},Oc:{}}},a.name=e.h,Ne(e),e.b==iu?(a.Ib=e.h,Ne(e)):a.Ib=null,e.b==Ku?(a.type=Yc,a.v.Oc.domain=rr(e),De(e,"OUT")||Ua(e,"keyword OUT missing where expected")):(a.type=zc,De(e,"IN")||Ua(e,"keyword IN missing where expected")),Ne(e),a.a=n=null;;)if(o={},e.b!=Tu&&e.b!=Nu&&e.b!=Ru||Ua(e,"argument expression missing where expected"),o.code=hr(e),o.code.type==qc&&(o.code=Ye(Mf,o.code,Zc,0)),o.code.type!=Zc&&Ua(e,"argument expression has invalid type"),o.e=null,null==n?a.a=o:n.e=o,n=o,e.b==Tu)Ne(e)
else if(e.b==Nu||e.b==Ru)break
switch(e.b==Nu?Ne(e):Ua(e,"colon missing where expected"),a.type){case zc:for(e.b==tu?(o=e.V[e.h],null==o&&Ua(e,e.h+" not defined"),o.type!=Kc&&Ua(e,e.h+" not a set"),a.v.qa.set=o.link,null!=a.v.qa.set.assign&&Ua(e,e.h+" needs no data"),0!=a.v.qa.set.q&&Ua(e,e.h+" must be a simple set"),Ne(e),e.b==Qu?Ne(e):Ua(e,"delimiter <- missing where expected")):Ge(e)?Ua(e,"invalid use of reserved keyword "+e.h):a.v.qa.set=null,a.v.qa.We=o=null,n=0,e.b==Uu?Ne(e):Ua(e,"field list missing where expected");;)if(l={},e.b!=tu&&(Ge(e)?Ua(e,"invalid use of reserved keyword "+e.h):Ua(e,"field name missing where expected")),l.name=e.h,Ne(e),l.e=null,null==o?a.v.qa.We=l:o.e=l,o=l,n++,e.b==Tu)Ne(e)
else{if(e.b==Hu)break
Ua(e,"syntax error in field list")}for(null!=a.v.qa.set&&a.v.qa.set.X!=n&&Ua(e,"there must be "+a.v.qa.set.X+" field"+(1==a.v.qa.set.X?"":"s")+" rather than "+n),Ne(e),a.v.qa.list=l=null;e.b==Tu;)Ne(e),s={},e.b!=tu&&(Ge(e)?Ua(e,"invalid use of reserved keyword "+e.h):Ua(e,"parameter name missing where expected")),o=e.V[e.h],null==o&&Ua(e,e.h+" not defined"),o.type!=Uc&&Ua(e,e.h+" not a parameter"),s.S=o.link,s.S.q!=n&&Ua(e,e.h+" must have "+n+" subscript"+(1==n?"":"s")+" rather than "+s.S.q),null!=s.S.assign&&Ua(e,e.h+" needs no data"),Ne(e),e.b==Ju?(Ne(e),e.b!=tu&&(Ge(e)?Ua(e,"invalid use of reserved keyword "+e.h):Ua(e,"field name missing where expected")),o=e.h,Ne(e)):o=s.S.name,s.name=o,s.e=null,null==l?a.v.qa.list=s:l.e=s,l=s
break
case Yc:for(a.v.Oc.list=n=null;;)if(l={},e.b!=Tu&&e.b!=Ru||Ua(e,"expression missing where expected"),o=e.b==tu?e.h:"",l.code=hr(e),e.b==Ju&&(Ne(e),e.b!=tu&&(Ge(e)?Ua(e,"invalid use of reserved keyword "+e.h):Ua(e,"field name missing where expected")),o=e.h,Ne(e)),""==o&&Ua(e,"field name required"),l.name=o,l.e=null,null==n?a.v.Oc.list=l:n.e=l,n=l,e.b==Tu)Ne(e)
else{if(e.b==Ru)break
Ua(e,"syntax error in output list")}tr(e,a.v.Oc.domain)}e.b!=Ru&&Ua(e,"syntax error in table statement"),Ne(e),i.nd=a}else if(De(e,"solve"))r&&Ua(e,"solve statement not allowed here"),t.type=Wc,i=t.v,e.Ob&&Ua(e,"at most one solve statement allowed"),e.Ob=1,Ne(e),e.b!=Ru&&Ua(e,"syntax error in solve statement"),Ne(e),i.zh=null
else if(De(e,"check"))t.type=Pc,i=t.v,a={domain:null,code:null},Ne(e),e.b==Ku&&(a.domain=rr(e)),e.b==Nu&&Ne(e),a.code=wr(e),a.code.type!=Nc&&Ua(e,"expression has invalid type"),null!=a.domain&&tr(e,a.domain),e.b!=Ru&&Ua(e,"syntax error in check statement"),Ne(e),i.Rg=a
else if(De(e,"display"))t.type=Ic,t.v.Sg=Lr(e)
else if(De(e,"printf")){for(t.type=Hc,i=t.v,o={domain:null,zd:null},o.list=n=null,Ne(e),e.b==Ku&&(o.domain=rr(e)),e.b==Nu&&Ne(e),o.zd=hr(e),o.zd.type==qc&&(o.zd=Ye(Mf,o.zd,Zc,0)),o.zd.type!=Zc&&Ua(e,"format expression has invalid type");e.b==Tu;)Ne(e),a={code:null,e:null},null==o.list?o.list=a:n.e=a,n=a,a.code=br(e),a.code.type!=qc&&a.code.type!=Zc&&a.code.type!=Nc&&Ua(e,"only numeric, symbolic, or logical expression allowed")
null!=o.domain&&tr(e,o.domain),o.Ea=null,o.Mg=0,e.b!=Xu&&e.b!=Zu||(o.Mg=e.b==Zu,Ne(e),o.Ea=hr(e),o.Ea.type==qc&&(o.Ea=Ye(Mf,o.Ea,Zc,0)),o.Ea.type!=Zc&&Ua(e,"file name expression has invalid type")),e.b!=Ru&&Ua(e,"syntax error in printf statement"),Ne(e),i.nh=o}else if(De(e,"for")){if(t.type=Ec,i=t.v,o={domain:null},o.list=n=null,Ne(e),e.b!=Ku&&Ua(e,"indexing expression missing where expected"),o.domain=rr(e),e.b==Nu&&Ne(e),e.b!=Ku)o.list=Pr(e,1)
else{for(Ne(e);e.b!=Wu;)a=Pr(e,1),null==n?o.list=a:n.e=a,n=a
Ne(e)}tr(e,o.domain),i.Ug=o}else e.b==tu?(r&&Ua(e,"constraint statement not allowed here"),t.type=Vc,t.v.H=Ar(e)):Ge(e)?Ua(e,"invalid use of reserved keyword "+e.h):Ua(e,"syntax error in model section")
return t}function Vr(e){var r,t
for(t=null;e.b!=ru&&!De(e,"data")&&!De(e,"end");)r=Pr(e,0),null==t?e.uc=r:t.e=r,t=r}function Ir(e,r){var t,a={}
if(a.Y=r,a.e=null,null==e)e=a
else{for(t=e;null!=t.e;t=t.e);t.e=a}return e}function Sr(e){for(var r=0;null!=e;e=e.e)r++
return r}function jr(e){for(var r=0;null!=e;e=e.e)null==e.Y&&r++
return r}function Or(e){for(var r=null;0<e--;)r=Ir(r,null)
return r}function Xr(e){return e.b==nu||e.b==au||e.b==iu}function Er(e,r){return Xr(e)&&e.h==r}function Fr(e){var r
return r=e.b==nu?bt(e.value):gt(e.h),Ne(e),r}function Br(e,r,t){var a,n
switch(e.b){case Uu:n=Hu
break
case qu:n=Yu}for(0==t&&Ua(e,r+" cannot be subscripted"),Ne(e),a=null;;)if(Xr(e)?a=Ir(a,Fr(e)):e.b==Cu?(a=Ir(a,null),Ne(e)):Ua(e,"number, symbol, or asterisk missing where expected"),e.b==Tu)Ne(e)
else{if(e.b==n)break
Ua(e,"syntax error in slice")}if(Sr(a)!=t)switch(n){case Hu:Ua(e,r+" must have "+t+" subscript"+(1==t?"":"s")+", not "+Sr(a))
break
case Yu:Ua(e,r+" has dimension "+t+", not "+Sr(a))}return Ne(e),a}function zr(e,r){var t
return t=e.V[r],null!=t&&t.type==Kc||Ua(e,r+" not a set"),t=t.link,null==t.assign&&null==t.Yc||Ua(e,r+" needs no data"),t.data=1,t}function Tr(e,r,t){var a,n,i=null
for(a=null;null!=t;t=t.e)null==t.Y?(Xr(e)||(n=jr(t),1==n?Ua(e,"one item missing in data group beginning with "+wt(i)):Ua(e,n+" items missing in data group beginning with "+wt(i))),n=Fr(e),null==i&&(i=n)):n=xt(t.Y),a=Mt(a,n),null!=t.e&&e.b==Tu&&Ne(e)
Vt(e,r.value.set,a)}function Nr(e,r,t,a){var n,i,o,l,s
for(n=null;e.b!=Du;)Xr(e)||Ua(e,"number, symbol, or := missing where expected"),n=Ir(n,Fr(e))
for(Ne(e);Xr(e);)for(s=Fr(e),i=n;null!=i;i=i.e){var c=0
if(!Er(e,"+")){if(Er(e,"-")){Ne(e)
continue}o=Sr(i),1==o?Ua(e,"one item missing in data group beginning with "+wt(s)):Ua(e,o+" items missing in data group beginning with "+wt(s))}for(l=null,o=t;null!=o;o=o.e)if(null==o.Y)switch(++c){case 1:l=Mt(l,xt(a?i.Y:s))
break
case 2:l=Mt(l,xt(a?s:i.Y))}else l=Mt(l,xt(o.Y))
Vt(e,r.value.set,l),Ne(e)}}function Rr(e){function r(){Ua(e,"slice currently used must specify 2 asterisks, not "+jr(l))}function t(){Ua(e,"transpose indicator (tr) incomplete")}function a(){Ne(e),Er(e,"tr")||t(),2!=jr(l)&&r(),Ne(e),e.b!=Yu&&t(),Ne(e),e.b==Nu&&Ne(e),s=1,Nr(e,o,l,s)}var n,i,o,l,s=0
if(Ne(e),Xr(e)||Ua(e,"set name missing where expected"),n=zr(e,e.h),Ne(e),i=null,e.b==Uu){for(0==n.q&&Ua(e,n.name+" cannot be subscripted"),Ne(e);;)if(Xr(e)||Ua(e,"number or symbol missing where expected"),i=Mt(i,Fr(e)),e.b==Tu)Ne(e)
else{if(e.b==Hu)break
Ua(e,"syntax error in subscript list")}n.q!=_t(i)&&Ua(e,n.name+" must have "+n.q+" subscript"+(1==n.q?"":"s")+" rather than "+_t(i)),Ne(e)}else 0!=n.q&&Ua(e,n.name+" must be subscripted")
for(null!=Nt(e,n.O,i)&&Ua(e,n.name+Ct("[",i)+" already defined"),o=Rt(n.O,i),o.value.set=zt(e,Gc,n.X),l=Or(n.X);;)if(e.b==Tu&&Ne(e),e.b==Du)Ne(e)
else if(e.b==qu)Ne(e),i=Er(e,"tr"),Re(e),i?a():(l=Br(e,n.name,n.X),s=0,0==jr(l)&&Tr(e,o,l))
else if(Xr(e))Tr(e,o,l)
else if(e.b==Nu)2!=jr(l)&&r(),Ne(e),Nr(e,o,l,s)
else if(e.b==qu)a()
else{if(e.b==Ru){Ne(e)
break}Ua(e,"syntax error in set data block")}}function Dr(e,r){var t
return t=e.V[r],null!=t&&t.type==Uc||Ua(e,r+" not a parameter"),t=t.link,null!=t.assign&&Ua(e,r+" needs no data"),t.data&&Ua(e,r+" already provided with data"),t.data=1,t}function Gr(e,r,t){null!=r.xa&&Ua(e,"default value for "+r.name+" already specified in model section"),r.Wc=t}function qr(e,r,t){switch(null!=Nt(e,r.O,t)&&Ua(e,r.name+Ct("[",t)+" already defined"),t=Rt(r.O,t),r.type){case qc:case Tc:case Cc:e.b==nu||Ua(e,r.name+" requires numeric data"),r=t.value,t=e.value,Ne(e),r.Q=t
break
case Zc:t.value.Y=Fr(e)}}function Yr(e,r,t){var a,n,i=null
for(a=null;null!=t;t=t.e)null==t.Y?(Xr(e)||Ua(e,jr(t)+1+" items missing in data group beginning with "+wt(i)),n=Fr(e),null==i&&(i=n)):n=xt(t.Y),a=Mt(a,n),e.b==Tu&&Ne(e)
Xr(e)||Ua(e,"one item missing in data group beginning with "+wt(i)),qr(e,r,a)}function Ur(e,r,t,a){var n,i,o,l,s
for(n=null;e.b!=Du;)Xr(e)||Ua(e,"number, symbol, or := missing where expected"),n=Ir(n,Fr(e))
for(Ne(e);Xr(e);)for(s=Fr(e),i=n;null!=i;i=i.e){var c=0
if(Er(e,"."))Ne(e)
else{for(l=null,o=t;null!=o;o=o.e)if(null==o.Y)switch(++c){case 1:l=Mt(l,xt(a?i.Y:s))
break
case 2:l=Mt(l,xt(a?s:i.Y))}else l=Mt(l,xt(o.Y))
Xr(e)||(o=Sr(i),1==o?Ua(e,"one item missing in data group beginning with "+wt(s)):Ua(e,o+" items missing in data group beginning with "+wt(s))),qr(e,r,l)}}}function Hr(e,r){var t,a,n,i,o=null,l=0
for(i=null,Xr(e)&&(Ne(e),a=e.b,Re(e),a==Nu&&(o=zr(e,e.h),0!=o.q&&Ua(e,o.name+" must be a simple set"),null!=o.O.head&&Ua(e,o.name+" already defined"),Rt(o.O,null).value.set=zt(e,Gc,o.X),i=o.name,l=o.X,Ne(e),Ne(e))),a=null;e.b!=Du;)Xr(e)||Ua(e,"parameter name or := missing where expected"),t=Dr(e,e.h),0==t.q&&Ua(e,e.h+" not a subscripted parameter"),0!=l&&t.q!=l&&Ua(e,i+" has dimension "+l+" while "+t.name+" has dimension "+t.q),null!=r&&Gr(e,t,xt(r)),a=Ir(a,t),i=t.name,l=t.q,Ne(e),e.b==Tu&&Ne(e)
for(0==Sr(a)&&Ua(e,"at least one parameter name required"),Ne(e),e.b==Tu&&Ne(e);Xr(e);){for(i=null,n=1;n<=l;n++)Xr(e)||(t=Sr(a)+l-n+1,Ua(e,t+" items missing in data group beginning with "+wt(i.Y))),i=Mt(i,Fr(e)),n<l&&e.b==Tu&&Ne(e)
for(null!=o&&Vt(e,o.O.head.value.set,kt(i)),e.b==Tu&&Ne(e),n=a;null!=n;n=n.e)Er(e,".")?Ne(e):(Xr(e)||(t=Sr(n),1==t?Ua(e,"one item missing in data group beginning with "+wt(i.Y)):Ua(e,t+" items missing in data group beginning with "+wt(i.Y))),qr(e,n.Y,kt(i)),null!=n.e&&e.b==Tu&&Ne(e))
e.b==Tu&&(Ne(e),Xr(e)||Re(e))}for(n=a;null!=n;n=n.e)n.Y=null}function Kr(e){function r(){Ua(e,n.name+" not a subscripted parameter")}function t(){Ua(e,"slice currently used must specify 2 asterisks, not "+jr(i))}function a(){Ua(e,"transpose indicator (tr) incomplete")}var n,i,o=null,l=0
if(Ne(e),Er(e,"default")&&(Ne(e),Xr(e)||Ua(e,"default value missing where expected"),o=Fr(e),e.b!=Nu&&Ua(e,"colon missing where expected")),e.b==Nu)Ne(e),e.b==Tu&&Ne(e),Hr(e,o),e.b!=Ru&&Ua(e,"symbol, number, or semicolon missing where expected"),Ne(e)
else for(Xr(e)||Ua(e,"parameter name missing where expected"),n=Dr(e,e.h),Ne(e),Er(e,"default")&&(Ne(e),Xr(e)||Ua(e,"default value missing where expected"),o=Fr(e),Gr(e,n,o)),i=Or(n.q);;)if(e.b==Tu&&Ne(e),e.b==Du)Ne(e)
else if(e.b==Uu)i=Br(e,n.name,n.q),l=0
else if(Xr(e))Yr(e,n,i)
else if(e.b==Nu)0==n.q&&r(),2!=jr(i)&&t(),Ne(e),Ur(e,n,i,l)
else if(e.b==qu)Ne(e),Er(e,"tr")||a(),0==n.q&&r(),2!=jr(i)&&t(),Ne(e),e.b!=Yu&&a(),Ne(e),e.b==Nu&&Ne(e),l=1,Ur(e,n,i,l)
else{if(e.b==Ru){Ne(e)
break}Ua(e,"syntax error in parameter data block")}}function Wr(e){for(;e.b!=ru&&!Er(e,"end");)Er(e,"set")?Rr(e):Er(e,"param")?Kr(e):Ua(e,"syntax error in data section")}function Zr(e,r,t){return(0<r&&0<t&&r>.999*hi-t||0>r&&0>t&&r<-.999*hi-t)&&Ua(e,r+" + "+t+"; floating-point overflow"),r+t}function Jr(e,r,t){return(0<r&&0>t&&r>.999*hi+t||0>r&&0<t&&r<-.999*hi+t)&&Ua(e,r+" - "+t+"; floating-point overflow"),r-t}function Qr(e,r,t){return r<t?0:(0<r&&0>t&&r>.999*hi+t&&Ua(e,r+" less "+t+"; floating-point overflow"),r-t)}function $r(e,r,t){return 1<Math.abs(t)&&Math.abs(r)>.999*hi/Math.abs(t)&&Ua(e,r+" * "+t+"; floating-point overflow"),r*t}function et(e,r,t){return Math.abs(t)<mi&&Ua(e,r+" / "+t+"; floating-point zero divide"),1>Math.abs(t)&&Math.abs(r)>.999*hi*Math.abs(t)&&Ua(e,r+" / "+t+"; floating-point overflow"),r/t}function rt(e,r,t){return Math.abs(t)<mi&&Ua(e,r+" div "+t+"; floating-point zero divide"),1>Math.abs(t)&&Math.abs(r)>.999*hi*Math.abs(t)&&Ua(e,r+" div "+t+"; floating-point overflow"),r/=t,0<r?Math.floor(r):0>r?Math.ceil(r):0}function tt(e,r){var t
return 0==e?t=0:0==r?t=e:0!=(t=Math.abs(e)%Math.abs(r))&&(0>e&&(t=-t),0<e&&0>r||0>e&&0<r)&&(t+=r),t}function at(e,r,t){return(0==r&&0>=t||0>r&&t!=Math.floor(t))&&Ua(e,r+" ** "+t+"; result undefined"),0==r?e=Math.pow(r,t):((1<Math.abs(r)&&1<t&&+Math.log(Math.abs(r))>.999*Math.log(hi)/t||1>Math.abs(r)&&-1>t&&+Math.log(Math.abs(r))<.999*Math.log(hi)/t)&&Ua(e,r+" ** "+t+"; floating-point overflow"),e=1<Math.abs(r)&&-1>t&&-Math.log(Math.abs(r))<.999*Math.log(hi)/t||1>Math.abs(r)&&1<t&&-Math.log(Math.abs(r))>.999*Math.log(hi)/t?0:Math.pow(r,t)),e}function nt(e,r){return r>.999*Math.log(hi)&&Ua(e,"exp("+r+"); floating-point overflow"),Math.exp(r)}function it(e,r){return 0>=r&&Ua(e,"log("+r+"); non-positive argument"),Math.log(r)}function ot(e,r){return 0>=r&&Ua(e,"log10("+r+"); non-positive argument"),Math.log(r)/Math.LN10}function lt(e,r){return 0>r&&Ua(e,"sqrt("+r+"); negative argument"),Math.sqrt(r)}function st(e,r){return-1e6<=r&&1e6>=r||Ua(e,"sin("+r+"); argument too large"),Math.sin(r)}function ct(e,r){return-1e6<=r&&1e6>=r||Ua(e,"cos("+r+"); argument too large"),Math.cos(r)}function ut(e){return Math.atan(e)}function ft(e,r){return Math.atan2(e,r)}function dt(e,r,t){return t!=Math.floor(t)&&Ua(e,"round("+r+", "+t+"); non-integer second argument"),18>=t&&(e=Math.pow(10,t),Math.abs(r)<.999*hi/e&&0!=(r=Math.floor(r*e+.5))&&(r/=e)),r}function ht(e,r,t){return t!=Math.floor(t)&&Ua(e,"trunc("+r+", "+t+"); non-integer second argument"),18>=t&&(e=Math.pow(10,t),Math.abs(r)<.999*hi/e&&0!=(r=0<=r?Math.floor(r*e):Math.ceil(r*e))&&(r/=e)),r}function mt(e,r,t){var a
return r>=t&&Ua(e,"Uniform("+r+", "+t+"); invalid range"),a=ni(e.Gd)/2147483648,a=Zr(e,r*(1-a),t*a)}function pt(e){var r,t
do{r=ni(e.Gd)/2147483648*2-1,t=ni(e.Gd)/2147483648*2-1,r=r*r+t*t}while(1<r||0==r)
return t*Math.sqrt(-2*Math.log(r)/r)}function vt(e,r,t){return Zr(e,r,$r(e,t,pt(e)))}function bt(e){var r={}
return r.Q=e,r.M=null,r}function gt(e){var r={Q:0}
return r.M=e,r}function xt(e){var r={}
return null==e.M?(r.Q=e.Q,r.M=null):(r.Q=0,r.M=e.M),r}function yt(e,r){var t
if(null==e.M&&null==r.M)t=e.Q<r.Q?-1:e.Q>r.Q?1:0
else if(null==e.M)t=-1
else if(null==r.M)t=1
else{t=e.M
var a=r.M
t=t==a?0:t>a?1:-1}return t}function wt(e){var r
if(null==e.M)r=String(e.Q)
else{var t,a,n=e.M
if(f(n[0])||"_"==n[0]){for(e=!1,t=1;t<n.length;t++)if(!(d(n[t])||0<="+-._".indexOf(n[t]))){e=!0
break}}else e=!0
r="",a=0
var i=function(e){255>a&&(r+=e,a++)}
for(e&&i("'"),t=0;t<n.length;t++)e&&"'"==n[t]&&i("'"),i(n[t])
e&&i("'"),255==a&&(r=r.slice(0,252)+"...")}return r}function Mt(e,r){var t,a={}
if(a.Y=r,a.e=null,null==e)e=a
else{for(t=e;null!=t.e;t=t.e);t.e=a}return e}function _t(e){for(var r=0;null!=e;e=e.e)r++
return r}function kt(e){var r,t
if(null==e)r=null
else{for(r=t={};null!=e;e=e.e)t.Y=xt(e.Y),null!=e.e&&(t=t.e={})
t.e=null}return r}function At(e,r){var t,a,n
for(t=e,a=r;null!=t;t=t.e,a=a.e)if(0!=(n=yt(t.Y,a.Y)))return n
return 0}function Lt(e,r){for(var t=null,a=1,n=e;a<=r;a++,n=n.e)t=Mt(t,xt(n.Y))
return t}function Ct(e,r){function t(e){255>i&&(o+=e),i++}var a,n,i=0,o="",l="",s=_t(r)
for("["==e&&0<s&&t("["),"("==e&&1<s&&t("("),a=r;null!=a;a=a.e)for(a!=r&&t(","),l=wt(a.Y),n=0;n<l.length;n++)t(l[n])
return"["==e&&0<s&&t("]"),"("==e&&1<s&&t(")"),255==i&&(o=o.slice(0,252)+"..."),o}function Pt(e,r){Rt(e,r).value.eh=null}function Vt(e,r,t){null!=Nt(e,r,t)&&Ua(e,"duplicate tuple "+Ct("(",t)+" detected"),Pt(r,t)}function It(e,r){var t,a
for(t=zt(e,Gc,r.q),a=r.head;null!=a;a=a.e)Pt(t,kt(a.w))
return t}function St(e,r,t,a){var n
return 0==a&&Ua(e,r+" .. "+t+" by "+a+"; zero stride not allowed"),n=0<t&&0>r&&t>.999*hi+r?+hi:0>t&&0<r&&t<-.999*hi+r?-hi:t-r,1>Math.abs(a)&&Math.abs(n)>.999*hi*Math.abs(a)?n=0<n&&0<a||0>n&&0>a?+hi:0:0>(n=Math.floor(n/a)+1)&&(n=0),2147483646<n&&Ua(e,r+" .. "+t+" by "+a+"; set too large"),n+.5|0}function jt(e,r,t,a,n){return 1<=n&&St(e,r,t,a),r+(n-1)*a}function Ot(e){var r
return 0==e?r=null:(r={},r.u=e,r.t=null,r.e=null),r}function Xt(e){var r,t
if(null==e)r=null
else{for(r=t={};null!=e;e=e.e)t.u=e.u,t.t=e.t,null!=e.e&&(t=t.e={})
t.e=null}return r}function Et(e,r,t,a,n){var i,o=null,l=0
for(i=t;null!=i;i=i.e)null==i.t?l=Zr(e,l,$r(e,r,i.u)):i.t.ja=Zr(e,i.t.ja,$r(e,r,i.u))
for(i=n;null!=i;i=i.e)null==i.t?l=Zr(e,l,$r(e,a,i.u)):i.t.ja=Zr(e,i.t.ja,$r(e,a,i.u))
for(i=t;null!=i;i=i.e)null!=i.t&&0!=i.t.ja&&(e={},e.u=i.t.ja,e.t=i.t,e.e=o,o=e,i.t.ja=0)
for(i=n;null!=i;i=i.e)null!=i.t&&0!=i.t.ja&&(e={},e.u=i.t.ja,e.t=i.t,e.e=o,o=e,i.t.ja=0)
return 0!=l&&(e={},e.u=l,e.t=null,e.e=o,o=e),o}function Ft(e,r,t){for(var a,n=null,i=0;null!=r;)a=r,r=r.e,null==a.t?i=Zr(e,i,a.u):(a.e=n,n=a)
return t(i),n}function Bt(e,r){switch(e){case Gc:r.eh=null
break
case qc:r.Q=0
break
case Zc:r.Y=null
break
case Nc:r.sg=0
break
case Qc:r.w=null
break
case jc:r.set=null
break
case Oc:r.t=null
break
case Fc:r.form=null
break
case Sc:r.H=null}}function zt(e,r,t){var a={}
return a.type=r,a.q=t,a.size=0,a.head=null,a.Xa=null,a.V=!1,a.ca=null,a.e=e.pg,null!=a.e&&(a.e.ca=a),e.pg=a}function Tt(e,r,t){return At(r,t)}function Nt(e,r,t){if(30<r.size&&!r.V){var a={root:null}
for(a.yg=Tt,a.info=e,a.size=0,a.height=0,r.V=a,e=r.head;null!=e;e=e.e)M(r.V,e.w).link=e}if(r.V){for(r=r.V,e=r.root;null!=e&&0!=(a=r.yg(r.info,t,e.key));)e=0>a?e.left:e.right
t=e,e=null==t?null:t.link}else for(e=r.head;null!=e&&0!=At(e.w,t);e=e.e);return e}function Rt(e,r){var t={}
return t.w=r,t.e=null,t.value={},e.size++,null==e.head?e.head=t:e.Xa.e=t,e.Xa=t,null!=e.V&&(M(e.V,t.w).link=t),t}function Dt(e){var r
if(null!=e.Le)for(r=e.list,e=e.Le;null!=r;r=r.e,e=e.e)e:{var t=r,a=e.Y,n=void 0,i=void 0
if(null!=t.value){if(0==yt(t.value,a))break e
t.value=null}for(n=t.list;null!=n;n=n.a.index.e)for(i=n;null!=i;i=i.R)i.valid&&(i.valid=0,Bt(i.type,i.value))
t.value=xt(a)}}function Gt(e,r,t,a,n){var i
return La(e,r.code,t)?(i=r.Le,r.Le=t,Dt(r),n(e,a),r.Le=i,Dt(r),0):1}function qt(e,r){if(null!=r.Kc){var t,a,n=null,i=null
for(t=r.Kc,r.Kc=t.e,a=t.list;null!=a;a=a.e)null==n?n=i={}:i=i.e={},null==a.code?(i.Y=r.w.Y,r.w=r.w.e):i.Y=xa(e,a.code)
for(i.e=null,Gt(e,t,n,r,qt)&&(r.Ve=1),a=t.list;null!=a;a=a.e)n=n.e}else null==r.domain.code||wa(e,r.domain.code)?r.Zd(e,r.info):r.Ve=2}function Yt(e,r,t,a,n){var i={}
return null==r?(n(e,a),i.Ve=0):(i.domain=r,i.Kc=r.list,i.w=t,i.info=a,i.Zd=n,i.Ve=0,qt(e,i)),i.Ve}function Ut(e,r){if(null!=r.Kc){var t,a,n
for(t=r.Kc,r.Kc=t.e,n=null,a=t.list;null!=a;a=a.e)null!=a.code&&(n=Mt(n,xa(e,a.code)))
if(t.code.Ta==_d){var i,o,l,s
for(o=ga(e,t.code.a.a.x),l=ga(e,t.code.a.a.y),s=null==t.code.a.a.z?1:ga(e,t.code.a.a.z),n=St(e,o,l,s),a=Mt(null,bt(0)),i=1;i<=n&&r.Wf;i++)a.Y.Q=jt(e,o,l,s,i),Gt(e,t,a,r,Ut)}else for(i=ka(e,t.code).head;null!=i&&r.Wf;i=i.e){for(o=i.w,l=n,s=!1,a=t.list;null!=a;a=a.e){if(null!=a.code){if(0!=yt(o.Y,l.Y)){s=!0
break}l=l.e}o=o.e}s||Gt(e,t,i.w,r,Ut)}r.Kc=t}else(null==r.domain.code||wa(e,r.domain.code))&&(r.Wf=!r.Zd(e,r.info))}function Ht(e,r,t,a){var n={}
null==r?a(e,t):(n.domain=r,n.Kc=r.list,n.Wf=1,n.info=t,n.Zd=a,Ut(e,n))}function Kt(e,r,t){Ua(e,r+Ct("[",t)+" out of domain")}function Wt(e){var r=null
if(null!=e)for(e=e.list;null!=e;e=e.e)for(var t=e.list;null!=t;t=t.e)null==t.code&&(r=Mt(r,xt(t.value)))
return r}function Zt(e,r,t,a){for(var n=r.Bf,i=1;null!=n;n=n.e,i++)for(var o=a.head;null!=o;o=o.e)if(!La(e,n.code,o.w)){var l=Ct("(",o.w)
Ua(e,r.name+Ct("[",t)+" contains "+l+" which not within specified set; see ("+i+")")}}function Jt(e,r,t){function a(){Zt(e,r,t,n),i=Rt(r.O,kt(t)),i.value.set=n}var n,i=Nt(e,r.O,t)
return null!=i?n=i.value.set:null!=r.assign?(n=ka(e,r.assign),a()):null!=r.xa?(n=ka(e,r.xa),a()):Ua(e,"no value for "+r.name+Ct("[",t)),n}function Qt(e,r){null!=r.ga?Zt(e,r.set,r.ga.w,r.ga.value.set):r.oe=Jt(e,r.set,r.w)}function $t(e,r){var a,n,i,o=r.Yc,l=Array(20)
for(t("Generating "+r.name+"..."),a=o.set,Ht(e,a.domain,a,ra),a=o.set.O.head.value.set.head;null!=a;a=a.e){for(i=kt(a.w),n=0;n<o.set.X;n++)l[n]=null
for(n=0;null!=i;i=i.e)l[o.Z[n++]-1]=i
for(n=0;n<o.set.X;n++)l[n].e=l[n+1]
0==r.q?i=null:(i=l[0],l[r.q-1].e=null),n=Nt(e,r.O,i),null==n&&(n=Rt(r.O,i),n.value.set=zt(e,Gc,r.X)),i=l[r.q],l[o.set.X-1].e=null,Pt(n.value.set,i)}r.data=1}function ea(e,r,t){var a={}
if(a.set=r,a.w=t,null!=r.Yc&&0==r.data&&$t(e,r),1==r.data)for(t=r.O.Xa,r.data=2,a.ga=r.O.head;null!=a.ga&&(Yt(e,r.domain,a.ga.w,a,Qt)&&Kt(e,r.name,a.ga.w),a.ga!=t);a.ga=a.ga.e);return a.ga=null,Yt(e,a.set.domain,a.w,a,Qt)&&Kt(e,r.name,a.w),a.oe}function ra(e,r){return ea(e,r,Wt(r.domain)),0}function ta(e,r,t,a){var n,i
switch(r.type){case Tc:a!=Math.floor(a)&&Ua(e,r.name+Ct("[",t)+" = "+a+" not integer")
break
case Cc:0!=a&&1!=a&&Ua(e,r.name+Ct("[",t)+" = "+a+" not binary")}for(n=r.wd,i=1;null!=n;n=n.e,i++){var o
o=ga(e,n.code)
var l=function(n){Ua(e,r.name+Ct("[",t)+" = "+a+" not "+n+" "+o+"; see ("+i+")")}
switch(n.jd){case ad:a<o||l("<")
break
case nd:a<=o||l("<=")
break
case id:a!=o&&l("=")
break
case od:a>=o||l(">=")
break
case ld:a>o||l(">")
break
case sd:a==o&&l("<>")}}for(i=1,n=r.qa;null!=n;n=n.e,i++)l=Mt(null,bt(a)),La(e,n.code,l)||Ua(e,r.name+Ct("[",t)+" = "+a+" not in specified set; see ("+i+")")}function aa(e,r,t){function a(a){return ta(e,r,t,a),n=Rt(r.O,kt(t)),n.value.Q=a}var n=Nt(e,r.O,t)
return null!=n?n.value.Q:null!=r.assign?a(ga(e,r.assign)):null!=r.xa?a(ga(e,r.xa)):null!=r.Wc?(null!=r.Wc.M&&Ua(e,"cannot convert "+wt(r.Wc)+" to floating-point number"),a(r.Wc.Q)):Ua(e,"no value for "+r.name+Ct("[",t))}function na(e,r){null!=r.ga?ta(e,r.S,r.ga.w,r.ga.value.Q):r.value=aa(e,r.S,r.w)}function ia(e,r,t){var a={}
if(a.S=r,a.w=t,1==r.data)for(t=r.O.Xa,r.data=2,a.ga=r.O.head;null!=a.ga&&(Yt(e,r.domain,a.ga.w,a,na)&&Kt(e,r.name,a.ga.w),a.ga!=t);a.ga=a.ga.e);return a.ga=null,Yt(e,a.S.domain,a.w,a,na)&&Kt(e,r.name,a.w),a.value}function oa(e,r,t,a){var n,i=1
for(n=r.wd;null!=n;n=n.e,i++){var o
switch(o=xa(e,n.code),n.jd){case ad:0>yt(a,o)||(o=wt(o),Ua(e,r.name+Ct("[",t)+" = "+wt(a)+" not < "+o))
break
case nd:0>=yt(a,o)||(o=wt(o),Ua(e,r.name+Ct("[",t)+" = "+wt(a)+" not <= "+o))
break
case id:0!=yt(a,o)&&(o=wt(o),Ua(e,r.name+Ct("[",t)+" = "+wt(a)+" not = "+o))
break
case od:0<=yt(a,o)||(o=wt(o),Ua(e,r.name+Ct("[",t)+" = "+wt(a)+" not >= "+o))
break
case ld:0<yt(a,o)||(o=wt(o),Ua(e,r.name+Ct("[",t)+" = "+wt(a)+" not > "+o))
break
case sd:0==yt(a,o)&&(o=wt(o),Ua(e,r.name+Ct("[",t)+" <> "+wt(a)+" not > "+o))}}for(i=1,n=r.qa;null!=n;n=n.e,i++)o=Mt(null,xt(a)),La(e,n.code,o)||Ua(e,r.name,Ct("[",t)+" = "+wt(a)+" not in specified set; see ("+i+")")}function la(e,r,t){function a(a){return oa(e,r,t,a),n=Rt(r.O,kt(t)),n.value.Y=xt(a),a}var n=Nt(e,r.O,t)
return null!=n?xt(n.value.Y):null!=r.assign?a(xa(e,r.assign)):null!=r.xa?a(xa(e,r.xa)):null!=r.Wc?xt(r.Wc):Ua(e,"no value for "+r.name+Ct("[",t))}function sa(e,r){null!=r.ga?oa(e,r.S,r.ga.w,r.ga.value.Y):r.value=la(e,r.S,r.w)}function ca(e,r,t){var a={}
if(a.S=r,a.w=t,1==r.data)for(t=r.O.Xa,r.data=2,a.ga=r.O.head;null!=a.ga&&(Yt(e,r.domain,a.ga.w,a,sa)&&Kt(e,r.name,a.ga.w),a.ga!=t);a.ga=a.ga.e);return a.ga=null,Yt(e,a.S.domain,a.w,a,sa)&&Kt(e,r.name,a.w),a.value}function ua(e,r){var t=Wt(r.domain)
switch(r.type){case qc:case Tc:case Cc:ia(e,r,t)
break
case Zc:ca(e,r,t)}return 0}function fa(e,r){var t=r.t,a=r.w,n=Nt(e,t.O,a)
null!=n?a=n.value.t:(n=Rt(t.O,kt(a)),a=n.value.t={},a.C=0,a.t=t,a.ga=n,a.P=null==t.P?0:ga(e,t.P),a.W=null==t.W?0:t.W==t.P?a.P:ga(e,t.W),a.ja=0,a.m=0,a.r=a.J=0),r.oe=a}function da(e,r,t){var a={}
return a.t=r,a.w=t,Yt(e,a.t.domain,a.w,a,fa)&&Kt(e,r.name,a.w),a.oe}function ha(e,r,t){var a=null,n=Nt(e,r.O,t)
if(null!=n)t=n.value.H
else{if(n=Rt(r.O,kt(t)),t=n.value.H={},t.ea=0,t.H=r,t.ga=n,t.form=Pa(e,r.code),null==r.P&&null==r.W)t.form=Ft(e,t.form,function(e){a=e}),t.P=t.W=-a
else if(null!=r.P&&null==r.W)t.form=Et(e,1,t.form,-1,Pa(e,r.P)),t.form=Ft(e,t.form,function(e){a=e}),t.P=-a,t.W=0
else if(null==r.P&&null!=r.W)t.form=Et(e,1,t.form,-1,Pa(e,r.W)),t.form=Ft(e,t.form,function(e){a=e}),t.P=0,t.W=-a
else if(r.P==r.W)t.form=Et(e,1,t.form,-1,Pa(e,r.P)),t.form=Ft(e,t.form,function(e){a=e}),t.P=t.W=-a
else{var i=null,o=null
t.form=Ft(e,t.form,function(e){a=e}),Ft(e,Pa(e,r.P),function(e){i=e}),Ft(e,Pa(e,r.W),function(e){o=e}),t.P=Jr(e,i,a),t.W=Jr(e,o,a)}t.m=0,t.r=t.J=0}return t}function ma(e,r){r.oe=ha(e,r.H,r.w)}function pa(e,r,t){var a={}
return a.H=r,a.w=t,Yt(e,a.H.domain,a.w,a,ma)&&Kt(e,r.name,a.w),a.oe}function va(e,r){return pa(e,r,Wt(r.domain)),0}function ba(e,r){var t=ga(e,r.code.a.loop.x)
switch(r.code.Ta){case Pd:r.value=Zr(e,r.value,t)
break
case Vd:r.value=$r(e,r.value,t)
break
case Id:r.value>t&&(r.value=t)
break
case Sd:r.value<t&&(r.value=t)}return 0}function ga(e,r){var t,a,n
if(r.T&&r.valid&&(r.valid=0,Bt(r.type,r.value)),r.valid)return r.value.Q
switch(r.Ta){case of:t=r.a.Q
break
case cf:for(a=null,n=r.a.S.list;null!=n;n=n.e)a=Mt(a,xa(e,n.x))
t=ia(e,r.a.S.S,a)
break
case df:for(a=null,n=r.a.t.list;null!=n;n=n.e)a=Mt(a,xa(e,n.x))
switch(n=da(e,r.a.t.t,a),r.a.t.Ac){case ef:t=null==n.t.P?-hi:n.P
break
case rf:t=null==n.t.W?+hi:n.W
break
case tf:t=n.m
break
case af:t=n.r
break
case nf:t=n.J}break
case hf:for(a=null,n=r.a.H.list;null!=n;n=n.e)a=Mt(a,xa(e,n.x))
switch(n=pa(e,r.a.H.H,a),r.a.H.Ac){case ef:t=null==n.H.P?-hi:n.P
break
case rf:t=null==n.H.W?+hi:n.W
break
case tf:t=n.m
break
case af:t=n.r
break
case nf:t=n.J}break
case bf:t=ii(e.Gd)
break
case gf:t=ni(e.Gd)/2147483648
break
case xf:t=pt(e)
break
case yf:t=Math.round(Date.now()/1e3)
break
case wf:n=xa(e,r.a.a.x),null==n.M?t=n.Q:ue(n.M,function(e){t=e})&&Ua(e,"cannot convert "+wt(n)+" to floating-point number")
break
case Lf:t=+ga(e,r.a.a.x)
break
case Cf:t=-ga(e,r.a.a.x)
break
case Vf:t=Math.abs(ga(e,r.a.a.x))
break
case If:t=Math.ceil(ga(e,r.a.a.x))
break
case Sf:t=Math.floor(ga(e,r.a.a.x))
break
case jf:t=nt(e,ga(e,r.a.a.x))
break
case Of:t=it(e,ga(e,r.a.a.x))
break
case Xf:t=ot(e,ga(e,r.a.a.x))
break
case Ef:t=lt(e,ga(e,r.a.a.x))
break
case Ff:t=st(e,ga(e,r.a.a.x))
break
case Bf:t=ct(e,ga(e,r.a.a.x))
break
case zf:t=ut(ga(e,r.a.a.x))
break
case Jf:t=ft(ga(e,r.a.a.x),ga(e,r.a.a.y))
break
case Tf:t=dt(e,ga(e,r.a.a.x),0)
break
case Qf:t=dt(e,ga(e,r.a.a.x),ga(e,r.a.a.y))
break
case Nf:t=ht(e,ga(e,r.a.a.x),0)
break
case $f:t=ht(e,ga(e,r.a.a.x),ga(e,r.a.a.y))
break
case Gf:t=Zr(e,ga(e,r.a.a.x),ga(e,r.a.a.y))
break
case qf:t=Jr(e,ga(e,r.a.a.x),ga(e,r.a.a.y))
break
case Yf:t=Qr(e,ga(e,r.a.a.x),ga(e,r.a.a.y))
break
case Uf:t=$r(e,ga(e,r.a.a.x),ga(e,r.a.a.y))
break
case Hf:t=et(e,ga(e,r.a.a.x),ga(e,r.a.a.y))
break
case Kf:t=rt(e,ga(e,r.a.a.x),ga(e,r.a.a.y))
break
case Wf:t=tt(ga(e,r.a.a.x),ga(e,r.a.a.y))
break
case Zf:t=at(e,ga(e,r.a.a.x),ga(e,r.a.a.y))
break
case ed:t=mt(e,ga(e,r.a.a.x),ga(e,r.a.a.y))
break
case rd:t=vt(e,ga(e,r.a.a.x),ga(e,r.a.a.y))
break
case Rf:t=ka(e,r.a.a.x).size
break
case Df:n=xa(e,r.a.a.x),a=null==n.M?String(n.Q):n.M,t=a.length
break
case wd:n=xa(e,r.a.a.x),a=null==n.M?String(n.Q):n.M,n=xa(e,r.a.a.y),t=Za(e,a,null==n.M?String(n.Q):n.M)
break
case kd:t=wa(e,r.a.a.x)?ga(e,r.a.a.y):null==r.a.a.z?0:ga(e,r.a.a.z)
break
case Ld:for(t=+hi,n=r.a.list;null!=n;n=n.e)a=ga(e,n.x),t>a&&(t=a)
break
case Cd:for(t=-hi,n=r.a.list;null!=n;n=n.e)a=ga(e,n.x),t<a&&(t=a)
break
case Pd:n={},n.code=r,n.value=0,Ht(e,r.a.loop.domain,n,ba),t=n.value
break
case Vd:n={},n.code=r,n.value=1,Ht(e,r.a.loop.domain,n,ba),t=n.value
break
case Id:n={},n.code=r,n.value=+hi,Ht(e,r.a.loop.domain,n,ba),n.value==+hi&&Ua(e,"min{} over empty set; result undefined"),t=n.value
break
case Sd:n={},n.code=r,n.value=-hi,Ht(e,r.a.loop.domain,n,ba),n.value==-hi&&Ua(e,"max{} over empty set; result undefined"),t=n.value}return r.valid=1,r.value.Q=t}function xa(e,r){var t
if(r.T&&r.valid&&(r.valid=0,Bt(r.type,r.value)),r.valid)return xt(r.value.Y)
switch(r.Ta){case lf:t=gt(r.a.M)
break
case sf:t=xt(r.a.index.ya.value)
break
case uf:var a
for(a=null,t=r.a.S.list;null!=t;t=t.e)a=Mt(a,xa(e,t.x))
t=ca(e,r.a.S.S,a)
break
case Mf:t=bt(ga(e,r.a.a.x))
break
case td:a=xa(e,r.a.a.x),t=xa(e,r.a.a.y),t=gt((null==a.M?String(a.Q):a.M)+(null==t.M?String(t.Q):t.M))
break
case kd:t=wa(e,r.a.a.x)?xa(e,r.a.a.y):null==r.a.a.z?bt(0):xa(e,r.a.a.z)
break
case yd:case Ad:var n
t=xa(e,r.a.a.x),t=null==t.M?String(t.Q):t.M,r.Ta==yd?(n=ga(e,r.a.a.y),n!=Math.floor(n)&&Ua(e,"substr('...', "+n+"); non-integer second argument"),(1>n||n>t.length+1)&&Ua(e,"substr('...', "+n+"); substring out of range")):(n=ga(e,r.a.a.y),a=ga(e,r.a.a.z),n==Math.floor(n)&&a==Math.floor(a)||Ua(e,"substr('...', "+n+", "+a+"); non-integer second and/or third argument"),(1>n||0>a||n+a>t.length+1)&&Ua(e,"substr('...', "+n+", "+a+"); substring out of range")),t=gt(t.slice(n-1,n+a-1))
break
case Md:a=ga(e,r.a.a.x),t=xa(e,r.a.a.y),t=en(e,a,null==t.M?String(t.Q):t.M),t=gt(t)}return r.valid=1,r.value.Y=xt(t),t}function ya(e,r){var t=0
switch(r.code.Ta){case jd:r.value&=wa(e,r.code.a.loop.x),r.value||(t=1)
break
case Od:r.value|=wa(e,r.code.a.loop.x),r.value&&(t=1)}return t}function wa(e,r){var t,a
if(r.T&&r.valid&&(r.valid=0,Bt(r.type,r.value)),r.valid)return r.value.sg
switch(r.Ta){case _f:t=0!=ga(e,r.a.a.x)
break
case Pf:t=!wa(e,r.a.a.x)
break
case ad:r.a.a.x.type==qc?t=ga(e,r.a.a.x)<ga(e,r.a.a.y):(t=xa(e,r.a.a.x),a=xa(e,r.a.a.y),t=0>yt(t,a))
break
case nd:r.a.a.x.type==qc?t=ga(e,r.a.a.x)<=ga(e,r.a.a.y):(t=xa(e,r.a.a.x),a=xa(e,r.a.a.y),t=0>=yt(t,a))
break
case id:r.a.a.x.type==qc?t=ga(e,r.a.a.x)==ga(e,r.a.a.y):(t=xa(e,r.a.a.x),a=xa(e,r.a.a.y),t=0==yt(t,a))
break
case od:r.a.a.x.type==qc?t=ga(e,r.a.a.x)>=ga(e,r.a.a.y):(t=xa(e,r.a.a.x),a=xa(e,r.a.a.y),t=0<=yt(t,a))
break
case ld:r.a.a.x.type==qc?t=ga(e,r.a.a.x)>ga(e,r.a.a.y):(t=xa(e,r.a.a.x),a=xa(e,r.a.a.y),t=0<yt(t,a))
break
case sd:r.a.a.x.type==qc?t=ga(e,r.a.a.x)!=ga(e,r.a.a.y):(t=xa(e,r.a.a.x),a=xa(e,r.a.a.y),t=0!=yt(t,a))
break
case cd:t=wa(e,r.a.a.x)&&wa(e,r.a.a.y)
break
case ud:t=wa(e,r.a.a.x)||wa(e,r.a.a.y)
break
case vd:t=Ma(e,r.a.a.x),t=La(e,r.a.a.y,t)
break
case bd:t=Ma(e,r.a.a.x),t=!La(e,r.a.a.y,t)
break
case gd:for(a=ka(e,r.a.a.x),t=1,a=a.head;null!=a;a=a.e)if(!La(e,r.a.a.y,a.w)){t=0
break}break
case xd:for(a=ka(e,r.a.a.x),t=1,a=a.head;null!=a;a=a.e)if(La(e,r.a.a.y,a.w)){t=0
break}break
case jd:t={},t.code=r,t.value=1,Ht(e,r.a.loop.domain,t,ya),t=t.value
break
case Od:t={},t.code=r,t.value=0,Ht(e,r.a.loop.domain,t,ya),t=t.value}return r.valid=1,r.value.sg=t}function Ma(e,r){var t
if(r.T&&r.valid&&(r.valid=0,Bt(r.type,r.value)),r.valid)return kt(r.value.w)
switch(r.Ta){case mf:t=null
for(var a=r.a.list;null!=a;a=a.e)t=Mt(t,xa(e,a.x))
break
case kf:t=Mt(null,xa(e,r.a.a.x))}return r.valid=1,r.value.w=kt(t),t}function _a(e,r){var t
switch(r.code.Ta){case Xd:t=Ma(e,r.code.a.loop.x),null==Nt(e,r.value,t)&&Pt(r.value,t)
break
case Ed:Pt(r.value,Wt(r.code.a.loop.domain))}return 0}function ka(e,r){var t,a
if(r.T&&r.valid&&(r.valid=0,Bt(r.type,r.value)),r.valid)return It(e,r.value.set)
switch(r.Ta){case ff:for(t=null,a=r.a.set.list;null!=a;a=a.e)t=Mt(t,xa(e,a.x))
t=It(e,ea(e,r.a.set.set,t))
break
case pf:for(t=zt(e,Gc,r.q),a=r.a.list;null!=a;a=a.e)Vt(e,t,Ma(e,a.x))
break
case fd:for(a=ka(e,r.a.a.x),t=ka(e,r.a.a.y).head;null!=t;t=t.e)null==Nt(e,a,t.w)&&Pt(a,kt(t.w))
t=a
break
case dd:var n=ka(e,r.a.a.x)
for(a=ka(e,r.a.a.y),t=zt(e,Gc,n.q),n=n.head;null!=n;n=n.e)null==Nt(e,a,n.w)&&Pt(t,kt(n.w))
break
case hd:a=ka(e,r.a.a.x),t=ka(e,r.a.a.y)
for(var i=zt(e,Gc,a.q),n=a.head;null!=n;n=n.e)null==Nt(e,t,n.w)&&Pt(i,kt(n.w))
for(n=t.head;null!=n;n=n.e)null==Nt(e,a,n.w)&&Pt(i,kt(n.w))
t=i
break
case md:for(n=ka(e,r.a.a.x),a=ka(e,r.a.a.y),t=zt(e,Gc,n.q),n=n.head;null!=n;n=n.e)null!=Nt(e,a,n.w)&&Pt(t,kt(n.w))
break
case pd:n=ka(e,r.a.a.x),a=ka(e,r.a.a.y)
var o,l
for(t=zt(e,Gc,n.q+a.q),n=n.head;null!=n;n=n.e)for(i=a.head;null!=i;i=i.e){for(o=kt(n.w),l=i.w;null!=l;l=l.e)o=Mt(o,xt(l.Y))
Pt(t,o)}break
case _d:for(a=ga(e,r.a.a.x),t=ga(e,r.a.a.y),n=null==r.a.a.z?1:ga(e,r.a.a.z),i=zt(e,Gc,1),o=St(e,a,t,n),l=1;l<=o;l++)Pt(i,Mt(null,bt(jt(e,a,t,n,l))))
t=i
break
case kd:t=wa(e,r.a.a.x)?ka(e,r.a.a.y):ka(e,r.a.a.z)
break
case Xd:a={},a.code=r,a.value=zt(e,Gc,r.q),Ht(e,r.a.loop.domain,a,_a),t=a.value
break
case Ed:a={},a.code=r,a.value=zt(e,Gc,r.q),Ht(e,r.a.loop.domain,a,_a),t=a.value}return r.valid=1,r.value.set=It(e,t),t}function Aa(){}function La(e,r,t){var a,n,i
switch(r.Ta){case ff:for(i=null,n=r.a.set.list;null!=n;n=n.e)i=Mt(i,xa(e,n.x))
r=ea(e,r.a.set.set,i),i=Lt(t,r.q),a=null!=Nt(e,r,i)
break
case pf:for(a=0,i=Lt(t,r.q),n=r.a.list;null!=n&&(t=Ma(e,n.x),!(a=0==At(i,t)));n=n.e);break
case fd:a=La(e,r.a.a.x,t)||La(e,r.a.a.y,t)
break
case dd:a=La(e,r.a.a.x,t)&&!La(e,r.a.a.y,t)
break
case hd:i=La(e,r.a.a.x,t),e=La(e,r.a.a.y,t),a=i&&!e||!i&&e
break
case md:a=La(e,r.a.a.x,t)&&La(e,r.a.a.y,t)
break
case pd:if(a=La(e,r.a.a.x,t)){for(i=1;i<=r.a.a.x.q;i++)t=t.e
a=La(e,r.a.a.y,t)}break
case _d:if(i=ga(e,r.a.a.x),n=ga(e,r.a.a.y),r=null==r.a.a.z?1:ga(e,r.a.a.z),St(e,i,n,r),null!=t.Y.M){a=0
break}if(t=t.Y.Q,0<r&&!(i<=t&&t<=n)||0>r&&!(n<=t&&t<=i)){a=0
break}a=jt(e,i,n,r,1+((t-i)/r+.5|0))==t
break
case kd:a=wa(e,r.a.a.x)?La(e,r.a.a.y,t):La(e,r.a.a.z,t)
break
case Xd:Ua(e,"implementation restriction; in/within setof{} not allowed")
break
case Ed:i=Lt(t,r.q),a=0==Yt(e,r.a.loop.domain,i,null,Aa)}return a}function Ca(e,r){switch(r.code.Ta){case Pd:var t
for(t=Pa(e,r.code.a.loop.x),null==r.value?r.value=t:r.Xa.e=t;null!=t;t=t.e)r.Xa=t}return 0}function Pa(e,r){var t
if(r.T&&r.valid&&(r.valid=0,Bt(r.type,r.value)),r.valid)return Xt(r.value.form)
switch(r.Ta){case df:var a=null
for(t=r.a.t.list;null!=t;t=t.e)a=Mt(a,xa(e,t.x))
t=da(e,r.a.t.t,a),a={u:1},a.t=t,a.e=null,t=a
break
case Af:t=Ot(ga(e,r.a.a.x))
break
case Lf:t=Et(e,0,Ot(0),1,Pa(e,r.a.a.x))
break
case Cf:t=Et(e,0,Ot(0),-1,Pa(e,r.a.a.x))
break
case Gf:t=Et(e,1,Pa(e,r.a.a.x),1,Pa(e,r.a.a.y))
break
case qf:t=Et(e,1,Pa(e,r.a.a.x),-1,Pa(e,r.a.a.y))
break
case Uf:t=r.a.a.x.type==qc?Et(e,ga(e,r.a.a.x),Pa(e,r.a.a.y),0,Ot(0)):Et(e,ga(e,r.a.a.y),Pa(e,r.a.a.x),0,Ot(0))
break
case Hf:t=Et(e,et(e,1,ga(e,r.a.a.y)),Pa(e,r.a.a.x),0,Ot(0))
break
case kd:t=wa(e,r.a.a.x)?Pa(e,r.a.a.y):null==r.a.a.z?Ot(0):Pa(e,r.a.a.z)
break
case Pd:t={},t.code=r,t.value=Ot(0),t.Xa=null,Ht(e,r.a.loop.domain,t,Ca),t=t.value
for(var n,i=0,a=t;null!=a;a=a.e)null==a.t?i=Zr(e,i,a.u):a.t.ja=Zr(e,a.t.ja,a.u)
for(n=t,t=null,a=n;null!=a;a=n)n=a.e,null==a.t&&0!=i?(a.u=i,i=0,a.e=t,t=a):null!=a.t&&0!=a.t.ja&&(a.u=a.t.ja,a.t.ja=0,a.e=t,t=a)}return r.valid=1,r.value.form=Xt(t),t}function Va(e,r){var t,a,n,i=e.Mc
for(n=0,t=r.v.Oc.list;null!=t;t=t.e)switch(n++,t.code.type){case qc:i.type[n]="N",i.Q[n]=ga(e,t.code),i.M[n][0]="\0"
break
case Zc:a=xa(e,t.code),null==a.M?(i.type[n]="N",i.Q[n]=a.Q,i.M[n][0]="\0"):(i.type[n]="S",i.Q[n]=0,i.M[n]=a.M)}return i=e.Mc,i.link.writeRecord(i)&&Ua(e,"error on writing data to table "+e.ib.v.nd.name),0}function Ia(e,r){return wa(e,r.code)||Ua(e,"check"+Ct("[",Wt(r.domain))+" failed"),0}function Sa(e,r,t){var a=t.value.set
for(qa(e,r.name+Ct("[",t.w)+(null==a.head?" is empty":":")),r=a.head;null!=r;r=r.e)qa(e,"   "+Ct("(",r.w))}function ja(e,r,t){switch(r.type){case qc:case Tc:case Cc:qa(e,r.name+Ct("[",t.w)+" = "+t.value.Q)
break
case Zc:qa(e,r.name+Ct("[",t.w)+" = "+wt(t.value.Y))}}function Oa(e,r,t,a){a==$u||a==af?qa(e,r.name+Ct("[",t.w)+".val = "+t.value.t.r):a==ef?qa(e,r.name+Ct("[",t.w)+".lb = "+(null==t.value.t.t.P?-hi:t.value.t.P)):a==rf?qa(e,r.name+Ct("[",t.w)+".ub = "+(null==t.value.t.t.W?+hi:t.value.t.W)):a==tf?qa(e,r.name+Ct("[",t.w)+".status = "+t.value.t.m):a==nf&&qa(e,r.name+Ct("[",t.w)+".dual = "+t.value.t.J)}function Xa(e,r,t,a){a==$u||a==af?qa(e,r.name+Ct("[",t.w)+".val = "+t.value.H.r):a==ef?qa(e,r.name+Ct("[",t.w)+".lb = "+(null==t.value.H.H.P?-hi:t.value.H.P)):a==rf?qa(e,r.name+Ct("[",t.w)+".ub = "+(null==t.value.H.H.W?+hi:t.value.H.W)):a==tf?qa(e,r.name+Ct("[",t.w)+".status = "+t.value.H.m):a==nf&&qa(e,r.name+Ct("[",t.w)+".dual = "+t.value.H.J)}function Ea(e,r){for(var t,a=r.list;null!=a;a=a.e)if(a.type==Bc)t=a.v.ya,qa(e,t.name+" = "+wt(t.value))
else if(a.type==Kc){var n=a.v.set
for(null!=n.assign?Ht(e,n.domain,n,ra):(null!=n.Yc&&0==n.data&&$t(e,n),null!=n.O.head&&ea(e,n,n.O.head.w)),null==n.O.head&&qa(e,n.name+" has empty content"),t=n.O.head;null!=t;t=t.e)Sa(e,n,t)}else if(a.type==Uc)for(n=a.v.S,null!=n.assign?Ht(e,n.domain,n,ua):null!=n.O.head&&(n.type!=Zc?ia(e,n,n.O.head.w):ca(e,n,n.O.head.w)),null==n.O.head&&qa(e,n.name+" has empty content"),t=n.O.head;null!=t;t=t.e)ja(e,n,t)
else if(a.type==$c)for(n=a.v.t,null==n.O.head&&qa(e,n.name+" has empty content"),t=n.O.head;null!=t;t=t.e)Oa(e,n,t,$u)
else if(a.type==Vc)for(n=a.v.H,null==n.O.head&&qa(e,n.name+" has empty content"),t=n.O.head;null!=t;t=t.e)Xa(e,n,t,$u)
else if(a.type==Xc)if(n=a.v.code,n.Ta==cf||n.Ta==uf||n.Ta==ff||n.Ta==df||n.Ta==hf){t=e
var i={value:{}},o=void 0
for(i.w=null,o=n.a.S.list||n.a.t.list;null!=o;o=o.e)i.w=Mt(i.w,xa(t,o.x))
switch(n.Ta){case cf:i.value.Q=ia(t,n.a.S.S,i.w),ja(t,n.a.S.S,i)
break
case uf:i.value.Y=ca(t,n.a.S.S,i.w),ja(t,n.a.S.S,i)
break
case ff:i.value.set=ea(t,n.a.set.set,i.w),Sa(t,n.a.set.set,i)
break
case df:i.value.t=da(t,n.a.t.t,i.w),Oa(t,n.a.t.t,i,n.a.t.Ac)
break
case hf:i.value.H=pa(t,n.a.H.H,i.w),Xa(t,n.a.H.H,i,n.a.H.Ac)}}else switch(t=e,n.type){case qc:n=ga(t,n),qa(t,String(n))
break
case Zc:n=xa(t,n),qa(t,wt(n))
break
case Nc:n=wa(t,n),qa(t,n?"true":"false")
break
case Qc:n=Ma(t,n),qa(t,Ct("(",n))
break
case jc:for(n=ka(t,n),0==n.head&&qa(t,"set is empty"),n=n.head;null!=n;n=n.e)qa(t,"   "+Ct("(",n.w))
break
case Fc:for(i=void 0,n=Pa(t,n),null==n&&qa(t,"linear form is empty"),i=n;null!=i;i=i.e)null==i.t?qa(t,"   "+i.u):qa(t,"   "+i.u+" "+i.t.t.name+Ct("[",i.t.ga.w))}return 0}function Fa(e,r){null==e.Hg?"\n"==r?(e.he(e.dd,e.le),e.dd=""):e.dd+=r:e.Hg(r)}function Ba(e,r){for(var t=0;t<r.length;t++)Fa(e,r[t])}function za(e,r){var t,a,n,i,o,l=xa(e,r.zd)
for(a=null==l.M?String(l.Q):l.M,t=r.list,i=0;i<a.length;i++)if("%"==a[i])if(n=i++,"%"==a[i])Fa(e,"%")
else{if(null==t)break
for(;"-"==a[i]||"+"==a[i]||" "==a[i]||"#"==a[i]||"0"==a[i];)i++
for(;h(a[i]);)i++
if("."==a[i])for(i++;h(a[i]);)i++
if("d"==a[i]||"i"==a[i]||"e"==a[i]||"E"==a[i]||"f"==a[i]||"F"==a[i]||"g"==a[i]||"G"==a[i]){switch(t.code.type){case qc:o=ga(e,t.code)
break
case Zc:l=xa(e,t.code),null!=l.M&&Ua(e,"cannot convert "+wt(l)+" to floating-point number"),o=l.Q
break
case Nc:o=wa(e,t.code)?1:0}"d"==a[i]||"i"==a[i]?(-2147483647<=o&&2147483647>=o||Ua(e,"cannot convert "+o+" to integer"),Ba(e,m(a.slice(n,i+1),0|Math.floor(o+.5)))):Ba(e,m(a.slice(n,i+1),o))}else if("s"==a[i]){switch(t.code.type){case qc:o=String(ga(e,t.code))
break
case Nc:o=wa(e,t.code)?"T":"F"
break
case Zc:l=xa(e,t.code),o=null==l.M?String(l.Q):l.M}Ba(e,m(a.slice(n,i+1),o))}else Ua(e,"format specifier missing or invalid")
t=t.e}else"\\"==a[i]?(i++,"t"==a[i]?Fa(e,"\t"):"n"==a[i]?Fa(e,"\n"):"\0"==a[i]?Ua(e,"invalid use of escape character \\ in format control string"):Fa(e,a[i])):Fa(e,a[i])
return 0}function Ta(e,r){for(var t=e.ib,a=r.list;null!=a;a=a.e)Na(e,a)
return e.ib=t,0}function Na(e,r){switch(e.ib=r,r.type){case Vc:t("Generating "+r.v.H.name+"...")
var a=r.v.H
Ht(e,a.domain,a,va)
break
case Jc:switch(r.v.nd.type){case zc:t("Reading "+r.v.nd.name+"...")
break
case Yc:t("Writing "+r.v.nd.name+"...")}var n,i,o,l,a=r.v.nd
for(e.Mc=o={},o.id=0,o.link=null,o.ff=0,o.a=null,o.Wa=0,o.name=null,o.type=null,o.Q=null,o.M=null,n=a.a;null!=n;n=n.e)o.ff++
for(o.a=Array(1+o.ff),l=1;l<=o.ff;l++)o.a[l]=null
for(l=0,n=a.a;null!=n;n=n.e)l++,i=xa(e,n.code),i=null==i.M?String(i.Q):i.M,o.a[l]=i
switch(a.type){case zc:for(l=a.v.qa.set,null!=l&&(l.data&&Ua(e,l.name+" already provided with data"),Rt(l.O,null).value.set=zt(e,Gc,l.X),l.data=1),i=a.v.qa.list;null!=i;i=i.e)i.S.data&&Ua(e,i.S.name+" already provided with data"),i.S.data=1
for(i=a.v.qa.We;null!=i;i=i.e)o.Wa++
for(i=a.v.qa.list;null!=i;i=i.e)o.Wa++
for(o.name=Array(1+o.Wa),o.type=Array(1+o.Wa),o.Q=new Float64Array(1+o.Wa),o.M=Array(1+o.Wa),l=0,i=a.v.qa.We;null!=i;i=i.e)l++,o.name[l]=i.name,o.type[l]="?",o.Q[l]=0,o.M[l]=""
for(i=a.v.qa.list;null!=i;i=i.e)l++,o.name[l]=i.name,o.type[l]="?",o.Q[l]=0,o.M[l]=""
for(rn(e,"R");;){for(l=1;l<=o.Wa;l++)o.type[l]="?"
if(l=e,n=l.Mc,n=n.link.readRecord(n),0<n&&Ua(l,"error on reading data from table "+l.ib.v.nd.name),n)break
for(l=1;l<=o.Wa;l++)"?"==o.type[l]&&Ua(e,"field "+o.name[l]+" missing in input table")
for(n=null,l=0,i=a.v.qa.We;null!=i;i=i.e)switch(l++,o.type[l]){case"N":n=Mt(n,bt(o.Q[l]))
break
case"S":n=Mt(n,gt(o.M[l]))}for(null!=a.v.qa.set&&Vt(e,a.v.qa.set.O.head.value.set,kt(n)),i=a.v.qa.list;null!=i;i=i.e){var s
switch(l++,null!=Nt(e,i.S.O,n)&&Ua(e,i.S.name+Ct("[",n)+" already defined"),s=Rt(i.S.O,kt(n)),i.S.type){case qc:case Tc:case Cc:"N"!=o.type[l]&&Ua(e,i.S.name+" requires numeric data"),s.value.Q=o.Q[l]
break
case Zc:switch(o.type[l]){case"N":s.value.Y=bt(o.Q[l])
break
case"S":s.value.Y=gt(o.M[l])}}}}e.Mc=null
break
case Yc:for(n=a.v.Oc.list;null!=n;n=n.e)o.Wa++
for(o.name=Array(1+o.Wa),o.type=Array(1+o.Wa),o.Q=new Float64Array(1+o.Wa),o.M=Array(1+o.Wa),l=0,n=a.v.Oc.list;null!=n;n=n.e)l++,o.name[l]=n.name,o.type[l]="?",o.Q[l]=0,o.M[l]=""
rn(e,"W"),Ht(e,a.v.Oc.domain,a,Va),a=e.Mc,a.link.flush(a),e.Mc=null}break
case Pc:t("Checking (line "+r.bb+")..."),a=r.v.Rg,Ht(e,a.domain,a,Ia)
break
case Ic:qa(e,"Display statement at line "+r.bb),a=r.v.Sg,Ht(e,a.domain,a,Ea)
break
case Hc:a=r.v.nh,null==a.Ea?e.le=null:(o=xa(e,a.Ea),e.le=null==o.M?o.Q:o.M),Ht(e,a.domain,a,za)
break
case Ec:a=r.v.Ug,Ht(e,a.domain,a,Ta)}}function Ra(e){var r
for(r=e.uc;null!=r;r=r.e)switch(r.type){case Kc:r.v.set.O=zt(e,jc,r.v.set.q)
break
case Uc:switch(r.v.S.type){case qc:case Tc:case Cc:r.v.S.O=zt(e,qc,r.v.S.q)
break
case Zc:r.v.S.O=zt(e,Zc,r.v.S.q)}break
case $c:r.v.t.O=zt(e,Oc,r.v.t.q)
break
case Vc:r.v.H.O=zt(e,Sc,r.v.H.q)}}function Da(e,r,t){e.bb=0,e.Vc=0,e.l="\n",e.b=0,e.Bb=0,e.h="",e.value=0,e.Hf=ru,e.Gf=0,e.Ff="",e.If=0,e.Te=0,e.Ue=0,e.Mf=0,e.Lf=0,e.Kf="",e.Nf=0,i(e.Zb,0," ",eu),e.lc=0,e.cf=t,e.bf=r||"input",ze(e),Ne(e)}function Ga(e,r,a){null==a?e.he=function(e){t(e)}:(e.he=a,e.jh=r),e.dd=""}function qa(e,r){e.he(r,e.le)}function Ya(e){0<e.dd.length&&(e.he(e.dd,e.le),e.dd="")}function Ua(e,r){var a
switch(e.D){case 1:case 2:a=Error(e.bf+":"+e.bb+": "+r),a.line=e.bb,a.column=e.Vc
for(var i;0<e.lc;)e.lc--,i=e.Zb[0],n(e.Zb,0,e.Zb,1,eu-1),e.Zb[eu-1]=i
t("Context: "+e.bb+" > "+(" "==e.Zb[0]?"":"...")+e.Zb.join("").trim())
break
case 3:i=null==e.ib?0:e.ib.bb
var o=null==e.ib?0:e.ib.Vc
a=Error(i+": "+r),a.line=i,a.column=o}throw e.D=4,a}function Ha(e,r){switch(e.D){case 1:case 2:t(e.bf+":"+e.bb+": warning: "+r)
break
case 3:t(e.Yf+":"+(null==e.ib?0:e.ib.bb)+": warning: "+r)}}function Ka(e){for(var r="";0<e;)r+="^",e--
return r}function Wa(e,r,a,n,i,o){t("Input string passed to str2time:"),t(r),t(Ka(a+1)),t("Format string passed to str2time:\n"),t(n),t(Ka(i+1)),Ua(e,o)}function Za(e,r,t){function a(){Wa(e,r,m,t,p,"time zone offset value incomplete or invalid")}function n(){Wa(e,r,m,t,p,"time zone offset value out of range")}function i(){r[m]!=t[p]&&Wa(e,r,m,t,p,"character mismatch"),m++}var o,l,s,c,u,f,d,h,m,p
for(l=s=c=u=f=d=-1,h=2147483647,p=m=0;p<t.length;p++)if("%"==t[p])if(p++,"b"==t[p]||"h"==t[p]){var v
for(0<=s&&Wa(e,r,m,t,p,"month multiply specified");" "==r[m];)m++
for(s=1;12>=s;s++){v=yh[s-1]
var b=!1
for(o=0;2>=o;o++)if(m[o].toUpperCase()!=v[o].toUpperCase()){b=!0
break}if(!b){for(m+=3,o=3;"\0"!=v[o]&&r[m].toUpperCase()==v[o].toUpperCase();o++)m++
break}}12<s&&Wa(e,r,m,t,p,"abbreviated month name missing or invalid")}else if("d"==t[p]){for(0<=c&&Wa(e,r,m,t,p,"day multiply specified");" "==r[m];)m++
"0"<=r[m]&&"9">=r[m]||Wa(e,r,m,t,p,"day missing or invalid"),c=r[m++]-0,"0"<=r[m]&&"9">=r[m]&&(c=10*c+(r[m++]-0)),1<=c&&31>=c||Wa(e,r,m,t,p,"day out of range")}else if("H"==t[p]){for(0<=u&&Wa(e,r,m,t,p,"hour multiply specified");" "==r[m];)m++
"0"<=r[m]&&"9">=r[m]||Wa(e,r,m,t,p,"hour missing or invalid"),u=r[m++]-0,"0"<=r[m]&&"9">=r[m]&&(u=10*u+(r[m++]-0)),0<=u&&23>=u||Wa(e,r,m,t,p,"hour out of range")}else if("m"==t[p]){for(0<=s&&Wa(e,r,m,t,p,"month multiply specified");" "==r[m];)m++
"0"<=r[m]&&"9">=r[m]||Wa(e,r,m,t,p,"month missing or invalid"),s=r[m++]-0,"0"<=r[m]&&"9">=r[m]&&(s=10*s+(r[m++]-0)),1<=s&&12>=s||Wa(e,r,m,t,p,"month out of range")}else if("M"==t[p]){for(0<=f&&Wa(e,r,m,t,p,"minute multiply specified");" "==r[m];)m++
"0"<=r[m]&&"9">=r[m]||Wa(e,r,m,t,p,"minute missing or invalid"),f=r[m++]-0,"0"<=r[m]&&"9">=r[m]&&(f=10*f+(r[m++]-0)),0<=f&&59>=f||Wa(e,r,m,t,p,"minute out of range")}else if("S"==t[p]){for(0<=d&&Wa(e,r,m,t,p,"second multiply specified");" "==r[m];)m++
"0"<=r[m]&&"9">=r[m]||Wa(e,r,m,t,p,"second missing or invalid"),d=r[m++]-0,"0"<=r[m]&&"9">=r[m]&&(d=10*d+(r[m++]-0)),0<=d&&60>=d||Wa(e,r,m,t,p,"second out of range")}else if("y"==t[p]){for(0<=l&&Wa(e,r,m,t,p,"year multiply specified");" "==r[m];)m++
"0"<=r[m]&&"9">=r[m]||Wa(e,r,m,t,p,"year missing or invalid"),l=r[m++]-0,"0"<=r[m]&&"9">=r[m]&&(l=10*l+(r[m++]-0)),l+=69<=l?1900:2e3}else if("Y"==t[p]){for(0<=l&&Wa(e,r,m,t,p,"year multiply specified");" "==r[m];)m++
for("0"<=r[m]&&"9">=r[m]||Wa(e,r,m,t,p,"year missing or invalid"),l=0,o=1;4>=o&&"0"<=r[m]&&"9">=r[m];o++)l=10*l+(r[m++]-0)
1<=l&&4e3>=l||Wa(e,r,m,t,p,"year out of range")}else if("z"==t[p]){var g
for(2147483647!=h&&Wa(e,r,m,t,p,"time zone offset multiply specified");" "==r[m];)m++
if("Z"==r[m])g=u=f=0,m++
else{for("+"==r[m]?(g=1,m++):"-"==r[m]?(g=-1,m++):Wa(e,r,m,t,p,"time zone offset sign missing"),u=0,o=1;2>=o;o++)"0"<=r[m]&&"9">=r[m]||a(),u=10*u+(r[m++]-0)
if(23<u&&n(),":"==r[m]&&(m++,"0"<=r[m]&&"9">=r[m]||a()),f=0,"0"<=r[m]&&"9">=r[m]){for(o=1;2>=o;o++)"0"<=r[m]&&"9">=r[m]||a(),f=10*f+(r[m++]-0)
59<f&&n()}}h=g*(60*u+f)}else"%"==t[p]?i():Wa(e,r,m,t,p,"invalid conversion specifier")
else" "!=t[p]&&i()
return 0>l&&(l=1970),0>s&&(s=1),0>c&&(c=1),0>u&&(u=0),0>f&&(f=0),0>d&&(d=0),2147483647==h&&(h=0),60*(60*(24*((o=de(c,s,l))-de(1,1,1970))+u)+f)+d-60*h}function Ja(e,r,a){t("Format string passed to time2str:"),t(r),t(Ka(a)),Ua(e,"invalid conversion specifier")}function Qa(e){return(e+de(1,1,1970))%7+1}function $a(e){switch(e=de(1,1,e)-de(1,1,1970),Qa(e)){case 1:e+=0
break
case 2:e-=1
break
case 3:e-=2
break
case 4:e-=3
break
case 5:e+=3
break
case 6:e+=2
break
case 7:e+=1}return Qa(e),e}function en(e,r,t){var a,n,i,o,l,s=0,c=0,u=0,f=""
for(-62135596800<=r&&64092211199>=r||Ua(e,"time2str("+r+",...); argument out of range"),r=Math.floor(r+.5),n=Math.abs(r)/86400,a=Math.floor(n),0>r&&(a=n==Math.floor(n)?-a:-(a+1)),he(a+de(1,1,1970),function(e,r,t){u=e,c=r,s=t}),i=r-86400*a|0,n=i/60,i%=60,r=n/60,n%=60,o=0;o<t.length;o++)"%"==t[o]?(o++,"a"==t[o]?l=xh[Qa(a)-1].slice(0,3):"A"==t[o]?l=xh[Qa(a)-1]:"b"==t[o]||"h"==t[o]?l=yh[c-1].slice(0,3):"B"==t[o]?l=yh[c-1]:"C"==t[o]?l=String(Math.floor(s/100)):"d"==t[o]?l=String(u):"D"==t[o]?l=c+"/"+u+"/"+s%100:"e"==t[o]?l=String(u):"F"==t[o]?m(l,s+"-"+c+"-"+u):"g"==t[o]?(l=a<$a(s)?s-1:a<$a(s+1)?s:s+1,l=String(l%100)):"G"==t[o]?(l=a<$a(s)?s-1:a<$a(s+1)?s:s+1,l=String(l)):"H"==t[o]?l=String(r):"I"==t[o]?l=String(0==r?12:12>=r?r:r-12):"j"==t[o]?l=String(de(u,c,s)-de(1,1,s)+1):"k"==t[o]?l=String(r):"l"==t[o]?l=String(0==r?12:12>=r?r:r-12):"m"==t[o]?l=String(c):"M"==t[o]?l=String(n):"p"==t[o]?l=11>=r?"AM":"PM":"P"==t[o]?l=11>=r?"am":"pm":"r"==t[o]?l=(0==r?12:12>=r?r:r-12)+":"+n+":"+i+" "+(11>=r?"AM":"PM"):"R"==t[o]?l=r+":"+n:"S"==t[o]?l=String(i):"T"==t[o]?l=r+":"+n+":"+i:"u"==t[o]?l=String(Qa(a)):"U"==t[o]?(l=de(1,1,s)-de(1,1,1970),l+=7-Qa(l),l=String((a+7-l)/7)):"V"==t[o]?(l=a<$a(s)?a-$a(s-1):a<$a(s+1)?a-$a(s):a-$a(s+1),l=String(l/7+1)):"w"==t[o]?l=String(Qa(a)%7):"W"==t[o]?(l=de(1,1,s)-de(1,1,1970),l+=(8-Qa(l))%7,l=String((a+7-l)/7)):"y"==t[o]?l=String(s%100):"Y"==t[o]?l=String(s):"%"==t[o]?l="%":Ja(e,t,o)):l=t[o],f+=l
return f}function rn(e,r){var t=e.Mc,a=wh[t.a[1].toLowerCase()]
a?t.link=new a(t,r,e.ve):Ua(e,"Invalid table driver '"+t.a[1]+"'"),null==t.link&&Ua(e,"error on opening table "+e.ib.v.nd.name)}function tn(e,t,a){if(this.mode=t,this.Ea=null,this.count=0,this.l="\n",this.Hb=0,this.pb="",this.Wa=0,this.Oa=[],this.ve=a,this.ng=0,this.Ae=1,this.og=2,this.Be=3,2>Yd(e)&&r("csv_driver: file name not specified\n"),this.Ea=Ud(e,2),"R"==t){for(a?(this.data=a(e.a,t),this.cursor=0):r("csv_driver: unable to open "+this.Ea),this.Eg=0,an(this);an(this),this.Hb!=this.Ae;){for(this.Hb!=this.Be&&r(this.Ea+":"+this.count+": invalid field name\n"),this.Wa++,t=Hd(e);1<=t&&Kd(e,t)!=this.pb;t--);this.Oa[this.Wa]=t}for(t=Hd(e);1<=t&&"RECNO"!=Kd(e,t);t--);this.Oa[0]=t}else if("W"==t){for(this.data="",a=Hd(e),t=1;t<=a;t++)this.data+=Kd(e,t)+(t<a?",":"\n")
this.count++}}function an(e){if(-1==e.l)e.Hb=e.ng,e.pb="EOF"
else if("\n"==e.l){if(e.Hb=e.Ae,e.pb="EOR",nn(e),","==e.l&&r(e.Ea+":"+e.count+": empty field not allowed\n"),"\n"==e.l&&r(e.Ea+":"+e.count+": empty record not allowed\n"),"#"==e.l&&1==e.count)for(;"#"==e.l;){for(;"\n"!=e.l;)nn(e)
nn(e),e.Eg++}}else if(","==e.l&&nn(e),"'"==e.l||'"'==e.l){var t=e.l
for(e.pb="",e.Hb=e.Be,nn(e);;){if(e.l==t&&(nn(e),e.l!=t)){if(","==e.l||"\n"==e.l)break
r(e.Ea+":"+e.count+": invalid field")}e.pb+=e.l,nn(e)}0==e.pb.length&&r(e.Ea+":"+e.count+": empty field not allowed")}else{for(e.pb="",e.Hb=e.og;","!=e.l&&"\n"!=e.l;)"'"!=e.l&&'"'!=e.l||r(e.Ea+":"+e.count+": invalid use of single or double quote within field"),e.pb+=e.l,nn(e)
0==e.pb.length&&r(e.Ea+":"+e.count+": empty field not allowed"),ue(e.pb,function(){})&&(e.Hb=e.Be)}}function nn(e){var t
for("\n"==e.l&&e.count++;;)if("\r"!=(t=e.cursor<e.data.length?e.data[e.cursor++]:-1)){"\n"!=t&&u(t)&&r(e.Ea+":"+e.count+": invalid control character "+t)
break}e.l=t}function on(e,t,a){if(this.mode=t,this.Ea=null,2>Yd(e)&&r("json driver: file name not specified"),this.Ea=Ud(e,2),"R"==t)for(this.Oa={},a?(this.data=a(e.a,t),"string"==typeof this.data&&(this.data=JSON.parse(this.data)),this.cursor=1):r("json driver: unable to open "+this.Ea),e=0,t=this.data[0];e<t.length;e++)this.Oa[t[e]]=e
else if("W"==t){this.ve=a,a=[],this.data=[a]
var n=Hd(e)
for(t=1;t<=n;t++)a.push(Kd(e,t))}}function ln(){var e={$b:0}
return e.wc=e.gh=e.hh=0,e.name=e.eb=null,e.ha=0,e.ee=e.de=0,e.Db=e.Pc=null,e.Kb=e.td=null,e.top=null,e.g=e.i=e.L=0,e.uf=e.Sd=null,e.da=e.ue=0,e.nf=e.xg=e.Kg=e.zg=0,e.la=null,e.Aa=null,e.ka=null,e.Pa=null,e}function sn(e,r,t){0==t?(r.ca=null,r.e=e.Db,null==r.e?e.Pc=r:r.e.ca=r,e.Db=r):(r.ca=e.Pc,r.e=null,null==r.ca?e.Db=r:r.ca.e=r,e.Pc=r)}function cn(e,r){null==r.ca?e.Db=r.e:r.ca.e=r.e,null==r.e?e.Pc=r.ca:r.e.ca=r.ca}function un(e,r){r.ja||(r.ja=1,cn(e,r),sn(e,r,0))}function fn(e,r,t){0==t?(r.ca=null,r.e=e.Kb,null==r.e?e.td=r:r.e.ca=r,e.Kb=r):(r.ca=e.td,r.e=null,null==r.ca?e.Kb=r:r.ca.e=r,e.td=r)}function dn(e,r){null==r.ca?e.Kb=r.e:r.ca.e=r.e,null==r.e?e.td=r.ca:r.e.ca=r.ca}function hn(e,r){r.ja||(r.ja=1,dn(e,r),fn(e,r,0))}function mn(e){var r={}
return r.ea=++e.ee,r.name=null,r.c=-hi,r.d=+hi,r.k=null,r.ja=0,sn(e,r,1),r}function pn(e){var r={}
return r.C=++e.de,r.name=null,r.Ra=0,r.c=r.d=r.u=0,r.k=null,r.ja=0,r.qb={},r.ub={},fn(e,r,1),r}function vn(e,r,t){var a={}
a.n=e,a.f=r,a.j=t,a.ua=null,a.B=e.k,a.ra=null,a.I=r.k,null!=a.B&&(a.B.ua=a),null!=a.I&&(a.I.ra=a),e.k=r.k=a}function bn(e,r){var t
return t={},t.Zd=r,t.info={},t.link=e.top,e.top=t,t.info}function gn(e){for(var r;null!=e.k;)r=e.k,e.k=r.B,null==r.ra?r.f.k=r.I:r.ra.I=r.I,null!=r.I&&(r.I.ra=r.ra)}function xn(e,r){gn(r),cn(e,r)}function yn(e,r){for(var t;null!=r.k;)t=r.k,r.k=t.I,null==t.ua?t.n.k=t.B:t.ua.B=t.B,null!=t.B&&(t.B.ua=t.ua)
dn(e,r)}function wn(e,r,t){var a,n,i,o=bs,l=bs,s=r.g,c=r.i
for(e.$b=r.dir,e.$b==sl?i=1:e.$b==cl&&(i=-1),e.wc=s,e.gh=c,e.hh=r.L,o&&null!=r.name&&(e.name=r.name),o&&null!=r.eb&&(e.eb=r.eb),e.ha=i*r.ha,a=Array(1+s),n=1;n<=s;n++){var u,f=r.n[n]
if(a[n]=u=mn(e),o&&null!=f.name&&(u.name=f.name),l){var d=f.ma
f.type==hl?(u.c=-hi,u.d=+hi):f.type==ml?(u.c=f.c*d,u.d=+hi):f.type==pl?(u.c=-hi,u.d=f.d*d):f.type==vl?(u.c=f.c*d,u.d=f.d*d):f.type==bl&&(u.c=u.d=f.c*d)}else f.type==hl?(u.c=-hi,u.d=+hi):f.type==ml?(u.c=f.c,u.d=+hi):f.type==pl?(u.c=-hi,u.d=f.d):f.type==vl?(u.c=f.c,u.d=f.d):f.type==bl&&(u.c=u.d=f.c)}for(s=1;s<=c;s++)if(u=r.f[s],n=pn(e),o&&null!=u.name&&(n.name=u.name),t==Il&&(n.Ra=Number(u.kind==fl)),l)for(f=u.va,u.type==hl?(n.c=-hi,n.d=+hi):u.type==ml?(n.c=u.c/f,n.d=+hi):u.type==pl?(n.c=-hi,n.d=u.d/f):u.type==vl?(n.c=u.c/f,n.d=u.d/f):u.type==bl&&(n.c=n.d=u.c/f),n.u=i*u.u*f,u=u.k;null!=u;u=u.I)vn(a[u.n.ea],n,u.n.ma*u.j*f)
else for(u.type==hl?(n.c=-hi,n.d=+hi):u.type==ml?(n.c=u.c,n.d=+hi):u.type==pl?(n.c=-hi,n.d=u.d):u.type==vl?(n.c=u.c,n.d=u.d):u.type==bl&&(n.c=n.d=u.c),n.u=i*u.u,u=u.k;null!=u;u=u.I)vn(a[u.n.ea],n,u.j)
e.da=t,e.ue=l}function Mn(e,r){var t,a,n,i,o,l,s
for(Oi(r),gi(r,e.name),xi(r,e.eb),yi(r,e.$b),e.$b==sl?l=1:e.$b==cl&&(l=-1),Ci(r,0,l*e.ha),t=e.Db;null!=t;t=t.e)t.ja=n=wi(r,1),_i(r,n,t.name),a=t.c==-hi&&t.d==+hi?hl:t.d==+hi?ml:t.c==-hi?pl:t.c!=t.d?vl:bl,Ai(r,n,a,t.c,t.d)
for(o=new Int32Array(1+r.g),s=new Float64Array(1+r.g),t=e.Kb;null!=t;t=t.e){for(n=Mi(r,1),ki(r,n,t.name),xo(r,n,t.Ra?fl:ul),a=t.c==-hi&&t.d==+hi?hl:t.d==+hi?ml:t.c==-hi?pl:t.c!=t.d?vl:bl,Li(r,n,a,t.c,t.d),Ci(r,n,l*t.u),i=0,a=t.k;null!=a;a=a.I)i++,o[i]=a.n.ja,s[i]=a.j
Vi(r,n,i,o,s)}for(e.g=r.g,e.i=r.i,e.L=r.L,e.uf=new Int32Array(1+e.g),e.Sd=new Int32Array(1+e.i),t=e.Db,n=0;null!=t;t=t.e)e.uf[++n]=t.ea
for(t=e.Kb,n=0;null!=t;t=t.e)e.Sd[++n]=t.C
e.name=e.eb=null,e.ha=0,e.Db=e.Pc=null,e.Kb=e.td=null}function _n(e,r){var t,a,n,i
if(e.$b==sl?a=1:e.$b==cl&&(a=-1),e.da==Pl?(e.nf=r.na,e.xg=r.sa):e.da==Vl?e.Kg=r.df:e.da==Il&&(e.zg=r.za),e.da==Pl){for(null==e.la&&(e.la=new Int8Array(1+e.ee)),i=1;i<=e.ee;i++)e.la[i]=0
for(null==e.ka&&(e.ka=new Int8Array(1+e.de)),t=1;t<=e.de;t++)e.ka[t]=0}for(null==e.Pa&&(e.Pa=new Float64Array(1+e.de)),t=1;t<=e.de;t++)e.Pa[t]=hi
if(e.da!=Il)for(null==e.Aa&&(e.Aa=new Float64Array(1+e.ee)),i=1;i<=e.ee;i++)e.Aa[i]=hi
if(e.da==Pl){for(i=1;i<=e.g;i++)t=r.n[i],n=e.uf[i],e.la[n]=t.m,e.Aa[n]=a*t.J
for(t=1;t<=e.i;t++)a=r.f[t],n=e.Sd[t],e.ka[n]=a.m,e.Pa[n]=a.r}else if(e.da==Vl){for(i=1;i<=e.g;i++)t=r.n[i],n=e.uf[i],e.Aa[n]=a*t.mc
for(t=1;t<=e.i;t++)a=r.f[t],n=e.Sd[t],e.Pa[n]=a.dc}else if(e.da==Il)for(t=1;t<=e.i;t++)a=r.f[t],n=e.Sd[t],e.Pa[n]=a.Sa
for(n=e.top;null!=n;n=n.link)n.Zd(e,n.info)}function kn(e,r){var t,a,n,i
if(e.$b==sl?n=1:e.$b==cl&&(n=-1),e.da==Pl){for(r.valid=0,r.na=e.nf,r.sa=e.xg,r.aa=r.ha,r.some=0,a=1;a<=r.g;a++)t=r.n[a],t.m=e.la[a],t.J=e.ue?n*e.Aa[a]*t.ma:n*e.Aa[a],t.m==gl?t.J=0:t.m==xl?t.r=t.c:t.m==yl?t.r=t.d:t.m==wl?t.r=0:t.m==Ml&&(t.r=t.c)
for(a=1;a<=r.i;a++)t=r.f[a],t.m=e.ka[a],t.r=e.ue?e.Pa[a]*t.va:e.Pa[a],t.m==gl?t.J=0:t.m==xl?t.r=t.c:t.m==yl?t.r=t.d:t.m==wl?t.r=0:t.m==Ml&&(t.r=t.c),r.aa+=t.u*t.r
for(a=1;a<=r.g;a++)if(t=r.n[a],t.m==gl){for(i=0,n=t.k;null!=n;n=n.B)i+=n.j*n.f.r
t.r=i}for(a=1;a<=r.i;a++)if(t=r.f[a],t.m!=gl){for(i=t.u,n=t.k;null!=n;n=n.I)i-=n.j*n.n.J
t.J=i}}else if(e.da==Vl){for(r.df=e.Kg,r.ae=r.ha,a=1;a<=r.g;a++)t=r.n[a],t.mc=e.ue?n*e.Aa[a]*t.ma:n*e.Aa[a]
for(a=1;a<=r.i;a++)t=r.f[a],t.dc=e.ue?e.Pa[a]*t.va:e.Pa[a],r.ae+=t.u*t.dc
for(a=1;a<=r.g;a++){for(t=r.n[a],i=0,n=t.k;null!=n;n=n.B)i+=n.j*n.f.dc
t.dc=i}for(a=1;a<=r.i;a++){for(t=r.f[a],i=t.u,n=t.k;null!=n;n=n.I)i-=n.j*n.n.mc
t.mc=i}}else if(e.da==Il){for(r.za=e.zg,r.ta=r.ha,a=1;a<=r.i;a++)t=r.f[a],t.Sa=e.Pa[a],r.ta+=t.u*t.Sa
for(a=1;a<=r.g;a++){for(t=r.n[a],i=0,n=t.k;null!=n;n=n.B)i+=n.j*n.f.Sa
t.Sa=i}}}function An(e,r){bn(e,function(e,r){return e.da==Pl&&(e.la[r.s]=gl),e.da!=Il&&(e.Aa[r.s]=0),0}).s=r.ea,xn(e,r)}function Ln(e,r){var t,a
for(t=bn(e,function(e,r){if(e.da==Pl){if(e.ka[r.F]!=gl&&e.ka[r.F]!=xl&&e.ka[r.F]!=yl)return 1
e.ka[r.F]=e.ka[r.F]}return e.Pa[r.F]=r.Ng+e.Pa[r.F],0}),t.F=r.C,t.Ng=r.c,e.ha+=r.u*r.c,a=r.k;null!=a;a=a.I)t=a.n,t.c==t.d?t.d=t.c-=a.j*r.c:(t.c!=-hi&&(t.c-=a.j*r.c),t.d!=+hi&&(t.d-=a.j*r.c))
r.d!=+hi&&(r.d-=r.c),r.c=0}function Cn(e,r){var t,a
for(t=bn(e,function(e,r){return e.da==Pl&&(e.ka[r.F]=Ml),e.Pa[r.F]=r.ph,0}),t.F=r.C,t.ph=r.c,e.ha+=r.u*r.c,a=r.k;null!=a;a=a.I)t=a.n,t.c==t.d?t.d=t.c-=a.j*r.c:(t.c!=-hi&&(t.c-=a.j*r.c),t.d!=+hi&&(t.d-=a.j*r.c))
yn(e,r)}function Pn(e,r){var t,a,n
a=1e-9+1e-12*Math.abs(r.c),r.d-r.c>a||(bn(e,function(e,r){if(e.da==Pl)if(e.la[r.s]==gl)e.la[r.s]=gl
else{if(e.la[r.s]!=Ml)return 1
e.la[r.s]=0<=e.Aa[r.s]?xl:yl}return 0}).s=r.ea,t=.5*(r.d+r.c),n=Math.floor(t+.5),Math.abs(t-n)<=a&&(t=n),r.c=r.d=t)}function Vn(e,r){var t,a,n,i
if(i=1e-9+1e-12*Math.abs(r.c),r.d-r.c>i)return 0
if(t=bn(e,function(e,r){var t,a
if(e.da==Pl)if(e.ka[r.F]==gl)e.ka[r.F]=gl
else{if(e.ka[r.F]!=Ml)return 1
for(a=r.l,t=r.k;null!=t;t=t.e)a-=t.j*e.Aa[t.Oa]
e.ka[r.F]=0<=a?xl:yl}return 0}),t.F=r.C,t.l=r.u,t.k=null,e.da==Pl)for(a=r.k;null!=a;a=a.I)n={},n.Oa=a.n.ea,n.j=a.j,n.e=t.k,t.k=n
return t=.5*(r.d+r.c),a=Math.floor(t+.5),Math.abs(t-a)<=i&&(t=a),r.c=r.d=t,1}function In(e,r){return.001<r.c||-.001>r.d?1:(r.c=-hi,r.d=+hi,An(e,r),0)}function Sn(e,r){function t(){n.m=xl,r.d=r.c}function a(){n.m=yl,r.c=r.d}var n
return.001<r.u&&r.c==-hi||-.001>r.u&&r.d==+hi?1:(n=bn(e,function(e,r){return e.da==Pl&&(e.ka[r.F]=r.m),0}),n.F=r.C,r.c==-hi&&r.d==+hi?(n.m=wl,r.c=r.d=0):r.d==+hi?t():r.c==-hi?a():r.c!=r.d?2.220446049250313e-16<=r.u?t():-2.220446049250313e-16>=r.u?a():Math.abs(r.c)<=Math.abs(r.d)?t():a():n.m=Ml,Cn(e,r),0)}function jn(e,r){var t
if(e.Ra){if(t=Math.floor(r+.5),!(1e-5>=Math.abs(r-t)))return 2
r=t}if(e.c!=-hi){if(t=e.Ra?1e-5:1e-5+1e-8*Math.abs(e.c),r<e.c-t)return 1
if(r<e.c+.001*t)return e.d=e.c,0}if(e.d!=+hi){if(t=e.Ra?1e-5:1e-5+1e-8*Math.abs(e.d),r>e.d+t)return 1
if(r>e.d-.001*t)return e.c=e.d,0}return e.c=e.d=r,0}function On(e,r){var t,a,n
if(n=r.k,a=n.f,0!=(t=jn(a,r.c/n.j)))return t
if(t=bn(e,function(e,r){var t,a
if(e.da==Pl){if(e.ka[r.F]!=Ml)return 1
e.la[r.s]=Ml,e.ka[r.F]=gl}if(e.da!=Il){for(a=r.l,t=r.k;null!=t;t=t.e)a-=t.j*e.Aa[t.Oa]
e.Aa[r.s]=a/r.Da}return 0}),t.s=r.ea,t.F=a.C,t.Da=n.j,t.l=a.u,t.k=null,e.da!=Il)for(n=a.k;null!=n;n=n.I)n.n!=r&&(a={},a.Oa=n.n.ea,a.j=n.j,a.e=t.k,t.k=a)
return xn(e,r),0}function Xn(e,r){var t
if(e.Ra&&(t=Math.floor(r+.5),r=1e-5>=Math.abs(r-t)?t:Math.ceil(r)),e.c!=-hi&&(t=e.Ra?.001:.001+1e-6*Math.abs(e.c),r<e.c+t))return 0
if(e.d!=+hi){if(t=e.Ra?1e-5:1e-5+1e-8*Math.abs(e.d),r>e.d+t)return 4
if(r>e.d-.001*t)return e.c=e.d,3}return t=e.c==-hi?2:e.Ra&&r>e.c+.5?2:r>e.c+.3*(1+Math.abs(e.c))?2:1,e.c=r,t}function En(e,r){var t
if(e.Ra&&(t=Math.floor(r+.5),r=1e-5>=Math.abs(r-t)?t:Math.floor(r)),e.d!=+hi&&(t=e.Ra?.001:.001+1e-6*Math.abs(e.d),r>e.d-t))return 0
if(e.c!=-hi){if(t=e.Ra?1e-5:1e-5+1e-8*Math.abs(e.c),r<e.c-t)return 4
if(r<e.c+.001*t)return e.d=e.c,3}return t=e.d==+hi?2:e.Ra&&r<e.d-.5?2:r<e.d-.3*(1+Math.abs(e.d))?2:1,e.d=r,t}function Fn(e,r){var t,a,n,i,o,l
if(n=r.k,a=n.f,0<n.j?(o=r.c==-hi?-hi:r.c/n.j,t=r.d==+hi?+hi:r.d/n.j):(o=r.d==+hi?-hi:r.d/n.j,t=r.c==-hi?+hi:r.c/n.j),o==-hi)o=0
else if(4==(o=Xn(a,o)))return 4
if(t==+hi)l=0
else if(3==o)l=0
else if(4==(l=En(a,t)))return 4
if(!o&&!l)return r.c=-hi,r.d=+hi,An(e,r),0
if(t=bn(e,function(e,r){var t,a
if(e.da==Il)return 0
for(a=r.l,t=r.k;null!=t;t=t.e)a-=t.j*e.Aa[t.Oa]
if(e.da==Pl){t=function(){return r.Vf?(e.la[r.s]=0<r.Da?xl:yl,e.ka[r.F]=gl,e.Aa[r.s]=a/r.Da):(e.la[r.s]=gl,e.Aa[r.s]=0),0}
var n=function(){return r.gg?(e.la[r.s]=0<r.Da?yl:xl,e.ka[r.F]=gl,e.Aa[r.s]=a/r.Da):(e.la[r.s]=gl,e.Aa[r.s]=0),0}
if(e.ka[r.F]==gl)e.la[r.s]=gl,e.Aa[r.s]=0
else if(e.ka[r.F]==xl)t()
else if(e.ka[r.F]==yl)n()
else{if(e.ka[r.F]!=Ml)return 1
if(1e-7<a&&(0<r.Da&&r.c!=-hi||0>r.Da&&r.d!=+hi||!r.Vf))return e.ka[r.F]=xl,t()
if(-1e-7>a&&(0<r.Da&&r.d!=+hi||0>r.Da&&r.c!=-hi||!r.gg))return e.ka[r.F]=yl,n()
if(r.c!=-hi&&r.d==+hi)e.la[r.s]=xl
else if(r.c==-hi&&r.d!=+hi)e.la[r.s]=yl
else{if(r.c==-hi||r.d==+hi)return 1
e.la[r.s]=r.Da*e.Pa[r.F]<=.5*(r.c+r.d)?xl:yl}e.ka[r.F]=gl,e.Aa[r.s]=a/r.Da}}return e.da==Vl&&(e.Aa[r.s]=2.220446049250313e-16<a&&r.Vf||-2.220446049250313e-16>a&&r.gg?a/r.Da:0),0}),t.s=r.ea,t.F=a.C,t.Da=n.j,t.l=a.u,t.c=r.c,t.d=r.d,t.Vf=o,t.gg=l,t.k=null,e.da!=Il)for(a=a.k;null!=a;a=a.I)a!=n&&(i={},i.Oa=a.n.ea,i.j=a.j,i.e=t.k,t.k=i)
return xn(e,r),o>=l?o:l}function Bn(e,r){var t,a,n,i
for(n=r.k,a=n.n,t=bn(e,function(e,r){var t,a
if(e.da==Pl){if(e.la[r.s]==gl||e.la[r.s]==wl)e.ka[r.F]=e.la[r.s]
else if(e.la[r.s]==xl)e.ka[r.F]=0<r.Da?yl:xl
else{if(e.la[r.s]!=yl)return 1
e.ka[r.F]=0<r.Da?xl:yl}e.la[r.s]=Ml}for(e.da!=Il&&(e.Aa[r.s]+=r.l/r.Da),t=r.qd,a=r.k;null!=a;a=a.e)t-=a.j*e.Pa[a.Oa]
return e.Pa[r.F]=t/r.Da,0}),t.s=a.ea,t.F=r.C,t.Da=n.j,t.qd=a.c,t.l=r.u,t.k=null,n=a.k;null!=n;n=n.B)n.f!=r&&(i={},i.Oa=n.f.C,i.j=n.j,i.e=t.k,t.k=i,n.f.u-=n.j/t.Da*t.l)
e.ha+=t.qd/t.Da*t.l,0<t.Da?(a.c=r.d==+hi?-hi:t.qd-t.Da*r.d,a.d=r.c==-hi?+hi:t.qd-t.Da*r.c):(a.c=r.c==-hi?-hi:t.qd-t.Da*r.c,a.d=r.d==+hi?+hi:t.qd-t.Da*r.d),yn(e,r)}function zn(e,r){function t(){n.m=xl,i.d=i.c}function a(){n.m=yl,i.c=i.d}var n,i,o,l,s,c
if(o=r.k,i=o.n,(s=i.c)!=-hi)for(l=i.k;null!=l;l=l.B)if(l!=o)if(0<l.j){if(l.f.d==+hi){s=-hi
break}s-=l.j*l.f.d}else{if(l.f.c==-hi){s=-hi
break}s-=l.j*l.f.c}if((c=i.d)!=+hi)for(l=i.k;null!=l;l=l.B)if(l!=o)if(0<l.j){if(l.f.c==-hi){c=+hi
break}c-=l.j*l.f.c}else{if(l.f.d==+hi){c=+hi
break}c-=l.j*l.f.d}if(l=0<o.j?s==-hi?-hi:s/o.j:c==+hi?-hi:c/o.j,s=0<o.j?c==+hi?+hi:c/o.j:s==-hi?+hi:s/o.j,r.c!=-hi&&(c=1e-9+1e-12*Math.abs(r.c),l<r.c-c)||r.d!=+hi&&(c=1e-9+1e-12*Math.abs(r.d),s>r.d+c))return 1
if(r.c=-hi,r.d=+hi,n=bn(e,function(e,r){if(e.da==Pl)if(e.la[r.s]==gl)e.la[r.s]=gl
else{if(e.la[r.s]!=Ml)return 1
e.la[r.s]=r.m}return 0}),n.s=i.ea,n.m=-1,2.220446049250313e-16<(o=r.u/o.j))if(i.c!=-hi)t()
else{if(1e-5<o)return 2
a()}else if(-2.220446049250313e-16>o)if(i.d!=+hi)a()
else{if(-1e-5>o)return 2
t()}else i.d==+hi?t():i.c==-hi?a():Math.abs(i.c)<=Math.abs(i.d)?t():a()
return 0}function Tn(e,r,t){var a,n,i,o,l=null
for(a=1,i=r.k;null!=i;i=i.B)a<Math.abs(i.j)&&(a=Math.abs(i.j))
for(i=r.k;null!=i;i=i.B)if(Math.abs(i.j)<1e-7*a)return 1
for(a=bn(e,function(e,r){var t,a,n,i,o
if(e.da==Il)return 0
if(e.da==Pl){if(e.la[r.s]!=gl)return 1
for(t=r.k;null!=t;t=t.e){if(e.ka[t.C]!=Ml)return 1
e.ka[t.C]=t.m}}for(t=r.k;null!=t;t=t.e){for(n=t.l,a=t.k;null!=a;a=a.e)n-=a.j*e.Aa[a.Oa]
t.l=n}for(a=null,i=0,t=r.k;null!=t;t=t.e)if(n=t.l,o=Math.abs(n/t.Jc),t.m==xl)0>n&&i<o&&(a=t,i=o)
else{if(t.m!=yl)return 1
0<n&&i<o&&(a=t,i=o)}return null!=a&&(e.da==Pl&&(e.la[r.s]=r.m,e.ka[a.C]=gl),e.Aa[r.s]=a.l/a.Jc),0}),a.s=r.ea,a.m=r.c==r.d?Ml:0==t?xl:yl,a.k=null,i=r.k;null!=i;i=i.B)if(n=i.f,e.da!=Il&&(l={},l.C=n.C,l.m=-1,l.Jc=i.j,l.l=n.u,l.k=null,l.e=a.k,a.k=l),0==t&&0>i.j||0!=t&&0<i.j?(e.da!=Il&&(l.m=xl),n.d=n.c):(e.da!=Il&&(l.m=yl),n.c=n.d),e.da!=Il)for(n=n.k;null!=n;n=n.I)n!=i&&(o={},o.Oa=n.n.ea,o.j=n.j,o.e=l.k,l.k=o)
return r.c=-hi,r.d=+hi,0}function Nn(e){var r,t,a,n=0
for(t=0,r=e.k;null!=r;r=r.B)if(0<r.j){if(r.f.c==-hi){t=-hi
break}t+=r.j*r.f.c}else{if(r.f.d==+hi){t=-hi
break}t+=r.j*r.f.d}for(a=0,r=e.k;null!=r;r=r.B)if(0<r.j){if(r.f.d==+hi){a=+hi
break}a+=r.j*r.f.d}else{if(r.f.c==-hi){a=+hi
break}a+=r.j*r.f.c}return e.c!=-hi&&(r=.001+1e-6*Math.abs(e.c),e.c-r>a)||e.d!=+hi&&(r=.001+1e-6*Math.abs(e.d),e.d+r<t)?51:(e.c!=-hi&&(r=1e-9+1e-12*Math.abs(e.c),e.c-r>t&&(n=e.c+r<=a?1|n:2|n)),e.d!=+hi&&(r=1e-9+1e-12*Math.abs(e.d),e.d+r<a&&(n=e.d-r>=t?16|n:32|n)),n)}function Rn(e,r,t){e.da==Pl&&(e=bn(e,function(e,r){return e.da!=Pl?1:(e.la[r.s]=e.la[r.s]==gl?gl:r.m,0)}),e.s=r.ea,e.m=r.d==+hi?xl:r.c==-hi?yl:r.c!=r.d?0==t?yl:xl:Ml),0==t?r.c=-hi:1==t&&(r.d=+hi)}function Dn(e){var r,a,n,i,o,l,s,c,u,f,d
for(c=u=f=d=0,n=e.td;null!=n;n=n.ca)if(n.Ra&&n.c!=n.d&&(0!=n.c||1!=n.d))if(-1e6>n.c||1e6<n.d||4095<n.d-n.c)c++
else if(u++,0!=n.c&&Ln(e,n),1!=(i=0|n.d)){for(l=2,a=4;i>=a;)l++,a+=a
for(f+=l,r=bn(e,function(e,r){var t,a,n=e.Pa[r.F]
for(t=1,a=2;t<r.i;t++,a+=a)n+=a*e.Pa[r.C+(t-1)]
return e.Pa[r.F]=n,0}),r.F=n.C,r.C=0,r.i=l,i<a-1?(a=mn(e),d++,a.c=-hi,a.d=i):a=null,n.d=1,null!=a&&vn(a,n,1),s=1,a=2;s<l;s++,a+=a)for(i=pn(e),i.Ra=1,i.c=0,i.d=1,i.u=a*n.u,0==r.C&&(r.C=i.C),o=n.k;null!=o;o=o.I)vn(o.n,i,a*o.j)}0<u&&t(u+" integer variable(s) were replaced by "+f+" binary ones"),0<d&&t(d+" row(s) were added due to binarization"),0<c&&t("Binarization failed for "+c+" integer variable(s)")}function Gn(e,r){var t,a,n
for(a=null,t=e.k;null!=t;t=t.B)n={},n.fa=r*t.j,n.jc=t.f,n.e=a,a=n
return a}function qn(e,r,t){var a,n,i
for(a=e;null!=a;a=a.e);for(n=0,a=e;null!=a;a=a.e)if(1!=a.fa){if(-1!=a.fa)break
n++}if(null==a&&r==1-n)return 1
for(a=e;null!=a;a=a.e)0>a.fa&&(r-=a.fa)
for(a=e;null!=a;a=a.e)if(Math.abs(a.fa)>r)return 0
for(n=null,a=e;null!=a;a=a.e)(null==n||Math.abs(n.fa)>Math.abs(a.fa))&&(n=a)
for(i=null,a=e;null!=a;a=a.e)a!=n&&(null==i||Math.abs(i.fa)>Math.abs(a.fa))&&(i=a)
if(Math.abs(n.fa)+Math.abs(i.fa)<=r+(.001+1e-6*Math.abs(r)))return 0
for(r=1,a=e;null!=a;a=a.e)0<a.fa?a.fa=1:(a.fa=-1,r-=1)
return t(r),2}function Yn(e,r){var t,a,n,i,o,l=0
for(i=0;1>=i;i++){if(0==i){if(r.d==+hi)continue
n=Gn(r,1),o=+r.d}else{if(r.c==-hi)continue
n=Gn(r,-1),o=-r.c}if(t=qn(n,o,function(e){o=e}),1==i&&1==t||2==t){if(l++,r.c==-hi||r.d==+hi)t=null
else for(t=mn(e),0==i?(t.c=r.c,t.d=+hi):(t.c=-hi,t.d=r.d),a=r.k;null!=a;a=a.B)vn(t,a.f,a.j)
for(gn(r),r.c=-hi,r.d=o;null!=n;n=n.e)vn(r,n.jc,n.fa)
null!=t&&(r=t)}}return l}function Un(e,r,t){var a,n
for(a=e;null!=a;a=a.e);for(n=0,a=e;null!=a;a=a.e)if(1!=a.fa){if(-1!=a.fa)break
n++}if(null==a&&r==1-n)return 1
for(a=e;null!=a;a=a.e)0>a.fa&&(r-=a.fa)
if(.001>r)return 0
for(n=1e-9+1e-12*Math.abs(r),a=e;null!=a;a=a.e)if(Math.abs(a.fa)<r-n)return 0
for(r=1,a=e;null!=a;a=a.e)0<a.fa?a.fa=1:(a.fa=-1,r-=1)
return t(r),2}function Hn(e,r){var t,a,n,i,o,l=0
for(i=0;1>=i;i++){if(0==i){if(r.c==-hi)continue
n=Gn(r,1),o=+r.c}else{if(r.d==+hi)continue
n=Gn(r,-1),o=-r.d}if(t=Un(n,o,function(e){o=e}),1==i&&1==t||2==t){if(l++,r.c==-hi||r.d==+hi)t=null
else for(t=mn(e),0==i?(t.c=-hi,t.d=r.d):(t.c=r.c,t.d=+hi),a=r.k;null!=a;a=a.B)vn(t,a.f,a.j)
for(gn(r),r.c=o,r.d=+hi;null!=n;n=n.e)vn(r,n.jc,n.fa)
null!=t&&(r=t)}}return l}function Kn(e,r,t){var a,n,i,o=0
for(n=0,a=e;null!=a;a=a.e)if(0<a.fa){if(a.jc.c==-hi)return o
n+=a.fa*a.jc.c}else{if(a.jc.d==+hi)return o
n+=a.fa*a.jc.d}for(a=e;null!=a;a=a.e)a.jc.Ra&&0==a.jc.c&&1==a.jc.d&&(0<a.fa?(e=n,r-a.fa<e&&e<r&&.001<=(i=r-e)&&a.fa-i>=.01*(1+a.fa)&&(a.fa=i,o++)):(e=n-a.fa,r<e&&e<r-a.fa&&-.001>=(i=a.fa+(e-r))&&i-a.fa>=.01*(1-a.fa)&&(a.fa=i,n+=e-r,r=e,o++)))
return t(r),o}function Wn(e,r){var t,a,n,i,o,l=Array(2)
for(i=l[0]=l[1]=0;1>=i;i++){if(0==i){if(r.c==-hi)continue
n=Gn(r,1),o=+r.c}else{if(r.d==+hi)continue
n=Gn(r,-1),o=-r.d}if(l[i]=Kn(n,o,function(e){o=e}),0<l[i]){if(r.c==-hi||r.d==+hi)t=null
else for(t=mn(e),0==i?(t.c=-hi,t.d=r.d):(t.c=r.c,t.d=+hi),a=r.k;null!=a;a=a.B)vn(t,a.f,a.j)
for(gn(r),r.c=o,r.d=+hi,a=n;null!=a;a=a.e)vn(r,a.jc,a.fa)
null!=t&&(r=t)}}return l[0]+l[1]}function Zn(e,r,t){function a(){for(i=r.k;null!=i;i=o){for(n=i.f,o=i.B,l=n.k;null!=l;l=l.I)un(e,l.n)
Cn(e,n)}return An(e,r),0}var n,i,o,l,s
if(null==r.k){if(0==(s=In(e,r)))return 0
if(1==s)return Bs}if(null==r.k.B)if(n=r.k.f,r.c==r.d){if(0==(s=On(e,r))){for(i=n.k;null!=i;i=i.I)un(e,i.n)
return Cn(e,n),0}if(1==s||2==s)return Bs}else{if(0<=(s=Fn(e,r))&&3>=s){if(hn(e,n),2<=s)for(i=n.k;null!=i;i=i.I)un(e,i.n)
return 3==s&&Cn(e,n),0}if(4==s)return Bs}if(51==(s=Nn(r)))return Bs
if(0==(15&s))r.c!=-hi&&Rn(e,r,0)
else if(1!=(15&s)&&2==(15&s)&&0==Tn(e,r,0))return a()
if(0==(240&s))r.d!=+hi&&Rn(e,r,1)
else if(16!=(240&s)&&32==(240&s)&&0==Tn(e,r,1))return a()
if(r.c==-hi&&r.d==+hi){for(i=r.k;null!=i;i=i.B)hn(e,i.f)
return An(e,r),0}return e.da==Il&&t&&0>Jn(e,r,1)?Bs:0}function Jn(e,r,t){var a,n,i,o,l,s,c=0
for(l=!1,n=1,a=r.k;null!=a;a=a.B)a.f.qb.qb=-hi,a.f.ub.ub=+hi,n<Math.abs(a.j)&&(n=Math.abs(a.j))
if(o=1e-6*n,r.c!=-hi){for(n=null,a=r.k;null!=a;a=a.B)if(0<a.j&&a.f.d==+hi||0>a.j&&a.f.c==-hi){if(null!=n){l=!0
break}n=a}if(!l){for(l=r.c,a=r.k;null!=a;a=a.B)a!=n&&(l=0<a.j?l-a.j*a.f.d:l-a.j*a.f.c)
if(null==n)for(a=r.k;null!=a;a=a.B)a.j>=+o?a.f.qb.qb=a.f.d+l/a.j:a.j<=-o&&(a.f.ub.ub=a.f.c+l/a.j)
else n.j>=+o?n.f.qb.qb=l/n.j:n.j<=-o&&(n.f.ub.ub=l/n.j)}}if(l=!1,r.d!=+hi){for(n=null,a=r.k;null!=a;a=a.B)if(0<a.j&&a.f.c==-hi||0>a.j&&a.f.d==+hi){if(null!=n){l=!0
break}n=a}if(!l){for(l=r.d,a=r.k;null!=a;a=a.B)a!=n&&(l=0<a.j?l-a.j*a.f.c:l-a.j*a.f.d)
if(null==n)for(a=r.k;null!=a;a=a.B)a.j>=+o?a.f.ub.ub=a.f.c+l/a.j:a.j<=-o&&(a.f.qb.qb=a.f.d+l/a.j)
else n.j>=+o?n.f.ub.ub=l/n.j:n.j<=-o&&(n.f.qb.qb=l/n.j)}}for(n=r.k;null!=n;)for(a=n.f,n=n.B,o=0;1>=o;o++){if(i=a.c,s=a.d,0==o){if(a.qb.qb==-hi)continue
l=Xn(a,a.qb.qb)}else{if(a.ub.ub==+hi)continue
l=En(a,a.ub.ub)}if(0==l||1==l)a.c=i,a.d=s
else if(2==l||3==l){if(c++,t)for(i=a.k;null!=i;i=i.I)i.n!=r&&un(e,i.n)
if(3==l){Cn(e,a)
break}}else if(4==l)return-1}return c}function Qn(e,r){var t,a,n
if(null==r.k){if(0==(n=Sn(e,r)))return 0
if(1==n)return zs}if(null==r.k.I){t=r.k.n
var i=function(){if(Bn(e,r),t.c==-hi&&t.d==+hi){for(a=t.k;null!=a;a=a.B)hn(e,a.f)
An(e,t)}else un(e,t)
return 0}
if(t.c==t.d){if(!r.Ra)return i()}else if(!r.Ra){if(0==(n=zn(e,r)))return i()
if(1!=n&&2==n)return zs}}return 0}function $n(e,r){var t,a,n
for(t=e.Db;null!=t;t=a)a=t.e,t.c==-hi&&t.d==+hi&&An(e,t)
for(t=e.Db;null!=t;t=a)a=t.e,t.c!=-hi&&t.d!=+hi&&t.c<t.d&&Pn(e,t)
for(t=e.Kb;null!=t;t=a)a=t.e,t.c==t.d&&Cn(e,t)
for(t=e.Kb;null!=t;t=a)a=t.e,t.c!=-hi&&t.d!=+hi&&t.c<t.d&&0!=(n=Vn(e,t))&&1==n&&Cn(e,t)
for(t=e.Db;null!=t;t=t.e)t.ja=1
for(t=e.Kb;null!=t;t=t.e)t.ja=1
for(a=1;a;){for(a=0;null!=(t=e.Db)&&t.ja;){if(a=e,n=t,n.ja&&(n.ja=0,cn(a,n),sn(a,n,1)),0!=(t=Zn(e,t,r)))return t
a=1}for(;null!=(t=e.Kb)&&t.ja;){if(a=e,n=t,n.ja&&(n.ja=0,dn(a,n),fn(a,n,1)),0!=(t=Qn(e,t)))return t
a=1}}if(e.da==Il&&!r)for(t=e.Db;null!=t;t=t.e)if(0>Jn(e,t,0))return t=Bs
return 0}function ei(e,r){var a,n,i,o,l
if(0!=(a=$n(e,1)))return a
for(r.sd&&Dn(e),l=0,a=e.Pc;null!=a;a=n)if(n=a.ca,(a.c!=-hi||a.d!=+hi)&&a.c!=a.d&&null!=a.k&&null!=a.k.B){for(o=a.k;null!=o&&(i=o.f,i.Ra&&0==i.c&&1==i.d);o=o.B);null==o&&(l+=Yn(e,a))}for(0<l&&t(l+" hidden packing inequaliti(es) were detected"),l=0,a=e.Pc;null!=a;a=n)if(n=a.ca,(a.c!=-hi||a.d!=+hi)&&a.c!=a.d&&null!=a.k&&null!=a.k.B&&null!=a.k.B.B){for(o=a.k;null!=o&&(i=o.f,i.Ra&&0==i.c&&1==i.d);o=o.B);null==o&&(l+=Hn(e,a))}for(0<l&&t(l+" hidden covering inequaliti(es) were detected"),l=0,a=e.Pc;null!=a;a=n)n=a.ca,a.c!=a.d&&(l+=Wn(e,a))
return 0<l&&t(l+" constraint coefficient(s) were reduced"),0}function ri(e){var r,t
for(r=1,t=32;55>=t;r++,t++)e.nb[r]=e.nb[r]-e.nb[t]&2147483647
for(t=1;55>=r;r++,t++)e.nb[r]=e.nb[r]-e.nb[t]&2147483647
return e.Qf=54,e.nb[55]}function ti(){var e,r={}
for(r.nb=Array(56),r.nb[0]=-1,e=1;55>=e;e++)r.nb[e]=0
return r.Qf=0,ai(r,1),r}function ai(e,r){var t,a,n=1
for(r=a=r-0&2147483647,e.nb[55]=a,t=21;t;t=(t+21)%55)e.nb[t]=n,n=a-n&2147483647,r=1&r?1073741824+(r>>1):r>>1,n=n-r&2147483647,a=e.nb[t]
ri(e),ri(e),ri(e),ri(e),ri(e)}function ni(e){return 0<=e.nb[e.Qf]?e.nb[e.Qf--]:ri(e)}function ii(e){var r
do{r=ni(e)}while(2147483648<=r)
return r%16777216}function oi(e){return-.3*(1-(e=ni(e)/2147483647))+.7*e}function li(e,r,t){return(r-1)*e.K+t-r*(r-1)/2}function si(e,r,t){var a
0==r?(r=1,a=0):Math.abs(e)<=Math.abs(r)?(e=-e/r,a=1/Math.sqrt(1+e*e),r=a*e):(e=-r/e,r=1/Math.sqrt(1+e*e),a=r*e),t(r,a)}function ci(e,r,t){for(var a,n,i,o,l,s,c=e.i,u=e.Nb,f=e.v;r<c;r++)o=li(e,r,r),n=(r-1)*e.K+1,l=(c-1)*e.K+1,Math.abs(f[o])<Ph&&Math.abs(t[r])<Ph&&(f[o]=t[r]=0),0!=t[r]&&si(f[o],t[r],function(e,d){for(a=r,i=o;a<=c;a++,i++){var h=f[i],m=t[a]
f[i]=e*h-d*m,t[a]=d*h+e*m}for(a=1,i=n,s=l;a<=c;a++,i++,s++)h=u[i],m=u[s],u[i]=e*h-d*m,u[s]=d*h+e*m})
Math.abs(t[c])<Ph&&(t[c]=0),f[li(e,c,c)]=t[c]}function ui(e,t,a,n){if(e.pa<e.i&&r("scf_solve_it: singular matrix"),t){t=e.i
var i,o,l,s=e.Nb,c=e.v,u=e.s,f=e.ig
for(i=1;i<=t;i++)f[i]=a[u[i]+n]
for(i=1;i<=t;i++)for(o=li(e,i,i),l=f[i]/=c[o],u=i+1,o++;u<=t;u++,o++)f[u]-=c[o]*l
for(u=1;u<=t;u++)a[u+n]=0
for(i=1;i<=t;i++)for(l=f[i],u=1,o=(i-1)*e.K+1;u<=t;u++,o++)a[u+n]+=s[o]*l}else{t=e.i,s=e.Nb,c=e.v,f=e.s,i=e.ig
for(var d,u=1;u<=t;u++){for(d=0,o=1,l=(u-1)*e.K+1;o<=t;o++,l++)d+=s[l]*a[o+n]
i[u]=d}for(u=t;1<=u;u--){for(d=i[u],o=t,l=li(e,u,t);o>u;o--,l--)d-=c[l]*i[o]
i[u]=d/c[l]}for(u=1;u<=t;u++)a[f[u]+n]=i[u]}}function fi(e,r){function a(e,r,t,a){var i=e.g,o=e.Ca,l=e.Ba,s=e.Ia
if((e=e.head[r])<=i)i=1,t[1]=e,a[1]=1
else for(r=o[e-i],i=o[e-i+1]-r,n(t,1,l,r,i),n(a,1,s,r,i),t=1;t<=i;t++)a[t]=-a[t]
return i}function o(e,r,t){var a,i,o,l=e.g,s=e.jb,c=e.jb,u=e.g,f=e.Ca,d=e.Ba,h=e.Ia,m=e.head
for(n(c,1,r,1,u),r=1;r<=u;r++)if(0!=(o=t[r]))if((a=m[r])<=u)c[a]-=o
else for(i=f[a-u],a=f[a-u+1];i<a;i++)c[d[i]]+=h[i]*o
for(A(e.U,s),e=1;e<=l;e++)t[e]+=s[e]}function c(e,r,t){var a,n,i,o,l=e.g,s=e.jb,c=e.jb,u=e.g,f=e.Ca,d=e.Ba,h=e.Ia,m=e.head
for(a=1;a<=u;a++){if(n=m[a],o=r[a],n<=u)o-=t[n]
else for(i=f[n-u],n=f[n-u+1];i<n;i++)o+=h[i]*t[d[i]]
c[a]=o}for(L(e.U,s),e=1;e<=l;e++)t[e]+=s[e]}function u(e,r,t){var a,n=e.g,i=e.De,o=e.Kd,l=e.Ce,s=e.Ee
if(t<=n)a=i[t]+o[t]++,l[a]=r,s[a]=1
else{a=e.Ca
var c=e.Ba
e=e.Ia
var u
for(u=a[t-n],t=a[t-n+1],n=u;n<t;n++)a=c[n],a=i[a]+o[a]++,l[a]=r,s[a]=-e[n]}}function f(e,r){var t,a,n=e.c,i=e.d,o=e.m
switch(t=e.head[e.g+r],o[r]){case xl:a=n[t]
break
case yl:a=i[t]
break
case wl:a=0
break
case Ml:a=n[t]}return a}function d(e){var r,t=e.i,a=e.Qa,i=e.Hc
r=e.g
var o,l=e.u,s=e.head,u=e.Gc
for(o=1;o<=r;o++)u[o]=l[s[o]]
for(n(i,1,u,1,r),L(e.U,i),c(e,u,i),r=1;r<=t;r++){if(l=e.g,o=e.u,u=s=void 0,s=e.head[l+r],u=o[s],s<=l)u-=i[s]
else{o=e.Ca
for(var f=e.Ba,d=e.Ia,h=void 0,m=void 0,h=void 0,h=o[s-l],m=o[s-l+1];h<m;h++)u+=d[h]*i[f[h]]}a[r]=u}}function h(e,r){var t,a,n,i,o=e.i,l=e.m,s=e.Qa,c=e.gamma
for(i=a=0,t=1;t<=o;t++){switch(n=s[t],l[t]){case xl:if(n>=-r)continue
break
case yl:if(n<=+r)continue
break
case wl:if(-r<=n&&n<=+r)continue
break
case Ml:continue}n=n*n/c[t],i<n&&(a=t,i=n)}e.F=a}function m(e,r){var t,a,n,i,o,l,s,c,u,f=e.g,d=e.type,h=e.c,m=e.d,p=e.u,v=e.head,b=e.D,g=e.Ha,x=e.F,y=e.yb,w=e.Ua,M=e.sh
for(s=0<e.Qa[x]?-1:1,t=v[f+x],d[t]==vl?(x=-1,a=0,u=m[t]-h[t],o=1):(a=x=0,u=hi,o=0),n=1;n<=M;n++){if(f=y[n],t=v[f],0<(i=s*w[f]))if(1==b&&0>p[t])l=r*(1+_*Math.abs(h[t])),c=(h[t]+l-g[f])/i,t=xl
else{if(1==b&&0<p[t])continue
if(d[t]!=pl&&d[t]!=vl&&d[t]!=bl)continue
l=r*(1+_*Math.abs(m[t])),c=(m[t]+l-g[f])/i,t=yl}else if(1==b&&0<p[t])l=r*(1+_*Math.abs(m[t])),c=(m[t]-l-g[f])/i,t=yl
else{if(1==b&&0>p[t])continue
if(d[t]!=ml&&d[t]!=vl&&d[t]!=bl)continue
l=r*(1+_*Math.abs(h[t])),c=(h[t]-l-g[f])/i,t=xl}0>c&&(c=0),(u>c||u==c&&o<Math.abs(i))&&(x=f,a=t,u=c,o=Math.abs(i))}if(!(0==r||0>=x||0==u))for(l=u,a=x=0,u=hi,o=0,n=1;n<=M;n++){if(f=y[n],t=v[f],0<(i=s*w[f]))if(1==b&&0>p[t])c=(h[t]-g[f])/i,t=xl
else{if(1==b&&0<p[t])continue
if(d[t]!=pl&&d[t]!=vl&&d[t]!=bl)continue
c=(m[t]-g[f])/i,t=yl}else if(1==b&&0<p[t])c=(m[t]-g[f])/i,t=yl
else{if(1==b&&0>p[t])continue
if(d[t]!=ml&&d[t]!=vl&&d[t]!=bl)continue
c=(h[t]-g[f])/i,t=xl}0>c&&(c=0),c<=l&&o<Math.abs(i)&&(x=f,a=t,u=c,o=Math.abs(i))}e.s=x,e.nf=0<x&&d[v[x]]==bl?Ml:a,e.th=s*u}function p(e){var r=e.g,t=e.i,a=e.u,n=e.eb
e=e.$a
var i
for(i=1;i<=r;i++)a[i]=0
for(i=1;i<=t;i++)a[r+i]=e*n[i]}function v(e){var r,t,a,n=e.g,i=e.i,o=e.eb,l=e.head,s=e.Ha
for(a=o[0],r=1;r<=n;r++)(t=l[r])>n&&(a+=o[t-n]*s[r])
for(s=1;s<=i;s++)(t=l[n+s])>n&&(a+=o[t-n]*f(e,s))
return a}function b(e,r,a){var n,i,o=e.g,l=e.type,c=e.c,u=e.d,f=e.D,d=e.head,h=e.Ha
if(!(r.o<Dl||0<r.fb&&1e3*s(e.hc)<r.fb||e.$==e.be||!a&&0!=e.$%r.bc)){for(n=i=0,r=1;r<=o;r++)a=d[r],(l[a]==ml||l[a]==vl||l[a]==bl)&&h[r]<c[a]&&(i+=c[a]-h[r]),(l[a]==pl||l[a]==vl||l[a]==bl)&&h[r]>u[a]&&(i+=h[r]-u[a]),l[a]==bl&&n++
t((1==f?" ":"*")+e.$+": obj = "+v(e)+"  infeas = "+i+" ("+n+")"),e.be=e.$}}function g(e,r,t,a,i){var o=e.g,l=e.i,s=e.$a,c=e.head,u=e.m,f=e.Ha,d=e.Qa
for(r.valid=1,e.valid=0,r.U=e.U,e.U=null,n(r.head,1,c,1,o),r.na=t,r.sa=a,r.aa=v(e),r.$=e.$,r.some=i,e=1;e<=o;e++)t=c[e],t<=o?(t=r.n[t],t.m=gl,t.bind=e,t.r=f[e]/t.ma):(t=r.f[t-o],t.m=gl,t.bind=e,t.r=f[e]*t.va),t.J=0
for(f=1;f<=l;f++)if((t=c[o+f])<=o){switch(t=r.n[t],t.m=u[f],t.bind=0,u[f]){case xl:t.r=t.c
break
case yl:t.r=t.d
break
case wl:t.r=0
break
case Ml:t.r=t.c}t.J=d[f]*t.ma/s}else{switch(t=r.f[t-o],t.m=u[f],t.bind=0,u[f]){case xl:t.r=t.c
break
case yl:t.r=t.d
break
case wl:t.r=0
break
case Ml:t.r=t.c}t.J=d[f]/t.va/s}}var x,y,w,M,_=.1,P=2,V=0,I=0,S=0
for(x=function(e){var r=e.g,t=e.i
e=e.L
var a={}
return a.g=r,a.i=t,a.type=new Int8Array(1+r+t),a.c=new Float64Array(1+r+t),a.d=new Float64Array(1+r+t),a.u=new Float64Array(1+r+t),a.eb=new Float64Array(1+t),a.Ca=new Int32Array(1+t+1),a.Ba=new Int32Array(1+e),a.Ia=new Float64Array(1+e),a.head=new Int32Array(1+r+t),a.m=new Int8Array(1+t),a.De=new Int32Array(1+r+1),a.Kd=new Int32Array(1+r),a.Ce=null,a.Ee=null,a.Ha=new Float64Array(1+r),a.Qa=new Float64Array(1+t),a.hd=new Int8Array(1+r+t),a.gamma=new Float64Array(1+t),a.yb=new Int32Array(1+r),a.Ua=new Float64Array(1+r),a.Vb=new Int32Array(1+t),a.mb=new Float64Array(1+t),a.jb=new Float64Array(1+r),a.Gc=new Float64Array(1+r),a.Hc=new Float64Array(1+r),a.jg=new Float64Array(1+r),a}(e),function(e,r){var t,a,o=e.g,s=e.i,c=e.type,f=e.c,d=e.d,h=e.u,m=e.eb,p=e.Ca,v=e.Ba,b=e.Ia,g=e.head,x=e.m,y=e.hd,w=e.gamma
for(t=1;t<=o;t++)a=r.n[t],c[t]=a.type,f[t]=a.c*a.ma,d[t]=a.d*a.ma,h[t]=0
for(t=1;t<=s;t++)a=r.f[t],c[o+t]=a.type,f[o+t]=a.c/a.va,d[o+t]=a.d/a.va,h[o+t]=a.u*a.va
for(m[0]=r.ha,n(m,1,h,o+1,s),c=0,t=1;t<=s;t++)c<Math.abs(m[t])&&(c=Math.abs(m[t]))
switch(0==c&&(c=1),r.dir){case sl:e.$a=1/c
break
case cl:e.$a=-1/c}for(1>Math.abs(e.$a)&&(e.$a*=1e3),t=m=1;t<=s;t++)for(p[t]=m,c=r.f[t].k;null!=c;c=c.I)v[m]=c.n.ea,b[m]=c.n.ma*c.j*c.f.va,m++
for(p[s+1]=m,n(g,1,r.head,1,o),p=0,t=1;t<=o;t++)a=r.n[t],a.m!=gl&&(p++,g[o+p]=t,x[p]=a.m)
for(t=1;t<=s;t++)a=r.f[t],a.m!=gl&&(p++,g[o+p]=o+t,x[p]=a.m)
for(e.valid=1,r.valid=0,e.U=r.U,r.U=null,g=e.g,x=e.i,p=e.Ca,v=e.Ba,b=e.De,t=e.Kd,m=1;m<=g;m++)t[m]=1
for(m=1;m<=x;m++)for(f=p[m],c=p[m+1];f<c;f++)t[v[f]]++
for(m=b[1]=1;m<=g;m++)t[m]>x&&(t[m]=x),b[m+1]=b[m]+t[m]
for(e.Ce=new Int32Array(b[g+1]),e.Ee=new Float64Array(b[g+1]),g=e.g,x=e.i,p=e.head,v=e.m,i(e.Kd,1,0,g),b=1;b<=x;b++)v[b]!=Ml&&(t=p[g+b],u(e,b,t))
for(e.D=0,e.hc=l(),e.Sf=e.$=r.$,e.be=-1,e.Rb=0,i(y,1,0,o+s),t=1;t<=s;t++)w[t]=1}(x,e),r.o>=ql&&t("Objective scale factor = "+x.$a);;){if(0==P){if(0!=(M=function(e){var r=k(e.U,e.g,a,e)
return e.valid=0==r,r}(x)))return r.o>=Rl&&(t("Error: unable to factorize the basis matrix ("+M+")"),t("Sorry, basis recovery procedure not implemented yet")),e.U=x.U,x.U=null,e.na=e.sa=Sl,e.aa=0,e.$=x.$,e.some=0,M=js
P=x.valid=1,V=I=0}if(0==V&&(function(e,r){var t,a,i,l,s=e.g,c=e.i,u=e.Ca,d=e.Ba,h=e.Ia,m=e.head,p=e.Gc
for(t=1;t<=s;t++)p[t]=0
for(t=1;t<=c;t++)if(a=m[s+t],0!=(l=f(e,t)))if(a<=s)p[a]-=l
else for(i=u[a-s],a=u[a-s+1];i<a;i++)p[d[i]]+=l*h[i]
n(r,1,p,1,s),A(e.U,r),o(e,p,r)}(x,x.Ha),V=1,0==x.D&&(0<function(e,r){var t,a,n=e.g,i=e.i,o=e.type,l=e.c,s=e.d,c=e.u,u=e.head,f=e.Ha,d=0
for(r*=.9,t=1;t<=n+i;t++)c[t]=0
for(i=1;i<=n;i++)t=u[i],o[t]!=ml&&o[t]!=vl&&o[t]!=bl||(a=r*(1+_*Math.abs(l[t])),f[i]<l[t]-a&&(c[t]=-1,d++)),o[t]!=pl&&o[t]!=vl&&o[t]!=bl||(a=r*(1+_*Math.abs(s[t])),f[i]>s[t]+a&&(c[t]=1,d++))
return d}(x,r.Gb)?x.D=1:(p(x),x.D=2),I=0,b(x,r,1)),function(e,r){var t,a,n,i=e.g,o=e.type,l=e.c,s=e.d,c=e.u,u=e.head,f=e.D,d=e.Ha
for(t=1;t<=i;t++)if(a=u[t],1==f&&0>c[a]){if(n=r*(1+_*Math.abs(l[a])),d[t]>l[a]+n)return 1}else if(1==f&&0<c[a]){if(n=r*(1+_*Math.abs(s[a])),d[t]<s[a]-n)return 1}else{if((o[a]==ml||o[a]==vl||o[a]==bl)&&(n=r*(1+_*Math.abs(l[a])),d[t]<l[a]-n))return 1
if((o[a]==pl||o[a]==vl||o[a]==bl)&&(n=r*(1+_*Math.abs(s[a])),d[t]>s[a]+n))return 1}return 0}(x,r.Gb)))r.o>=Rl&&t("Warning: numerical instability (primal simplex, phase "+(1==x.D?"I":"II")+")"),P=x.D=0,S=5
else{switch(1!=x.D||function(e,r){var t,a,n,i=e.g,o=e.c,l=e.d,s=e.u,c=e.head,u=e.Ha
for(t=1;t<=i;t++)if(a=c[t],0>s[a]){if(n=r*(1+_*Math.abs(o[a])),u[t]<o[a]-n)return 1}else if(0<s[a]&&(n=r*(1+_*Math.abs(l[a])),u[t]>l[a]+n))return 1
return 0}(x,r.Gb)||(x.D=2,p(x),I=0,b(x,r,1)),0==I&&(d(x),I=1),r.fd){case Wl:0==x.Rb&&function(e){var r,t=e.g,a=e.i,n=e.head,o=e.hd,l=e.gamma
for(e.Rb=1e3,i(o,1,0,t+a),e=1;e<=a;e++)r=n[t+e],o[r]=1,l[e]=1}(x)}if(2147483647>r.oc&&x.$-x.Sf>=r.oc){if(1!=V||2==x.D&&1!=I){1!=V&&(V=0),2==x.D&&1!=I&&(I=0)
continue}switch(b(x,r,1),r.o>=Gl&&t("ITERATION LIMIT EXCEEDED; SEARCH TERMINATED"),x.D){case 1:y=Ol,p(x),d(x)
break
case 2:y=jl}return h(x,r.tb),w=0==x.F?jl:Ol,g(x,e,y,w,0),M=Es}if(2147483647>r.sb&&1e3*s(x.hc)>=r.sb){if(1!=V||2==x.D&&1!=I){1!=V&&(V=0),2==x.D&&1!=I&&(I=0)
continue}switch(b(x,r,1),r.o>=Gl&&t("TIME LIMIT EXCEEDED; SEARCH TERMINATED"),x.D){case 1:y=Ol,p(x),d(x)
break
case 2:y=jl}return h(x,r.tb),w=0==x.F?jl:Ol,g(x,e,y,w,0),M=Fs}if(b(x,r,0),h(x,r.tb),0==x.F){if(1!=V||1!=I){1!=V&&(V=0),1!=I&&(I=0)
continue}switch(b(x,r,1),x.D){case 1:r.o>=Gl&&t("PROBLEM HAS NO FEASIBLE SOLUTION"),y=Xl,p(x),d(x),h(x,r.tb),w=0==x.F?jl:Ol
break
case 2:r.o>=Gl&&t("OPTIMAL SOLUTION FOUND"),y=w=jl}return g(x,e,y,w,0),M=0}!function(e){var r,t,a=e.g,n=e.yb,i=e.Ua,o=e.Ua
for(t=e.head[a+e.F],r=1;r<=a;r++)o[r]=0
if(t<=a)o[t]=-1
else{var l=e.Ca
r=e.Ba
var s,c=e.Ia
for(s=l[t-a],t=l[t-a+1];s<t;s++)o[r[s]]=c[s]}for(A(e.U,i),o=0,r=1;r<=a;r++)0!=i[r]&&(n[++o]=r)
e.Tb=o}(x),S&&function(e){var r,t,a=e.g,n=e.yb,i=e.Ua,l=e.Hc
for(t=e.head[a+e.F],r=1;r<=a;r++)l[r]=0
if(t<=a)l[t]=-1
else{var s=e.Ca
r=e.Ba
var c,u=e.Ia
for(c=s[t-a],t=s[t-a+1];c<t;c++)l[r[c]]=u[c]}for(o(e,l,i),l=0,r=1;r<=a;r++)0!=i[r]&&(n[++l]=r)
e.Tb=l}(x),function(e,r){var t,a,n,i=e.Tb,o=e.yb,l=e.Ua
for(a=0,t=1;t<=i;t++)n=Math.abs(l[o[t]]),a<n&&(a=n)
for(e.rh=a,n=r*(1+.01*a),a=0;a<i;)t=o[i],Math.abs(l[t])<n?i--:(a++,o[i]=o[a],o[a]=t)
e.sh=a}(x,r.xe)
var j=x.Qa[x.F],O=function(e){var r,t,a=e.u,n=e.head,i=e.Tb,o=e.yb,l=e.Ua
for(t=a[n[e.g+e.F]],r=1;r<=i;r++)e=o[r],t+=a[n[e]]*l[e]
return t}(x)
if(!(Math.abs(j-O)>1e-5*(1+Math.abs(O)))&&(0>j&&0>O||0<j&&0<O)||(r.o>=ql&&t("d1 = "+j+"; d2 = "+O),1==I&&S)){switch(x.Qa[x.F]=0<j?0<O?O:2.220446049250313e-16:0>O?O:-2.220446049250313e-16,r.ne){case Zl:m(x,0)
break
case Jl:m(x,.3*r.Gb)}if(0==x.s){if(1!=V||1!=I||!S){1!=V&&(V=0),1!=I&&(I=0),S=1
continue}switch(b(x,r,1),x.D){case 1:r.o>=Rl&&t("Error: unable to choose basic variable on phase I"),e.U=x.U,x.U=null,e.na=e.sa=Sl,e.aa=0,e.$=x.$,e.some=0,M=js
break
case 2:r.o>=Gl&&t("PROBLEM HAS UNBOUNDED SOLUTION"),g(x,e,jl,Xl,x.head[x.g+x.F]),M=0}return M}if(0<x.s&&(j=x.Ua[x.s],O=1e-5*(1+.01*x.rh),Math.abs(j)<O&&(r.o>=ql&&t("piv = "+j+"; eps = "+O),!S)))S=5
else{if(0<x.s&&(j=x.jg,function(e,r){var t,a=e.g,n=e.s
for(t=1;t<=a;t++)r[t]=0
r[n]=1,L(e.U,r)}(x,j),S&&function(e,r){var t,a=e.g,n=e.s,i=e.Hc
for(t=1;t<=a;t++)i[t]=0
i[n]=1,c(e,i,r)}(x,j),function(e,r){var t,a,n,i,o=e.g,l=e.i,s=e.De,c=e.Kd,u=e.Ce,f=e.Ee,d=e.Vb,h=e.mb
for(t=1;t<=l;t++)h[t]=0
for(t=1;t<=o;t++)if(0!=(i=r[t]))for(a=s[t],n=a+c[t];a<n;a++)h[u[a]]-=i*f[a]
for(o=0,t=1;t<=l;t++)0!=h[t]&&(d[++o]=t)
e.Bc=o}(x,j)),0<x.s&&(j=x.Ua[x.s],O=x.mb[x.F],Math.abs(j-O)>1e-8*(1+Math.abs(j))||!(0<j&&0<O||0>j&&0>O))){if(r.o>=ql&&t("piv1 = "+j+"; piv2 = "+O),1!=P||!S){1!=P&&(P=0),S=5
continue}0==x.mb[x.F]&&(x.Bc++,x.Vb[x.Bc]=x.F),x.mb[x.F]=j}if(function(e){var r=e.Ha,t=e.F,a=e.Tb,n=e.yb,i=e.Ua,o=e.s,l=e.th
if(0<o&&(r[o]=f(e,t)+l),0!=l)for(t=1;t<=a;t++)(e=n[t])!=o&&(r[e]+=i[e]*l)}(x),V=2,0<x.s&&(function(e){var r=e.Qa,t=e.F,a=e.Bc,n=e.Vb
e=e.mb
var i,o,l
for(l=r[t]/=e[t],o=1;o<=a;o++)(i=n[o])!=t&&(r[i]-=e[i]*l)}(x),I=2,1==x.D&&(j=x.head[x.s],x.Qa[x.F]-=x.u[j],x.u[j]=0)),0<x.s)switch(r.fd){case Wl:0<x.Rb&&function(e){var r,t,a,n,i,o,l=e.g,s=e.type,c=e.Ca,u=e.Ba,f=e.Ia,d=e.head,h=e.hd,m=e.gamma,p=e.F,v=e.Tb,b=e.yb,g=e.Ua,x=e.s,y=e.Bc,w=e.Vb,M=e.mb,_=e.Hc
for(e.Rb--,n=i=h[d[l+p]]?1:0,r=1;r<=l;r++)_[r]=0
for(t=1;t<=v;t++)r=b[t],h[d[r]]?(_[r]=r=g[r],n+=r*r):_[r]=0
for(L(e.U,_),v=M[p],t=1;t<=y;t++)if((e=w[t])!=p){if(r=M[e]/v,(b=d[l+e])<=l)o=_[b]
else for(o=0,a=c[b-l],g=c[b-l+1];a<g;a++)o-=f[a]*_[u[a]]
g=m[e]+r*r*n+2*r*o,r=(h[b]?1:0)+i*r*r,m[e]=g>=r?g:r,2.220446049250313e-16>m[e]&&(m[e]=2.220446049250313e-16)}s[d[x]]==bl?m[p]=1:(m[p]=n/(v*v),2.220446049250313e-16>m[p]&&(m[p]=2.220446049250313e-16))}(x)}0<x.s&&(M=function(e,r,t){var a,n=e.g
if(t<=n){var i=Array(2)
a=Array(2),i[1]=t,a[1]=1,r=C(e.U,r,1,i,0,a)}else{var o=e.Ca,i=e.Ba,l=e.Ia
a=e.jb
var s
for(s=o[t-n],t=o[t-n+1],o=0,n=s;n<t;n++)a[++o]=-l[n]
r=C(e.U,r,o,i,s-1,a)}return e.valid=0==r,r}(x,x.s,x.head[x.g+x.F]),P=0==M?2:x.valid=0),0<x.s&&(function(e,r,t){var a,n=e.g,i=e.De,o=e.Kd,l=e.Ce,s=e.Ee
if(t<=n){for(n=a=i[t];l[n]!=r;n++);a+=--o[t],l[n]=l[a],s[n]=s[a]}else{a=e.Ca,e=e.Ba
var c,u
for(u=a[t-n],t=a[t-n+1];u<t;u++){for(c=e[u],n=a=i[c];l[n]!=r;n++);a+=--o[c],l[n]=l[a],s[n]=s[a]}}}(x,x.F,x.head[x.g+x.F]),x.type[x.head[x.s]]!=bl&&u(x,x.F,x.head[x.s])),function(e){var r=e.g,t=e.head,a=e.m,n=e.F,i=e.s
e=e.nf
var o
if(0>i)switch(a[n]){case xl:a[n]=yl
break
case yl:a[n]=xl}else o=t[i],t[i]=t[r+n],t[r+n]=o,a[n]=e}(x),x.$++,0<S&&S--}}else 1!=I&&(I=0),S=5}}}function di(e,r){function a(e,r,t,a){var i=e.g,o=e.Ca,l=e.Ba,s=e.Ia
if((e=e.head[r])<=i)i=1,t[1]=e,a[1]=1
else for(r=o[e-i],i=o[e-i+1]-r,n(t,1,l,r,i),n(a,1,s,r,i),t=1;t<=i;t++)a[t]=-a[t]
return i}function o(e,r,t){var a,i,o,l=e.g,s=e.jb,c=e.jb,u=e.g,f=e.Ca,d=e.Ba,h=e.Ia,m=e.head
for(n(c,1,r,1,u),r=1;r<=u;r++)if(0!=(o=t[r]))if((a=m[r])<=u)c[a]-=o
else for(i=f[a-u],a=f[a-u+1];i<a;i++)c[d[i]]+=h[i]*o
for(A(e.U,s),e=1;e<=l;e++)t[e]+=s[e]}function c(e,r,t){var a,n,i,o,l=e.g,s=e.jb,c=e.jb,u=e.g,f=e.Ca,d=e.Ba,h=e.Ia,m=e.head
for(a=1;a<=u;a++){if(n=m[a],o=r[a],n<=u)o-=t[n]
else for(i=f[n-u],n=f[n-u+1];i<n;i++)o+=h[i]*t[d[i]]
c[a]=o}for(L(e.U,s),e=1;e<=l;e++)t[e]+=s[e]}function u(e,r){var t,a,n=e.c,i=e.d,o=e.m
switch(t=e.head[e.g+r],o[r]){case xl:a=n[t]
break
case yl:a=i[t]
break
case wl:a=0
break
case Ml:a=n[t]}return a}function f(e,r){var t,a,i,l,s=e.g,c=e.i,f=e.Ca,d=e.Ba,h=e.Ia,m=e.head,p=e.Gc
for(t=1;t<=s;t++)p[t]=0
for(t=1;t<=c;t++)if(a=m[s+t],0!=(l=u(e,t)))if(a<=s)p[a]-=l
else for(i=f[a-s],a=f[a-s+1];i<a;i++)p[d[i]]+=l*h[i]
n(r,1,p,1,s),A(e.U,r),o(e,p,r)}function d(e){var r,t=e.i,a=e.Qa,i=e.Hc
r=e.g
var o,l=e.u,s=e.head,u=e.Gc
for(o=1;o<=r;o++)u[o]=l[s[o]]
for(n(i,1,u,1,r),L(e.U,i),c(e,u,i),r=1;r<=t;r++){if(l=e.g,o=e.u,u=s=void 0,s=e.head[l+r],u=o[s],s<=l)u-=i[s]
else{o=e.Ca
for(var f=e.Ba,d=e.Ia,h=void 0,m=void 0,h=void 0,h=o[s-l],m=o[s-l+1];h<m;h++)u+=d[h]*i[f[h]]}a[r]=u}}function h(e,r){var t,a,n,i,o,l,s,c,u,f=e.m,d=e.Qa,h=e.Vb,m=e.mb,p=e.vh
for(l=0<e.Se?1:-1,n=0,c=hi,o=0,a=1;a<=p;a++){if(t=h[a],0<(i=l*m[t])){if(f[t]!=xl&&f[t]!=wl)continue
s=(d[t]+r)/i}else{if(f[t]!=yl&&f[t]!=wl)continue
s=(d[t]-r)/i}0>s&&(s=0),(c>s||c==s&&o<Math.abs(i))&&(n=t,c=s,o=Math.abs(i))}if(0!=r&&0!=n&&0!=c)for(u=c,n=0,c=hi,o=0,a=1;a<=p;a++){if(t=h[a],0<(i=l*m[t])){if(f[t]!=xl&&f[t]!=wl)continue
s=d[t]/i}else{if(f[t]!=yl&&f[t]!=wl)continue
s=d[t]/i}0>s&&(s=0),s<=u&&o<Math.abs(i)&&(n=t,c=s,o=Math.abs(i))}e.F=n,e.bh=l*c}function m(e,r){var t,a,n=e.g,i=e.i,o=e.ac,l=e.head,s=e.Qa
for(t=1;t<=i;t++)if(a=l[n+t],s[t]<-r&&(o[a]==ml||o[a]==hl)||s[t]>+r&&(o[a]==pl||o[a]==hl))return 1
return 0}function p(e){var r=e.g,t=e.i,a=e.type,i=e.c,o=e.d,l=e.bd,s=e.cd,c=e.head,u=e.m,f=e.Qa
for(n(a,1,e.ac,1,r+t),n(i,1,l,1,r+t),n(o,1,s,1,r+t),e=1;e<=t;e++)switch(l=c[r+e],a[l]){case hl:u[e]=wl
break
case ml:u[e]=xl
break
case pl:u[e]=yl
break
case vl:u[e]=2.220446049250313e-16<=f[e]?xl:-2.220446049250313e-16>=f[e]?yl:Math.abs(i[l])<=Math.abs(o[l])?xl:yl
break
case bl:u[e]=Ml}}function v(e){var r,t,a,n=e.g,i=e.i,o=e.eb,l=e.head,s=e.Ha
for(a=o[0],r=1;r<=n;r++)(t=l[r])>n&&(a+=o[t-n]*s[r])
for(s=1;s<=i;s++)(t=l[n+s])>n&&(a+=o[t-n]*u(e,s))
return a}function b(e,r,a){var n=e.g,i=e.i,o=e.u,l=e.ac,c=e.head,f=e.m,d=e.D,h=e.Ha,m=e.Qa
if(!(r.o<Dl||0<r.fb&&1e3*s(e.hc)<r.fb||e.$==e.be||!a&&0!=e.$%r.bc)){if(r=0,1==d){for(f=1;f<=n;f++)r-=o[c[f]]*h[f]
for(h=1;h<=i;h++)r-=o[c[n+h]]*u(e,h)}else for(h=1;h<=i;h++)0>m[h]&&(f[h]==xl||f[h]==wl)&&(r-=m[h]),0<m[h]&&(f[h]==yl||f[h]==wl)&&(r+=m[h])
for(i=0,f=1;f<=n;f++)l[c[f]]==bl&&i++
t(1==e.D?" "+e.$+":  infeas = "+r+" ("+i+")":"|"+e.$+": obj = "+v(e)+"  infeas = "+r+" ("+i+")"),e.be=e.$}}function g(e,r,t,a,i){var o=e.g,l=e.i,s=e.$a,c=e.head,u=e.m,f=e.Ha,d=e.Qa
for(r.valid=1,e.valid=0,r.U=e.U,e.U=null,n(r.head,1,c,1,o),r.na=t,r.sa=a,r.aa=v(e),r.$=e.$,r.some=i,e=1;e<=o;e++)t=c[e],t<=o?(t=r.n[t],t.m=gl,t.bind=e,t.r=f[e]/t.ma):(t=r.f[t-o],t.m=gl,t.bind=e,t.r=f[e]*t.va),t.J=0
for(f=1;f<=l;f++)if((t=c[o+f])<=o){switch(t=r.n[t],t.m=u[f],t.bind=0,u[f]){case xl:t.r=t.c
break
case yl:t.r=t.d
break
case wl:t.r=0
break
case Ml:t.r=t.c}t.J=d[f]*t.ma/s}else{switch(t=r.f[t-o],t.m=u[f],t.bind=0,u[f]){case xl:t.r=t.c
break
case yl:t.r=t.d
break
case wl:t.r=0
break
case Ml:t.r=t.c}t.J=d[f]/t.va/s}}var x,y,w,M,_=.1,P=2,V=0,I=0,S=0
for(x=function(e){var r=e.g,t=e.i
e=e.L
var a={}
return a.g=r,a.i=t,a.type=new Int8Array(1+r+t),a.c=new Float64Array(1+r+t),a.d=new Float64Array(1+r+t),a.u=new Float64Array(1+r+t),a.ac=new Int8Array(1+r+t),a.bd=new Float64Array(1+r+t),a.cd=new Float64Array(1+r+t),a.eb=new Float64Array(1+t),a.Ca=new Int32Array(1+t+1),a.Ba=new Int32Array(1+e),a.Ia=new Float64Array(1+e),a.lg=new Int32Array(1+r+1),a.kg=new Int32Array(1+e),a.mg=new Float64Array(1+e),a.head=new Int32Array(1+r+t),a.bind=new Int32Array(1+r+t),a.m=new Int8Array(1+t),a.Ha=new Float64Array(1+r),a.Qa=new Float64Array(1+t),a.hd=new Int8Array(1+r+t),a.gamma=new Float64Array(1+r),a.Vb=new Int32Array(1+t),a.mb=new Float64Array(1+t),a.yb=new Int32Array(1+r),a.Ua=new Float64Array(1+r),a.jb=new Float64Array(1+r),a.Gc=new Float64Array(1+r),a.Hc=new Float64Array(1+r),a.jg=new Float64Array(1+r),a}(e),function(e,r){var t,a,o=e.g,s=e.i,c=e.type,u=e.c,f=e.d,d=e.u,h=e.ac,m=e.bd,p=e.cd,v=e.eb,b=e.Ca,g=e.Ba,x=e.Ia,y=e.lg,w=e.kg,M=e.mg,_=e.head,k=e.bind,A=e.m,L=e.hd,C=e.gamma
for(t=1;t<=o;t++)a=r.n[t],c[t]=a.type,u[t]=a.c*a.ma,f[t]=a.d*a.ma,d[t]=0
for(t=1;t<=s;t++)a=r.f[t],c[o+t]=a.type,u[o+t]=a.c/a.va,f[o+t]=a.d/a.va,d[o+t]=a.u*a.va
for(n(h,1,c,1,o+s),n(m,1,u,1,o+s),n(p,1,f,1,o+s),v[0]=r.ha,n(v,1,d,o+1,s),c=0,t=1;t<=s;t++)c<Math.abs(v[t])&&(c=Math.abs(v[t]))
switch(0==c&&(c=1),r.dir){case sl:e.$a=1/c
break
case cl:e.$a=-1/c}for(1>Math.abs(e.$a)&&(e.$a*=1e3),t=1;t<=s;t++)d[o+t]*=e.$a
for(t=d=1;t<=s;t++)for(b[t]=d,v=r.f[t].k;null!=v;v=v.I)g[d]=v.n.ea,x[d]=v.n.ma*v.j*v.f.va,d++
for(b[s+1]=d,t=d=1;t<=o;t++)for(y[t]=d,v=r.n[t].k;null!=v;v=v.B)w[d]=v.f.C,M[d]=v.n.ma*v.j*v.f.va,d++
for(y[o+1]=d,n(_,1,r.head,1,o),b=0,t=1;t<=o;t++)a=r.n[t],a.m!=gl&&(b++,_[o+b]=t,A[b]=a.m)
for(t=1;t<=s;t++)a=r.f[t],a.m!=gl&&(b++,_[o+b]=o+t,A[b]=a.m)
for(b=1;b<=o+s;b++)k[_[b]]=b
for(e.valid=1,r.valid=0,e.U=r.U,r.U=null,e.D=0,e.hc=l(),e.Sf=e.$=r.$,e.be=-1,e.Rb=0,i(L,1,0,o+s),t=1;t<=o;t++)C[t]=1}(x,e),r.o>=ql&&t("Objective scale factor = "+x.$a);;){if(0==P){if(0!=(M=function(e){var r=k(e.U,e.g,a,e)
return e.valid=0==r,r}(x)))return r.o>=Rl&&(t("Error: unable to factorize the basis matrix ("+M+")"),t("Sorry, basis recovery procedure not implemented yet")),e.U=x.U,x.U=null,e.na=e.sa=Sl,e.aa=0,e.$=x.$,e.some=0,M=js
P=x.valid=1,V=I=0}if(0!=I||(d(x),I=1,0==x.D&&(0!=m(x,.9*r.tb)?(x.D=1,function(e){var r=e.g,t=e.i,a=e.type,n=e.c,i=e.d,o=e.ac,l=e.head,s=e.m
e=e.Qa
var c
for(c=1;c<=r+t;c++)switch(o[c]){case hl:a[c]=vl,n[c]=-1e3,i[c]=1e3
break
case ml:a[c]=vl,n[c]=0,i[c]=1
break
case pl:a[c]=vl,n[c]=-1,i[c]=0
break
case vl:case bl:a[c]=bl,n[c]=i[c]=0}for(n=1;n<=t;n++)c=l[r+n],s[n]=a[c]==bl?Ml:0<=e[n]?xl:yl}(x)):(x.D=2,p(x)),V=x.Rb=0),0==function(e,r){var t,a=e.i,n=e.m,i=e.Qa
for(t=1;t<=a;t++)if(i[t]<-r&&(n[t]==xl||n[t]==wl)||i[t]>+r&&(n[t]==yl||n[t]==wl))return 1
return 0}(x,r.tb))){switch(1==x.D&&0==m(x,r.tb)&&(b(x,r,1),x.D=2,1!=I&&(d(x),I=1),p(x),V=x.Rb=0),0==V&&(f(x,x.Ha),2==x.D&&(x.Ha[0]=v(x)),V=1),r.fd){case Wl:0==x.Rb&&function(e){var r=e.g,t=e.i,a=e.head,n=e.hd,o=e.gamma
for(e.Rb=1e3,i(n,1,0,r+t),e=1;e<=r;e++)t=a[e],n[t]=1,o[e]=1}(x)}if(2==x.D&&0>x.$a&&r.hf>-hi&&x.Ha[0]<=r.hf){if(1!=V||1!=I){1!=V&&(V=0),1!=I&&(I=0)
continue}return b(x,r,1),r.o>=Gl&&t("OBJECTIVE LOWER LIMIT REACHED; SEARCH TERMINATED"),g(x,e,Ol,jl,0),M=Os}if(2==x.D&&0<x.$a&&r.jf<+hi&&x.Ha[0]>=r.jf){if(1!=V||1!=I){1!=V&&(V=0),1!=I&&(I=0)
continue}return b(x,r,1),r.o>=Gl&&t("OBJECTIVE UPPER LIMIT REACHED; SEARCH TERMINATED"),g(x,e,Ol,jl,0),M=Xs}if(2147483647>r.oc&&x.$-x.Sf>=r.oc){if(2==x.D&&1!=V||1!=I){2==x.D&&1!=V&&(V=0),1!=I&&(I=0)
continue}switch(b(x,r,1),r.o>=Gl&&t("ITERATION LIMIT EXCEEDED; SEARCH TERMINATED"),x.D){case 1:w=Ol,p(x),f(x,x.Ha)
break
case 2:w=jl}return g(x,e,Ol,w,0),M=Es}if(2147483647>r.sb&&1e3*s(x.hc)>=r.sb){if(2==x.D&&1!=V||1!=I){2==x.D&&1!=V&&(V=0),1!=I&&(I=0)
continue}switch(b(x,r,1),r.o>=Gl&&t("TIME LIMIT EXCEEDED; SEARCH TERMINATED"),x.D){case 1:w=Ol,p(x),f(x,x.Ha)
break
case 2:w=jl}return g(x,e,Ol,w,0),M=Fs}if(b(x,r,0),function(e,r){var t,a,n,i,o,l,s,c=e.g,u=e.type,f=e.c,d=e.d,h=e.head,m=e.Ha,p=e.gamma
for(o=i=n=0,t=1;t<=c;t++)a=h[t],s=0,u[a]!=ml&&u[a]!=vl&&u[a]!=bl||(l=r*(1+_*Math.abs(f[a])),m[t]<f[a]-l&&(s=f[a]-m[t])),u[a]!=pl&&u[a]!=vl&&u[a]!=bl||(l=r*(1+_*Math.abs(d[a])),m[t]>d[a]+l&&(s=d[a]-m[t])),0!=s&&(a=p[t],2.220446049250313e-16>a&&(a=2.220446049250313e-16),a=s*s/a,o<a&&(n=t,i=s,o=a))
e.s=n,e.Se=i}(x,r.Gb),0==x.s){if(1!=V||1!=I){1!=V&&(V=0),1!=I&&(I=0)
continue}switch(b(x,r,1),x.D){case 1:r.o>=Gl&&t("PROBLEM HAS NO DUAL FEASIBLE SOLUTION"),p(x),f(x,x.Ha),y=Ol,w=Xl
break
case 2:r.o>=Gl&&t("OPTIMAL SOLUTION FOUND"),y=w=jl}return g(x,e,y,w,0),M=0}var j=x.jg
switch(function(e,r){var t,a=e.g,n=e.s
for(t=1;t<=a;t++)r[t]=0
r[n]=1,L(e.U,j)}(x,j),S&&function(e,r){var t,a=e.g,n=e.s,i=e.Hc
for(t=1;t<=a;t++)i[t]=0
i[n]=1,c(e,i,r)}(x,j),function(e,r){var t,a,n=e.g
for(a=0,t=1;t<=n;t++)0!=r[t]&&a++
if(.2<=a/n){n=e.g,t=e.i,a=e.Ca
var i,o,l,s,c,u=e.Ba,f=e.Ia,d=e.head,h=e.m,m=e.Vb,p=e.mb
for(s=0,i=1;i<=t;i++)if(h[i]==Ml)p[i]=0
else{if((o=d[n+i])<=n)c=-r[o]
else for(l=a[o-n],o=a[o-n+1],c=0;l<o;l++)c+=r[u[l]]*f[l]
0!=c&&(m[++s]=i),p[i]=c}e.Bc=s}else{for(u=e.g,n=e.i,f=e.lg,d=e.kg,h=e.mg,m=e.bind,p=e.m,t=e.Vb,a=e.mb,s=1;s<=n;s++)a[s]=0
for(i=1;i<=u;i++)if(0!=(o=r[i]))for(s=m[i]-u,1<=s&&p[s]!=Ml&&(a[s]-=o),s=f[i],l=f[i+1],c=s;c<l;c++)1<=(s=m[u+d[c]]-u)&&p[s]!=Ml&&(a[s]+=o*h[c])
for(u=0,s=1;s<=n;s++)0!=a[s]&&(t[++u]=s)
e.Bc=u}}(x,j),function(e,r){var t,a,n,i=e.Bc,o=e.Vb,l=e.mb
for(a=0,t=1;t<=i;t++)n=Math.abs(l[o[t]]),a<n&&(a=n)
for(e.uh=a,n=r*(1+.01*a),a=0;a<i;)t=o[i],Math.abs(l[t])<n?i--:(a++,o[i]=o[a],o[a]=t)
e.vh=a}(x,r.Gb),r.ne){case Zl:h(x,0)
break
case Jl:h(x,.3*r.tb)}if(0==x.F){if(1!=V||1!=I||!S){1!=V&&(V=0),1!=I&&(I=0),S=1
continue}switch(b(x,r,1),x.D){case 1:r.o>=Rl&&t("Error: unable to choose basic variable on phase I"),e.U=x.U,x.U=null,e.na=e.sa=Sl,e.aa=0,e.$=x.$,e.some=0,M=js
break
case 2:r.o>=Gl&&t("PROBLEM HAS NO FEASIBLE SOLUTION"),g(x,e,Xl,jl,x.head[x.s]),M=0}return M}var O=x.mb[x.F],X=1e-5*(1+.01*x.uh)
if(Math.abs(O)<X&&(r.o>=ql&&t("piv = "+O+"; eps = "+X),!S))S=5
else{if(function(e){var r,t,a=e.g,n=e.yb,i=e.Ua,o=e.Ua
for(t=e.head[a+e.F],r=1;r<=a;r++)o[r]=0
if(t<=a)o[t]=-1
else{var l=e.Ca
r=e.Ba
var s,c=e.Ia
for(s=l[t-a],t=l[t-a+1];s<t;s++)o[r[s]]=c[s]}for(A(e.U,i),o=0,r=1;r<=a;r++)0!=i[r]&&(n[++o]=r)
e.Tb=o}(x),S&&function(e){var r,t,a=e.g,n=e.yb,i=e.Ua,l=e.Hc
for(t=e.head[a+e.F],r=1;r<=a;r++)l[r]=0
if(t<=a)l[t]=-1
else{var s=e.Ca
r=e.Ba
var c,u=e.Ia
for(c=s[t-a],t=s[t-a+1];c<t;c++)l[r[c]]=u[c]}for(o(e,l,i),l=0,r=1;r<=a;r++)0!=i[r]&&(n[++l]=r)
e.Tb=l}(x),O=x.Ua[x.s],X=x.mb[x.F],Math.abs(O-X)>1e-8*(1+Math.abs(O))||!(0<O&&0<X||0>O&&0>X)){if(r.o>=ql&&t("piv1 = "+O+"; piv2 = "+X),1!=P||!S){1!=P&&(P=0),S=5
continue}0==x.Ua[x.s]&&(x.Tb++,x.yb[x.Tb]=x.s),x.Ua[x.s]=X}switch(function(e){var r,t=e.Ha,a=e.s,n=e.F,i=e.Tb,o=e.yb,l=e.Ua
if(r=e.Se/l[a],t[a]=u(e,n)+r,0!=r)for(n=1;n<=i;n++)(e=o[n])!=a&&(t[e]+=l[e]*r)}(x),2==x.D&&(x.Ha[0]+=x.Qa[x.F]/x.$a*(x.Se/x.Ua[x.s])),V=2,function(e){var r=e.Qa,t=e.Bc,a=e.Vb,n=e.mb,i=e.F
e=e.bh
var o,l
if(r[i]=e,0!=e)for(l=1;l<=t;l++)(o=a[l])!=i&&(r[o]-=n[o]*e)}(x),I=2,r.fd){case Wl:0<x.Rb&&function(e){var r,t,a,n,i,o,l=e.g,s=e.type,c=e.head,u=e.hd,f=e.gamma,d=e.s,h=e.Bc,m=e.Vb,p=e.mb,v=e.F,b=e.Tb,g=e.yb,x=e.Ua,y=e.Hc
for(e.Rb--,i=o=u[c[d]]?1:0,r=1;r<=l;r++)y[r]=0
for(n=1;n<=h;n++)if(t=m[n],a=c[l+t],u[a])if(t=p[t],i+=t*t,a<=l)y[a]+=t
else{var w=e.Ca
r=e.Ba
var M,_=e.Ia
for(M=w[a-l],a=w[a-l+1];M<a;M++)y[r[M]]-=t*_[M]}for(A(e.U,y),e=x[d],n=1;n<=b;n++)r=g[n],a=c[r],r!=d&&s[c[r]]!=hl&&(t=x[r]/e,h=f[r]+t*t*i+2*t*y[r],t=(u[a]?1:0)+o*t*t,f[r]=h>=t?h:t,2.220446049250313e-16>f[r]&&(f[r]=2.220446049250313e-16))
if(s[c[l+v]]==hl?f[d]=1:(f[d]=i/(e*e),2.220446049250313e-16>f[d]&&(f[d]=2.220446049250313e-16)),a=c[d],s[a]==bl&&u[a])for(u[a]=0,n=1;n<=b;n++){if((r=g[n])==d){if(s[c[l+v]]==hl)continue
t=1/x[d]}else{if(s[c[r]]==hl)continue
t=x[r]/x[d]}f[r]-=t*t,2.220446049250313e-16>f[r]&&(f[r]=2.220446049250313e-16)}}(x)}M=function(e,r,t){var a,n=e.g
if(t<=n){var i=Array(2)
a=Array(2),i[1]=t,a[1]=1,r=C(e.U,r,1,i,0,a)}else{var o=e.Ca,i=e.Ba,l=e.Ia
a=e.jb
var s
for(s=o[t-n],t=o[t-n+1],o=0,n=s;n<t;n++)a[++o]=-l[n]
r=C(e.U,r,o,i,s-1,a)}return e.valid=0==r,r}(x,x.s,x.head[x.g+x.F]),P=0==M?2:x.valid=0,function(e){var r=e.g,t=e.type,a=e.head,n=e.bind,i=e.m,o=e.s,l=e.Se
e=e.F
var s
s=a[o],a[o]=a[r+e],a[r+e]=s,n[a[o]]=o,n[a[r+e]]=r+e,i[e]=t[s]==bl?Ml:0<l?xl:yl}(x),x.$++,0<S&&S--}}else{if(r.o>=Rl&&t("Warning: numerical instability (dual simplex, phase "+(1==x.D?"I":"II")+")"),r.cb==Ul)return g(x,e,Sl,Sl,0),M=js
P=x.D=0,S=5}}}var hi=Number.MAX_VALUE,mi=Number.MIN_VALUE
e.glp_get_print_func=function(){return t},e.glp_set_print_func=function(e){t=e}
var pi={},vi=e.glp_version=function(){return ol+"."+ll},bi=e.glp_create_prob=function(){var e={}
return p(e),e},gi=e.glp_set_prob_name=function(e,t){var a=e.V
null!=a&&0!=a.reason&&r("glp_set_prob_name: operation not allowed"),e.name=t},xi=e.glp_set_obj_name=function(e,t){var a=e.V
null!=a&&0!=a.reason&&r("glp_set_obj_name: operation not allowed"),e.eb=t},yi=e.glp_set_obj_dir=function(e,t){var a=e.V
null!=a&&0!=a.reason&&r("glp_set_obj_dir: operation not allowed"),t!=sl&&t!=cl&&r("glp_set_obj_dir: dir = "+t+"; invalid direction flag"),e.dir=t},wi=e.glp_add_rows=function(e,t){var a,n=e.V
1>t&&r("glp_add_rows: nrs = "+t+"; invalid number of rows"),t>1e8-e.g&&r("glp_add_rows: nrs = "+t+"; too many rows")
var i=e.g+t
if(e.hb<i){for(;e.hb<i;)e.hb+=e.hb
e.n.length=1+e.hb,e.head=new Int32Array(1+e.hb)}for(var o=e.g+1;o<=i;o++){if(e.n[o]=a={},a.ea=o,a.name=null,a.rb=null,a.La=0,a.origin=0,a.qc=0,null!=n)switch(n.reason){case gs:a.La=n.N.La,a.origin=us
break
case ws:a.La=n.N.La,a.origin=fs}a.type=hl,a.c=a.d=0,a.k=null,a.ma=1,a.m=gl,a.bind=0,a.r=a.J=0,a.dc=a.mc=0,a.Sa=0}return e.g=i,e.valid=0,null!=n&&0!=n.reason&&(n.pe=1),i-t+1},Mi=e.glp_add_cols=function(e,t){var a=e.V
null!=a&&0!=a.reason&&r("glp_add_cols: operation not allowed"),1>t&&r("glp_add_cols: ncs = "+t+"; invalid number of columns"),t>1e8-e.i&&r("glp_add_cols: ncs = "+t+"; too many columns")
var n=e.i+t
if(e.K<n){for(;e.K<n;)e.K+=e.K
e.f.length=1+e.K}for(var i=e.i+1;i<=n;i++)e.f[i]=a={},a.C=i,a.name=null,a.rb=null,a.kind=ul,a.type=bl,a.c=a.d=0,a.u=0,a.k=null,a.va=1,a.m=Ml,a.bind=0,a.r=a.J=0,a.dc=a.mc=0,a.Sa=0
return e.i=n,n-t+1},_i=e.glp_set_row_name=function(e,t,a){1<=t&&t<=e.g||r("glp_set_row_name: i = "+t+"; row number out of range"),t=e.n[t],null!=t.name&&(delete e.fc[t.name],t.name=null),null!=a&&(t.name=a,e.fc[t.name]=t)},ki=e.glp_set_col_name=function(e,t,a){var n=e.V
null!=n&&0!=n.reason&&r("glp_set_col_name: operation not allowed"),1<=t&&t<=e.i||r("glp_set_col_name: j = "+t+"; column number out of range"),t=e.f[t],null!=t.name&&(delete e.Lc[t.name],t.name=null),null!=a&&(t.name=a,e.Lc[t.name]=t)},Ai=e.glp_set_row_bnds=function(e,t,a,n,i){switch(1<=t&&t<=e.g||r("glp_set_row_bnds: i = "+t+"; row number out of range"),e=e.n[t],e.type=a,a){case hl:e.c=e.d=0,e.m!=gl&&(e.m=wl)
break
case ml:e.c=n,e.d=0,e.m!=gl&&(e.m=xl)
break
case pl:e.c=0,e.d=i,e.m!=gl&&(e.m=yl)
break
case vl:e.c=n,e.d=i,e.m!=gl&&e.m!=xl&&e.m!=yl&&(e.m=Math.abs(n)<=Math.abs(i)?xl:yl)
break
case bl:e.c=e.d=n,e.m!=gl&&(e.m=Ml)
break
default:r("glp_set_row_bnds: i = "+t+"; type = "+a+"; invalid row type")}},Li=e.glp_set_col_bnds=function(e,t,a,n,i){switch(1<=t&&t<=e.i||r("glp_set_col_bnds: j = "+t+"; column number out of range"),e=e.f[t],e.type=a,a){case hl:e.c=e.d=0,e.m!=gl&&(e.m=wl)
break
case ml:e.c=n,e.d=0,e.m!=gl&&(e.m=xl)
break
case pl:e.c=0,e.d=i,e.m!=gl&&(e.m=yl)
break
case vl:e.c=n,e.d=i,e.m!=gl&&e.m!=xl&&e.m!=yl&&(e.m=Math.abs(n)<=Math.abs(i)?xl:yl)
break
case bl:e.c=e.d=n,e.m!=gl&&(e.m=Ml)
break
default:r("glp_set_col_bnds: j = "+t+"; type = "+a+"; invalid column type")}},Ci=e.glp_set_obj_coef=function(e,t,a){var n=e.V
null!=n&&0!=n.reason&&r("glp_set_obj_coef: operation not allowed"),0<=t&&t<=e.i||r("glp_set_obj_coef: j = "+t+"; column number out of range"),0==t?e.ha=a:e.f[t].u=a},Pi=e.glp_set_mat_row=function(e,t,a,n,i){var o,l,s
1<=t&&t<=e.g||r("glp_set_mat_row: i = "+t+"; row number out of range")
for(var c=e.n[t];null!=c.k;)l=c.k,c.k=l.B,o=l.f,null==l.ra?o.k=l.I:l.ra.I=l.I,null!=l.I&&(l.I.ra=l.ra),e.L--,o.m==gl&&(e.valid=0)
for(0<=a&&a<=e.i||r("glp_set_mat_row: i = "+t+"; len = "+a+"; invalid row length "),a>5e8-e.L&&r("glp_set_mat_row: i = "+t+"; len = "+a+"; too many constraint coefficients"),s=1;s<=a;s++)l=n[s],1<=l&&l<=e.i||r("glp_set_mat_row: i = "+t+"; ind["+s+"] = "+l+"; column index out of range"),o=e.f[l],null!=o.k&&o.k.n.ea==t&&r("glp_set_mat_row: i = "+t+"; ind["+s+"] = "+l+"; duplicate column indices not allowed"),l={},e.L++,l.n=c,l.f=o,l.j=i[s],l.ua=null,l.B=c.k,l.ra=null,l.I=o.k,null!=l.B&&(l.B.ua=l),null!=l.I&&(l.I.ra=l),c.k=o.k=l,o.m==gl&&0!=l.j&&(e.valid=0)
for(l=c.k;null!=l;l=t)t=l.B,0==l.j&&(null==l.ua?c.k=t:l.ua.B=t,null!=t&&(t.ua=l.ua),l.f.k=l.I,null!=l.I&&(l.I.ra=null),e.L--)},Vi=e.glp_set_mat_col=function(e,t,a,n,i){var o,l,s,c=e.V
for(null!=c&&0!=c.reason&&r("glp_set_mat_col: operation not allowed"),1<=t&&t<=e.i||r("glp_set_mat_col: j = "+t+"; column number out of range"),c=e.f[t];null!=c.k;)l=c.k,c.k=l.I,o=l.n,null==l.ua?o.k=l.B:l.ua.B=l.B,null!=l.B&&(l.B.ua=l.ua),e.L--
for(0<=a&&a<=e.g||r("glp_set_mat_col: j = "+t+"; len = "+a+"; invalid column length"),a>5e8-e.L&&r("glp_set_mat_col: j = "+t+"; len = "+a+"; too many constraint coefficients"),s=1;s<=a;s++)l=n[s],1<=l&&l<=e.g||r("glp_set_mat_col: j = "+t+"; ind["+s+"] = "+l+"; row index out of range"),o=e.n[l],null!=o.k&&o.k.f.C==t&&r("glp_set_mat_col: j = "+t+"; ind["+s+"] = "+l+"; duplicate row indices not allowed"),l={},e.L++,l.n=o,l.f=c,l.j=i[s],l.ua=null,l.B=o.k,l.ra=null,l.I=c.k,null!=l.B&&(l.B.ua=l),null!=l.I&&(l.I.ra=l),o.k=c.k=l
for(l=c.k;null!=l;l=t)t=l.I,0==l.j&&(l.n.k=l.B,null!=l.B&&(l.B.ua=null),null==l.ra?c.k=t:l.ra.I=t,null!=t&&(t.ra=l.ra),e.L--)
c.m==gl&&(e.valid=0)}
e.glp_load_matrix=function(e,t,a,n,i){var o,l,s,c,u=e.V
for(null!=u&&0!=u.reason&&r("glp_load_matrix: operation not allowed"),s=1;s<=e.g;s++)for(u=e.n[s];null!=u.k;)l=u.k,u.k=l.B,e.L--
for(l=1;l<=e.i;l++)e.f[l].k=null
for(0>t&&r("glp_load_matrix: ne = "+t+"; invalid number of constraint coefficients"),5e8<t&&r("glp_load_matrix: ne = "+t+"; too many constraint coefficients"),c=1;c<=t;c++)s=a[c],l=n[c],1<=s&&s<=e.g||r("glp_load_matrix: ia["+c+"] = "+s+"; row index out of range"),u=e.n[s],1<=l&&l<=e.i||r("glp_load_matrix: ja["+c+"] = "+l+"; column index out of range"),o=e.f[l],l={},e.L++,l.n=u,l.f=o,l.j=i[c],l.ua=null,l.B=u.k,null!=l.B&&(l.B.ua=l),u.k=l
for(s=1;s<=e.g;s++)for(l=e.n[s].k;null!=l;l=l.B){if(o=l.f,null!=o.k&&o.k.n.ea==s){for(c=1;c<=t&&(a[c]!=s||n[c]!=o.C);c++);r("glp_load_mat: ia["+c+"] = "+s+"; ja["+c+"] = "+o.C+"; duplicate indices not allowed")}l.ra=null,l.I=o.k,null!=l.I&&(l.I.ra=l),o.k=l}for(s=1;s<=e.g;s++)for(u=e.n[s],l=u.k;null!=l;l=t)t=l.B,0==l.j&&(null==l.ua?u.k=t:l.ua.B=t,null!=t&&(t.ua=l.ua),null==l.ra?l.f.k=l.I:l.ra.I=l.I,null!=l.I&&(l.I.ra=l.ra),e.L--)
e.valid=0},e.glp_check_dup=function(e,t,a,n,i){var o,l,s,c,u
for(0>e&&r("glp_check_dup: m = %d; invalid parameter"),0>t&&r("glp_check_dup: n = %d; invalid parameter"),0>a&&r("glp_check_dup: ne = %d; invalid parameter"),0<a&&null==n&&r("glp_check_dup: ia = "+n+"; invalid parameter"),0<a&&null==i&&r("glp_check_dup: ja = "+i+"; invalid parameter"),s=1;s<=a;s++)if(o=n[s],l=i[s],!(1<=o&&o<=e&&1<=l&&l<=t))return e=-s
if(0==e||0==t)return 0
for(c=new Int32Array(1+e),u=new Int32Array(1+a),t=new Int8Array(1+t),s=1;s<=a;s++)o=n[s],u[s]=c[o],c[o]=s
for(o=1;o<=e;o++){for(s=c[o];0!=s;s=u[s]){if(l=i[s],t[l]){for(s=1;s<=a&&(n[s]!=o||i[s]!=l);s++);for(s++;s<=a&&(n[s]!=o||i[s]!=l);s++);return e=+s}t[l]=1}for(s=c[o];0!=s;s=u[s])t[i[s]]=0}return 0}
var Ii=e.glp_sort_matrix=function(e){var t,a,n
for(null!=e&&3621377730==e.Dd||r("glp_sort_matrix: P = "+e+"; invalid problem object"),a=e.g;1<=a;a--)e.n[a].k=null
for(n=e.i;1<=n;n--)for(t=e.f[n].k;null!=t;t=t.I)a=t.n.ea,t.ua=null,t.B=e.n[a].k,null!=t.B&&(t.B.ua=t),e.n[a].k=t
for(n=e.i;1<=n;n--)e.f[n].k=null
for(a=e.g;1<=a;a--)for(t=e.n[a].k;null!=t;t=t.B)n=t.f.C,t.ra=null,t.I=e.f[n].k,null!=t.I&&(t.I.ra=t),e.f[n].k=t},Si=e.glp_del_rows=function(e,t,a){var n,i,o,l=e.V
for(1<=t&&t<=e.g||r("glp_del_rows: nrs = "+t+"; invalid number of rows"),o=1;o<=t;o++)i=a[o],1<=i&&i<=e.g||r("glp_del_rows: num["+o+"] = "+i+"; row number out of range"),n=e.n[i],null!=l&&0!=l.reason&&(l.reason!=gs&&l.reason!=ws&&r("glp_del_rows: operation not allowed"),n.La!=l.N.La&&r("glp_del_rows: num["+o+"] = "+i+"; invalid attempt to delete row created not in current subproblem"),n.m!=gl&&r("glp_del_rows: num["+o+"] = "+i+"; invalid attempt to delete active row (constraint)"),l.tf=1),0==n.ea&&r("glp_del_rows: num["+o+"] = "+i+"; duplicate row numbers not allowed"),_i(e,i,null),Pi(e,i,0,null,null),n.ea=0
for(t=0,i=1;i<=e.g;i++)n=e.n[i],0!=n.ea&&(n.ea=++t,e.n[n.ea]=n)
e.g=t,e.valid=0}
e.glp_del_cols=function(e,t,a){var n,i,o=e.V
for(null!=o&&0!=o.reason&&r("glp_del_cols: operation not allowed"),1<=t&&t<=e.i||r("glp_del_cols: ncs = "+t+"; invalid number of columns"),i=1;i<=t;i++)o=a[i],1<=o&&o<=e.i||r("glp_del_cols: num["+i+"] = "+o+"; column number out of range"),n=e.f[o],0==n.C&&r("glp_del_cols: num["+i+"] = "+o+"; duplicate column numbers not allowed"),ki(e,o,null),Vi(e,o,0,null,null),n.C=0,n.m==gl&&(e.valid=0)
for(t=0,o=1;o<=e.i;o++)n=e.f[o],0!=n.C&&(n.C=++t,e.f[n.C]=n)
if(e.i=t,e.valid)for(a=e.g,n=e.head,o=1;o<=t;o++)0!=(i=e.f[o].bind)&&(n[i]=a+o)}
var ji=e.glp_copy_prob=function(e,t,a){var n,i,o,l,s=e.V,c={}
for(null!=s&&0!=s.reason&&r("glp_copy_prob: operation not allowed"),e==t&&r("glp_copy_prob: copying problem object to itself not allowed"),a!=vs&&a!=bs&&r("glp_copy_prob: names = "+a+"; invalid parameter"),Oi(e),a&&null!=t.name&&gi(e,t.name),a&&null!=t.eb&&xi(e,t.eb),e.dir=t.dir,e.ha=t.ha,0<t.g&&wi(e,t.g),0<t.i&&Mi(e,t.i),Po(t,c),Vo(e,c),e.na=t.na,e.sa=t.sa,e.aa=t.aa,e.some=t.some,e.df=t.df,e.ae=t.ae,e.za=t.za,e.ta=t.ta,n=1;n<=t.g;n++)s=e.n[n],c=t.n[n],a&&null!=c.name&&_i(e,n,c.name),s.type=c.type,s.c=c.c,s.d=c.d,s.ma=c.ma,s.m=c.m,s.r=c.r,s.J=c.J,s.dc=c.dc,s.mc=c.mc,s.Sa=c.Sa
for(o=new Int32Array(1+t.g),l=new Float64Array(1+t.g),n=1;n<=t.i;n++)s=e.f[n],c=t.f[n],a&&null!=c.name&&ki(e,n,c.name),s.kind=c.kind,s.type=c.type,s.c=c.c,s.d=c.d,s.u=c.u,i=Hi(t,n,o,l),Vi(e,n,i,o,l),s.va=c.va,s.m=c.m,s.r=c.r,s.J=c.J,s.dc=c.dc,s.mc=c.mc,s.Sa=c.Sa},Oi=e.glp_erase_prob=function(e){var t=e.V
null!=t&&0!=t.reason&&r("glp_erase_prob: operation not allowed"),e.Dd=1061109567,e.ke=null,e.n=null,e.f=null,e.fc=null,e.Lc=null,e.head=null,e.Qd=null,e.U=null,p(e)}
e.glp_get_prob_name=function(e){return e.name}
var Xi=e.glp_get_obj_name=function(e){return e.eb},Ei=e.glp_get_obj_dir=function(e){return e.dir},Fi=e.glp_get_num_rows=function(e){return e.g},Bi=e.glp_get_num_cols=function(e){return e.i},zi=e.glp_get_row_name=function(e,t){return 1<=t&&t<=e.g||r("glp_get_row_name: i = "+t+"; row number out of range"),e.n[t].name},Ti=e.glp_get_col_name=function(e,t){return 1<=t&&t<=e.i||r("glp_get_col_name: j = "+t+"; column number out of range"),e.f[t].name},Ni=e.glp_get_row_type=function(e,t){return 1<=t&&t<=e.g||r("glp_get_row_type: i = "+t+"; row number out of range"),e.n[t].type},Ri=e.glp_get_row_lb=function(e,t){var a
switch(1<=t&&t<=e.g||r("glp_get_row_lb: i = "+t+"; row number out of range"),e.n[t].type){case hl:case pl:a=-hi
break
case ml:case vl:case bl:a=e.n[t].c}return a},Di=e.glp_get_row_ub=function(e,t){var a
switch(1<=t&&t<=e.g||r("glp_get_row_ub: i = "+t+"; row number out of range"),e.n[t].type){case hl:case ml:a=+hi
break
case pl:case vl:case bl:a=e.n[t].d}return a},Gi=e.glp_get_col_type=function(e,t){return 1<=t&&t<=e.i||r("glp_get_col_type: j = "+t+"; column number out of range"),e.f[t].type},qi=e.glp_get_col_lb=function(e,t){var a
switch(1<=t&&t<=e.i||r("glp_get_col_lb: j = "+t+"; column number out of range"),e.f[t].type){case hl:case pl:a=-hi
break
case ml:case vl:case bl:a=e.f[t].c}return a},Yi=e.glp_get_col_ub=function(e,t){var a
switch(1<=t&&t<=e.i||r("glp_get_col_ub: j = "+t+"; column number out of range"),e.f[t].type){case hl:case ml:a=+hi
break
case pl:case vl:case bl:a=e.f[t].d}return a}
e.glp_get_obj_coef=function(e,t){return 0<=t&&t<=e.i||r("glp_get_obj_coef: j = "+t+"; column number out of range"),0==t?e.ha:e.f[t].u},e.glp_get_num_nz=function(e){return e.L}
var Ui=e.glp_get_mat_row=function(e,t,a,n){var i
for(1<=t&&t<=e.g||r("glp_get_mat_row: i = "+t+"; row number out of range"),i=0,e=e.n[t].k;null!=e;e=e.B)i++,null!=a&&(a[i]=e.f.C),null!=n&&(n[i]=e.j)
return i},Hi=e.glp_get_mat_col=function(e,t,a,n){var i
for(1<=t&&t<=e.i||r("glp_get_mat_col: j = "+t+"; column number out of range"),i=0,e=e.f[t].k;null!=e;e=e.I)i++,null!=a&&(a[i]=e.n.ea),null!=n&&(n[i]=e.j)
return i},Ki=e.glp_create_index=function(e){var r,t
if(null==e.fc)for(e.fc={},t=1;t<=e.g;t++)r=e.n[t],null!=r.name&&(e.fc[r.name]=r)
if(null==e.Lc)for(e.Lc={},t=1;t<=e.i;t++)r=e.f[t],null!=r.name&&(e.Lc[r.name]=r)},Wi=e.glp_find_row=function(e,t){var a=0
null==e.fc&&r("glp_find_row: row name index does not exist")
var n=e.fc[t]
return n&&(a=n.ea),a},Zi=e.glp_find_col=function(e,t){var a=0
null==e.Lc&&r("glp_find_col: column name index does not exist")
var n=e.Lc[t]
return n&&(a=n.C),a},Ji=e.glp_delete_index=function(e){e.fc=null,e.fc=null},Qi=e.glp_set_rii=function(e,t,a){if(1<=t&&t<=e.g||r("glp_set_rii: i = "+t+"; row number out of range"),0>=a&&r("glp_set_rii: i = "+t+"; rii = "+a+"; invalid scale factor"),e.valid&&e.n[t].ma!=a)for(var n=e.n[t].k;null!=n;n=n.B)if(n.f.m==gl){e.valid=0
break}e.n[t].ma=a},$i=e.glp_set_sjj=function(e,t,a){1<=t&&t<=e.i||r("glp_set_sjj: j = "+t+"; column number out of range"),0>=a&&r("glp_set_sjj: j = "+t+"; sjj = "+a+"; invalid scale factor"),e.valid&&e.f[t].va!=a&&e.f[t].m==gl&&(e.valid=0),e.f[t].va=a},eo=e.glp_get_rii=function(e,t){return 1<=t&&t<=e.g||r("glp_get_rii: i = "+t+"; row number out of range"),e.n[t].ma},ro=e.glp_get_sjj=function(e,t){return 1<=t&&t<=e.i||r("glp_get_sjj: j = "+t+"; column number out of range"),e.f[t].va},to=e.glp_unscale_prob=function(e){var r,t=Fi(e),a=Bi(e)
for(r=1;r<=t;r++)Qi(e,r,1)
for(t=1;t<=a;t++)$i(e,t,1)},ao=e.glp_set_row_stat=function(e,t,a){if(1<=t&&t<=e.g||r("glp_set_row_stat: i = "+t+"; row number out of range"),a!=gl&&a!=xl&&a!=yl&&a!=wl&&a!=Ml&&r("glp_set_row_stat: i = "+t+"; stat = "+a+"; invalid status"),t=e.n[t],a!=gl)switch(t.type){case hl:a=wl
break
case ml:a=xl
break
case pl:a=yl
break
case vl:a!=yl&&(a=xl)
break
case bl:a=Ml}(t.m==gl&&a!=gl||t.m!=gl&&a==gl)&&(e.valid=0),t.m=a},no=e.glp_set_col_stat=function(e,t,a){if(1<=t&&t<=e.i||r("glp_set_col_stat: j = "+t+"; column number out of range"),a!=gl&&a!=xl&&a!=yl&&a!=wl&&a!=Ml&&r("glp_set_col_stat: j = "+t+"; stat = "+a+"; invalid status"),t=e.f[t],a!=gl)switch(t.type){case hl:a=wl
break
case ml:a=xl
break
case pl:a=yl
break
case vl:a!=yl&&(a=xl)
break
case bl:a=Ml}(t.m==gl&&a!=gl||t.m!=gl&&a==gl)&&(e.valid=0),t.m=a},io=e.glp_std_basis=function(e){var r
for(r=1;r<=e.g;r++)ao(e,r,gl)
for(r=1;r<=e.i;r++){var t=e.f[r]
t.type==vl&&Math.abs(t.c)>Math.abs(t.d)?no(e,r,yl):no(e,r,xl)}},oo=e.glp_simplex=function(e,a){function n(e,r){var a
return Lo(e)||(a=Co(e),0!=a&&(a==Ps?r.o>=Rl&&t("glp_simplex: initial basis is invalid"):a==Vs?r.o>=Rl&&t("glp_simplex: initial basis is singular"):a==Is&&r.o>=Rl&&t("glp_simplex: initial basis is ill-conditioned")),0==a)?(r.cb==Yl?a=fi(e,r):r.cb==Ul?(a=di(e,r))==js&&e.valid&&(a=fi(e,r)):r.cb==Hl&&(a=di(e,r)),a):a}var i
for(null!=e&&3621377730==e.Dd||r("glp_simplex: P = "+e+"; invalid problem object"),null!=e.V&&0!=e.V.reason&&r("glp_simplex: operation not allowed"),null==a&&(a=new lo),a.o!=Nl&&a.o!=Rl&&a.o!=Dl&&a.o!=Gl&&a.o!=ql&&r("glp_simplex: msg_lev = "+a.o+"; invalid parameter"),a.cb!=Yl&&a.cb!=Ul&&a.cb!=Hl&&r("glp_simplex: meth = "+a.cb+"; invalid parameter"),a.fd!=Kl&&a.fd!=Wl&&r("glp_simplex: pricing = "+a.fd+"; invalid parameter"),a.ne!=Zl&&a.ne!=Jl&&r("glp_simplex: r_test = "+a.ne+"; invalid parameter"),0<a.Gb&&1>a.Gb||r("glp_simplex: tol_bnd = "+a.Gb+"; invalid parameter"),0<a.tb&&1>a.tb||r("glp_simplex: tol_dj = "+a.tb+"; invalid parameter"),0<a.xe&&1>a.xe||r("glp_simplex: tol_piv = "+a.xe+"; invalid parameter"),0>a.oc&&r("glp_simplex: it_lim = "+a.oc+"; invalid parameter"),0>a.sb&&r("glp_simplex: tm_lim = "+a.sb+"; invalid parameter"),1>a.bc&&r("glp_simplex: out_frq = "+a.bc+"; invalid parameter"),0>a.fb&&r("glp_simplex: out_dly = "+a.fb+"; invalid parameter"),a.yc!=vs&&a.yc!=bs&&r("glp_simplex: presolve = "+a.yc+"; invalid parameter"),e.na=e.sa=Sl,e.aa=0,e.some=0,i=1;i<=e.g;i++){var o=e.n[i]
if(o.type==vl&&o.c>=o.d)return a.o>=Rl&&t("glp_simplex: row "+i+": lb = "+o.c+", ub = "+o.d+"; incorrect bounds"),i=Ss}for(i=1;i<=e.i;i++)if(o=e.f[i],o.type==vl&&o.c>=o.d)return a.o>=Rl&&t("glp_simplex: column "+i+": lb = "+o.c+", ub = "+o.d+"; incorrect bounds"),i=Ss
return a.o>=Gl&&(t("GLPK Simplex Optimizer, v"+vi()),t(e.g+" row"+(1==e.g?"":"s")+", "+e.i+" column"+(1==e.i?"":"s")+", "+e.L+" non-zero"+(1==e.L?"":"s"))),0==e.L?(function(e,r){function a(){o.m=xl,o.r=o.c}function n(){o.m=yl,o.r=o.d}var i,o,l,s,c
for(e.valid=0,e.na=e.sa=jl,e.aa=e.ha,s=c=e.some=0,l=1;l<=e.g;l++)i=e.n[l],i.m=gl,i.r=i.J=0,i.type!=ml&&i.type!=vl&&i.type!=bl||(i.c>+r.Gb&&(e.na=Xl,0==e.some&&r.cb!=Yl&&(e.some=l)),s<+i.c&&(s=+i.c)),i.type!=pl&&i.type!=vl&&i.type!=bl||(i.d<-r.Gb&&(e.na=Xl,0==e.some&&r.cb!=Yl&&(e.some=l)),s<-i.d&&(s=-i.d))
for(i=l=1;i<=e.i;i++)o=e.f[i],l<Math.abs(o.u)&&(l=Math.abs(o.u))
for(l=(e.dir==sl?1:-1)/l,i=1;i<=e.i;i++)o=e.f[i],o.type==hl?(o.m=wl,o.r=0):o.type==ml?a():o.type==pl?n():o.type==vl?0<l*o.u?a():0>l*o.u?n():Math.abs(o.c)<=Math.abs(o.d)?a():n():o.type==bl&&(o.m=Ml,o.r=o.c),o.J=o.u,e.aa+=o.u*o.r,o.type!=hl&&o.type!=ml||(l*o.J<-r.tb&&(e.sa=Xl,0==e.some&&r.cb==Yl&&(e.some=e.g+i)),c<-l*o.J&&(c=-l*o.J)),o.type!=hl&&o.type!=pl||(l*o.J>+r.tb&&(e.sa=Xl,0==e.some&&r.cb==Yl&&(e.some=e.g+i)),c<+l*o.J&&(c=+l*o.J))
r.o>=Dl&&0==r.fb&&t("~"+e.$+": obj = "+e.aa+"  infeas = "+(r.cb==Yl?s:c)),r.o>=Gl&&0==r.fb&&t(e.na==jl&&e.sa==jl?"OPTIMAL SOLUTION FOUND":e.na==Xl?"PROBLEM HAS NO FEASIBLE SOLUTION":r.cb==Yl?"PROBLEM HAS UNBOUNDED SOLUTION":"PROBLEM HAS NO DUAL FEASIBLE SOLUTION")}(e,a),i=0):i=a.yc?function(e,r){function a(){return _n(i,l),l=null,kn(i,e),o=0}var i,o,l=null,s={}
if(r.o>=Gl&&t("Preprocessing..."),i=ln(),wn(i,e,Pl),o=$n(i,0),0!=o&&(o==Bs?r.o>=Gl&&t("PROBLEM HAS NO PRIMAL FEASIBLE SOLUTION"):o==zs&&r.o>=Gl&&t("PROBLEM HAS NO DUAL FEASIBLE SOLUTION")),0!=o)return o
if(l=bi(),Mn(i,l),0==l.g&&0==l.i)return l.na=l.sa=jl,l.aa=l.ha,r.o>=Dl&&0==r.fb&&t(e.$+": obj = "+l.aa+"  infeas = 0.0"),r.o>=Gl&&t("OPTIMAL SOLUTION FOUND BY LP PREPROCESSOR"),a()
r.o>=Gl&&t(l.g+" row"+(1==l.g?"":"s")+", "+l.i+" column"+(1==l.i?"":"s")+", "+l.L+" non-zero"+(1==l.L?"":"s")),Po(e,s),Vo(l,s)
var s=pi,c=s.Fb
return s.Fb=!c||r.o<Gl?bs:vs,Vh(l,Cl),s.Fb=c,s=pi,c=s.Fb,s.Fb=!c||r.o<Gl?bs:vs,I(l),s.Fb=c,l.$=e.$,o=n(l,r),e.$=l.$,0!=o||l.na!=jl||l.sa!=jl?(r.o>=Rl&&t("glp_simplex: unable to recover undefined or non-optimal solution"),0==o&&(l.na==Xl?o=Bs:l.sa==Xl&&(o=zs)),o):a()}(e,a):n(e,a),i},lo=e.SMCP=function(e){e=e||{},this.o=e.msg_lev||Gl,this.cb=e.meth||Yl,this.fd=e.pricing||Wl,this.ne=e.r_test||Jl,this.Gb=e.tol_bnd||1e-7,this.tb=e.tol_dj||1e-7,this.xe=e.tol_piv||1e-10,this.hf=e.obj_ll||-hi,this.jf=e.obj_ul||+hi,this.oc=e.it_lim||2147483647,this.sb=e.tm_lim||2147483647,this.bc=e.out_frq||500,this.fb=e.out_dly||0,this.yc=e.presolve||bs},so=e.glp_get_status=function(e){var r
switch(r=co(e)){case jl:switch(uo(e)){case jl:r=El
break
case Xl:r=Fl}}return r},co=e.glp_get_prim_stat=function(e){return e.na},uo=e.glp_get_dual_stat=function(e){return e.sa},fo=e.glp_get_obj_val=function(e){return e.aa},ho=e.glp_get_row_stat=function(e,t){return 1<=t&&t<=e.g||r("glp_get_row_stat: i = "+t+"; row number out of range"),e.n[t].m},mo=e.glp_get_row_prim=function(e,t){return 1<=t&&t<=e.g||r("glp_get_row_prim: i = "+t+"; row number out of range"),e.n[t].r},po=e.glp_get_row_dual=function(e,t){return 1<=t&&t<=e.g||r("glp_get_row_dual: i = "+t+"; row number out of range"),e.n[t].J},vo=e.glp_get_col_stat=function(e,t){return 1<=t&&t<=e.i||r("glp_get_col_stat: j = "+t+"; column number out of range"),e.f[t].m},bo=e.glp_get_col_prim=function(e,t){return 1<=t&&t<=e.i||r("glp_get_col_prim: j = "+t+"; column number out of range"),e.f[t].r},go=e.glp_get_col_dual=function(e,t){return 1<=t&&t<=e.i||r("glp_get_col_dual: j = "+t+"; column number out of range"),e.f[t].J}
e.glp_get_unbnd_ray=function(e){var r=e.some
return r>e.g+e.i&&(r=0),r}
var xo=e.glp_set_col_kind=function(e,t,a){1<=t&&t<=e.i||r("glp_set_col_kind: j = "+t+"; column number out of range")
var n=e.f[t]
switch(a){case ul:n.kind=ul
break
case fl:n.kind=fl
break
case dl:n.kind=fl,n.type==vl&&0==n.c&&1==n.d||Li(e,t,vl,0,1)
break
default:r("glp_set_col_kind: j = "+t+"; kind = "+a+"; invalid column kind")}},yo=e.glp_get_col_kind=function(e,t){1<=t&&t<=e.i||r("glp_get_col_kind: j = "+t+"; column number out of range")
var a=e.f[t],n=a.kind
switch(n){case fl:a.type==vl&&0==a.c&&1==a.d&&(n=dl)}return n},wo=e.glp_get_num_int=function(e){for(var r,t=0,a=1;a<=e.i;a++)r=e.f[a],r.kind==fl&&t++
return t},Mo=e.glp_get_num_bin=function(e){for(var r,t=0,a=1;a<=e.i;a++)r=e.f[a],r.kind==fl&&r.type==vl&&0==r.c&&1==r.d&&t++
return t}
e.glp_intopt=function(e,a){function n(e,r){var a
if(so(e)!=El)return r.o>=Rl&&t("glp_intopt: optimal basis to initial LP relaxation not provided"),a=Ts
r.o>=Gl&&t("Integer optimization begins...")
var n=e.g
a=e.i
var i,o
for(e.V=i={},i.i=a,i.wc=n,i.ac=new Int8Array(1+n+a),i.bd=new Float64Array(1+n+a),i.cd=new Float64Array(1+n+a),i.mf=new Int8Array(1+n+a),i.lf=new Float64Array(1+n+a),i.kf=new Float64Array(1+n+a),o=1;o<=n;o++){var s=e.n[o]
i.ac[o]=s.type,i.bd[o]=s.c,i.cd[o]=s.d,i.mf[o]=s.m,i.lf[o]=s.r,i.kf[o]=s.J}for(o=1;o<=a;o++)s=e.f[o],i.ac[n+o]=s.type,i.bd[n+o]=s.c,i.cd[n+o]=s.d,i.mf[n+o]=s.m,i.lf[n+o]=s.r,i.kf[n+o]=s.J
i.ih=e.aa,i.fe=0,i.Sc=0,i.ya=null,i.head=i.Xa=null,i.Pd=i.Zf=i.Jg=0,i.Ig=0,i.se=null,i.qe=i.te=null,i.re=null,i.N=null,i.A=e,i.ad=new Int8Array(1+a),i.Fg=i.Gg=0,i.qf=null,i.of=i.rf=null,i.pf=null,n={size:0},n.head=n.Xa=null,n.fh=0,n.N=null,i.Bd=n,i.Xf=null,i.Ne=null,i.Fd=null,i.Bg=new Int32Array(1+a),i.Tg=new Float64Array(1+a),i.p=r,i.hc=l(),i.Lg=0,i.qh=0,i.reason=0,i.pe=0,i.tf=0,i.Tc=0,i.Jf=0,i.ud=0,i.gf=0,i.stop=0,S(i,null),a=G(i)
var n=i.A,c=n.g
if(o=n.i,c!=i.wc){var u,c=c-i.wc
for(u=new Int32Array(1+c),s=1;s<=c;s++)u[s]=i.wc+s
Si(n,c,u)}for(c=i.wc,s=1;s<=c;s++)Ai(n,s,i.ac[s],i.bd[s],i.cd[s]),ao(n,s,i.mf[s]),n.n[s].r=i.lf[s],n.n[s].J=i.kf[s]
for(s=1;s<=o;s++)Li(n,s,i.ac[c+s],i.bd[c+s],i.cd[c+s]),no(n,s,i.mf[c+s]),n.f[s].r=i.lf[c+s],n.f[s].J=i.kf[c+s]
return n.na=n.sa=jl,n.aa=i.ih,R(i.Bd),n.V=null,0==a?e.za==jl?(r.o>=Gl&&t("INTEGER OPTIMAL SOLUTION FOUND"),e.za=El):(r.o>=Gl&&t("PROBLEM HAS NO INTEGER FEASIBLE SOLUTION"),e.za=Xl):a==Rs?r.o>=Gl&&t("RELATIVE MIP GAP TOLERANCE REACHED; SEARCH TERMINATED"):a==Fs?r.o>=Gl&&t("TIME LIMIT EXCEEDED; SEARCH TERMINATED"):a==js?r.o>=Rl&&t("glp_intopt: cannot solve current LP relaxation"):a==Ns&&r.o>=Gl&&t("SEARCH TERMINATED BY APPLICATION"),a}var i,o
for(null!=e&&3621377730==e.Dd||r("glp_intopt: P = "+e+"; invalid problem object"),null!=e.V&&r("glp_intopt: operation not allowed"),null==a&&(a=new _o),a.o!=Nl&&a.o!=Rl&&a.o!=Dl&&a.o!=Gl&&a.o!=ql&&r("glp_intopt: msg_lev = "+a.o+"; invalid parameter"),a.Jb!=Ql&&a.Jb!=$l&&a.Jb!=es&&a.Jb!=rs&&a.Jb!=ts&&r("glp_intopt: br_tech = "+a.Jb+"; invalid parameter"),a.kc!=as&&a.kc!=ns&&a.kc!=is&&a.kc!=os&&r("glp_intopt: bt_tech = "+a.kc+"; invalid parameter"),0<a.Ub&&1>a.Ub||r("glp_intopt: tol_int = "+a.Ub+"; invalid parameter"),0<a.we&&1>a.we||r("glp_intopt: tol_obj = "+a.we+"; invalid parameter"),0>a.sb&&r("glp_intopt: tm_lim = "+a.sb+"; invalid parameter"),0>a.bc&&r("glp_intopt: out_frq = "+a.bc+"; invalid parameter"),0>a.fb&&r("glp_intopt: out_dly = "+a.fb+"; invalid parameter"),0<=a.Me&&256>=a.Me||r("glp_intopt: cb_size = "+a.Me+"; invalid parameter"),a.ed!=ls&&a.ed!=ss&&a.ed!=cs&&r("glp_intopt: pp_tech = "+a.ed+"; invalid parameter"),0>a.ce&&r("glp_intopt: mip_gap = "+a.ce+"; invalid parameter"),a.Ed!=vs&&a.Ed!=bs&&r("glp_intopt: mir_cuts = "+a.Ed+"; invalid parameter"),a.Ad!=vs&&a.Ad!=bs&&r("glp_intopt: gmi_cuts = "+a.Ad+"; invalid parameter"),a.xd!=vs&&a.xd!=bs&&r("glp_intopt: cov_cuts = "+a.xd+"; invalid parameter"),a.vd!=vs&&a.vd!=bs&&r("glp_intopt: clq_cuts = "+a.vd+"; invalid parameter"),a.yc!=vs&&a.yc!=bs&&r("glp_intopt: presolve = "+a.yc+"; invalid parameter"),a.sd!=vs&&a.sd!=bs&&r("glp_intopt: binarize = "+a.sd+"; invalid parameter"),a.Xe!=vs&&a.Xe!=bs&&r("glp_intopt: fp_heur = "+a.Xe+"; invalid parameter"),e.za=Sl,e.ta=0,i=1;i<=e.g;i++)if(o=e.n[i],o.type==vl&&o.c>=o.d)return a.o>=Rl&&t("glp_intopt: row "+i+": lb = "+o.c+", ub = "+o.d+"; incorrect bounds"),i=Ss
for(i=1;i<=e.i;i++)if(o=e.f[i],o.type==vl&&o.c>=o.d)return a.o>=Rl&&t("glp_intopt: column "+i+": lb = "+o.c+", ub = "+o.d+"; incorrect bounds"),i=Ss
for(i=1;i<=e.i;i++)if(o=e.f[i],o.kind==fl){if((o.type==ml||o.type==vl)&&o.c!=Math.floor(o.c))return a.o>=Rl&&t("glp_intopt: integer column "+i+" has non-integer lower bound "+o.c),i=Ss
if((o.type==pl||o.type==vl)&&o.d!=Math.floor(o.d))return a.o>=Rl&&t("glp_intopt: integer column "+i+" has non-integer upper bound "+o.d),i=Ss
if(o.type==bl&&o.c!=Math.floor(o.c))return a.o>=Rl&&t("glp_intopt: integer column "+i+" has non-integer fixed value "+o.c),i=Ss}return a.o>=Gl&&(i=wo(e),o=Mo(e),t("GLPK Integer Optimizer, v"+vi()),t(e.g+" row"+(1==e.g?"":"s")+", "+e.i+" column"+(1==e.i?"":"s")+", "+e.L+" non-zero"+(1==e.L?"":"s")),t(i+" integer variable"+(1==i?"":"s")+", "+(0==o?"none of":1==i&&1==o?"":1==o?"one of":o==i?"all of":o+" of")+" which "+(1==o?"is":"are")+" binary")),i=a.yc?function(e,r){function a(){return _n(i,c),c=null,kn(i,e),o}var i,o,l=pi,s=l.Fb,c=null,u={}
if(r.o>=Gl&&t("Preprocessing..."),i=ln(),wn(i,e,Il),l.Fb=!s||r.o<Gl?bs:vs,o=ei(i,r),l.Fb=s,0!=o&&(o==Bs?r.o>=Gl&&t("PROBLEM HAS NO PRIMAL FEASIBLE SOLUTION"):o==zs&&r.o>=Gl&&t("LP RELAXATION HAS NO DUAL FEASIBLE SOLUTION")),0!=o)return o
if(c=bi(),Mn(i,c),0==c.g&&0==c.i)return c.za=El,c.ta=c.ha,r.o>=Gl&&(t("Objective value = "+c.ta),t("INTEGER OPTIMAL SOLUTION FOUND BY MIP PREPROCESSOR")),a()
if(r.o>=Gl){var f=wo(c),d=Mo(c)
t(c.g+" row"+(1==c.g?"":"s")+", "+c.i+" column"+(1==c.i?"":"s")+", "+c.L+" non-zero"+(1==c.L?"":"s")),t(f+" integer variable"+(1==f?"":"s")+", "+(0==d?"none of":1==f&&1==d?"":1==d?"one of":d==f?"all of":d+" of")+" which "+(1==d?"is":"are")+" binary")}return Po(e,u),Vo(c,u),l.Fb=!s||r.o<Gl?bs:vs,Vh(c,_l|kl|Al|Ll),l.Fb=s,l.Fb=!s||r.o<Gl?bs:vs,I(c),l.Fb=s,r.o>=Gl&&t("Solving LP relaxation..."),l=new lo,l.o=r.o,c.$=e.$,o=oo(c,l),e.$=c.$,0!=o?(r.o>=Rl&&t("glp_intopt: cannot solve LP relaxation"),o=js):(o=so(c),o==El?o=0:o==Xl?o=Bs:o==Fl&&(o=zs),0!=o?o:(c.$=e.$,o=n(c,r),e.$=c.$,c.za!=El&&c.za!=jl?(e.za=c.za,o):a()))}(e,a):n(e,a)}
var _o=e.IOCP=function(e){e=e||{},this.o=e.msg_lev||Gl,this.Jb=e.br_tech||rs,this.kc=e.bt_tech||is,this.Ub=e.tol_int||1e-5,this.we=e.tol_obj||1e-7,this.sb=e.tm_lim||2147483647,this.bc=e.out_frq||5e3,this.fb=e.out_dly||1e4,this.ob=e.cb_func||null,this.Uc=e.cb_info||null,this.Me=e.cb_size||0,this.ed=e.pp_tech||cs,this.ce=e.mip_gap||0,this.Ed=e.mir_cuts||bs,this.Ad=e.gmi_cuts||bs,this.xd=e.cov_cuts||bs,this.vd=e.clq_cuts||bs,this.yc=e.presolve||bs,this.sd=e.binarize||bs,this.Xe=e.fp_heur||bs}
e.glp_mip_status=function(e){return e.za},e.glp_mip_obj_val=function(e){return e.ta}
var ko=e.glp_mip_row_val=function(e,t){return 1<=t&&t<=e.g||r("glp_mip_row_val: i = "+t+"; row number out of range"),e.n[t].Sa},Ao=e.glp_mip_col_val=function(e,t){return 1<=t&&t<=e.i||r("glp_mip_col_val: j = "+t+"; column number out of range"),e.f[t].Sa},Lo=e.glp_bf_exists=function(e){return 0==e.g||e.valid},Co=e.glp_factorize=function(e){function r(e,r,t,a){var n,i=e.g
if((n=e.head[r])<=i)r=1,t[1]=n,a[1]=1
else for(r=0,e=e.f[n-i].k;null!=e;e=e.I)r++,t[r]=e.n.ea,a[r]=-e.n.ma*e.j*e.f.va
return r}var t,a,n,i=e.g,o=e.i,l=e.n,s=e.f,c=e.head
for(t=e.valid=0,a=1;a<=i+o;a++)if(a<=i?(n=l[a].m,l[a].bind=0):(n=s[a-i].m,s[a-i].bind=0),n==gl){if(++t>i)return e=Ps
c[t]=a,a<=i?l[a].bind=t:s[a-i].bind=t}if(t<i)return e=Ps
if(0<i){switch(null==e.U&&(e.U={valid:0,type:Bl,gb:null,Za:null,Cd:0,cc:.1,xc:4,gc:1,Mb:1e-15,sc:1e10,$c:100,ic:1e-6,vc:100,kd:1e3,Ch:-1,hg:0},v(e)),k(e.U,i,r,e)){case Do:return e=Vs
case Go:return e=Is}e.valid=1}return 0}
e.glp_bf_updated=function(e){return 0==e.g||e.valid||r("glp_bf_update: basis factorization does not exist"),0==e.g?0:e.U.hg}
var Po=e.glp_get_bfcp=function(e,r){var t=e.Qd
null==t?(r.type=Bl,r.Cd=0,r.cc=.1,r.xc=4,r.gc=vs,r.Mb=1e-15,r.sc=1e10,r.$c=100,r.ic=1e-6,r.vc=100,r.kd=0):a(r,t)},Vo=e.glp_set_bfcp=function(e,t){var n=e.Qd
null==t?null!=n&&(e.Qd=null):(null==n&&(n=e.Qd={}),a(n,t),n.type!=Bl&&n.type!=zl&&n.type!=Tl&&r("glp_set_bfcp: type = "+n.type+"; invalid parameter"),0>n.Cd&&r("glp_set_bfcp: lu_size = "+n.Cd+"; invalid parameter"),0<n.cc&&1>n.cc||r("glp_set_bfcp: piv_tol = "+n.cc+"; invalid parameter"),1>n.xc&&r("glp_set_bfcp: piv_lim = "+n.xc+"; invalid parameter"),n.gc!=vs&&n.gc!=bs&&r("glp_set_bfcp: suhl = "+n.gc+"; invalid parameter"),0<=n.Mb&&1e-6>=n.Mb||r("glp_set_bfcp: eps_tol = "+n.Mb+"; invalid parameter"),1>n.sc&&r("glp_set_bfcp: max_gro = "+n.sc+"; invalid parameter"),1<=n.$c&&32767>=n.$c||r("glp_set_bfcp: nfs_max = "+n.$c+"; invalid parameter"),0<n.ic&&1>n.ic||r("glp_set_bfcp: upd_tol = "+n.ic+"; invalid parameter"),1<=n.vc&&32767>=n.vc||r("glp_set_bfcp: nrs_max = "+n.vc+"; invalid parameter"),0>n.kd&&r("glp_set_bfcp: rs_size = "+n.vc+"; invalid parameter"),0==n.kd&&(n.kd=20*n.vc)),null!=e.U&&v(e)},Io=e.glp_get_bhead=function(e,t){return 0==e.g||e.valid||r("glp_get_bhead: basis factorization does not exist"),1<=t&&t<=e.g||r("glp_get_bhead: k = "+t+"; index out of range"),e.head[t]},So=e.glp_get_row_bind=function(e,t){return 0==e.g||e.valid||r("glp_get_row_bind: basis factorization does not exist"),1<=t&&t<=e.g||r("glp_get_row_bind: i = "+t+"; row number out of range"),e.n[t].bind},jo=e.glp_get_col_bind=function(e,t){return 0==e.g||e.valid||r("glp_get_col_bind: basis factorization does not exist"),1<=t&&t<=e.i||r("glp_get_col_bind: j = "+t+"; column number out of range"),e.f[t].bind},Oo=e.glp_ftran=function(e,t){var a,n,i=e.g,o=e.n,l=e.f
for(0==i||e.valid||r("glp_ftran: basis factorization does not exist"),a=1;a<=i;a++)t[a]*=o[a].ma
for(0<i&&A(e.U,t),a=1;a<=i;a++)n=e.head[a],t[a]=n<=i?t[a]/o[n].ma:t[a]*l[n-i].va},Xo=e.glp_btran=function(e,t){var a,n,i=e.g,o=e.n,l=e.f
for(0==i||e.valid||r("glp_btran: basis factorization does not exist"),a=1;a<=i;a++)n=e.head[a],t[a]=n<=i?t[a]/o[n].ma:t[a]*l[n-i].va
for(0<i&&L(e.U,t),a=1;a<=i;a++)t[a]*=o[a].ma}
e.glp_warm_up=function(e){var r,t,a,n,i
for(e.na=e.sa=Sl,e.aa=0,e.some=0,a=1;a<=e.g;a++)r=e.n[a],r.r=r.J=0
for(a=1;a<=e.i;a++)r=e.f[a],r.r=r.J=0
if(!Lo(e)&&0!=(n=Co(e)))return n
for(n=new Float64Array(1+e.g),a=1;a<=e.g;a++)r=e.n[a],r.m!=gl&&(r.m==xl?r.r=r.c:r.m==yl?r.r=r.d:r.m==wl?r.r=0:r.m==Ml&&(r.r=r.c),n[a]-=r.r)
for(a=1;a<=e.i;a++)if(r=e.f[a],r.m!=gl&&(r.m==xl?r.r=r.c:r.m==yl?r.r=r.d:r.m==wl?r.r=0:r.m==Ml&&(r.r=r.c),0!=r.r))for(t=r.k;null!=t;t=t.I)n[t.n.ea]+=t.j*r.r
for(Oo(e,n),e.na=jl,a=1;a<=e.g;a++)r=e.n[a],r.m==gl&&(r.r=n[r.bind],t=r.type,t!=ml&&t!=vl&&t!=bl||(i=1e-6+1e-9*Math.abs(r.c),r.r<r.c-i&&(e.na=Ol)),t!=pl&&t!=vl&&t!=bl||(i=1e-6+1e-9*Math.abs(r.d),r.r>r.d+i&&(e.na=Ol)))
for(a=1;a<=e.i;a++)r=e.f[a],r.m==gl&&(r.r=n[r.bind],t=r.type,t!=ml&&t!=vl&&t!=bl||(i=1e-6+1e-9*Math.abs(r.c),r.r<r.c-i&&(e.na=Ol)),t!=pl&&t!=vl&&t!=bl||(i=1e-6+1e-9*Math.abs(r.d),r.r>r.d+i&&(e.na=Ol)))
for(e.aa=e.ha,a=1;a<=e.i;a++)r=e.f[a],e.aa+=r.u*r.r
for(a=1;a<=e.g;a++)n[a]=0
for(a=1;a<=e.i;a++)r=e.f[a],r.m==gl&&(n[r.bind]=r.u)
for(Xo(e,n),e.sa=jl,a=1;a<=e.g;a++)r=e.n[a],r.m==gl?r.J=0:(r.J=-n[a],t=r.m,r=e.dir==sl?+r.J:-r.J,((t==wl||t==xl)&&-1e-5>r||(t==wl||t==yl)&&1e-5<r)&&(e.sa=Ol))
for(a=1;a<=e.i;a++)if(r=e.f[a],r.m==gl)r.J=0
else{for(r.J=r.u,t=r.k;null!=t;t=t.I)r.J+=t.j*n[t.n.ea]
t=r.m,r=e.dir==sl?+r.J:-r.J,((t==wl||t==xl)&&-1e-5>r||(t==wl||t==yl)&&1e-5<r)&&(e.sa=Ol)}return 0}
var Eo=e.glp_eval_tab_row=function(e,t,a,n){var i,o,l,s,c,u,f,d=e.g,h=e.i
for(0==d||e.valid||r("glp_eval_tab_row: basis factorization does not exist"),1<=t&&t<=d+h||r("glp_eval_tab_row: k = "+t+"; variable number out of range"),i=t<=d?So(e,t):jo(e,t-d),0==i&&r("glp_eval_tab_row: k = "+t+"; variable must be basic"),u=new Float64Array(1+d),s=new Int32Array(1+d),f=new Float64Array(1+d),u[i]=1,Xo(e,u),o=0,t=1;t<=d+h;t++){if(t<=d){if(ho(e,t)==gl)continue
c=-u[t]}else{if(vo(e,t-d)==gl)continue
for(l=Hi(e,t-d,s,f),c=0,i=1;i<=l;i++)c+=u[s[i]]*f[i]}0!=c&&(o++,a[o]=t,n[o]=c)}return o},Fo=e.glp_eval_tab_col=function(e,t,a,n){var i,o=e.g,l=e.i
if(0==o||e.valid||r("glp_eval_tab_col: basis factorization does not exist"),1<=t&&t<=o+l||r("glp_eval_tab_col: k = "+t+"; variable number out of range"),(t<=o?ho(e,t):vo(e,t-o))==gl&&r("glp_eval_tab_col: k = "+t+"; variable must be non-basic"),l=new Float64Array(1+o),t<=o)l[t]=-1
else for(i=Hi(e,t-o,a,n),t=1;t<=i;t++)l[a[t]]=n[t]
for(Oo(e,l),i=0,t=1;t<=o;t++)0!=l[t]&&(i++,a[i]=Io(e,t),n[i]=l[t])
return i},Bo=e.glp_transform_row=function(e,t,a,n){var i,o,l,s,c,u,f,d,h,m
for(Lo(e)||r("glp_transform_row: basis factorization does not exist "),o=Fi(e),l=Bi(e),d=new Float64Array(1+l),0<=t&&t<=l||r("glp_transform_row: len = "+t+"; invalid row length"),s=1;s<=t;s++)i=a[s],1<=i&&i<=l||r("glp_transform_row: ind["+s+"] = "+i+"; column index out of range"),0==n[s]&&r("glp_transform_row: val["+s+"] = 0; zero coefficient not allowed"),0!=d[i]&&r("glp_transform_row: ind["+s+"] = "+i+"; duplicate column indices not allowed"),d[i]=n[s]
for(h=new Float64Array(1+o),i=1;i<=o;i++)t=Io(e,i),h[i]=t<=o?0:d[t-o]
for(Xo(e,h),t=0,i=1;i<=o;i++)ho(e,i)!=gl&&0!=(f=-h[i])&&(t++,a[t]=i,n[t]=f)
for(u=new Int32Array(1+o),m=new Float64Array(1+o),i=1;i<=l;i++)if(vo(e,i)!=gl){for(f=d[i],c=Hi(e,i,u,m),s=1;s<=c;s++)f+=m[s]*h[u[s]]
0!=f&&(t++,a[t]=o+i,n[t]=f)}return t}
e.glp_transform_col=function(e,t,a,n){var i,o,l,s
for(Lo(e)||r("glp_transform_col: basis factorization does not exist "),o=Fi(e),s=new Float64Array(1+o),0<=t&&t<=o||r("glp_transform_col: len = "+t+"; invalid column length"),l=1;l<=t;l++)i=a[l],1<=i&&i<=o||r("glp_transform_col: ind["+l+"] = "+i+"; row index out of range"),0==n[l]&&r("glp_transform_col: val["+l+"] = 0; zero coefficient not allowed"),0!=s[i]&&r("glp_transform_col: ind["+l+"] = "+i+"; duplicate row indices not allowed"),s[i]=n[l]
for(Oo(e,s),t=0,i=1;i<=o;i++)0!=s[i]&&(t++,a[t]=Io(e,i),n[t]=s[i])
return t}
var zo=e.glp_prim_rtest=function(e,t,a,n,i,o){var l,s,c,u,f,d,h,m,p,v,b,g,x
for(co(e)!=jl&&r("glp_prim_rtest: basic solution is not primal feasible "),1!=i&&-1!=i&&r("glp_prim_rtest: dir = "+i+"; invalid parameter"),0<o&&1>o||r("glp_prim_rtest: eps = "+o+"; invalid parameter"),s=Fi(e),c=Bi(e),u=0,x=hi,m=0,f=1;f<=t;f++)if(l=a[f],1<=l&&l<=s+c||r("glp_prim_rtest: ind["+f+"] = "+l+"; variable number out of range"),l<=s?(d=Ni(e,l),v=Ri(e,l),b=Di(e,l),h=ho(e,l),p=mo(e,l)):(d=Gi(e,l-s),v=qi(e,l-s),b=Yi(e,l-s),h=vo(e,l-s),p=bo(e,l-s)),h!=gl&&r("glp_prim_rtest: ind["+f+"] = "+l+"; non-basic variable not allowed"),l=0<i?+n[f]:-n[f],d!=hl){if(d==ml){if(l>-o)continue
g=(v-p)/l}else if(d==pl){if(l<+o)continue
g=(b-p)/l}else if(d==vl)if(0>l){if(l>-o)continue
g=(v-p)/l}else{if(l<+o)continue
g=(b-p)/l}else if(d==bl){if(-o<l&&l<+o)continue
g=0}0>g&&(g=0),(x>g||x==g&&m<Math.abs(l))&&(u=f,x=g,m=Math.abs(l))}return u},To=e.glp_dual_rtest=function(e,t,a,n,i,o){var l,s,c,u,f,d,h,m,p,v,b
for(uo(e)!=jl&&r("glp_dual_rtest: basic solution is not dual feasible"),1!=i&&-1!=i&&r("glp_dual_rtest: dir = "+i+"; invalid parameter"),0<o&&1>o||r("glp_dual_rtest: eps = "+o+"; invalid parameter"),s=Fi(e),c=Bi(e),p=Ei(e)==sl?1:-1,u=0,b=hi,h=0,f=1;f<=t;f++){if(l=a[f],1<=l&&l<=s+c||r("glp_dual_rtest: ind["+f+"] = "+l+"; variable number out of range"),l<=s?(d=ho(e,l),m=po(e,l)):(d=vo(e,l-s),m=go(e,l-s)),d==gl&&r("glp_dual_rtest: ind["+f+"] = "+l+"; basic variable not allowed"),l=0<i?+n[f]:-n[f],d==xl){if(l<+o)continue
v=p*m/l}else if(d==yl){if(l>-o)continue
v=p*m/l}else if(d==wl){if(-o<l&&l<+o)continue
v=0}else if(d==Ml)continue
0>v&&(v=0),(b>v||b==v&&h<Math.abs(l))&&(u=f,b=v,h=Math.abs(l))}return u}
e.glp_analyze_bound=function(e,t,a){var n,i,o,l,s,c,u,f,d,h,m,p,v,b
for(m=p=v=b=null,null!=e&&3621377730==e.Dd||r("glp_analyze_bound: P = "+e+"; invalid problem object"),i=e.g,o=e.i,e.na==jl&&e.sa==jl||r("glp_analyze_bound: optimal basic solution required"),0==i||e.valid||r("glp_analyze_bound: basis factorization required"),1<=t&&t<=i+o||r("glp_analyze_bound: k = "+t+"; variable number out of range"),n=t<=i?e.n[t]:e.f[t-i],l=n.m,o=n.r,l==gl&&r("glp_analyze_bound: k = "+t+"; basic variable not allowed "),l=new Int32Array(1+i),h=new Float64Array(1+i),c=Fo(e,t,l,h),t=-1;1>=t;t+=2)u=zo(e,c,l,h,t,1e-9),0==u?(s=0,u=0>t?-hi:+hi):(s=l[u],s<=i?(n=e.n[s],f=Ri(e,n.ea),d=Di(e,n.ea)):(n=e.f[s-i],f=qi(e,n.C),d=Yi(e,n.C)),n=n.r,n=0>t&&0<h[u]||0<t&&0>h[u]?f-n:d-n,u=o+n/h[u]),0>t?(m=u,p=s):(v=u,b=s)
a(m,p,v,b)},e.glp_analyze_coef=function(e,t,a){var n,i,o,l,s,c,u,f,d,h,m,p,v,b,g,x,y,w,M,_,k=null,A=null,L=null,C=null,P=null,V=null
for(null!=e&&3621377730==e.Dd||r("glp_analyze_coef: P = "+e+"; invalid problem object"),i=e.g,o=e.i,e.na==jl&&e.sa==jl||r("glp_analyze_coef: optimal basic solution required"),0==i||e.valid||r("glp_analyze_coef: basis factorization required"),1<=t&&t<=i+o||r("glp_analyze_coef: k = "+t+"; variable number out of range"),t<=i?(n=e.n[t],l=n.type,p=n.c,v=n.d,b=0):(n=e.f[t-i],l=n.type,p=n.c,v=n.d,b=n.u),s=n.m,g=n.r,s!=gl&&r("glp_analyze_coef: k = "+t+"; non-basic variable not allowed"),s=new Int32Array(1+i),_=new Float64Array(1+i),m=new Int32Array(1+o),M=new Float64Array(1+o),d=Eo(e,t,m,M),o=-1;1>=o;o+=2)e.dir==sl?u=-o:e.dir==cl&&(u=+o),h=To(e,d,m,M,u,1e-9),0==h?(x=0>o?-hi:+hi,c=0,h=g):(c=m[h],n=c<=i?e.n[c]:e.f[c-i],u=n.J,n=-u/M[h],x=b+n,u=0>o&&0<M[h]||0<o&&0>M[h]?1:-1,e.dir==cl&&(u=-u),f=Fo(e,c,s,_),n=t<=i?e.n[t]:e.f[t-i],n.type=hl,n.c=n.d=0,f=zo(e,f,s,_,u,1e-9),n=t<=i?e.n[t]:e.f[t-i],n.type=l,n.c=p,n.d=v,0==f?h=0>u&&0<M[h]||0<u&&0>M[h]?-hi:+hi:(n=s[f],n<=i?(n=e.n[n],y=Ri(e,n.ea),w=Di(e,n.ea)):(n=e.f[n-i],y=qi(e,n.C),w=Yi(e,n.C)),n=n.r,n=0>u&&0<_[f]||0<u&&0>_[f]?y-n:w-n,h=g+M[h]/_[f]*n)),0>o?(k=x,A=c,L=h):(C=x,P=c,V=h)
a(k,A,L,C,P,V)},e.glp_ios_reason=function(e){return e.reason},e.glp_ios_get_prob=function(e){return e.A},e.glp_mpl_alloc_wksp=function(){return eh()},e._glp_mpl_init_rand=function(e,t){0!=e.D&&r("glp_mpl_init_rand: invalid call sequence\n"),ai(e.Gd,t)}
var No=e.glp_mpl_read_model=function(e,t,a,n){return 0!=e.D&&r("glp_mpl_read_model: invalid call sequence"),e=rh(e,t,a,n),1==e||2==e?e=0:4==e&&(e=1),e}
e.glp_mpl_read_model_from_string=function(e,r,t,a){var n=0
return No(e,r,function(){return n<t.length?t[n++]:-1},a)}
var Ro=e.glp_mpl_read_data=function(e,t,a){return 1!=e.D&&2!=e.D&&r("glp_mpl_read_data: invalid call sequence"),e=th(e,t,a),2==e?e=0:4==e&&(e=1),e}
e.glp_mpl_read_data_from_string=function(e,r,t){var a=0
return Ro(e,r,function(){return a<t.length?t[a++]:-1})},e.glp_mpl_generate=function(e,t,a,n){return 1!=e.D&&2!=e.D&&r("glp_mpl_generate: invalid call sequence\n"),e=ah(e,t,a,n),3==e?e=0:4==e&&(e=1),e},e.glp_mpl_build_prob=function(e,a){var n,i,o,l,s,c,u
for(3!=e.D&&r("glp_mpl_build_prob: invalid call sequence\n"),Oi(a),gi(a,nh(e)),n=ih(e),0<n&&wi(a,n),i=1;i<=n;i++){switch(_i(a,i,lh(e,i)),s=ch(e,i,function(e,r){c=e,u=r})){case Fd:s=hl
break
case Bd:s=ml
break
case zd:s=pl
break
case Td:s=vl
break
case Nd:s=bl}s==vl&&Math.abs(c-u)<1e-9*(1+Math.abs(c))&&(s=bl,Math.abs(c)<=Math.abs(u)?u=c:c=u),Ai(a,i,s,c,u),0!=fh(e,i)&&t("glp_mpl_build_prob: row "+lh(e,i)+"; constant term "+fh(e,i)+" ignored")}for(i=oh(e),0<i&&Mi(a,i),o=1;o<=i;o++){switch(ki(a,o,dh(e,o)),l=hh(e,o)){case Gd:case qd:xo(a,o,fl)}switch(s=mh(e,o,function(e,r){c=e,u=r})){case Fd:s=hl
break
case Bd:s=ml
break
case zd:s=pl
break
case Td:s=vl
break
case Nd:s=bl}l==qd&&((s==hl||s==pl||0>c)&&(c=0),(s==hl||s==ml||1<u)&&(u=1),s=vl),s==vl&&Math.abs(c-u)<1e-9*(1+Math.abs(c))&&(s=bl,Math.abs(c)<=Math.abs(u)?u=c:c=u),Li(a,o,s,c,u)}for(s=new Int32Array(1+i),o=new Float64Array(1+i),i=1;i<=n;i++)l=uh(e,i,s,o),Pi(a,i,l,s,o)
for(i=1;i<=n;i++)if((l=sh(e,i))==Rd||l==Dd){for(xi(a,lh(e,i)),yi(a,l==Rd?sl:cl),Ci(a,0,fh(e,i)),l=uh(e,i,s,o),n=1;n<=l;n++)Ci(a,s[n],o[n])
break}},e.glp_mpl_postsolve=function(e,t,a){var n,i,o,l,s,c
if((3!=e.D||e.Of)&&r("glp_mpl_postsolve: invalid call sequence"),a!=Pl&&a!=Vl&&a!=Il&&r("glp_mpl_postsolve: sol = "+a+"; invalid parameter"),i=ih(e),o=oh(e),i==Fi(t)&&o==Bi(t)||r("glp_mpl_postsolve: wrong problem object\n"),!ph(e))return 0
for(n=1;n<=i;n++)a==Pl?(l=ho(t,n),s=mo(t,n),c=po(t,n)):a==Vl?(l=0,s=glp_ipt_row_prim(t,n),c=glp_ipt_row_dual(t,n)):a==Il&&(l=0,s=ko(t,n),c=0),1e-9>Math.abs(s)&&(s=0),1e-9>Math.abs(c)&&(c=0),vh(e,n,l,s,c)
for(n=1;n<=o;n++)a==Pl?(l=vo(t,n),s=bo(t,n),c=go(t,n)):a==Vl?(l=0,s=glp_ipt_col_prim(t,n),c=glp_ipt_col_dual(t,n)):a==Il&&(l=0,s=Ao(t,n),c=0),1e-9>Math.abs(s)&&(s=0),1e-9>Math.abs(c)&&(c=0),bh(e,n,l,s,c)
return e=gh(e),3==e?e=0:4==e&&(e=1),e}
var Do=1,Go=2,qo=3,Yo=4,Uo=5,Ho="!\"#$%&()/,.;?@_`'{}|~",Ko=e.glp_read_lp=function(e,r,a){function o(e,r){throw Error(e.count+": "+r)}function l(e,r){t(e.count+": warning: "+r)}function s(e){var r
"\n"==e.l&&e.count++,r=e.Qg(),0>r?"\n"==e.l?(e.count--,r=-1):(l(e,"missing final end of line"),r="\n"):"\n"!=r&&(0<=" \t\n\v\f\r".indexOf(r)?r=" ":u(r)&&o(e,"invalid control character "+r.charCodeAt(0))),e.l=r}function c(e){e.h+=e.l,s(e)}function m(e,r){return e.toLowerCase()==r.toLowerCase()?1:0}function p(e){function r(){for(e.b=V;d(e.l)||0<=Ho.indexOf(e.l);)c(e)
t&&(m(e.h,"minimize")?e.b=w:m(e.h,"minimum")?e.b=w:m(e.h,"min")?e.b=w:m(e.h,"maximize")?e.b=M:m(e.h,"maximum")?e.b=M:m(e.h,"max")?e.b=M:m(e.h,"subject")?" "==e.l&&(s(e),"t"==e.l.toLowerCase()&&(e.b=_,e.h+=" ",c(e),"o"!=e.l.toLowerCase()&&o(e,"keyword `subject to' incomplete"),c(e),f(e.l)&&o(e,"keyword `"+e.h+e.l+"...' not recognized"))):m(e.h,"such")?" "==e.l&&(s(e),"t"==e.l.toLowerCase()&&(e.b=_,e.h+=" ",c(e),"h"!=e.l.toLowerCase()&&o(e,"keyword `such that' incomplete"),c(e),"a"!=e.l.toLowerCase()&&o(e,"keyword `such that' incomplete"),c(e),"t"!=e.l.toLowerCase()&&o(e,"keyword `such that' incomplete"),c(e),f(e.l)&&o(e,"keyword `"+e.h+e.l+"...' not recognized"))):m(e.h,"st")?e.b=_:m(e.h,"s.t.")?e.b=_:m(e.h,"st.")?e.b=_:m(e.h,"bounds")?e.b=k:m(e.h,"bound")?e.b=k:m(e.h,"general")?e.b=A:m(e.h,"generals")?e.b=A:m(e.h,"gen")?e.b=A:m(e.h,"integer")?e.b=L:m(e.h,"integers")?e.b=L:m(e.h,"int")?e.b=L:m(e.h,"binary")?e.b=C:m(e.h,"binaries")?e.b=C:m(e.h,"bin")?e.b=C:m(e.h,"end")&&(e.b=P))}var t
for(e.b=-1,e.h="",e.value=0;;){for(t=0;" "==e.l;)s(e)
if(-1==e.l)e.b=y
else if("\n"==e.l){if(s(e),!f(e.l))continue
t=1,r()}else{if("\\"==e.l){for(;"\n"!=e.l;)s(e)
continue}if(f(e.l)||"."!=e.l&&0<=Ho.indexOf(e.l))r()
else if(h(e.l)||"."==e.l){for(e.b=I;h(e.l);)c(e)
if("."==e.l)for(c(e),1!=e.h.length||h(e.l)||o(e,"invalid use of decimal point");h(e.l);)c(e)
if("e"==e.l||"E"==e.l)for(c(e),"+"!=e.l&&"-"!=e.l||c(e),h(e.l)||o(e,"numeric constant `"+e.h+"' incomplete");h(e.l);)c(e)
e.value=Number(e.h),e.value==Number.NaN&&o(e,"numeric constant `"+e.h+"' out of range")}else"+"==e.l?(e.b=S,c(e)):"-"==e.l?(e.b=j,c(e)):":"==e.l?(e.b=O,c(e)):"<"==e.l?(e.b=X,c(e),"="==e.l&&c(e)):">"==e.l?(e.b=E,c(e),"="==e.l&&c(e)):"="==e.l?(e.b=F,c(e),"<"==e.l?(e.b=X,c(e)):">"==e.l&&(e.b=E,c(e))):o(e,"character `"+e.l+"' not recognized")}break}for(;" "==e.l;)s(e)}function v(e,r){var t=Zi(e.Ka,r)
if(0==t){if(t=Mi(e.Ka,1),ki(e.Ka,t,r),e.K<t){var a=e.K,o=e.Z,l=e.j,s=e.ba,c=e.c,u=e.d
e.K+=e.K,e.Z=new Int32Array(1+e.K),n(e.Z,1,o,1,a),e.j=new Float64Array(1+e.K),n(e.j,1,l,1,a),e.ba=new Int8Array(1+e.K),i(e.ba,1,0,e.K),n(e.ba,1,s,1,a),e.c=new Float64Array(1+e.K),n(e.c,1,c,1,a),e.d=new Float64Array(1+e.K),n(e.d,1,u,1,a)}e.c[t]=+hi,e.d[t]=-hi}return t}function b(e){for(var r,t,a,n,i=0;;)if(e.b==S?(a=1,p(e)):e.b==j?(a=-1,p(e)):a=1,e.b==I?(n=e.value,p(e)):n=1,e.b!=V&&o(e,"missing variable name"),r=v(e,e.h),e.ba[r]&&o(e,"multiple use of variable `"+e.h+"' not allowed"),i++,e.Z[i]=r,e.j[i]=a*n,e.ba[r]=1,p(e),e.b!=S&&e.b!=j){for(r=1;r<=i;r++)e.ba[e.Z[r]]=0
for(t=0,r=1;r<=i;r++)0!=e.j[r]&&(t++,e.Z[t]=e.Z[r],e.j[t]=e.j[r])
break}return t}function g(e,r,t){e.c[r]!=+hi&&l(e,"lower bound of variable `"+Ti(e.Ka,r)+"' redefined"),e.c[r]=t}function x(e,r,t){e.d[r]!=-hi&&l(e,"upper bound of variable `"+Ti(e.Ka,r)+"' redefined"),e.d[r]=t}var y=0,w=1,M=2,_=3,k=4,A=5,L=6,C=7,P=8,V=9,I=10,S=11,j=12,O=13,X=14,E=15,F=16,B={}
for(t("Reading problem data"),null==r&&(r={}),B.Ka=e,B.p=r,B.Qg=a,B.count=0,B.l="\n",B.b=y,B.h="",B.value=0,B.K=100,B.Z=new Int32Array(1+B.K),B.j=new Float64Array(1+B.K),B.ba=new Int8Array(1+B.K),i(B.ba,1,0,B.K),B.c=new Float64Array(1+B.K),B.d=new Float64Array(1+B.K),Oi(e),Ki(e),p(B),B.b!=w&&B.b!=M&&o(B,"`minimize' or `maximize' keyword missing"),function(e){var r,t
for(e.b==w?yi(e.Ka,sl):e.b==M&&yi(e.Ka,cl),p(e),e.b==V&&":"==e.l?(xi(e.Ka,e.h),p(e),p(e)):xi(e.Ka,"obj"),t=b(e),r=1;r<=t;r++)Ci(e.Ka,e.Z[r],e.j[r])}(B),B.b!=_&&o(B,"constraints section missing"),function(e){var r,t,a
for(p(e);r=wi(e.Ka,1),e.b==V&&":"==e.l?(0!=Wi(e.Ka,e.h)&&o(e,"constraint `"+e.h+"' multiply defined"),_i(e.Ka,r,e.h),p(e),p(e)):_i(e.Ka,r,"r."+e.count),t=b(e),Pi(e.Ka,r,t,e.Z,e.j),e.b==X?(a=pl,p(e)):e.b==E?(a=ml,p(e)):e.b==F?(a=bl,p(e)):o(e,"missing constraint sense"),e.b==S?(t=1,p(e)):e.b==j?(t=-1,p(e)):t=1,e.b!=I&&o(e,"missing right-hand side"),Ai(e.Ka,r,a,t*e.value,t*e.value),"\n"!=e.l&&-1!=e.l&&o(e,"invalid symbol(s) beyond right-hand side"),p(e),e.b==S||e.b==j||e.b==I||e.b==V;);}(B),B.b==k&&function(e){var r,t,a,n
for(p(e);e.b==S||e.b==j||e.b==I||e.b==V;)e.b==S||e.b==j?(t=1,n=e.b==S?1:-1,p(e),e.b==I?(a=n*e.value,p(e)):m(e.h,"infinity")||m(e.h,"inf")?(0<n&&o(e,"invalid use of `+inf' as lower bound"),a=-hi,p(e)):o(e,"missing lower bound")):e.b==I?(t=1,a=e.value,p(e)):t=0,t&&(e.b!=X&&o(e,"missing `<', `<=', or `=<' after lower bound"),p(e)),e.b!=V&&o(e,"missing variable name"),r=v(e,e.h),t&&g(e,r,a),p(e),e.b==X?(p(e),e.b==S||e.b==j?(n=e.b==S?1:-1,p(e),e.b==I?(x(e,r,n*e.value),p(e)):m(e.h,"infinity")||m(e.h,"inf")?(0>n&&o(e,"invalid use of `-inf' as upper bound"),x(e,r,+hi),p(e)):o(e,"missing upper bound")):e.b==I?(x(e,r,e.value),p(e)):o(e,"missing upper bound")):e.b==E?(t&&o(e,"invalid bound definition"),p(e),e.b==S||e.b==j?(n=e.b==S?1:-1,p(e),e.b==I?(g(e,r,n*e.value),p(e)):m(e.h,"infinity")||0==m(e.h,"inf")?(0<n&&o(e,"invalid use of `+inf' as lower bound"),g(e,r,-hi),p(e)):o(e,"missing lower bound")):e.b==I?(g(e,r,e.value),p(e)):o(e,"missing lower bound")):e.b==F?(t&&o(e,"invalid bound definition"),p(e),e.b==S||e.b==j?(n=e.b==S?1:-1,p(e),e.b==I?(g(e,r,n*e.value),x(e,r,n*e.value),p(e)):o(e,"missing fixed value")):e.b==I?(g(e,r,e.value),x(e,r,e.value),p(e)):o(e,"missing fixed value")):m(e.h,"free")?(t&&o(e,"invalid bound definition"),g(e,r,-hi),x(e,r,+hi),p(e)):t||o(e,"invalid bound definition")}(B);B.b==A||B.b==L||B.b==C;)!function(e){var r,t
for(e.b==A?(t=0,p(e)):e.b==L?(t=0,p(e)):e.b==C&&(t=1,p(e));e.b==V;)r=v(e,e.h),xo(e.Ka,r,fl),t&&(g(e,r,0),x(e,r,1)),p(e)}(B)
B.b==P?p(B):B.b==y?l(B,"keyword `end' missing"):o(B,"symbol "+B.h+" in wrong position"),B.b!=y&&o(B,"extra symbol(s) detected beyond `end'")
var z,T
for(r=1;r<=e.i;r++)z=B.c[r],T=B.d[r],z==+hi&&(z=0),T==-hi&&(T=+hi),a=z==-hi&&T==+hi?hl:T==+hi?ml:z==-hi?pl:z!=T?vl:bl,Li(B.Ka,r,a,z,T)
return t(e.g+" row"+(1==e.g?"":"s")+", "+e.i+" column"+(1==e.i?"":"s")+", "+e.L+" non-zero"+(1==e.L?"":"s")),0<wo(e)&&(r=wo(e),a=Mo(e),1==r?t(0==a?"One variable is integer":"One variable is binary"):(z=r+" integer variables, ",t((0==a?z+"none":1==a?z+"one":a==r?z+"all":z+a)+" of which "+(1==a?"is":"are")+" binary"))),t(B.count+" lines were read"),Ji(e),Ii(e),0}
e.glp_write_lp=function(e,r,a){function n(e){if("."==e[0]||h(e[0]))return 1
for(var r=0;r<e.length;r++)if(!d(e[r])&&0>Ho.indexOf(e[r]))return 1
return 0}function i(e){for(var r=0;r<e.length;r++)" "==e[r]?e[r]="_":"-"==e[r]?e[r]="~":"["==e[r]?e[r]="(":"]"==e[r]&&(e[r]=")")}function o(e,r){var t
return null==(t=0==r?Xi(e.Ka):zi(e.Ka,r))?0==r?"obj":"r_"+r:(i(t),n(t)?0==r?"obj":"r_"+r:t)}function l(e,r){var t=Ti(e.Ka,r)
return null==t?"x_"+r:(i(t),n(t)?"x_"+r:t)}function s(){return a("End"),p++,t(p+" lines were written"),0}var c,u,f,m,p,v,b={}
if(t("Writing problem data"),null==r&&(r={}),b.Ka=e,b.p=r,p=0,a("\\* Problem: "+(null==e.name?"Unknown":e.name)+" *\\"),p++,a(""),p++,!(0<e.g&&0<e.i))return t("Warning: problem has no rows/columns"),a("\\* WARNING: PROBLEM HAS NO ROWS/COLUMNS *\\"),p++,a(""),p++,s()
for(e.dir==sl?(a("Minimize"),p++):e.dir==cl&&(a("Maximize"),p++),r=o(b,0),v=" "+r+":",u=0,f=1;f<=e.i;f++)c=e.f[f],(0!=c.u||null==c.k)&&(u++,r=l(b,f),m=0==c.u?" + 0 "+r:1==c.u?" + "+r:-1==c.u?" - "+r:0<c.u?" + "+c.u+" "+r:" - "+-c.u+" "+r,72<v.length+m.length&&(a(v),v="",p++),v+=m)
for(0==u&&(m=" 0 "+l(b,1),v+=m),a(v),p++,0!=e.ha&&(a("\\* constant term = "+e.ha+" *\\"),p++),a(""),p++,a("Subject To"),p++,f=1;f<=e.g;f++)if(c=e.n[f],c.type!=hl){for(r=o(b,f),v=" "+r+":",u=c.k;null!=u;u=u.B)r=l(b,u.f.C),m=1==u.j?" + "+r:-1==u.j?" - "+r:0<u.j?" + "+u.j+" "+r:" - "+-u.j+" "+r,72<v.length+m.length&&(a(v),v="",p++),v+=m
c.type==vl?(m=" - ~r_"+f,72<v.length+m.length&&(a(v),v="",p++),v+=m):null==c.k&&(m=" 0 "+l(b,1),v+=m),c.type==ml?m=" >= "+c.c:c.type==pl?m=" <= "+c.d:c.type!=vl&&c.type!=bl||(m=" = "+c.c),72<v.length+m.length&&(a(v),v="",p++),v+=m,a(v),p++}for(a(""),p++,m=0,f=1;f<=e.g;f++)c=e.n[f],c.type==vl&&(m||(a("Bounds"),m=1,p++),a(" 0 <= ~r_"+f+" <= "+(c.d-c.c)),p++)
for(f=1;f<=e.i;f++)c=e.f[f],(c.type!=ml||0!=c.c)&&(m||(a("Bounds"),m=1,p++),r=l(b,f),c.type==hl?(a(" "+r+" free"),p++):c.type==ml?(a(" "+r+" >= "+c.c),p++):c.type==pl?(a(" -Inf <= "+r+" <= "+c.d),p++):c.type==vl?(a(" "+c.c+" <= "+r+" <= "+c.d),p++):c.type==bl&&(a(" "+r+" = "+c.c),p++))
for(m&&a(""),p++,m=0,f=1;f<=e.i;f++)c=e.f[f],c.kind!=ul&&(m||(a("Generals"),m=1,p++),a(" "+l(b,f)),p++)
return m&&(a(""),p++),s()},e.glp_read_lp_from_string=function(e,r,t){var a=0
return Ko(e,r,function(){return a<t.length?t[a++]:-1})}
var Wo=1,Zo=2,Jo=3,Qo=4,$o=5,el=e.glp_ios_relative_gap=function(e){var r,t=e.A
return t.za==jl?(t=t.ta,r=T(e),0==r?e=0:(e=e.ya[r].rb.bound,e=Math.abs(t-e)/(Math.abs(t)+2.220446049250313e-16))):e=hi,e},rl=0,tl=5,al=0,nl=1,il=2,ol=e.GLP_MAJOR_VERSION=4,ll=e.GLP_MINOR_VERSION=49,sl=e.GLP_MIN=1,cl=e.GLP_MAX=2,ul=e.GLP_CV=1,fl=e.GLP_IV=2,dl=e.GLP_BV=3,hl=e.GLP_FR=1,ml=e.GLP_LO=2,pl=e.GLP_UP=3,vl=e.GLP_DB=4,bl=e.GLP_FX=5,gl=e.GLP_BS=1,xl=e.GLP_NL=2,yl=e.GLP_NU=3,wl=e.GLP_NF=4,Ml=e.GLP_NS=5,_l=e.GLP_SF_GM=1,kl=e.GLP_SF_EQ=16,Al=e.GLP_SF_2N=32,Ll=e.GLP_SF_SKIP=64,Cl=e.GLP_SF_AUTO=128,Pl=e.GLP_SOL=1,Vl=e.GLP_IPT=2,Il=e.GLP_MIP=3,Sl=e.GLP_UNDEF=1,jl=e.GLP_FEAS=2,Ol=e.GLP_INFEAS=3,Xl=e.GLP_NOFEAS=4,El=e.GLP_OPT=5,Fl=e.GLP_UNBND=6,Bl=e.GLP_BF_FT=1,zl=e.GLP_BF_BG=2,Tl=e.GLP_BF_GR=3,Nl=e.GLP_MSG_OFF=0,Rl=e.GLP_MSG_ERR=1,Dl=e.GLP_MSG_ON=2,Gl=e.GLP_MSG_ALL=3,ql=e.GLP_MSG_DBG=4,Yl=e.GLP_PRIMAL=1,Ul=e.GLP_DUALP=2,Hl=e.GLP_DUAL=3,Kl=e.GLP_PT_STD=17,Wl=e.GLP_PT_PSE=34,Zl=e.GLP_RT_STD=17,Jl=e.GLP_RT_HAR=34
e.GLP_ORD_NONE=0,e.GLP_ORD_QMD=1,e.GLP_ORD_AMD=2,e.GLP_ORD_SYMAMD=3
var Ql=e.GLP_BR_FFV=1,$l=e.GLP_BR_LFV=2,es=e.GLP_BR_MFV=3,rs=e.GLP_BR_DTH=4,ts=e.GLP_BR_PCH=5,as=e.GLP_BT_DFS=1,ns=e.GLP_BT_BFS=2,is=e.GLP_BT_BLB=3,os=e.GLP_BT_BPH=4,ls=e.GLP_PP_NONE=0,ss=e.GLP_PP_ROOT=1,cs=e.GLP_PP_ALL=2
e.GLP_RF_REG=0
var us=e.GLP_RF_LAZY=1,fs=e.GLP_RF_CUT=2,ds=e.GLP_RF_GMI=1,hs=e.GLP_RF_MIR=2,ms=e.GLP_RF_COV=3,ps=e.GLP_RF_CLQ=4,vs=e.GLP_ON=1,bs=e.GLP_OFF=0,gs=e.GLP_IROWGEN=1,xs=e.GLP_IBINGO=2,ys=e.GLP_IHEUR=3,ws=e.GLP_ICUTGEN=4,Ms=e.GLP_IBRANCH=5,_s=e.GLP_ISELECT=6,ks=e.GLP_IPREPRO=7,As=e.GLP_NO_BRNCH=0,Ls=e.GLP_DN_BRNCH=1,Cs=e.GLP_UP_BRNCH=2,Ps=e.GLP_EBADB=1,Vs=e.GLP_ESING=2,Is=e.GLP_ECOND=3,Ss=e.GLP_EBOUND=4,js=e.GLP_EFAIL=5,Os=e.GLP_EOBJLL=6,Xs=e.GLP_EOBJUL=7,Es=e.GLP_EITLIM=8,Fs=e.GLP_ETMLIM=9,Bs=e.GLP_ENOPFS=10,zs=e.GLP_ENODFS=11,Ts=e.GLP_EROOT=12,Ns=e.GLP_ESTOP=13,Rs=e.GLP_EMIPGAP=14
e.GLP_ENOFEAS=15,e.GLP_ENOCVG=16,e.GLP_EINSTAB=17,e.GLP_EDATA=18,e.GLP_ERANGE=19,e.GLP_KKT_PE=1,e.GLP_KKT_PB=2,e.GLP_KKT_DE=3,e.GLP_KKT_DB=4,e.GLP_KKT_CS=5,e.GLP_MPS_DECK=1,e.GLP_MPS_FILE=2,e.GLP_ASN_MIN=1,e.GLP_ASN_MAX=2,e.GLP_ASN_MMP=3
var Ds=1
LPF_ECOND=2,LPF_ELIMIT=3
var Gs=0
if(Gs)var qs=function(e,r,a,n){var i=e.g
e=e.Cf
var o,l,s,c,u,f=0
for(o=1;o<=i;o++){for(s=0,l=u=1;l<=i;l++)c=r?e[i*(l-1)+o]*a[l]:e[i*(o-1)+l]*a[l],u<Math.abs(c)&&(u=Math.abs(c)),s+=c
l=Math.abs(s-n[o])/u,f<l&&(f=l)}1e-8<f&&t((r?"lpf_btran":"lpf_ftran")+": dmax = "+f+"; relative error too large")}
e.LPX_LP=100,e.LPX_MIP=101
var Ys=e.LPX_FR=110,Us=e.LPX_LO=111,Hs=e.LPX_UP=112,Ks=e.LPX_DB=113,Ws=e.LPX_FX=114
e.LPX_MIN=120,e.LPX_MAX=121,e.LPX_P_UNDEF=132,e.LPX_P_FEAS=133,e.LPX_P_INFEAS=134,e.LPX_P_NOFEAS=135,e.LPX_D_UNDEF=136,e.LPX_D_FEAS=137,e.LPX_D_INFEAS=138,e.LPX_D_NOFEAS=139
var Zs=e.LPX_BS=140,Js=e.LPX_NL=141,Qs=e.LPX_NU=142,$s=e.LPX_NF=143,ec=e.LPX_NS=144
e.LPX_T_UNDEF=150,e.LPX_T_OPT=151
var rc=e.LPX_CV=160,tc=e.LPX_IV=161
e.LPX_I_UNDEF=170,e.LPX_I_OPT=171,e.LPX_I_FEAS=172,e.LPX_I_NOFEAS=173,e.LPX_OPT=180,e.LPX_FEAS=181,e.LPX_INFEAS=182,e.LPX_NOFEAS=183,e.LPX_UNBND=184,e.LPX_UNDEF=185,e.LPX_E_OK=200,e.LPX_E_EMPTY=201,e.LPX_E_BADB=202,e.LPX_E_INFEAS=203,e.LPX_E_FAULT=204,e.LPX_E_OBJLL=205,e.LPX_E_OBJUL=206,e.LPX_E_ITLIM=207,e.LPX_E_TMLIM=208,e.LPX_E_NOFEAS=209,e.LPX_E_INSTAB=210,e.LPX_E_SING=211,e.LPX_E_NOCONV=212,e.LPX_E_NOPFS=213,e.LPX_E_NODFS=214,e.LPX_E_MIPGAP=215
var ac=e.LPX_K_MSGLEV=300,nc=e.LPX_K_SCALE=301,ic=e.LPX_K_DUAL=302,oc=e.LPX_K_PRICE=303
e.LPX_K_RELAX=304,e.LPX_K_TOLBND=305,e.LPX_K_TOLDJ=306,e.LPX_K_TOLPIV=307
var lc=e.LPX_K_ROUND=308
e.LPX_K_OBJLL=309,e.LPX_K_OBJUL=310
var sc=e.LPX_K_ITLIM=311,cc=e.LPX_K_ITCNT=312
e.LPX_K_TMLIM=313
var uc=e.LPX_K_OUTFRQ=314
e.LPX_K_OUTDLY=315
var fc=e.LPX_K_BRANCH=316,dc=e.LPX_K_BTRACK=317
e.LPX_K_TOLINT=318,e.LPX_K_TOLOBJ=319
var hc=e.LPX_K_MPSINFO=320,mc=e.LPX_K_MPSOBJ=321,pc=e.LPX_K_MPSORIG=322,vc=e.LPX_K_MPSWIDE=323,bc=e.LPX_K_MPSFREE=324,gc=e.LPX_K_MPSSKIP=325,xc=e.LPX_K_LPTORIG=326,yc=e.LPX_K_PRESOL=327,wc=e.LPX_K_BINARIZE=328,Mc=e.LPX_K_USECUTS=329,_c=e.LPX_K_BFTYPE=330
e.LPX_K_MIPGAP=331,e.LPX_C_COVER=1,e.LPX_C_CLIQUE=2,e.LPX_C_GOMORY=4,e.LPX_C_MIR=8,e.LPX_C_ALL=255
var kc=1,Ac=2,Lc=-1,Cc=101,Pc=102,Vc=103,Ic=104,Sc=105,jc=106,Oc=107,Xc=108,Ec=109,Fc=110,Bc=111,zc=112,Tc=113,Nc=114,Rc=115,Dc=116,Gc=117,qc=118,Yc=119,Uc=120,Hc=121,Kc=122,Wc=123,Zc=124,Jc=125,Qc=126,$c=127,eu=60,ru=201,tu=202,au=203,nu=204,iu=205,ou=206,lu=207,su=208,cu=209,uu=210,fu=211,du=212,hu=213,mu=214,pu=215,vu=216,bu=217,gu=218,xu=219,yu=220,wu=221,Mu=222,_u=223,ku=224,Au=225,Lu=226,Cu=227,Pu=228,Vu=229,Iu=230,Su=231,ju=232,Ou=233,Xu=234,Eu=235,Fu=236,Bu=237,zu=238,Tu=239,Nu=240,Ru=241,Du=242,Gu=243,qu=244,Yu=245,Uu=246,Hu=247,Ku=248,Wu=249,Zu=250,Ju=251,Qu=252,$u=0,ef=1,rf=2,tf=3,af=4,nf=5,of=301,lf=302,sf=303,cf=304,uf=305,ff=306,df=307,hf=308,mf=309,pf=310,vf=311,bf=312,gf=313,xf=314,yf=315,wf=316,Mf=317,_f=318,kf=319,Af=320,Lf=321,Cf=322,Pf=323,Vf=324,If=325,Sf=326,jf=327,Of=328,Xf=329,Ef=330,Ff=331,Bf=332,zf=333,Tf=334,Nf=335,Rf=336,Df=337,Gf=338,qf=339,Yf=340,Uf=341,Hf=342,Kf=343,Wf=344,Zf=345,Jf=346,Qf=347,$f=348,ed=349,rd=350,td=351,ad=352,nd=353,id=354,od=355,ld=356,sd=357,cd=358,ud=359,fd=360,dd=361,hd=362,md=363,pd=364,vd=365,bd=366,gd=367,xd=368,yd=369,wd=370,Md=371,_d=372,kd=373,Ad=374,Ld=375,Cd=376,Pd=377,Vd=378,Id=379,Sd=380,jd=381,Od=382,Xd=383,Ed=384,Fd=401,Bd=402,zd=403,Td=404,Nd=405,Rd=412,Dd=413,Gd=422,qd=423,Yd=e.mpl_tab_num_args=function(e){return e.ff},Ud=e.mpl_tab_get_arg=function(e,r){return e.a[r]}
e.mpl_tab_get_args=function(e){return e.a}
var Hd=e.mpl_tab_num_flds=function(e){return e.Wa},Kd=e.mpl_tab_get_name=function(e,r){return e.name[r]},Wd=e.mpl_tab_get_type=function(e,r){return e.type[r]},Zd=e.mpl_tab_get_num=function(e,r){return e.Q[r]},Jd=e.mpl_tab_get_str=function(e,r){return e.M[r]},Qd=e.mpl_tab_set_num=function(e,r,t){e.type[r]="N",e.Q[r]=t},$d=e.mpl_tab_set_str=function(e,r,t){e.type[r]="S",e.M[r]=t},eh=e.mpl_initialize=function(){var e={bb:0,Vc:0,l:0,b:0,Bb:0,h:"",value:0,Hf:0,Gf:0,Ff:"",If:0,Te:0,Ue:0,Mf:0,Lf:0,Kf:"",Nf:0}
return e.Zb=Array(eu),i(e.Zb,0," ",eu),e.lc=0,e.nc=0,e.V={},e.uc=null,e.Pf=0,e.rg=0,e.qg=0,e.Ke=0,e.Ob=0,e.pg=null,e.Ah="",e.Bh="",e.Gd=ti(),e.Of=0,e.ib=null,e.Mc=null,e.g=0,e.i=0,e.n=null,e.f=null,e.cf=null,e.bf=null,e.he=null,e.jh=null,e.Hg=null,e.le=null,e.D=0,e.Yf=null,e.xh="",e},rh=e.mpl_read_model=function(e,a,n,i){function o(){return t(e.bb+" line"+(1==e.bb?"":"s")+" were read"),e.cf=null,e.D}if(0!=e.D&&r("mpl_read_model: invalid call sequence"),null==n&&r("mpl_read_model: no input specified"),e.D=1,t("Reading model section from "+a+" ..."),Da(e,a,n),Vr(e),null==e.uc&&Ua(e,"empty model section not allowed"),e.Yf=e.bf,Ra(e),De(e,"data")){if(i)return Ha(e,"data section ignored"),o()
e.nc=1,Ne(e),e.b!=Ru&&Ua(e,"semicolon missing where expected"),Ne(e),e.D=2,t("Reading data section from "+a+" ..."),Wr(e)}return Cr(e),o()},th=e.mpl_read_data=function(e,a,n){return 1!=e.D&&2!=e.D&&r("mpl_read_data: invalid call sequence"),null==n&&r("mpl_read_data: no input specified"),e.D=2,t("Reading data section from "+a+" ..."),e.nc=1,Da(e,a,n),Er(e,"data")&&(Ne(e),e.b!=Ru&&Ua(e,"semicolon missing where expected"),Ne(e)),Wr(e),Cr(e),t(e.bb+" line"+(1==e.bb?"":"s")+" were read"),e.cf=null,e.D},ah=e.mpl_generate=function(e,a,n,i){for(1!=e.D&&2!=e.D&&r("mpl_generate: invalid call sequence"),e.D=3,e.ve=i,Ga(e,a,n),a=e.uc;null!=a&&(Na(e,a),e.ib.type!=Wc);a=a.e);for(e.ib=a,Ya(e),a=e.uc;null!=a;a=a.e)if(a.type==$c)for(n=a.v.t,n=n.O.head;null!=n;n=n.e);for(a=e.uc;null!=a;a=a.e)if(a.type==Vc)for(n=a.v.H,n=n.O.head;null!=n;n=n.e)for(n.value.H.ea=++e.g,i=n.value.H.form;null!=i;i=i.e)i.t.ga.value.t.C=-1
for(a=e.uc;null!=a;a=a.e)if(a.type==$c)for(n=a.v.t,n=n.O.head;null!=n;n=n.e)0!=n.value.t.C&&(n.value.t.C=++e.i)
for(e.n=Array(1+e.g),i=1;i<=e.g;i++)e.n[i]=null
for(a=e.uc;null!=a;a=a.e)if(a.type==Vc)for(n=a.v.H,n=n.O.head;null!=n;n=n.e)i=n.value.H.ea,e.n[i]=n.value.H
for(i=1;i<=e.g;i++);for(e.f=Array(1+e.i),i=1;i<=e.i;i++)e.f[i]=null
for(a=e.uc;null!=a;a=a.e)if(a.type==$c)for(n=a.v.t,n=n.O.head;null!=n;n=n.e)0!=(i=n.value.t.C)&&(e.f[i]=n.value.t)
for(i=1;i<=e.i;i++);return t("Model has been successfully generated"),e.D},nh=e.mpl_get_prob_name=function(e){return e.Yf},ih=e.mpl_get_num_rows=function(e){return 3!=e.D&&r("mpl_get_num_rows: invalid call sequence"),e.g},oh=e.mpl_get_num_cols=function(e){return 3!=e.D&&r("mpl_get_num_cols: invalid call sequence"),e.i},lh=e.mpl_get_row_name=function(e,t){3!=e.D&&r("mpl_get_row_name: invalid call sequence"),1<=t&&t<=e.g||r("mpl_get_row_name: i = "+t+"; row number out of range")
var a=e.n[t].H.name,a=a+Ct("[",e.n[t].ga.w).slice(0,255)
return 255==a.length&&(a=a.slice(0,252)+"..."),a},sh=e.mpl_get_row_kind=function(e,t){var a
switch(3!=e.D&&r("mpl_get_row_kind: invalid call sequence"),1<=t&&t<=e.g||r("mpl_get_row_kind: i = "+t+"; row number out of range"),e.n[t].H.type){case Vc:a=411
break
case Dc:a=Rd
break
case Rc:a=Dd}return a},ch=e.mpl_get_row_bnds=function(e,t,a){var n
return 3!=e.D&&r("mpl_get_row_bnds: invalid call sequence"),1<=t&&t<=e.g||r("mpl_get_row_bnds: i = "+t+"; row number out of range"),n=e.n[t],e=null==n.H.P?-hi:n.P,t=null==n.H.W?+hi:n.W,e==-hi&&t==+hi?(n=Fd,e=t=0):t==+hi?(n=Bd,t=0):e==-hi?(n=zd,e=0):n=n.H.P!=n.H.W?Td:Nd,a(e,t),n},uh=e.mpl_get_mat_row=function(e,t,a,n){var i=0
for(3!=e.D&&r("mpl_get_mat_row: invalid call sequence"),1<=t&&t<=e.g||r("mpl_get_mat_row: i = "+t+"; row number out of range"),e=e.n[t].form;null!=e;e=e.e)i++,null!=a&&(a[i]=e.t.C),null!=n&&(n[i]=e.u)
return i},fh=e.mpl_get_row_c0=function(e,t){var a
return 3!=e.D&&r("mpl_get_row_c0: invalid call sequence"),1<=t&&t<=e.g||r("mpl_get_row_c0: i = "+t+"; row number out of range"),a=e.n[t],null==a.H.P&&null==a.H.W?-a.P:0},dh=e.mpl_get_col_name=function(e,t){3!=e.D&&r("mpl_get_col_name: invalid call sequence"),1<=t&&t<=e.i||r("mpl_get_col_name: j = "+t+"; column number out of range")
var a=e.f[t].t.name,a=a+Ct("[",e.f[t].ga.w)
return 255==a.length&&(a=a.slice(0,252)+"..."),a},hh=e.mpl_get_col_kind=function(e,t){var a
switch(3!=e.D&&r("mpl_get_col_kind: invalid call sequence"),1<=t&&t<=e.i||r("mpl_get_col_kind: j = "+t+"; column number out of range"),e.f[t].t.type){case qc:a=421
break
case Tc:a=Gd
break
case Cc:a=qd}return a},mh=e.mpl_get_col_bnds=function(e,t,a){var n
return 3!=e.D&&r("mpl_get_col_bnds: invalid call sequence"),1<=t&&t<=e.i||r("mpl_get_col_bnds: j = "+t+"; column number out of range"),n=e.f[t],e=null==n.t.P?-hi:n.P,t=null==n.t.W?+hi:n.W,e==-hi&&t==+hi?(n=Fd,e=t=0):t==+hi?(n=Bd,t=0):e==-hi?(n=zd,e=0):n=n.t.P!=n.t.W?Td:Nd,a(e,t),n},ph=e.mpl_has_solve_stmt=function(e){return 3!=e.D&&r("mpl_has_solve_stmt: invalid call sequence"),e.Ob},vh=e.mpl_put_row_soln=function(e,r,t,a,n){e.n[r].m=t,e.n[r].r=a,e.n[r].J=n},bh=e.mpl_put_col_soln=function(e,r,t,a,n){e.f[r].m=t,e.f[r].r=a,e.f[r].J=n},gh=e.mpl_postsolve=function(e){(3!=e.D||e.Of)&&r("mpl_postsolve: invalid call sequence")
var a
for(e.Of=1,a=e.ib;null!=a;a=a.e)Na(e,a)
return e.ib=null,Ya(e),t("Model has been successfully processed"),e.D},xh="Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),yh="January February March April May June July August September October November December".split(" "),wh={},Mh=e.mpl_tab_drv_register=function(e,r){wh[e.toLowerCase()]=r}
tn.prototype.readRecord=function(e){var t
for(0<this.Oa[0]&&Qd(e,this.Oa[0],this.count-this.Eg-1),t=1;t<=this.Wa;t++){if(an(this),this.Hb==this.ng)return-1
if(this.Hb==this.Ae){var a=this.Wa-t+1
r(1==a?this.Ea+":"+this.count+": one field missing":this.Ea+":"+this.count+": "+a+" fields missing")}else if(this.Hb==this.og){if(0<this.Oa[t]){var n=0
ue(this.pb,function(e){n=e}),Qd(e,this.Oa[t],n)}}else this.Hb==this.Be&&0<this.Oa[t]&&$d(e,this.Oa[t],this.pb)}return an(this),this.Hb!=this.Ae&&r(this.Ea+":"+this.count+": too many fields"),0},tn.prototype.writeRecord=function(e){var r,t,a,n
for(t=Hd(e),r=1;r<=t;r++){switch(Wd(e,r)){case"N":this.data+=Zd(e,r)
break
case"S":for(this.data+='"',a=Jd(e,r),n=0;a.length>n;n++)this.data='"'==a[n]?this.data+'""':this.data+a[n]
this.data+='"'}this.data+=r<t?",":"\n"}return this.count++,0},tn.prototype.flush=function(e){this.ve(e.a,this.mode,this.data)},Mh("CSV",tn),on.prototype.writeRecord=function(e){var r,t=Hd(e),a=[]
for(r=1;r<=t;r++)switch(Wd(e,r)){case"N":a.push(Zd(e,r))
break
case"S":a.push(Jd(e,r))}return this.data.push(a),0},on.prototype.readRecord=function(e){var t=this.data[this.cursor++]
if(null==t)return-1
for(var a=1;a<=Hd(e);a++){var n=this.Oa[Kd(e,a)]
if(null!=n)switch(typeof(n=t[n])){case"number":Qd(e,a,n)
break
case"boolean":Qd(e,a,Number(n))
break
case"string":$d(e,a,n)
break
default:r("Unexpected data type "+n+" in "+this.Ea)}}return 0},on.prototype.flush=function(e){this.ve(e.a,this.mode,this.data)},Mh("JSON",on)
var _h=1,kh=2,Ah=1,Lh=2,Ch=0,Ph=1e-10
Ch&&(qs=function(e,r){var a,n,i,o,l=e.i,s=e.Nb,c=e.v,u=e.s,f=e.l,d=0
for(a=1;a<=l;a++)for(n=1;n<=l;n++){for(o=0,i=1;i<=l;i++)o+=s[(a-1)*e.K+i]*f[(i-1)*e.K+n]
i=u[n],i=a<=i?c[li(e,a,i)]:0,o=Math.abs(o-i)/(1+Math.abs(i)),d<o&&(d=o)}1e-8<d&&t(r+": dmax = "+d+"; relative error too large")})
var Vh=e.glp_scale_prob=function(e,a){function n(e,r){var t,a,n
for(a=1,t=e.n[r].k;null!=t;t=t.B)n=Math.abs(t.j),n=n*t.n.ma*t.f.va,(null==t.ua||a>n)&&(a=n)
return a}function i(e,r){var t,a,n
for(a=1,t=e.n[r].k;null!=t;t=t.B)n=Math.abs(t.j),n=n*t.n.ma*t.f.va,(null==t.ua||a<n)&&(a=n)
return a}function o(e,r){var t,a,n
for(a=1,t=e.f[r].k;null!=t;t=t.I)n=Math.abs(t.j),n=n*t.n.ma*t.f.va,(null==t.ra||a>n)&&(a=n)
return a}function l(e,r){var t,a,n
for(a=1,t=e.f[r].k;null!=t;t=t.I)n=Math.abs(t.j),n=n*t.n.ma*t.f.va,(null==t.ra||a<n)&&(a=n)
return a}function s(e){var r,t,a
for(r=t=1;r<=e.g;r++)a=n(e,r),(1==r||t>a)&&(t=a)
return t}function c(e){var r,t,a
for(r=t=1;r<=e.g;r++)a=i(e,r),(1==r||t<a)&&(t=a)
return t}function u(e,r){var t,a,n
for(a=0;1>=a;a++)if(a==r)for(t=1;t<=e.g;t++)n=i(e,t),Qi(e,t,eo(e,t)/n)
else for(t=1;t<=e.i;t++)n=l(e,t),$i(e,t,ro(e,t)/n)}function f(e){var r,t,a
for(r=t=1;r<=e.g;r++)a=i(e,r)/n(e,r),(1==r||t<a)&&(t=a)
return t}function d(e){var r,t,a
for(r=t=1;r<=e.i;r++)a=l(e,r)/o(e,r),(1==r||t<a)&&(t=a)
return t}function h(e){var r,t,a,u=0
for(t=f(e)>d(e),r=1;15>=r&&(a=u,u=c(e)/s(e),!(1<r&&u>.9*a));r++){a=e
for(var h=t,m=void 0,p=m=void 0,v=void 0,p=0;1>=p;p++)if(p==h)for(m=1;m<=a.g;m++)v=n(a,m)*i(a,m),Qi(a,m,eo(a,m)/Math.sqrt(v))
else for(m=1;m<=a.i;m++)v=o(a,m)*l(a,m),$i(a,m,ro(a,m)/Math.sqrt(v))}}a&~(_l|kl|Al|Ll|Cl)&&r("glp_scale_prob: flags = "+a+"; invalid scaling options"),a&Cl&&(a=_l|kl|Ll),function(e,r){function a(e,r,t,a){return e+": min|aij| = "+r+"  max|aij| = "+t+"  ratio = "+a}var n,i
if(t("Scaling..."),to(e),n=s(e),i=c(e),t(a(" A",n,i,i/n)),!(.1<=n&&10>=i&&(t("Problem data seem to be well scaled"),r&Ll))&&(r&_l&&(h(e),n=s(e),i=c(e),t(a("GM",n,i,i/n))),r&kl&&(u(e,f(e)>d(e)),n=s(e),i=c(e),t(a("EQ",n,i,i/n))),r&Al)){for(n=1;n<=e.g;n++)Qi(e,n,ce(eo(e,n)))
for(n=1;n<=e.i;n++)$i(e,n,ce(ro(e,n)))
n=s(e),i=c(e),t(a("2N",n,i,i/n))}}(e,a)}}("object"==typeof exports&&exports||this),Distribution.prototype.construct=function(e){},Distribution.prototype.pdf=function(e){},Distribution.prototype.sample=function(e){},Distribution.prototype.estimate=function(e){},Distribution.prototype.info=function(){var e,r="{<br>",t=new Array
for(e in this)switch(type(this[e])){case"string":case"boolean":case"number":r+=e+": "+this[e]+"<br>"
break
case"vector":r+=e+": "+printVector(this[e])+"<br>"
break
case"matrix":r+=e+": matrix of size "+this[e].m+"-by-"+this[e].n+"<br>"
break
case"function":t.push(e)
break
default:r+=e+": "+typeof this[e]+"<br>"}return r+="<i>Functions: "+t.join(", ")+"</i><br>",r+="}"},Uniform.prototype.construct=function(e,r){if(void 0===e)this.isDiscrete=!1,this.a=-1,this.b=1,this.dimension=1,this.px=.5,this.mean=0,this.variance=1/3,this.std=Math.sqrt(this.variance)
else if(void 0===r)this.isDiscrete=!0,this.values="number"==typeof e?range(e):e,this.dimension=1,this.mean=(min(this.values)+max(this.values))/2,this.variance=(this.values.length*this.values.length-1)/12,this.std=Math.sqrt(this.variance)
else{this.isDiscrete=!1,this.a=e,this.b=r,this.dimension=size(e,1),this.px=1/prod(sub(r,e)),this.mean=mul(.5,add(e,r))
var t=sub(r,e)
this.variance=entrywisediv(entrywisemul(t,t),12),this.std=sqrt(this.variance)}},Uniform.prototype.pdf=function(e){const r=type(e)
var t=void 0
if(this.isDiscrete){var a=function(e,r){return r.indexOf(e)<0?0:1/r.length}
if("number"==r)t=a(e,this.values)
else if("vector"==r){t=zeros(e.length)
for(var n=0;n<e.length;n++)t[n]=a(e[n],this.values)}else if("matrix"==r){t=zeros(e.m,e.n)
for(var n=0;n<e.m*e.n;n++)t.val[n]=a(e.val[n],this.values)}}else{var a=function(e,r,t,a){return e>=r&&e<=t?a:0}
if("number"==r)1==this.dimension&&(t=a(e,this.a,this.b,this.px))
else if("vector"==r){if(1==this.dimension){t=zeros(e.length)
for(var n=0;n<e.length;n++)t[n]=a(e[n],this.a,this.b,this.px)}else if(this.dimension==e.length){t=a(e[0],this.a[0],this.b[0],this.px)
for(var i=1;i<e.length&&0!=t;)t*=a(e[i],this.a[i],this.b[i],this.px),i++}}else if("matrix"==r)if(1==this.dimension){t=zeros(e.m,e.n)
for(var n=0;n<e.m*e.n;n++)t.val[n]=a(e.val[n],this.a,this.b,this.px)}else if(this.dimension==e.n){t=zeros(e.m)
for(var n=0;n<e.m;n++){t[n]=a(e.val[n*e.n],this.a[0],this.b[0],this.px)
for(var i=1;i<e.n&&0!=t[n];)t[n]*=a(e.val[n*e.n+i],this.a[i],this.b[i],this.px),i++}}}return t},Uniform.prototype.sample=function(e){if(void 0===e)var e=1
if(this.isDiscrete){for(var r=zeros(e),t=0;t<e;t++){for(var a=Math.random(),n=1,i=this.values.length;a>n/i;)n++
r[t]=this.values[n-1]}return 1==e?r[0]:r}return 1==this.dimension?add(entrywisemul(this.b-this.a,rand(e)),this.a):add(entrywisemul(outerprod(ones(e),sub(this.b,this.a)),rand(e,this.dimension)),outerprod(ones(e),this.a))},Uniform.prototype.estimate=function(e){const r=type(e)
if("matrix"==r)var t=e.val
else var t=e
for(var a=0;a<t.length&&Math.round(t[a])==t[a];)a++
if(a<t.length?this.isDiscrete=!1:this.isDiscrete=!0,this.isDiscrete){for(a=0;a<t.length;a++){var n=Math.round(t[a])
this.values.indexOf(n)<0&&this.values.push(n)}this.dimension=1,this.mean=(min(this.values)+max(this.values))/2,this.variance=(this.values.length*this.values.length-1)/12,this.std=Math.sqrt(this.variance)}else{"matrix"==r?(this.a=min(e,1).val,this.b=max(e).val,this.dimension=this.a.length):(this.a=minVector(e),this.b=maxVector(e),this.dimension=1),this.mean=mul(.5,add(this.a,this.b))
var i=sub(this.b,this.a)
this.variance=entrywisediv(entrywisemul(i,i),12),this.std=sqrt(this.variance),this.px=1/prod(sub(this.b,this.a))}return this},Gaussian.prototype.construct=function(e,r){if(void 0===e)var t=1
else if("matrix"==type(e))var t=e.val
else var t=e
var a=size(t,1)
if(void 0===r)if(1==a)var r=1
else var r=ones(a)
this.mean=t,this.variance=r,this.std=sqrt(this.variance),this.dimension=a},Gaussian.prototype.pdf=function(e){if(1==this.dimension){if("number"==typeof e){var r=e-this.mean
return Math.exp(-r*r/(2*this.variance))/(this.std*Math.sqrt(2*Math.PI))}var r=sub(e,this.mean)
return entrywisediv(exp(entrywisediv(entrywisemul(r,r),-2*this.variance)),this.std*Math.sqrt(2*Math.PI))}if("vector"==type(e)){if(e.length!=this.dimension)return void error("Error in Gaussian.pdf(x): x.length = "+e.length+" != "+this.dimension+" = Gaussian.dimension.")
var r=subVectors(e,this.mean),t=-.5*dot(r,divVectors(r,this.variance))
return Math.exp(t)/(Math.pow(2*Math.PI,.5*this.dimension)*Math.sqrt(prodVector(this.variance)))}if(e.n!=this.dimension)return void error("Error in Gaussian.pdf(X): X.n = "+e.n+" != "+this.dimension+" = Gaussian.dimension.")
for(var a=zeros(e.m),n=Math.pow(2*Math.PI,.5*this.dimension)*Math.sqrt(prodVector(this.variance)),i=0;i<e.m;i++){var r=subVectors(e.row(i),this.mean),t=-.5*dot(r,divVectors(r,this.variance))
a[i]=Math.exp(t)/n}return a},Gaussian.prototype.sample=function(e){if(void 0===e)var e=1
if(1==e)var r=add(entrywisemul(this.std,randn(this.dimension)),this.mean)
else var t=ones(e),r=add(entrywisemul(outerprod(t,this.std),randn(e,this.dimension)),outerprod(t,this.mean))
return r},Gaussian.prototype.estimate=function(e){return"matrix"==type(e)?(this.mean=mean(e,1).val,this.variance=variance(e,1).val,this.std=void 0,this.dimension=e.n):(this.mean=mean(e),this.variance=variance(e),this.std=Math.sqrt(this.variance),this.dimension=1),this},mvGaussian.prototype.construct=function(e,r){if(void 0===e)var t=1
else if("matrix"==type(e))var t=e.val
else var t=e
var a=size(t,1)
if(void 0===r)if(1==a)var r=1
else var r=eye(a)
this.mean=t,this.variance=r,this.dimension=a,this.L=chol(this.variance),void 0===this.L&&error("Error in new Distribution (mvGaussian, mu, Sigma): Sigma is not positive definite"),this.det=det(this.variance)},mvGaussian.prototype.pdf=function(e){if(1==this.dimension){if("number"==typeof e){var r=e-this.mean
return Math.exp(-r*r/(2*this.variance))/Math.sqrt(2*this.variance*Math.PI)}var r=sub(e,this.mean)
return entrywisediv(exp(entrywisediv(entrywisemul(r,r),-2*this.variance)),Math.sqrt(2*this.variance*Math.PI))}if("vector"==type(e)){if(e.length!=this.dimension)return void error("Error in mvGaussian.pdf(x): x.length = "+e.length+" != "+this.dimension+" = mvGaussian.dimension.")
var r=subVectors(e,this.mean),t=-.5*dot(r,cholsolve(this.L,r))
return Math.exp(t)/Math.sqrt(Math.pow(2*Math.PI,this.dimension)*this.det)}if(e.n!=this.dimension)return void error("Error in Gaussian.pdf(X): X.n = "+e.n+" != "+this.dimension+" = Gaussian.dimension.")
for(var a=zeros(e.m),n=Math.sqrt(Math.pow(2*Math.PI,this.dimension)*this.det),i=0;i<e.m;i++){var r=subVectors(e.row(i),this.mean),t=-.5*dot(r,cholsolve(this.L,r))
a[i]=Math.exp(t)/n}return a},mvGaussian.prototype.sample=function(e){if(void 0===e)var e=1
var r=add(mul(randn(e,this.dimension),transpose(this.L)),outerprod(ones(e),this.mean))
return 1==e?r.val:r},mvGaussian.prototype.estimate=function(e){if("matrix"==type(e))return this.mean=mean(e,1).val,this.variance=cov(e),this.dimension=e.n,this.L=chol(this.variance),void 0===this.L&&error("Error in mvGaussian.estimate(X): covariance estimate is not positive definite"),this.det=det(this.variance),this
error("mvGaussian.estimate( X ) needs a matrix X")},Bernoulli.prototype.construct=function(e){if(void 0===e)var e=.5
var r=size(e,1)
this.mean=e,this.variance=entrywisemul(e,sub(1,e)),this.std=sqrt(this.variance),this.dimension=r},Bernoulli.prototype.pdf=Bernoulli.prototype.pmf=function(e){const r=type(e)
var t=function(e,r){return 1==e?r:0==e?1-r:0}
if(1!=this.dimension){switch(r){case"vector":for(var a=t(e[0],this.mean[0]),n=1;n<this.dimension;n++)a*=t(e[n],this.mean[n])
break
case"spvector":for(var a=1,i=0;i<e.ind[0];i++)a*=1-this.mean[i]
for(var n=0;n<e.val.length-1;n++){a*=this.mean[e.ind[n]]
for(var i=e.ind[n]+1;i<e.ind[n+1];i++)a*=1-this.mean[i]}a*=this.mean[e.ind[n]]
for(var i=e.ind[n]+1;i<this.dimension;i++)a*=1-this.mean[i]
break
case"matrix":for(var a=zeros(e.m),o=0;o<e.m;o++){a[o]=t(e.val[o*e.n],this.mean[0])
for(var n=1;n<e.n;n++)a[o]*=t(e.val[o*e.n+n],this.mean[n])}break
case"spmatrix":for(var a=ones(e.m),o=0;o<e.m;o++){for(var l=e.row(o),i=0;i<l.ind[0];i++)a[o]*=1-this.mean[i]
for(var n=0;n<l.val.length-1;n++){a[o]*=this.mean[l.ind[n]]
for(var i=l.ind[n]+1;i<l.ind[n+1];i++)a[o]*=1-this.mean[i]}a[o]*=this.mean[l.ind[n]]
for(var i=l.ind[n]+1;i<this.dimension;i++)a[o]*=1-this.mean[i]}break
default:var a=void 0}return a}if("number"==r)return t(e,this.mean)
if("vector"==r){for(var a=zeros(e.length),o=0;o<e.length;o++)a[o]=t(e[o],this.mean)
return a}if("matrix"==r){for(var s=zeros(e.m,e.n),c=e.m*e.n,n=0;n<c;n++)s.val[n]=t(e.val[n],this.mean)
return s}},Bernoulli.prototype.logpdf=Bernoulli.prototype.logpmf=function(e){const r=type(e)
var t=function(e,r){return 1==e?Math.log(r):0==e?Math.log(1-r):-1/0}
if(1!=this.dimension){switch(r){case"vector":for(var a=0,n=0;n<this.dimension;n++)a+=t(e[n],this.mean[n])
break
case"spvector":for(var a=0,i=0;i<e.ind[0];i++)a+=Math.log(1-this.mean[i])
for(var n=0;n<e.val.length-1;n++){a+=Math.log(this.mean[e.ind[n]])
for(var i=e.ind[n]+1;i<e.ind[n+1];i++)a+=Math.log(1-this.mean[i])}a+=Math.log(this.mean[e.ind[n]])
for(var i=e.ind[n]+1;i<this.dimension;i++)a+=Math.log(1-this.mean[i])
break
case"matrix":for(var a=zeros(e.m),o=0;o<e.m;o++)for(var n=0;n<e.n;n++)a[o]+=t(e.val[o*e.n+n],this.mean[n])
break
case"spmatrix":for(var a=zeros(e.m),o=0;o<e.m;o++){for(var l=e.row(o),i=0;i<l.ind[0];i++)a[o]+=Math.log(1-this.mean[i])
for(var n=0;n<l.val.length-1;n++){a[o]+=Math.log(this.mean[l.ind[n]])
for(var i=l.ind[n]+1;i<l.ind[n+1];i++)a[o]+=Math.log(1-this.mean[i])}a[o]+=Math.log(this.mean[l.ind[n]])
for(var i=l.ind[n]+1;i<this.dimension;i++)a[o]+=Math.log(1-this.mean[i])}break
default:var a=void 0}return a}if("number"==r)return t(e,this.mean)
if("vector"==r){for(var a=zeros(e.length),o=0;o<e.length;o++)a[o]=t(e[o],this.mean)
return a}if("matrix"==r){for(var s=zeros(e.m,e.n),c=e.m*e.n,n=0;n<c;n++)s.val[n]=t(e.val[n],this.mean)
return s}},Bernoulli.prototype.sample=function(e){return void 0===e||1==e?isLower(rand(this.dimension),this.mean):isLower(rand(e,this.dimension),outerprod(ones(e),this.mean))},Bernoulli.prototype.estimate=function(e){switch(type(e)){case"matrix":case"spmatrix":this.mean=mean(e,1).val,this.variance=entrywisemul(this.mean,sub(1,this.mean)),this.std=sqrt(this.variance),this.dimension=e.n
break
case"vector":case"spvector":this.dimension=1,this.mean=mean(e),this.variance=this.mean*(1-this.mean),this.std=Math.sqrt(this.variance)
break
default:error("Error in Bernoulli.estimate( X ): X must be a (sp)matrix or (sp)vector.")}return this},Poisson.prototype.construct=function(e){if(void 0===e)var e=5
var r=size(e,1)
this.mean=e,this.variance=this.mean,this.std=sqrt(this.variance),this.dimension=r},Poisson.prototype.pdf=Poisson.prototype.pmf=function(e){const r=type(e)
var t=function(e,r){if(e<0||Math.round(e)!=e)return 0
if(0==e)return 1
for(var t=r,a=2;a<=e;a++)t*=r/a
return Math.exp(-r)*t}
if(1==this.dimension){if("number"==r)return t(e,this.mean)
if("vector"==r){for(var a=zeros(e.length),n=0;n<e.length;n++)a[n]=t(e[n],this.mean)
return a}if("matrix"==r){for(var i=zeros(e.m,e.n),o=e.m*e.n,l=0;l<o;l++)i.val[l]=t(e.val[l],this.mean)
return a}}else{if("vector"==r){for(var a=t(e[0],this.mean[0]),l=0;l<this.dimension;l++)a*=t(e[l],this.mean[l])
return a}if("matrix"==r){for(var a=zeros(e.m),n=0;n<e.m;n++){a[n]=t(e.val[n*e.n],this.mean[0])
for(var l=0;l<e.n;l++)a[n]*=t(e.val[n*e.n+l],this.mean[l])}return a}}},Poisson.prototype.sample=function(e){var r=function(e){var r=Math.random(),t=0
const a=Math.exp(-e)
for(;r>a;)r*=Math.random(),t++
return t}
if(void 0===e||1==e){if(1==this.dimension)return r(this.mean)
var t=zeros(this.dimension)
for(k=0;k<this.dimension;k++)t[k]=r(this.mean[k])
return t}if(1==this.dimension){for(var a=zeros(e),n=0;n<e;n++)a[n]=r(this.mean)
return a}for(var a=zeros(e,this.dimension),n=0;n<e;n++)for(k=0;k<this.dimension;k++)a[n*this.dimension+k]=r(this.mean[k])
return a},Poisson.prototype.estimate=function(e){return"matrix"==type(e)?(this.mean=mean(e,1).val,this.variance=this.mean,this.std=sqrt(this.variance),this.dimension=e.n):(this.dimension=1,this.mean=mean(e),this.variance=this.mean,this.std=Math.sqrt(this.variance)),this}
const Complex_I=new Complex(0,1)
Complex.prototype.toString=function(){return this.re+(this.im>=0?" + ":" - ")+Math.abs(this.im)+"i"},Complex.prototype.info=function(){return this.re+(this.im>=0?" + ":" - ")+Math.abs(this.im)+"i"}
var absComplex=modulus
return ComplexVector.prototype.toString=function(){return"["+this.type+" of size "+this.length+"]"},ComplexMatrix.prototype.toString=function(){return"["+this.type+" of size "+this.m+" x "+this.n+"]"},ComplexVector.prototype.get=function(e){return new Complex(this.re[e],this.im[e])},ComplexMatrix.prototype.get=function(e,r){return new Complex(this.re[e*this.n+r],this.im[e*this.n+r])},ComplexVector.prototype.set=function(e,r){"number"==typeof r?(this.re[e]=r,this.im[e]=0):(this.re[e]=r.re,this.im[e]=r.im)},ComplexMatrix.prototype.set=function(e,r,t){"number"==typeof t?(this.re[e*this.n+r]=t,this.im[e*this.n+r]=0):(this.re[e*this.n+r]=t.re,this.im[e*this.n+r]=t.im)},ComplexVector.prototype.getSubVector=function(e){const r=e.length
for(var t=new ComplexVector(r),a=0;a<r;a++)t.re[a]=this.re[e[a]],t.im[a]=this.im[e[a]]
return t},ComplexVector.prototype.setVectorScalar=function(e,r){var t
for(t=0;t<e.length;t++)A.set(e[t],r)},ComplexVector.prototype.setVectorVector=function(e,r){var t
for(t=0;t<e.length;t++)A.set(e[t],r[t])},ComplexMatrix.prototype.transpose=function(){const e=A.m,r=A.n
if(e>1){var t,a,n=new ComplexMatrix(r,e),i=0
for(a=0;a<e;a++){var o=0
for(t=0;t<r;t++)n.re[o+a]=A.re[i+t],n.im[o+a]=A.im[i+t],o+=e
i+=r}return n}return new ComplexVector(A.re,A.im)},Diagram.prototype.rect=function(e,r,t,a,n,i,o,l){if(void 0===l)var l=.6
if(void 0===o)var o=0
if(void 0===i)var i=""
if(void 0===n)var n=1
this.shapes.push(["rect",e,r,t,a,n,i,o,l]),this.redraw()},Diagram.prototype.circle=function(e,r,t,a,n,i,o,l){if(void 0===l)var l=.6
if(void 0===o)var o=0
if(void 0===i)var i=""
if(void 0===n)var n=1
this.shapes.push(["circle",e,r,t,a,n,i,o,l]),this.redraw()},Diagram.prototype.image=function(e,r,t,a,n,i,o,l){if(void 0===l)var l=.6
if(void 0===o)var o=0
if(void 0===i)var i=""
var s=this,c=this.shapes.length,u=new Image
u.src=n,u.onload=function(){s.shapes[c][9]=!0,s.redraw()},this.shapes.push(["image",e,r,t,a,u,i,o,l,!1])},Diagram.prototype.redraw=function(){var e=document.getElementById(this.canvasId),r=e.getContext("2d")
r.clearRect(0,0,e.width,e.height)
var t,a,n,i,o,l,s,c,u,f
for(t=0;t<this.shapes.length;t++){if(a=this.shapes[t][0],n=this.shapes[t][1],i=this.shapes[t][2],o=this.shapes[t][3],l=this.shapes[t][4],s=this.shapes[t][5],c=this.shapes[t][6],u=this.shapes[t][7],f=this.shapes[t][8],"rect"==a){setcolortransparent(r,s,f)
r.beginPath(),r.moveTo(n*e.width,i*e.height+15),r.quadraticCurveTo(n*e.width,i*e.height,n*e.width+15,i*e.height),r.lineTo((n+o)*e.width-15,i*e.height),r.quadraticCurveTo((n+o)*e.width,i*e.height,(n+o)*e.width,i*e.height+15),r.lineTo((n+o)*e.width,(i+l)*e.height-15),r.quadraticCurveTo((n+o)*e.width,(i+l)*e.height,(n+o)*e.width-15,(i+l)*e.height),r.lineTo(n*e.width+15,(i+l)*e.height),r.quadraticCurveTo(n*e.width,(i+l)*e.height,n*e.width,(i+l)*e.height-15),r.closePath(),r.fill(),(t==this.selectedShape||this.selectedShapes.indexOf(t)>=0)&&(setcolortransparent(r,5,.3),r.fillRect((n-.005)*e.width,(i-.005)*e.height,(o+.01)*e.width,(l+.01)*e.height))}else if("circle"==a)setcolortransparent(r,s,f),r.beginPath(),r.moveTo((n+o/2)*e.width,i*e.height),r.quadraticCurveTo((n+o)*e.width,i*e.height,(n+o)*e.width,(i+l/2)*e.height),r.quadraticCurveTo((n+o)*e.width,(i+l)*e.height,(n+o/2)*e.width,(i+l)*e.height),r.quadraticCurveTo(n*e.width,(i+l)*e.height,n*e.width,(i+l/2)*e.height),r.quadraticCurveTo(n*e.width,i*e.height,(n+o/2)*e.width,i*e.height),r.fill(),(t==this.selectedShape||this.selectedShapes.indexOf(t)>=0)&&(setcolortransparent(r,5,.3),r.fillRect((n-.005)*e.width,(i-.005)*e.height,(o+.01)*e.width,(l+.01)*e.height))
else if("point"==a)setcolortransparent(r,s,f),r.beginPath(),r.arc(n*e.width,i*e.height,o*e.width,0,2*Math.PI,!0),r.closePath(),r.fill(),(t==this.selectedShape||this.selectedShapes.indexOf(t)>=0)&&(setcolortransparent(r,5,.3),r.fillRect((n-.005)*e.width,(i-.005)*e.height,(o+.01)*e.width,(l+.01)*e.height))
else if("label"==a){setcolortransparent(r,s,f)
var d=document.getElementById(this.shapes[t][9])
d.style.left=n*e.width,d.style.top=i*e.height,d.style.visibility="visible"}else if("arrow"==a){setcolortransparent(r,s,f)
r.save(),r.translate(n*e.width,i*e.height),r.rotate(Math.PI*(this.shapes[t][9]/180)),r.beginPath(),r.moveTo(0,0),r.lineTo(o*e.width,0),r.lineTo(o*e.width,-4.5),r.lineTo(o*e.width+15,l/2*e.height),r.lineTo(o*e.width,l*e.height+4.5),r.lineTo(o*e.width,l*e.height),r.lineTo(0,l*e.height),r.closePath(),r.fill(),r.restore()}else"image"==a&&this.shapes[t][9]&&(r.drawImage(this.shapes[t][5],n*e.width,i*e.height,o*e.width,l*e.height),(t==this.selectedShape||this.selectedShapes.indexOf(t)>=0)&&(setcolortransparent(r,3,.3),r.fillRect((n-.005)*e.width,(i-.005)*e.height,(o+.01)*e.width,(l+.01)*e.height)))
if(""!=c){var h=c.split("*")
r.textAlign="center"
var m=Math.floor(50*o)
if(r.font=m+"pt sans-serif",setcolor(r,u),1==h.length)r.fillText(c,(n+o/2)*e.width,(i+l/2)*e.height)
else for(var p=0;p<h.length;p++)r.fillText(h[p],(n+o/2)*e.width,(i+l/2)*e.height-(h.length/2-p-.5)*(1.5*m))}}},Diagram.prototype.mouseselect=function(e){var r=document.getElementById(this.canvasId),t=r.getBoundingClientRect(),a=e.clientX-t.left,n=e.clientY-t.top
if(Math.abs(a-this.mousexprev)>=1||Math.abs(n-this.mouseyprev)>=1){this.mousexprev=a,this.mouseyprev=n
for(var i=this.shapes.length-1;i>=0&&0==this.isInShape(a,n,this.shapes[i]);)i--
i>=0?i!=this.selectedShape&&(this.selectedShape=i,this.redraw(),this.onSelect()):this.selectedShape>=0&&(this.onDeselect(),this.selectedShape=-1,this.redraw())}},Diagram.prototype.isInShape=function(e,r,t){var a=document.getElementById(this.canvasId)
return"rect"==t[0]?e>t[1]*a.width&&e<(t[1]+t[3])*a.width&&r>t[2]*a.height&&r<(t[2]+t[4])*a.height:"circle"==t[0]?e>t[1]*a.width&&e<(t[1]+t[3])*a.width&&r>t[2]*a.height&&r<(t[2]+t[4])*a.height:(t[0],!1)},Diagram.prototype.onSelect=function(){},Diagram.prototype.onDeselect=function(){},Diagram.prototype.select=function(e){if("number"==typeof e)this.selectedShapes.indexOf(e)<0&&(this.selectedShapes.push(e),this.redraw())
else{for(var r=0;r<e.length;r++)this.selectedShapes.indexOf(e[r])<0&&this.selectedShapes.push(e[r])
this.redraw()}},Diagram.prototype.deselect=function(e){if("number"==typeof e){var r=this.selectedShapes.indexOf(e)
r>=0&&(this.selectedShapes.splice(r,1),this.redraw())}else{for(var r,t=0;t<e.length;t++)(r=this.selectedShapes.indexOf(e[t]))>=0&&this.selectedShapes.splice(r,1)
this.redraw()}},Diagram.prototype.selectall=function(e){for(var r=0;r<this.shapes.length;r++)this.selectedShapes.push(r)
this.redraw()},Diagram.prototype.deselectall=function(){for(;this.selectedShapes.length>0;)this.selectedShapes.pop()
this.redraw()},Plot.prototype.addPoint=function(e,r,t,a,n){void 0===t&&(t=0),void 0===a&&(a=5),void 0===n&&(n=1.1),this.points.push([e,r,t,a,n])},Plot.prototype.plotAxis=function(){var e=this.buffer
if(e.getContext){var r=e.getContext("2d")
if(r.fillStyle="white",r.fillRect(0,0,e.width,e.height),r.strokeStyle="black",this.minY<0&&this.maxY>0){var t=e.height- -this.minY*this.scaleY
r.beginPath(),r.moveTo(0,t),r.lineTo(e.width,t),r.closePath(),r.stroke()
for(var a=Math.ceil((this.maxX-this.minX)/10),n=-a;n>this.minX;n-=a){var i=(n-this.minX)*this.scaleX
r.beginPath(),r.moveTo(i,t-5),r.lineTo(i,t+5),r.stroke()}for(var n=a;n<this.maxX;n+=a){var i=(n-this.minX)*this.scaleX
r.beginPath(),r.moveTo(i,t-5),r.lineTo(i,t+5),r.stroke()}}if(this.minX<0&&this.maxX>0){var o=-this.minX*this.scaleX
r.beginPath(),r.moveTo(o,0),r.lineTo(o,e.height),r.closePath(),r.stroke()
for(var a=Math.ceil((this.maxY-this.minY)/10),l=-a;l>this.minY;l-=a){var s=(l-this.minY)*this.scaleY
r.beginPath(),r.moveTo(o-5,e.height-s),r.lineTo(o+5,e.height-s),r.stroke()}for(var l=a;l<this.maxY;l+=a){var s=(l-this.minY)*this.scaleY
r.beginPath(),r.moveTo(o-5,e.height-s),r.lineTo(o+5,e.height-s),r.stroke()}}}},Plot.prototype.replot=function(){var e,r,t,a,n,i,o,l,s,c,u,f,d,h,m=0,p=this.buffer
if(p.getContext){var v=p.getContext("2d")
this.plotAxis(),v.shadowColor="#999",v.shadowBlur=3,v.shadowOffsetX=3,v.shadowOffsetY=3
const b=this.minX,g=this.minY,x=this.scaleX,y=this.scaleY,w=p.height
for(var M=function(e){return(e-b)*x},_=function(e){return w-(e-g)*y},k=0;k<this.areas.length;k++){h=this.areas[k],e=h[0],t=h[1],r=h[2],a=h[3],u=h[4],n=h[5],-1==u&&(u=k+1),setcolortransparent(v,u,n)
var A=Math.abs(r-e),L=Math.abs(a-t),C=Math.min(e,r),P=Math.max(t,a)
v.fillRect((C-this.minX)*this.scaleX,p.height-(P-this.minY)*this.scaleY,A*this.scaleX,L*this.scaleY)}v.lineWidth="3"
for(var V=1/0,k=0;k<this.lines.length;k++)h=this.lines[k],(h[0]>=this.minX&&h[0]<=this.maxX&&h[1]>=this.minY&&h[1]<=this.maxY||h[2]>=this.minX&&h[2]<=this.maxX&&h[3]>=this.minY&&h[3]<=this.maxY||h[0]<this.minX&&h[2]>this.maxX&&(h[1]>=this.minY&&h[1]<=this.maxY||h[3]>=this.minY&&h[3]<=this.maxY)||h[2]<this.minX&&0>this.maxX&&(h[1]>=this.minY&&h[1]<=this.maxY||h[3]>=this.minY&&h[3]<=this.maxY)||h[1]<this.minY&&h[3]>this.maxY&&(h[0]>=this.minX&&h[0]<=this.maxY||h[2]>=this.minX&&h[2]<=this.maxX)||h[3]<this.minY&&h[1]>this.maxY&&(h[0]>=this.minX&&h[0]<=this.maxX||h[2]>=this.minX&&h[2]<=this.maxX))&&(e=M(h[0]),t=_(h[1]),r=M(h[2]),a=_(h[3]),(Math.abs(r-e)>1||Math.abs(a-t)>1)&&(u=h[4],f=h[5],-1==u&&(u=k+1),u!=V&&setcolor(v,u),f&&(v.setLineDash([5]),v.lineWidth="1"),v.beginPath(),v.moveTo(e,t),v.lineTo(r,a),v.stroke(),f&&(v.setLineDash([1,0]),v.lineWidth="3"),V=u))
v.lineWidth="1"
for(var I=1/0,S=1/0,V=1/0,j=-1,k=0;k<this.points.length;k++)h=this.points[k],h[0]>=this.minX&&h[0]<=this.maxX&&h[1]>=this.minY&&h[1]<=this.maxY&&(o=M(h[0]),l=_(h[1]),(Math.abs(o-I)>1||Math.abs(l-S)>1)&&(u=h[2],i=h[3],n=h[4],j==n&&V==u||(n>1?setcolor(v,u):setcolortransparent(v,u,n)),v.beginPath(),v.arc(o,l,i,0,2*Math.PI,!0),v.closePath(),v.fill(),I=o,S=l,V=u,j=n))
for(var k=0;k<this.paths.length;k++){h=this.paths[k],u=h[1],i=h[2],n=h[3],f=h[4]
var O=n>0
n>1?setcolor(v,u):setcolortransparent(v,u,n),f?(v.setLineDash([5]),v.lineWidth="1"):v.lineWidth="3",v.beginPath(),o=M(h[0][0][0]),l=_(h[0][0][1]),v.arc(o,l,i,0,2*Math.PI,!0),v.moveTo(o,l)
for(var X=1;X<h[0].length;X++)o=M(h[0][X][0]),l=_(h[0][X][1]),o>=0&&o<=p.width&&l>=0&&l<=p.height&&(O&&v.arc(o,l,i,0,2*Math.PI,!0),v.lineTo(o,l))
v.stroke(),v.setLineDash([1,0]),v.lineWidth="1"}for(var k=0;k<this.fcts.length;k++){h=this.fcts[k],s=h[0],c=h[1],u=h[2],f=h[3],d=h[4],-1==u&&(u=k+1),setcolor(v,u),f?(v.setLineDash([5]),v.lineWidth="1"):v.lineWidth="3",!1!==d?(v.beginPath(),v.moveTo(p.width,p.height-(d-this.minY)*this.scaleY),v.lineTo(0,p.height-(d-this.minY)*this.scaleY)):(v.moveTo(0,p.height/2),v.beginPath())
for(var o=this.minX;o<this.maxX;o+=(this.maxX-this.minX)/this.Nsamples){var l=s(o),S=p.height-(l-this.minY)*this.scaleY
S>=0&&S<=p.height?v.lineTo(M(o),S):v.moveTo(M(o),S)}v.stroke(),!1!==d&&(v.closePath(),setcolortransparent(v,u,.5),v.fill()),v.setLineDash([1,0]),v.lineWidth="1",""!=this.legend&&""!=c&&(setcolor(v,u),"topright"==this.legend?v.strokeText(c,p.width-100,20*(m+1)):"topleft"==this.legend?v.strokeText(c,10,20*(m+1)):"bottomright"==this.legend?v.strokeText(c,p.width-100,p.height-20*(m+1)):"bottomleft"==this.legend&&v.strokeText(c,10,p.height-20*(m+1)),m++)}}var E=document.getElementById(this.canvasId),v=E.getContext("2d")
v.drawImage(this.buffer,this.viewX,this.viewY,E.width,E.height,0,0,E.width,E.height)},Plot.prototype.plot=function(e,r,t,a,n){void 0===n&&(n=!1),void 0===a&&(a=!1),void 0===t&&(t=-1),void 0===r&&(r=a?"":e.name),this.fcts.push([e,r,t,a,n]),this.replot()},Plot.prototype.plot_line=function(e,r,t,a,n,i){void 0===i&&(i=!1),void 0===n&&(n=-1),this.lines.push([e,r,t,a,n,i])},Plot.prototype.plot_area=function(e,r,t,a,n,i){void 0===i&&(i=1),void 0===n&&(n=-1),this.areas.push([e,r,t,a,n,i]),this.replot()},Plot.prototype.plot_path=function(e,r,t,a,n,i){if(void 0===i)var i=!1
if(void 0===t)var t=-1
if(void 0===n)var n=1
if(void 0===a)var a=5
this.paths.push([e,r,t,a,n,i])},Plot.prototype.clear=function(){var e=document.getElementById(this.canvasId)
if(e.getContext){e.getContext("2d")
for(this.plotAxis();this.fcts.length>0;)this.fcts.pop()
for(;this.lines.length>0;)this.lines.pop()
for(;this.areas.length>0;)this.areas.pop()
for(;this.points.length>0;)this.points.pop()}},Plot.prototype.setScalePlot=function(e,r,t,a){this.minX=e,this.maxX=r,this.Nsamples=t
var n=document.getElementById(this.canvasId)
this.scaleX=n.width/(r-e),this.scaleY=this.scaleX*a,this.maxY=n.height/2/this.scaleY,this.minY=-this.maxY,this.originalminX=this.minX,this.originalmaxX=this.maxX,this.originalminY=this.minY,this.originalmaxY=this.maxY},Plot.prototype.view=function(e,r,t,a){this.minX=e,this.maxX=r,this.minY=t,this.maxY=a
var n=this.buffer
this.scaleX=n.width/(r-e),this.scaleY=n.height/(a-t),this.replot()},Plot.prototype.translate=function(e,r){var t=document.getElementById(this.canvasId),a=this.viewX-e,n=this.viewY-r
if(a>=0&&a<this.buffer.width-t.width&&n>=0&&n<this.buffer.height-t.height){this.viewX=a,this.viewY=n
var i=t.getContext("2d")
i.clearRect(0,0,t.width,t.height),i.drawImage(this.buffer,this.viewX,this.viewY,t.width,t.height,0,0,t.width,t.height)}},Plot.prototype.zoom=function(e,r,t,a){var n=document.getElementById(this.canvasId),i=this.buffer
r>0?i.height*=r:i.height=n.height,e>0?i.width*=e:i.width=n.width,i.width<n.width&&(i.width=n.width),i.height<n.height&&(i.height=n.height),i.width>1e4&&(i.width=1e4),i.height>1e4&&i.height
var o=this.scaleX,l=this.scaleY
if(this.scaleX=i.width/(this.maxX-this.minX),this.scaleY=i.height/(this.maxY-this.minY),arguments.length<4)var t=n.width/2,a=n.height/2
this.viewX=(this.viewX+t)*this.scaleX/o-t,this.viewY=(this.viewY+a)*this.scaleY/l-a,this.viewX<0&&(this.viewX=0),this.viewY<0&&(this.viewY=0),this.viewX>i.width-n.width&&(this.viewX=i.width-n.width),this.viewY>i.height-n.height&&(this.viewY=i.height-n.height),o==this.scaleX&&l==this.scaleY||this.replot()},Plot.prototype.resetzoom=function(){var e=document.getElementById(this.canvasId),r=this.buffer
this.viewX=0,this.viewY=0,r.height=e.height,r.width=e.width,this.scaleX=e.width/(this.maxX-this.minX),this.scaleY=e.height/(this.maxY-this.minY),this.replot()},Plot.prototype.pick_point=function(e){if(0==e.button){e.preventDefault()
var r=document.getElementById(this.canvasId),t=r.getBoundingClientRect(),a=e.clientX-t.left,n=e.clientY-t.top
return[a/this.scaleX+this.minX,(r.height-n)/this.scaleY+this.minY]}return!1},Plot.prototype.proximityX=function(e,r,t){return void 0===t&&(t=(this.maxX-this.minX)/20),Math.abs(e-r)<t},Plot.prototype.plotmathjax=function(e,r,t){var a=document.getElementById(this.canvasId)
if(a.getContext){var n=(a.getContext("2d"),document.getElementById("jaxstring"+e))
n.style.top=a.height/2-t*this.scaleY+a.offsetTop,n.style.left=(r-this.minX)*this.scaleX+a.offsetLeft,n.style.visibility="visible"}},Plot.prototype.jpeg=function(){var e=document.getElementById(this.canvasId),r=e.toDataURL("image/jpeg")
document.location.href=r.replace("image/jpeg","image/octet-stream")},Plot.prototype.zoomoriginal=function(){this.view(this.originalminX,this.originalmaxX,this.originalminY,this.originalmaxY)},Plot.prototype.mousestartmove=function(e){var r=document.getElementById(this.canvasId)
if(0==e.button){this.MOVING=!0
var t=r.getBoundingClientRect()
this.xprev=e.clientX-t.left,this.yprev=e.clientY-t.top}else this.MOVING=!1},Plot.prototype.mousestopmove=function(e){this.MOVING=!1},Plot.prototype.mouseposition=function(e){var r=document.getElementById(this.canvasId),t=r.getBoundingClientRect(),a=e.clientX-t.left,n=e.clientY-t.top
if(!this.MOVING){var i=a/this.scaleX+this.minX,o=(r.height-n)/this.scaleY+this.minY
return"x = "+i.toFixed(3)+", y = "+o.toFixed(3)}var l=this.xprev-a,s=n-this.yprev;(Math.abs(l)>1||Math.abs(s)>1)&&this.translate(l,s),this.xprev=a,this.yprev=n},ColorPlot.prototype.colormap=function(e){return[[0,0,143],[0,0,159],[0,0,175],[0,0,191],[0,0,207],[0,0,223],[0,0,239],[0,0,255],[0,15,255],[0,31,255],[0,47,255],[0,63,255],[0,79,255],[0,95,255],[0,111,255],[0,127,255],[0,143,255],[0,159,255],[0,175,255],[0,191,255],[0,207,255],[0,223,255],[0,239,255],[0,255,255],[15,255,239],[31,255,223],[47,255,207],[63,255,191],[79,255,175],[95,255,159],[111,255,143],[127,255,127],[143,255,111],[159,255,95],[175,255,79],[191,255,63],[207,255,47],[223,255,31],[239,255,15],[255,255,0],[255,239,0],[255,223,0],[255,207,0],[255,191,0],[255,175,0],[255,159,0],[255,143,0],[255,127,0],[255,111,0],[255,95,0],[255,79,0],[255,63,0],[255,47,0],[255,31,0],[255,15,0],[255,0,0],[239,0,0],[223,0,0],[207,0,0],[191,0,0],[175,0,0],[159,0,0],[143,0,0],[127,0,0]]},ColorPlot.prototype.addPoint=function(e,r,t){this.x.push(e),this.y.push(r),this.z.push(t)},ColorPlot.prototype.plotAxis=function(){var e=this.buffer
if(e.getContext){var r=e.getContext("2d")
if(r.fillStyle="white",r.fillRect(0,0,e.width,e.height),r.strokeStyle="black",this.minY<0&&this.maxY>0){var t=e.height- -this.minY*this.scaleY
r.beginPath(),r.moveTo(0,t),r.lineTo(e.width,t),r.closePath(),r.stroke()
for(var a=Math.ceil((this.maxX-this.minX)/10),n=-a;n>this.minX;n-=a){var i=(n-this.minX)*this.scaleX
r.beginPath(),r.moveTo(i,t-5),r.lineTo(i,t+5),r.stroke()}for(var n=a;n<this.maxX;n+=a){var i=(n-this.minX)*this.scaleX
r.beginPath(),r.moveTo(i,t-5),r.lineTo(i,t+5),r.stroke()}}if(this.minX<0&&this.maxX>0){var o=-this.minX*this.scaleX
r.beginPath(),r.moveTo(o,0),r.lineTo(o,e.height),r.closePath(),r.stroke()
for(var l=Math.ceil(this.minY);l<this.maxY;l++){var s=e.height-(l-this.minY)*this.scaleY
r.beginPath(),r.moveTo(o-5,s),r.lineTo(o+5,s),r.stroke()}}}},ColorPlot.prototype.replot=function(){var e,r,t,a=this.buffer
if(a.getContext){var n=a.getContext("2d")
this.plotAxis(),n.shadowColor="#999",n.shadowBlur=3,n.shadowOffsetX=3,n.shadowOffsetY=3
for(var i=1/0,o=1/0,l=1/0,s=0;s<this.x.length;s++)this.x[s]>=this.minX&&this.x[s]<=this.maxX&&this.y[s]>=this.minY&&this.y[s]<=this.maxY&&(e=(this.x[s]-this.minX)*this.scaleX,r=a.height-(this.y[s]-this.minY)*this.scaleY,t=Math.floor((this.z[s]-this.minZ)*this.scaleZ),t>=this.cmap.length&&(t=this.cmap.length-1),t<0&&(t=0),(Math.abs(e-i)>1||Math.abs(r-o)>1||t!=l)&&(t!=l&&(n.fillStyle="rgb("+this.cmap[t][0]+","+this.cmap[t][1]+","+this.cmap[t][2]+")"),n.beginPath(),n.arc(e,r,5,0,2*Math.PI,!0),n.closePath(),n.fill(),l=t,i=e,o=r))}var c=document.getElementById(this.canvasId),n=c.getContext("2d")
n.drawImage(this.buffer,this.viewX,this.viewY,c.width,c.height,0,0,c.width,c.height)},ColorPlot.prototype.clear=function(){this.plotAxis(),this.x=new Array,this.y=new Array,this.z=new Array},ColorPlot.prototype.setScale=function(e,r,t,a,n,i){this.minX=e,this.maxX=r,this.minY=t,this.maxY=a,this.minZ=n,this.maxZ=i
var o=document.getElementById(this.canvasId)
this.scaleX=o.width/(r-e),this.scaleY=o.height/(a-t),this.scaleZ=this.cmap.length/(i-n),this.originalminX=this.minX,this.originalmaxX=this.maxX,this.originalminY=this.minY,this.originalmaxY=this.maxY},ColorPlot.prototype.view=function(e,r,t,a){this.minX=e,this.maxX=r,this.minY=t,this.maxY=a
var n=this.buffer
this.scaleX=n.width/(r-e),this.scaleY=n.height/(a-t),this.replot()},ColorPlot.prototype.translate=function(e,r){var t=document.getElementById(this.canvasId),a=this.viewX-e,n=this.viewY-r
if(a>=0&&a<this.buffer.width-t.width&&n>=0&&n<this.buffer.height-t.height){this.viewX=a,this.viewY=n
var i=t.getContext("2d")
i.clearRect(0,0,t.width,t.height),i.drawImage(this.buffer,this.viewX,this.viewY,t.width,t.height,0,0,t.width,t.height)}},ColorPlot.prototype.zoom=function(e,r,t,a){var n=document.getElementById(this.canvasId),i=this.buffer
r>0?i.height*=r:i.height=n.height,e>0?i.width*=e:i.width=n.width,i.width<n.width&&(i.width=n.width),i.height<n.height&&(i.height=n.height),i.width>1e4&&(i.width=1e4),i.height>1e4&&i.height
var o=this.scaleX,l=this.scaleY
if(this.scaleX=i.width/(this.maxX-this.minX),this.scaleY=i.height/(this.maxY-this.minY),arguments.length<4)var t=n.width/2,a=n.height/2
this.viewX=(this.viewX+t)*this.scaleX/o-t,this.viewY=(this.viewY+a)*this.scaleY/l-a,this.viewX<0&&(this.viewX=0),this.viewY<0&&(this.viewY=0),this.viewX>i.width-n.width&&(this.viewX=i.width-n.width),this.viewY>i.height-n.height&&(this.viewY=i.height-n.height),o==this.scaleX&&l==this.scaleY||this.replot()},ColorPlot.prototype.resetzoom=function(){var e=document.getElementById(this.canvasId),r=this.buffer
this.viewX=0,this.viewY=0,r.height=e.height,r.width=e.width,this.scaleX=e.width/(this.maxX-this.minX),this.scaleY=e.height/(this.maxY-this.minY),this.replot()},ColorPlot.prototype.jpeg=function(){var e=document.getElementById(this.canvasId),r=e.toDataURL("image/jpeg")
document.location.href=r.replace("image/jpeg","image/octet-stream")},ColorPlot.prototype.zoomoriginal=function(){this.view(this.originalminX,this.originalmaxX,this.originalminY,this.originalmaxY)},ColorPlot.prototype.mousestartmove=function(e){var r=document.getElementById(this.canvasId)
if(0==e.button){this.MOVING=!0
var t=r.getBoundingClientRect()
this.xprev=e.clientX-t.left,this.yprev=e.clientY-t.top}else this.MOVING=!1},ColorPlot.prototype.mousestopmove=function(e){this.MOVING=!1},ColorPlot.prototype.mouseposition=function(e){var r=document.getElementById(this.canvasId),t=r.getBoundingClientRect(),a=e.clientX-t.left,n=e.clientY-t.top
if(!this.MOVING){var i=a/this.scaleX+this.minX,o=(r.height-n)/this.scaleY+this.minY
return"x = "+i.toFixed(3)+", y = "+o.toFixed(3)}var l=this.xprev-a,s=n-this.yprev;(Math.abs(l)>1||Math.abs(s)>1)&&this.translate(l,s),this.xprev=a,this.yprev=n},Plot2D.prototype.clear=function(){var e=document.getElementById(this.canvasId)
if(e.getContext){var r=e.getContext("2d")
this.scaleX1=e.width/(this.maxX1-this.minX1),this.scaleX2=e.height/(this.maxX2-this.minX2),this.NsamplesX1=e.width/4,this.NsamplesX2=e.height/4,r.fillStyle="white",r.fillRect(0,0,e.width,e.height),r.strokeStyle="black",r.lineWidth="1",this.minX2<0&&this.maxX2>0&&(r.beginPath(),r.moveTo(0,e.height+this.minX2*this.scaleX2),r.lineTo(e.width,e.height+this.minX2*this.scaleX2),r.closePath(),r.stroke()),this.minX1<0&&this.maxX1>0&&(r.beginPath(),r.moveTo(-this.minX1*this.scaleX1,0),r.lineTo(-this.minX1*this.scaleX1,e.height),r.closePath(),r.stroke())}},Plot2D.prototype.clearData=function(){for(""!=this.tableId&&(document.getElementById(this.tableId).innerHTML="<tr> <td> x1 </td><td> x2 </td><td> y </td></tr> ");this.Yapp.length>0;)this.Yapp.pop(),this.Xapp.pop()
this.m=0},Plot2D.prototype.levelcurve=function(e,r){var t=document.getElementById(this.canvasId)
if(t.getContext){var a=t.getContext("2d")
a.fillStyle="rgb(0,0,200)",a.strokeStyle="rgb(0,0,200)"
for(var n=new Array,i=0,o=0,l=this.minX1;l<this.maxX1;l+=(this.maxX1-this.minX1)/this.NsamplesX1){n[i]=new Array
for(var s=this.minX2;s<this.maxX2;s+=(this.maxX2-this.minX2)/this.NsamplesX2){var c=[l,s]
n[i][o]=e(c),o++}i++}for(var i=0,o=0,l=this.minX1;l<this.maxX1;l+=(this.maxX1-this.minX1)/this.NsamplesX1){for(var s=this.minX2;s<this.maxX2;s+=(this.maxX2-this.minX2)/this.NsamplesX2)(o>0&&n[i][o]>=r&&n[i][o-1]<=r||o>0&&n[i][o]<=r&&n[i][o-1]>=r||i>0&&n[i][o]<=r&&n[i-1][o]>=r||i>0&&n[i][o]>=r&&n[i-1][o]<=r)&&a.fillRect((l-this.minX1)*this.scaleX1-2,t.height-(s-this.minX2)*this.scaleX2-2,4,4),o++
i++}}},Plot2D.prototype.colormap=function(e){var r=document.getElementById(this.canvasId)
if(r.getContext){for(var t=r.getContext("2d"),a=-1/0,n=1/0,i=new Array,o=0,l=0,s=this.minX1;s<this.maxX1;s+=(this.maxX1-this.minX1)/this.NsamplesX1){i[o]=new Array
for(var c=this.minX2;c<this.maxX2;c+=(this.maxX2-this.minX2)/this.NsamplesX2){var u=[s,c]
i[o][l]=e(u),i[o][l]>a&&(a=i[o][l]),i[o][l]<n&&(n=i[o][l]),l++}o++}for(var f=255/(a-n),o=0,l=0,s=this.minX1;s<this.maxX1;s+=(this.maxX1-this.minX1)/this.NsamplesX1){for(var c=this.minX2;c<this.maxX2;c+=(this.maxX2-this.minX2)/this.NsamplesX2)Math.abs(i[o][l])<1e-5?t.fillStyle="black":i[o][l]<0?t.fillStyle="rgba(0,0,"+(255-Math.floor((i[o][l]-n)*f))+", 0.9)":t.fillStyle="rgba("+Math.floor((i[o][l]-n)*f)+",0,0, 0.9)",t.fillRect((s-this.minX1)*this.scaleX1-2,r.height-(c-this.minX2)*this.scaleX2-2,4,4),Math.abs(i[o][l])<1&&(t.fillStyle="rgba(200,200,200,0.5)",t.fillRect((s-this.minX1)*this.scaleX1-2,r.height-(c-this.minX2)*this.scaleX2-2,4,4)),l++
o++}}},Plot2D.prototype.point=function(e,r,t,a,n){void 0===a&&(a=1.1),void 0===n&&(n=5)
var i=document.getElementById(this.canvasId)
if(i.getContext){var o=i.getContext("2d")
a<1?setcolortransparent(o,t,a):setcolor(o,t),o.beginPath(),o.arc((e-this.minX1)*this.scaleX1,i.height-(r-this.minX2)*this.scaleX2,n,0,2*Math.PI,!0),o.closePath(),o.fill()}},Plot2D.prototype.pointmouse=function(e){if(0==e.button){e.preventDefault()
var r=document.getElementById(this.canvasId)
if(r.getContext){var t=(r.getContext("2d"),r.getBoundingClientRect()),a=e.clientX-t.left,n=e.clientY-t.top,i=parseInt(document.getElementById("selectcolor").value),o=i,l=a/this.scaleX1+this.minX1,s=(r.height-n)/this.scaleX2+this.minX2
if(this.point(l,s,i),this.Xapp[this.m]=new Array,this.Xapp[this.m][0]=l,this.Xapp[this.m][1]=s,this.Yapp[this.m]=o,this.m++,""!=this.tableId){document.getElementById(this.tableId).innerHTML+="<tr><td>"+l.toFixed(2)+"</td><td>"+s.toFixed(2)+"</td><td>"+o+"</td></tr>"}}}},Plot2D.prototype.plot_data=function(){this.m!=this.Yapp.length&&(this.m=this.Yapp.length)
for(var e=0;e<this.m;e++)this.point(this.Xapp[e][0],this.Xapp[e][1],this.Yapp[e])},Plot2D.prototype.plot_vector=function(e,r,t,a,n,i){void 0===i&&(i=0),e=(e-this.minX1)*this.scaleX1,t=(t-this.minX1)*this.scaleX1,r=(r-this.minX2)*this.scaleX2,a=(a-this.minX2)*this.scaleX2
var o=Math.atan((a-r)/(t-e)),l=Math.atan((t-e)/(a-r)),s=t,c=a,u=t,f=a
a>=r?(s-=10*Math.sin(l-Math.PI/12),c-=10*Math.cos(l-Math.PI/12)):(s+=10*Math.sin(l-Math.PI/12),c+=10*Math.cos(l-Math.PI/12)),t>=e?(u-=10*Math.cos(o-Math.PI/12),f-=10*Math.sin(o-Math.PI/12)):(u+=10*Math.cos(o-Math.PI/12),f+=10*Math.sin(o-Math.PI/12))
var d=document.getElementById(this.canvasId)
if(d.getContext){var h=d.getContext("2d")
if(h.lineWidth="1",setcolor(h,i),h.beginPath(),h.moveTo(e,d.height-r),h.lineTo(t,d.height-a),h.lineTo(s,d.height-c),h.lineTo(u,d.height-f),h.lineTo(t,d.height-a),h.stroke(),h.fill(),void 0!==n){h.lineWidth="1"
var m=5
t<e&&(m=-15),h.strokeText(n,t+m,d.height-a)}}},Plot2D.prototype.plot_line=function(e,r,t,a,n,i,o,l){void 0===i&&(i=0),void 0===o&&(o=!1),void 0===l&&(l=1),e=(e-this.minX1)*this.scaleX1,t=(t-this.minX1)*this.scaleX1,r=(r-this.minX2)*this.scaleX2,a=(a-this.minX2)*this.scaleX2
var s=document.getElementById(this.canvasId)
if(s.getContext){var c=s.getContext("2d")
c.lineWidth=""+l,setcolor(c,i),o&&c.setLineDash([5]),c.beginPath(),c.moveTo(e,s.height-r),c.lineTo(t,s.height-a),c.stroke(),c.setLineDash([1,0]),void 0!==n&&""!=n&&(c.lineWidth="1",c.strokeText(n,(t+e)/2-10,s.height-10-(a+r)/2))}},Plot2D.prototype.plot_classifier=function(e,r,t,a){if(void 0===a)var a=!1
if(void 0===t)var t=0
var n,i,o=this.minX1,l=this.maxX1
0!=e[1]?(n=(-r-e[0]*o)/e[1],i=(-r-e[0]*l)/e[1]):(o=-r/e[0],l=-r/e[0],n=this.minX2,i=this.maxX2)
var s=document.getElementById(plot.canvasId)
if(s.getContext){var c=s.getContext("2d")
c.lineWidth="3",a?c.strokeStyle="grey":setcolor(c,t),c.setLineDash([1,0]),c.beginPath(),c.moveTo((o-this.minX1)*this.scaleX1,s.height/2-n*this.scaleX2),c.lineTo((l-this.minX1)*this.scaleX1,s.height/2-i*this.scaleX2),c.stroke()}},Plot2D.prototype.coord2datavector=function(e,r){var t=document.getElementById(this.canvasId),a=[0,0]
return a[0]=e/this.scaleX1+this.minX1,a[1]=-(r-t.height)/this.scaleX2+this.minX2,a},Plot2D.prototype.plotmathjax=function(e,r,t){var a=document.getElementById(this.canvasId)
if(a.getContext){var n=(a.getContext("2d"),document.getElementById("jaxstring"+e))
n.style.top=a.height-(t-this.minX2)*this.scaleX2+a.offsetTop,n.style.left=(r-this.minX1)*this.scaleX1+a.offsetLeft,n.style.visibility="visible"}},Plot2D.prototype.clearmathjax=function(e){document.getElementById("jaxstring"+e).style.visibility="hidden"},Plot2D.prototype.text=function(e,r,t){var a=document.getElementById(this.canvasId)
if(a.getContext){var n=a.getContext("2d")
n.lineWidth="0.5",n.strokeStyle="black",n.strokeText(t,(e-this.minX1)*this.scaleX1,a.height-(r-this.minX2)*this.scaleX2)}},Plot3D.prototype.test=function(){this.X.push([5,0,0]),this.X.push([0,5,0]),this.X.push([0,0,5]),this.Y.push(1),this.Y.push(2),this.Y.push(3),this.X.push([2,0,0]),this.X.push([0,-6,0]),this.X.push([0,0,2]),this.Y.push(1),this.Y.push(2),this.Y.push(3),this.X.push([5,5,5]),this.Y.push(3),this.sphere([5,-5,1],50,"",1),this.sphere([-5,5,-3],30,"",3),this.replot(),this.animateAuto=100,this.animate(50)},Plot3D.prototype.computeRanges=function(){var e
for(e=0;e<this.Y.length;e++){var r=Math.sqrt(this.X[e][0]*this.X[e][0]+this.X[e][1]*this.X[e][1]+this.X[e][2]*this.X[e][2])
r>this.maxX2&&(this.maxX2=r,this.minX2=-r)}},Plot3D.prototype.replot=function(){var e,r,t,a,n,i,o,l=this.cameraDistance+this.maxX2-this.minX2
for(this.clear(),this.point2D(0,0,0,1,3),this.line([-1,0,0],[10,0,0],this.axisNameX1),this.line([0,-1,0],[0,10,0],this.axisNameX2),this.line([0,0,-1],[0,0,10],this.axisNameX3),o=0;o<this.Y.length;o++)i=this.project(this.X[o]),e=i[0],r=i[1],t=i[2],a=t<l?t/l:1,n=Math.floor(2+10*(1-a)),this.point2D(e,r,this.Y[o],a,n)
for(o=0;o<this.lines.length;o++)this.line(this.lines[o][0],this.lines[o][1],this.lines[o][2],this.lines[o][3])
for(o=0;o<this.planes.length;o++)this.drawplane(this.planes[o][0],this.planes[o][1],this.planes[o][2],this.planes[o][3])
var s=new Array
for(o=0;o<this.spheres.length;o++){var i=this.project(this.spheres[o][0])
s[o]=i[2]}for(var c=0;c<this.spheres.length;c++){var u=0
for(o=1;o<this.spheres.length;o++)s[o]>s[u]&&(u=o)
this.drawsphere(this.spheres[u][0],this.spheres[u][1],this.spheres[u][2],this.spheres[u][3]),s[u]=-1}},Plot3D.prototype.clear=function(){var e=document.getElementById(this.canvasId)
if(e.getContext){e.getContext("2d").clearRect(0,0,e.width,e.height)}},Plot3D.prototype.clear_data=function(){for(;this.Y.length>0;)this.Y.pop(),this.X.pop()},Plot3D.prototype.clear_planes=function(){for(;this.planes.length>0;)this.planes.pop()},Plot3D.prototype.rotateX=function(e){this.angleX+=e,this.replot()},Plot3D.prototype.rotateY=function(e){this.angleY+=e,this.replot()},Plot3D.prototype.rotateZ=function(e,r){if(void 0===r)var r=!0
this.angleZ+=e,r&&this.replot()},Plot3D.prototype.mouserotation=function(e){if(this.ROTATING){e.preventDefault()
var r=e.clientX-this.mouseX,t=e.clientY-this.mouseY
this.mouseX=e.clientX,this.mouseY=e.clientY,Math.abs(r)>.2&&this.rotateZ(r/20,!(Math.abs(t)>.2)),Math.abs(t)>.2&&this.rotateX(t/20)}},Plot3D.prototype.mousedown=function(e){e.preventDefault(),this.ROTATING=!0,this.mouseX=e.clientX,this.mouseY=e.clientY,this.animateStop()},Plot3D.prototype.mouseup=function(e){e.preventDefault(),this.ROTATING=!1,this.animateAuto>0&&this.animate(this.animateAuto)},Plot3D.prototype.mousezoom=function(e){var r=0
e||(e=window.event),e.preventDefault(),e.wheelDelta?r=e.wheelDelta/30:e.detail&&(r=-e.detail),plot3.cameraDistance-=r,plot3.cameraDistance<5?plot3.cameraDistance=5:plot3.cameraDistance>100&&(plot3.cameraDistance=100),plot3.replot()},Plot3D.prototype.project=function(e){var r=new Array(3)
r[0]=e[0],r[1]=Math.cos(this.angleX)*e[1]-Math.sin(this.angleX)*e[2],r[2]=Math.sin(this.angleX)*e[1]+Math.cos(this.angleX)*e[2]
var t=new Array(3)
t[0]=Math.cos(this.angleY)*r[0]-Math.sin(this.angleY)*r[2],t[1]=r[1],t[2]=Math.sin(this.angleY)*r[0]+Math.cos(this.angleY)*r[2]
var a=new Array(3)
a[0]=Math.cos(this.angleZ)*t[0]-Math.sin(this.angleZ)*t[1],a[1]=Math.sin(this.angleZ)*t[0]+Math.cos(this.angleZ)*t[1],a[2]=t[2]
var n=this.cameraDistance/20
return a[0]/=n,a[1]/=n,a[2]/=n,[a[0],a[2],this.cameraDistance+a[1]]},Plot3D.prototype.line=function(e,r,t,a,n,i){var o,l,s=this.project(e)
o=s[0],l=s[1]
var c,u
s=this.project(r),c=s[0],u=s[1],this.line2D(o,l,c,u,t,a,n,i)},Plot3D.prototype.plot_line=function(e,r,t,a){if(void 0===a)var a=0
this.lines.push([e,r,t,a]),this.line(e,r,t,a)},Plot3D.prototype.plane=function(e,r,t,a){if(void 0===a)var a=3
if(void 0===t)var t=""
this.planes.push([e,r,t,a]),this.drawplane(e,r,t,a)},Plot3D.prototype.drawplane=function(e,r,t,a){var n,i=new Array(3),o=new Array(3)
i[0]=e[0],i[1]=r[1],i[2]=e[2],o[0]=r[0],o[1]=e[1],o[2]=r[2],n=this.project(e)
var l=n[0],s=n[1]
n=this.project(r)
var c=n[0],u=n[1]
n=this.project(i)
var f=n[0],d=n[1]
n=this.project(o)
var h=n[0],m=n[1]
this.polygone2D([l,f,c,h],[s,d,u,m],t,a)},Plot3D.prototype.sphere=function(e,r,t,a){if(void 0===a)var a=1
if(void 0===t)var t=""
this.spheres.push([e,r,t,a]),this.drawsphere(e,r,t,a)},Plot3D.prototype.drawsphere=function(e,r,t,a){var n
n=this.project(e)
var i=n[0],o=n[1],l=n[2]
if(l>=0){var s=1,c=this.cameraDistance+this.maxX2-this.minX2
l<c&&(s=l/c*.5)
var u=Math.floor(r*(0+3*(1-s)*(1-s)))
this.disk2D(i,o,u,t,a,s)}},Plot3D.prototype.point2D=function(e,r,t,a,n){if(e>=this.viewminX1&&e<=this.viewmaxX1&&r>=this.viewminX2&&r<=this.viewmaxX2){if(void 0===a)var a=1.1
if(void 0===n)var n=5
var i=document.getElementById(this.canvasId)
if(i.getContext){var o=i.getContext("2d")
a<1?setcolortransparent(o,t,a):setcolor(o,t),o.beginPath(),o.arc((e-this.viewminX1)*this.viewscaleX1,i.height-(r-this.viewminX2)*this.viewscaleX2,n,0,2*Math.PI,!0),o.closePath(),o.fill()}}},Plot3D.prototype.line2D=function(e,r,t,a,n,i,o,l){void 0===i&&(i=0),void 0===o&&(o=!1),void 0===l&&(l=1),e=(e-this.viewminX1)*this.viewscaleX1,t=(t-this.viewminX1)*this.viewscaleX1,r=(r-this.viewminX2)*this.viewscaleX2,a=(a-this.viewminX2)*this.viewscaleX2
var s=document.getElementById(this.canvasId)
if(e<0&&(e=0),e>=s.width&&(e=s.width-1),r<=0&&(r=1),r>s.height&&(r=s.height),t<0&&(t=0),t>=s.width&&(t=s.width-1),a<=0&&(a=1),a>s.height&&(r=s.height),s.getContext){var c=s.getContext("2d")
if(c.lineWidth=""+l,setcolor(c,i),o&&c.setLineDash([5]),c.beginPath(),c.moveTo(e,s.height-r),c.lineTo(t,s.height-a),c.stroke(),o&&c.setLineDash([1,0]),void 0!==n&&""!=n){var u=(t+e)/2-10,f=s.height+10-(a+r)/2
if(0==n.indexOf("jaxstring")){var d=document.getElementById(n)
d.style.fontSize="70%",d.style.top=f+s.offsetTop,d.style.left=u+s.offsetLeft,d.style.visibility="visible"}else c.lineWidth="1",c.strokeText(n,u,f)}}},Plot3D.prototype.polygone2D=function(e,r,t,a){void 0===a&&(a=3)
var n
for(n=0;n<e.length;n++)e[n]=(e[n]-this.viewminX1)*this.viewscaleX1,r[n]=(r[n]-this.viewminX2)*this.viewscaleX2
var i=document.getElementById(this.canvasId)
if(i.getContext){var o=i.getContext("2d")
for(setcolortransparent(o,a,.5),o.beginPath(),o.moveTo(e[0],i.height-r[0]),n=0;n<e.length;n++)o.lineTo(e[n],i.height-r[n])
if(o.fill(),void 0!==t&&""!=t){var l=-10+e[0],s=i.height+10-r[0]
if(0==t.indexOf("jaxstring")){var c=document.getElementById(t)
c.style.fontSize="70%",c.style.top=s+i.offsetTop,c.style.left=l+i.offsetLeft,c.style.visibility="visible"}else o.lineWidth="1",o.strokeText(t,l,s)}}},Plot3D.prototype.disk2D=function(e,r,t,a,n,i){if(void 0===i)var i=1.1
if(void 0===t)var t=5
if(e+t>=this.viewminX1&&e-t<=this.viewmaxX1&&r+t>=this.viewminX2&&r-t<=this.viewmaxX2){var o=document.getElementById(this.canvasId)
if(o.getContext){var l=o.getContext("2d"),s=(e-this.viewminX1)*this.viewscaleX1,c=o.height-(r-this.viewminX2)*this.viewscaleX2
if(i<1?setcolortransparentgradient(l,n,i,Math.sqrt(s*s+c*c)+t):setcolorgradient(l,n,Math.sqrt(s*s+c*c)+t),l.beginPath(),l.arc(s,c,t,0,2*Math.PI,!0),l.closePath(),l.fill(),void 0!==a&&""!=a){if(0==a.indexOf("jaxstring")){var u=document.getElementById(a)
u.style.fontSize="70%",u.style.top=c+o.offsetTop,u.style.left=s+o.offsetLeft,u.style.visibility="visible"}else{var f=a.split("*")
l.textAlign="center"
var d=Math.floor(.2*t),h=l.font
if(l.font=d+"pt sans-serif",l.fillStyle="black",1==f.length)l.fillText(a,s,c)
else for(var m=0;m<f.length;m++)l.fillText(f[m],s,c-(f.length/2-m-.5)*(1.5*d))
l.font=h}}}}},Plot3D.prototype.animate=function(e){if(void 0===e)var e=this.animateAuto
this.animateStop()
var r=this
this.animation=setInterval(function(){r.rotateZ(.01)},e)},Plot3D.prototype.animateStop=function(){null!=this.animation&&(clearInterval(this.animation),this.animation=null)},Plot3D.prototype.isInSphere=function(e,r,t,a){var n=e-a[0][0],i=r-a[0][1],o=t-a[0][2]
return n*n+i*i+o*o<=a[1]*a[1]},{laloprint:laloprint,lalo:lalo,Lalolab:Lalolab,load_data:load_data,LALOLIB_ERROR:LALOLIB_ERROR,EPS:EPS,isZero:isZero,tic:tic,toc:toc,type:type,isArrayOfNumbers:isArrayOfNumbers,isScalar:isScalar,printVector:printVector,Matrix:Matrix,array2mat:array2mat,array2vec:array2vec,size:size,ones:ones,zeros:zeros,eye:eye,diag:diag,vec:vec,matrixCopy:matrixCopy,vectorCopy:vectorCopy,vectorCopyInto:vectorCopyInto,arrayCopy:arrayCopy,appendRow:appendRow,reshape:reshape,get:get,getSubMatrix:getSubMatrix,getRows:getRows,getCols:getCols,getSubVector:getSubVector,getSubArray:getSubArray,getrowref:getrowref,set:set,setVectorScalar:setVectorScalar,setVectorVector:setVectorVector,setMatrixScalar:setMatrixScalar,setMatrixMatrix:setMatrixMatrix,setMatrixColVector:setMatrixColVector,setMatrixRowVector:setMatrixRowVector,setRows:setRows,setCols:setCols,dense:dense,supp:supp,range:range,swaprows:swaprows,swapcols:swapcols,randnScalar:randnScalar,randn:randn,randVector:randVector,randMatrix:randMatrix,rand:rand,randnsparse:randnsparse,randsparse:randsparse,randperm:randperm,apply:apply,aaplyVector:applyVector,applyMatrix:applyMatrix,applyComplexVector:applyComplexVector,applyComplexMatrix:applyComplexMatrix,mul:mul,mulScalarVector:mulScalarVector,mulScalarMatrix:mulScalarMatrix,dot:dot,mulMatrixVector:mulMatrixVector,mulMatrixTransVector:mulMatrixTransVector,mulMatrixMatrix:mulMatrixMatrix,entrywisemulVector:entrywisemulVector,entrywisemulMatrix:entrywisemulMatrix,entrywisemul:entrywisemul,saxpy:saxpy,gaxpy:gaxpy,divVectorScalar:divVectorScalar,divScalarVector:divScalarVector,divVectors:divVectors,divMatrixScalar:divMatrixScalar,divScalarMatrix:divScalarMatrix,divMatrices:divMatrices,entrywisediv:entrywisediv,outerprodVectors:outerprodVectors,outerprod:outerprod,addScalarVector:addScalarVector,addScalarMatrix:addScalarMatrix,addVectors:addVectors,addMatrices:addMatrices,add:add,subScalarVector:subScalarVector,subVectorScalar:subVectorScalar,subScalarMatrix:subScalarMatrix,subMatrixScalar:subMatrixScalar,subVectors:subVectors,subMatrices:subMatrices,sub:sub,pow:pow,minus:minus,minusVector:minusVector,minusMatrix:minusMatrix,minVector:minVector,minMatrix:minMatrix,minVectorScalar:minVectorScalar,minMatrixScalar:minMatrixScalar,minMatrixRows:minMatrixRows,minMatrixCols:minMatrixCols,minVectorVector:minVectorVector,minMatrixMatrix:minMatrixMatrix,min:min,maxVector:maxVector,maxMatrix:maxMatrix,maxVectorScalar:maxVectorScalar,maxMatrixScalar:maxMatrixScalar,maxMatrixRows:maxMatrixRows,maxMatrixCols:maxMatrixCols,maxVectorVector:maxVectorVector,maxMatrixMatrix:maxMatrixMatrix,max:max,transposeMatrix:transposeMatrix,transposeVector:transposeVector,transpose:transpose,det:det,trace:trace,triiu:triu,tril:tril,issymmetric:issymmetric,mat:mat,isEqual:isEqual,isNotEqual:isNotEqual,isGreater:isGreater,isGreaterOrEqual:isGreaterOrEqual,isLower:isLower,isLowerOrEqual:isLowerOrEqual,find:find,argmax:argmax,findmax:findmax,argmin:argmin,findmin:findmin,sort:sort,sumVector:sumVector,sumMatrix:sumMatrix,sumMatrixRows:sumMatrixRows,sumMatrixCols:sumMatrixCols,sum:sum,prodVector:prodVector,prodMatrix:prodMatrix,prodMatrixRows:prodMatrixRows,prodMatrixCols:prodMatrixCols,prod:prod,mean:mean,variance:variance,std:std,cov:cov,xtx:xtx,norm:norm,norm1:norm1,norminf:norminf,normp:normp,normnuc:normnuc,norm0:norm0,norm0Vector:norm0Vector,solve:solve,cholsolve:cholsolve,inv:inv,chol:chol,ldlsymmetricpivoting:ldlsymmetricpivoting,qr:qr,solvecg:solvecg,cgnr:cgnr,eig:eig,eigs:eigs,svd:svd,rank:rank,nullspace:nullspace,orth:orth,nchoosek:nchoosek,mvnrnd:mvnrnd,Distribution:Distribution,Uniform:Uniform,Gaussian:Gaussian,mvGaussian:mvGaussian,Bernoulli:Bernoulli,Poisson:Poisson,spVector:spVector,spMatrix:spMatrix,spgetRows:spgetRows,fullVector:fullVector,fullMatrix:fullMatrix,full:full,sparseVector:sparseVector,sparseMatrix:sparseMatrix,sparseMatrixRowMajor:sparseMatrixRowMajor,sparse:sparse,speye:speye,spdiag:spdiag,transposespVector:transposespVector,transposespMatrix:transposespMatrix,spmat:spmat,mulScalarspVector:mulScalarspVector,mulScalarspMatrix:mulScalarspMatrix,spdot:spdot,dotspVectorVector:dotspVectorVector,mulMatrixspVector:mulMatrixspVector,mulspMatrixVector:mulspMatrixVector,mulspMatrixTransVector:mulspMatrixTransVector,mulspMatrixspVector:mulspMatrixspVector,mulspMatrixTransspVector:mulspMatrixTransspVector,mulspMatrixspMatrix:mulspMatrixspMatrix,mulMatrixspMatrix:mulMatrixspMatrix,mulspMatrixMatrix:mulspMatrixMatrix,entrywisemulspVectors:entrywisemulspVectors,entrywisemulspVectorVector:entrywisemulspVectorVector,entrywisemulspMatrices:entrywisemulspMatrices,entrywisemulspMatrixMatrix:entrywisemulspMatrixMatrix,addScalarspVector:addScalarspVector,addVectorspVector:addVectorspVector,addspVectors:addspVectors,addScalarspMatrix:addScalarspMatrix,addMatrixspMatrix:addMatrixspMatrix,addspMatrices:addspMatrices,spsaxpy:spsaxpy,subScalarspVector:subScalarspVector,subVectorspVector:subVectorspVector,subspVectorVector:subspVectorVector,subspVectors:subspVectors,subScalarspMatrix:subScalarspMatrix,subspMatrixMatrix:subspMatrixMatrix,subMatrixspMatrix:subMatrixspMatrix,subspMatrices:subspMatrices,applyspVector:applyspVector,applyspMatrix:applyspMatrix,sumspVector:sumspVector,sumspMatrix:sumspMatrix,sumspMatrixRows:sumspMatrixRows,sumspMatrixCols:sumspMatrixCols,prodspMatrixRows:prodspMatrixRows,prodspMatrixCols:prodspMatrixCols,Complex:Complex,addComplex:addComplex,addComplexReal:addComplexReal,subComplex:subComplex,minusComplex:minusComplex,mulComplex:mulComplex,mulComplexReal:mulComplexReal,divComplex:divComplex,conj:conj,modulus:modulus,absComplex:absComplex,expComplex:expComplex,ComplexVector:ComplexVector,ComplexMatrix:ComplexMatrix,real:real,imag:imag,transposeComplexMatrix:transposeComplexMatrix,addComplexVectors:addComplexVectors,subComplexVectors:subComplexVectors,addComplexMatrices:addComplexMatrices,subComplexMatrices:subComplexMatrices,addComplexVectorVector:addComplexVectorVector,subComplexVectorVector:subComplexVectorVector,addComplexMatrixMatrix:addComplexMatrixMatrix,subComplexMatrixMatrix:subComplexMatrixMatrix,addScalarComplexVector:addScalarComplexVector,subScalarComplexVector:subScalarComplexVector,addScalarComplexMatrix:addScalarComplexMatrix,entrywisemulComplexVectors:entrywisemulComplexVectors,entrywisedivComplexVectors:entrywisedivComplexVectors,entrywisemulComplexMatrices:entrywisemulComplexMatrices,entrywisedivComplexMatrices:entrywisedivComplexMatrices,entrywisemulComplexVectorVector:entrywisemulComplexVectorVector,entrywisemulComplexMatrixMatrix:entrywisemulComplexMatrixMatrix,minusComplexVector:minusComplexVector,minusComplexMatrix:minusComplexMatrix,sumComplexVector:sumComplexVector,sumComplexMatrix:sumComplexMatrix,norm1ComplexVector:norm1ComplexVector,norm2ComplexVector:norm2ComplexVector,normFroComplexMatrix:normFroComplexMatrix,dotComplexVectors:dotComplexVectors,dotComplexVectorVector:dotComplexVectorVector,mulScalarComplexVector:mulScalarComplexVector,mulComplexComplexVector:mulComplexComplexVector,mulComplexVector:mulComplexVector,mulScalarComplexMatrix:mulScalarComplexMatrix,mulComplexComplexMatrix:mulComplexComplexMatrix,mulComplexMatrix:mulComplexMatrix,mulComplexMatrixVector:mulComplexMatrixVector,mulComplexMatrixComplexVector:mulComplexMatrixComplexVector,mulComplexMatrices:mulComplexMatrices,mulComplexMatrixMatrix:mulComplexMatrixMatrix,fft:fft,ifft:ifft,dft:dft,idft:idft,spectrum:spectrum,lp:lp,linprog:linprog,minl1:minl1,minl0:minl0,qp:qp,quadprog:quadprog,minimize:minimize,secant:secant,steepestdescent:steepestdescent,bfgs:bfgs}}()
